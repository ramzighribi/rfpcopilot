(()=>{var a={};a.id=974,a.ids=[974],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},374:(a,b,c)=>{let d=c(42596),e=c(55017),f=c(39379),g=c(45663),h=c(49622),i=c(47706),j=c(12132),k=c(60174),{KeyObject:l,createSecretKey:m,createPublicKey:n}=c(55511),o=["RS256","RS384","RS512"],p=["ES256","ES384","ES512"],q=["RS256","RS384","RS512"],r=["HS256","HS384","HS512"];j&&(o.splice(o.length,0,"PS256","PS384","PS512"),q.splice(q.length,0,"PS256","PS384","PS512")),a.exports=function(a,b,c,j){let s,t,u;if("function"!=typeof c||j||(j=c,c={}),c||(c={}),c=Object.assign({},c),s=j||function(a,b){if(a)throw a;return b},c.clockTimestamp&&"number"!=typeof c.clockTimestamp)return s(new d("clockTimestamp must be a number"));if(void 0!==c.nonce&&("string"!=typeof c.nonce||""===c.nonce.trim()))return s(new d("nonce must be a non-empty string"));if(void 0!==c.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof c.allowInvalidAsymmetricKeyTypes)return s(new d("allowInvalidAsymmetricKeyTypes must be a boolean"));let v=c.clockTimestamp||Math.floor(Date.now()/1e3);if(!a)return s(new d("jwt must be provided"));if("string"!=typeof a)return s(new d("jwt must be a string"));let w=a.split(".");if(3!==w.length)return s(new d("jwt malformed"));try{t=g(a,{complete:!0})}catch(a){return s(a)}if(!t)return s(new d("invalid token"));let x=t.header;if("function"==typeof b){if(!j)return s(new d("verify must be called asynchronous if secret or public key is provided as a callback"));u=b}else u=function(a,c){return c(null,b)};return u(x,function(b,g){let j;if(b)return s(new d("error in secret or public key callback: "+b.message));let u=""!==w[2].trim();if(!u&&g)return s(new d("jwt signature is required"));if(u&&!g)return s(new d("secret or public key must be provided"));if(!u&&!c.algorithms)return s(new d('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=g&&!(g instanceof l))try{g=n(g)}catch(a){try{g=m("string"==typeof g?Buffer.from(g):g)}catch(a){return s(new d("secretOrPublicKey is not valid key material"))}}if(c.algorithms||("secret"===g.type?c.algorithms=r:["rsa","rsa-pss"].includes(g.asymmetricKeyType)?c.algorithms=q:"ec"===g.asymmetricKeyType?c.algorithms=p:c.algorithms=o),-1===c.algorithms.indexOf(t.header.alg))return s(new d("invalid algorithm"));if(x.alg.startsWith("HS")&&"secret"!==g.type)return s(new d(`secretOrPublicKey must be a symmetric key when using ${x.alg}`));if(/^(?:RS|PS|ES)/.test(x.alg)&&"public"!==g.type)return s(new d(`secretOrPublicKey must be an asymmetric key when using ${x.alg}`));if(!c.allowInvalidAsymmetricKeyTypes)try{i(x.alg,g)}catch(a){return s(a)}try{j=k.verify(a,t.header.alg,g)}catch(a){return s(a)}if(!j)return s(new d("invalid signature"));let y=t.payload;if(void 0!==y.nbf&&!c.ignoreNotBefore){if("number"!=typeof y.nbf)return s(new d("invalid nbf value"));if(y.nbf>v+(c.clockTolerance||0))return s(new e("jwt not active",new Date(1e3*y.nbf)))}if(void 0!==y.exp&&!c.ignoreExpiration){if("number"!=typeof y.exp)return s(new d("invalid exp value"));if(v>=y.exp+(c.clockTolerance||0))return s(new f("jwt expired",new Date(1e3*y.exp)))}if(c.audience){let a=Array.isArray(c.audience)?c.audience:[c.audience];if(!(Array.isArray(y.aud)?y.aud:[y.aud]).some(function(b){return a.some(function(a){return a instanceof RegExp?a.test(b):a===b})}))return s(new d("jwt audience invalid. expected: "+a.join(" or ")))}if(c.issuer&&("string"==typeof c.issuer&&y.iss!==c.issuer||Array.isArray(c.issuer)&&-1===c.issuer.indexOf(y.iss)))return s(new d("jwt issuer invalid. expected: "+c.issuer));if(c.subject&&y.sub!==c.subject)return s(new d("jwt subject invalid. expected: "+c.subject));if(c.jwtid&&y.jti!==c.jwtid)return s(new d("jwt jwtid invalid. expected: "+c.jwtid));if(c.nonce&&y.nonce!==c.nonce)return s(new d("jwt nonce invalid. expected: "+c.nonce));if(c.maxAge){if("number"!=typeof y.iat)return s(new d("iat required when maxAge is specified"));let a=h(c.maxAge,y.iat);if(void 0===a)return s(new d('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(v>=a+(c.clockTolerance||0))return s(new f("maxAge exceeded",new Date(1e3*a)))}return!0===c.complete?s(null,{header:x,payload:y,signature:t.signature}):s(null,y)})}},1617:(a,b,c)=>{var d=c(74364).Buffer,e=c(94839),f=c(48604),g=c(27910),h=c(61626),i=c(28354);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),n=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),o=m.sign(n,k);return i.format("%s.%s",n,o)}function l(a){var b=a.secret;if(b=null==(b=null==b?a.privateKey:b)?a.key:b,!0===/^hs/i.test(a.header.alg)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=c,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,a.exports=l},1708:a=>{"use strict";a.exports=require("node:process")},2956:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),b.Agent=void 0;let h=f(c(91645)),i=f(c(81630)),j=c(55591);g(c(26855),b);let k=Symbol("AgentBaseInternalState");class l extends i.Agent{constructor(a){super(a),this[k]={}}isSecureEndpoint(a){if(a){if("boolean"==typeof a.secureEndpoint)return a.secureEndpoint;if("string"==typeof a.protocol)return"https:"===a.protocol}let{stack:b}=Error();return"string"==typeof b&&b.split("\n").some(a=>-1!==a.indexOf("(https.js:")||-1!==a.indexOf("node:https:"))}incrementSockets(a){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[a]||(this.sockets[a]=[]);let b=new h.Socket({writable:!1});return this.sockets[a].push(b),this.totalSocketCount++,b}decrementSockets(a,b){if(!this.sockets[a]||null===b)return;let c=this.sockets[a],d=c.indexOf(b);-1!==d&&(c.splice(d,1),this.totalSocketCount--,0===c.length&&delete this.sockets[a])}getName(a){return this.isSecureEndpoint(a)?j.Agent.prototype.getName.call(this,a):super.getName(a)}createSocket(a,b,c){let d={...b,secureEndpoint:this.isSecureEndpoint(b)},e=this.getName(d),f=this.incrementSockets(e);Promise.resolve().then(()=>this.connect(a,d)).then(g=>{if(this.decrementSockets(e,f),g instanceof i.Agent)try{return g.addRequest(a,d)}catch(a){return c(a)}this[k].currentSocket=g,super.createSocket(a,b,c)},a=>{this.decrementSockets(e,f),c(a)})}createConnection(){let a=this[k].currentSocket;if(this[k].currentSocket=void 0,!a)throw Error("No socket was returned in the `connect()` function");return a}get defaultPort(){return this[k].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(a){this[k]&&(this[k].defaultPort=a)}get protocol(){return this[k].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(a){this[k]&&(this[k].protocol=a)}}b.Agent=l},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},5852:(a,b,c)=>{"use strict";let d=c(26220);a.exports=(a,b)=>a.sort((a,c)=>d(c,a,b))},7588:(a,b,c)=>{"use strict";let d=c(32665),e=c(96775);a.exports=(a,b,c)=>{let f=[],g=null,h=null,i=a.sort((a,b)=>e(a,b,c));for(let a of i)d(a,b,c)?(h=a,g||(g=a)):(h&&f.push([g,h]),h=null,g=null);g&&f.push([g,null]);let j=[];for(let[a,b]of f)a===b?j.push(a):b||a!==i[0]?b?a===i[0]?j.push(`<=${b}`):j.push(`${a} - ${b}`):j.push(`>=${a}`):j.push("*");let k=j.join(" || "),l="string"==typeof b.raw?b.raw:String(b);return k.length<l.length?k:b}},8008:(a,b,c)=>{Promise.resolve().then(c.bind(c,52979))},8265:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>d(b,a,c)},8625:(a,b)=>{"use strict";function c(a){return"("===a[0]&&a.endsWith(")")}function d(a){return a.startsWith("@")&&"@children"!==a}function e(a,b){if(a.includes(f)){let a=JSON.stringify(b);return"{}"!==a?f+"?"+a:f}return a}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DEFAULT_SEGMENT_KEY:function(){return g},PAGE_SEGMENT_KEY:function(){return f},addSearchParamsIfPageSegment:function(){return e},isGroupSegment:function(){return c},isParallelRouteSegment:function(){return d}});let f="__PAGE__",g="__DEFAULT__"},8991:(a,b)=>{"use strict";function c(a){return a.startsWith("/")?a:"/"+a}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"ensureLeadingSlash",{enumerable:!0,get:function(){return c}})},9907:(a,b,c)=>{"use strict";var d=c(28354),e=c(10407),f={stream:!0},g=new Map;function h(a){var b=globalThis.__next_require__(a);return"function"!=typeof b.then||"fulfilled"===b.status?null:(b.then(function(a){b.status="fulfilled",b.value=a},function(a){b.status="rejected",b.reason=a}),b)}function i(){}function j(a){for(var b=a[1],d=[],e=0;e<b.length;){var f=b[e++];b[e++];var j=g.get(f);if(void 0===j){j=c.e(f),d.push(j);var k=g.set.bind(g,f,null);j.then(k,i),g.set(f,j)}else null!==j&&d.push(j)}return 4===a.length?0===d.length?h(a[0]):Promise.all(d).then(function(){return h(a[0])}):0<d.length?Promise.all(d):null}function k(a){var b=globalThis.__next_require__(a[0]);if(4===a.length&&"function"==typeof b.then)if("fulfilled"===b.status)b=b.value;else throw b.reason;return"*"===a[2]?b:""===a[2]?b.__esModule?b.default:b:b[a[2]]}var l=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,m=Symbol.for("react.transitional.element"),n=Symbol.for("react.lazy"),o=Symbol.iterator,p=Symbol.asyncIterator,q=Array.isArray,r=Object.getPrototypeOf,s=Object.prototype,t=new WeakMap;function u(a,b,c,d,e){function f(a,c){c=new Blob([new Uint8Array(c.buffer,c.byteOffset,c.byteLength)]);var d=i++;return null===k&&(k=new FormData),k.append(b+d,c),"$"+a+d.toString(16)}function g(a,v){if(null===v)return null;if("object"==typeof v){switch(v.$$typeof){case m:if(void 0!==c&&-1===a.indexOf(":")){var w,x,y,z,A,B=l.get(this);if(void 0!==B)return c.set(B+":"+a,v),"$T"}throw Error("React Element cannot be passed to Server Functions from the Client without a temporary reference set. Pass a TemporaryReferenceSet to the options.");case n:B=v._payload;var C=v._init;null===k&&(k=new FormData),j++;try{var D=C(B),E=i++,F=h(D,E);return k.append(b+E,F),"$"+E.toString(16)}catch(a){if("object"==typeof a&&null!==a&&"function"==typeof a.then){j++;var G=i++;return B=function(){try{var a=h(v,G),c=k;c.append(b+G,a),j--,0===j&&d(c)}catch(a){e(a)}},a.then(B,B),"$"+G.toString(16)}return e(a),null}finally{j--}}if("function"==typeof v.then){null===k&&(k=new FormData),j++;var H=i++;return v.then(function(a){try{var c=h(a,H);(a=k).append(b+H,c),j--,0===j&&d(a)}catch(a){e(a)}},e),"$@"+H.toString(16)}if(void 0!==(B=l.get(v)))if(u!==v)return B;else u=null;else -1===a.indexOf(":")&&void 0!==(B=l.get(this))&&(a=B+":"+a,l.set(v,a),void 0!==c&&c.set(a,v));if(q(v))return v;if(v instanceof FormData){null===k&&(k=new FormData);var I=k,J=b+(a=i++)+"_";return v.forEach(function(a,b){I.append(J+b,a)}),"$K"+a.toString(16)}if(v instanceof Map)return a=i++,B=h(Array.from(v),a),null===k&&(k=new FormData),k.append(b+a,B),"$Q"+a.toString(16);if(v instanceof Set)return a=i++,B=h(Array.from(v),a),null===k&&(k=new FormData),k.append(b+a,B),"$W"+a.toString(16);if(v instanceof ArrayBuffer)return a=new Blob([v]),B=i++,null===k&&(k=new FormData),k.append(b+B,a),"$A"+B.toString(16);if(v instanceof Int8Array)return f("O",v);if(v instanceof Uint8Array)return f("o",v);if(v instanceof Uint8ClampedArray)return f("U",v);if(v instanceof Int16Array)return f("S",v);if(v instanceof Uint16Array)return f("s",v);if(v instanceof Int32Array)return f("L",v);if(v instanceof Uint32Array)return f("l",v);if(v instanceof Float32Array)return f("G",v);if(v instanceof Float64Array)return f("g",v);if(v instanceof BigInt64Array)return f("M",v);if(v instanceof BigUint64Array)return f("m",v);if(v instanceof DataView)return f("V",v);if("function"==typeof Blob&&v instanceof Blob)return null===k&&(k=new FormData),a=i++,k.append(b+a,v),"$B"+a.toString(16);if(a=null===(w=v)||"object"!=typeof w?null:"function"==typeof(w=o&&w[o]||w["@@iterator"])?w:null)return(B=a.call(v))===v?(a=i++,B=h(Array.from(B),a),null===k&&(k=new FormData),k.append(b+a,B),"$i"+a.toString(16)):Array.from(B);if("function"==typeof ReadableStream&&v instanceof ReadableStream)return function(a){try{var c,f,h,l,m,n,o,p=a.getReader({mode:"byob"})}catch(l){return c=a.getReader(),null===k&&(k=new FormData),f=k,j++,h=i++,c.read().then(function a(i){if(i.done)f.append(b+h,"C"),0==--j&&d(f);else try{var k=JSON.stringify(i.value,g);f.append(b+h,k),c.read().then(a,e)}catch(a){e(a)}},e),"$R"+h.toString(16)}return l=p,null===k&&(k=new FormData),m=k,j++,n=i++,o=[],l.read(new Uint8Array(1024)).then(function a(c){c.done?(c=i++,m.append(b+c,new Blob(o)),m.append(b+n,'"$o'+c.toString(16)+'"'),m.append(b+n,"C"),0==--j&&d(m)):(o.push(c.value),l.read(new Uint8Array(1024)).then(a,e))},e),"$r"+n.toString(16)}(v);if("function"==typeof(a=v[p]))return x=v,y=a.call(v),null===k&&(k=new FormData),z=k,j++,A=i++,x=x===y,y.next().then(function a(c){if(c.done){if(void 0===c.value)z.append(b+A,"C");else try{var f=JSON.stringify(c.value,g);z.append(b+A,"C"+f)}catch(a){e(a);return}0==--j&&d(z)}else try{var h=JSON.stringify(c.value,g);z.append(b+A,h),y.next().then(a,e)}catch(a){e(a)}},e),"$"+(x?"x":"X")+A.toString(16);if((a=r(v))!==s&&(null===a||null!==r(a))){if(void 0===c)throw Error("Only plain objects, and a few built-ins, can be passed to Server Functions. Classes or null prototypes are not supported.");return"$T"}return v}if("string"==typeof v)return"Z"===v[v.length-1]&&this[a]instanceof Date?"$D"+v:a="$"===v[0]?"$"+v:v;if("boolean"==typeof v)return v;if("number"==typeof v)return Number.isFinite(v)?0===v&&-1/0==1/v?"$-0":v:1/0===v?"$Infinity":-1/0===v?"$-Infinity":"$NaN";if(void 0===v)return"$undefined";if("function"==typeof v){if(void 0!==(B=t.get(v)))return a=JSON.stringify({id:B.id,bound:B.bound},g),null===k&&(k=new FormData),B=i++,k.set(b+B,a),"$F"+B.toString(16);if(void 0!==c&&-1===a.indexOf(":")&&void 0!==(B=l.get(this)))return c.set(B+":"+a,v),"$T";throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if("symbol"==typeof v){if(void 0!==c&&-1===a.indexOf(":")&&void 0!==(B=l.get(this)))return c.set(B+":"+a,v),"$T";throw Error("Symbols cannot be passed to a Server Function without a temporary reference set. Pass a TemporaryReferenceSet to the options.")}if("bigint"==typeof v)return"$n"+v.toString(10);throw Error("Type "+typeof v+" is not supported as an argument to a Server Function.")}function h(a,b){return"object"==typeof a&&null!==a&&(b="$"+b.toString(16),l.set(a,b),void 0!==c&&c.set(b,a)),u=a,JSON.stringify(a,g)}var i=1,j=0,k=null,l=new WeakMap,u=a,v=h(a,0);return null===k?d(v):(k.set(b+"0",v),0===j&&d(k)),function(){0<j&&(j=0,null===k?d(v):d(k))}}var v=new WeakMap;function w(a){var b=t.get(this);if(!b)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var c=null;if(null!==b.bound){if((c=v.get(b))||(d={id:b.id,bound:b.bound},g=new Promise(function(a,b){e=a,f=b}),u(d,"",void 0,function(a){if("string"==typeof a){var b=new FormData;b.append("0",a),a=b}g.status="fulfilled",g.value=a,e(a)},function(a){g.status="rejected",g.reason=a,f(a)}),c=g,v.set(b,c)),"rejected"===c.status)throw c.reason;if("fulfilled"!==c.status)throw c;b=c.value;var d,e,f,g,h=new FormData;b.forEach(function(b,c){h.append("$ACTION_"+a+":"+c,b)}),c=h,b="$ACTION_REF_"+a}else b="$ACTION_ID_"+b.id;return{name:b,method:"POST",encType:"multipart/form-data",data:c}}function x(a,b){var c=t.get(this);if(!c)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(c.id!==a)return!1;var d=c.bound;if(null===d)return 0===b;switch(d.status){case"fulfilled":return d.value.length===b;case"pending":throw d;case"rejected":throw d.reason;default:throw"string"!=typeof d.status&&(d.status="pending",d.then(function(a){d.status="fulfilled",d.value=a},function(a){d.status="rejected",d.reason=a})),d}}function y(a,b,c,d){t.has(a)||(t.set(a,{id:b,originalBind:a.bind,bound:c}),Object.defineProperties(a,{$$FORM_ACTION:{value:void 0===d?w:function(){var a=t.get(this);if(!a)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var b=a.bound;return null===b&&(b=Promise.resolve([])),d(a.id,b)}},$$IS_SIGNATURE_EQUAL:{value:x},bind:{value:B}}))}var z=Function.prototype.bind,A=Array.prototype.slice;function B(){var a=t.get(this);if(!a)return z.apply(this,arguments);var b=a.originalBind.apply(this,arguments),c=A.call(arguments,1),d=null;return d=null!==a.bound?Promise.resolve(a.bound).then(function(a){return a.concat(c)}):Promise.resolve(c),t.set(b,{id:a.id,originalBind:b.bind,bound:d}),Object.defineProperties(b,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:x},bind:{value:B}}),b}function C(a,b,c){this.status=a,this.value=b,this.reason=c}function D(a){switch(a.status){case"resolved_model":O(a);break;case"resolved_module":P(a)}switch(a.status){case"fulfilled":return a.value;case"pending":case"blocked":case"halted":throw a;default:throw a.reason}}function E(a,b){for(var c=0;c<a.length;c++){var d=a[c];"function"==typeof d?d(b):T(d,b)}}function F(a,b){for(var c=0;c<a.length;c++){var d=a[c];"function"==typeof d?d(b):U(d,b)}}function G(a,b){var c=b.handler.chunk;if(null===c)return null;if(c===a)return b.handler;if(null!==(b=c.value))for(c=0;c<b.length;c++){var d=b[c];if("function"!=typeof d&&null!==(d=G(a,d)))return d}return null}function H(a,b,c){switch(a.status){case"fulfilled":E(b,a.value);break;case"blocked":for(var d=0;d<b.length;d++){var e=b[d];if("function"!=typeof e){var f=G(a,e);null!==f&&(T(e,f.value),b.splice(d,1),d--,null!==c&&-1!==(e=c.indexOf(e))&&c.splice(e,1))}}case"pending":if(a.value)for(d=0;d<b.length;d++)a.value.push(b[d]);else a.value=b;if(a.reason){if(c)for(b=0;b<c.length;b++)a.reason.push(c[b])}else a.reason=c;break;case"rejected":c&&F(c,a.reason)}}function I(a,b,c){"pending"!==b.status&&"blocked"!==b.status?b.reason.error(c):(a=b.reason,b.status="rejected",b.reason=c,null!==a&&F(a,c))}function J(a,b,c){return new C("resolved_model",(c?'{"done":true,"value":':'{"done":false,"value":')+b+"}",a)}function K(a,b,c,d){L(a,b,(d?'{"done":true,"value":':'{"done":false,"value":')+c+"}")}function L(a,b,c){if("pending"!==b.status)b.reason.enqueueModel(c);else{var d=b.value,e=b.reason;b.status="resolved_model",b.value=c,b.reason=a,null!==d&&(O(b),H(b,d,e))}}function M(a,b,c){if("pending"===b.status||"blocked"===b.status){a=b.value;var d=b.reason;b.status="resolved_module",b.value=c,null!==a&&(P(b),H(b,a,d))}}C.prototype=Object.create(Promise.prototype),C.prototype.then=function(a,b){switch(this.status){case"resolved_model":O(this);break;case"resolved_module":P(this)}switch(this.status){case"fulfilled":"function"==typeof a&&a(this.value);break;case"pending":case"blocked":"function"==typeof a&&(null===this.value&&(this.value=[]),this.value.push(a)),"function"==typeof b&&(null===this.reason&&(this.reason=[]),this.reason.push(b));break;case"halted":break;default:"function"==typeof b&&b(this.reason)}};var N=null;function O(a){var b=N;N=null;var c=a.value,d=a.reason;a.status="blocked",a.value=null,a.reason=null;try{var e=JSON.parse(c,d._fromJSON),f=a.value;if(null!==f&&(a.value=null,a.reason=null,E(f,e)),null!==N){if(N.errored)throw N.reason;if(0<N.deps){N.value=e,N.chunk=a;return}}a.status="fulfilled",a.value=e}catch(b){a.status="rejected",a.reason=b}finally{N=b}}function P(a){try{var b=k(a.value);a.status="fulfilled",a.value=b}catch(b){a.status="rejected",a.reason=b}}function Q(a,b){a._closed=!0,a._closedReason=b,a._chunks.forEach(function(c){"pending"===c.status&&I(a,c,b)})}function R(a){return{$$typeof:n,_payload:a,_init:D}}function S(a,b){var c=a._chunks,d=c.get(b);return d||(d=a._closed?new C("rejected",null,a._closedReason):new C("pending",null,null),c.set(b,d)),d}function T(a,b){for(var c=a.response,d=a.handler,e=a.parentObject,f=a.key,g=a.map,h=a.path,i=1;i<h.length;i++){for(;b.$$typeof===n;)if((b=b._payload)===d.chunk)b=d.value;else{switch(b.status){case"resolved_model":O(b);break;case"resolved_module":P(b)}switch(b.status){case"fulfilled":b=b.value;continue;case"blocked":var j=G(b,a);if(null!==j){b=j.value;continue}case"pending":h.splice(0,i-1),null===b.value?b.value=[a]:b.value.push(a),null===b.reason?b.reason=[a]:b.reason.push(a);return;case"halted":return;default:U(a,b.reason);return}}b=b[h[i]]}a=g(c,b,e,f),e[f]=a,""===f&&null===d.value&&(d.value=a),e[0]===m&&"object"==typeof d.value&&null!==d.value&&d.value.$$typeof===m&&(e=d.value,"3"===f)&&(e.props=a),d.deps--,0===d.deps&&null!==(f=d.chunk)&&"blocked"===f.status&&(e=f.value,f.status="fulfilled",f.value=d.value,f.reason=d.reason,null!==e&&E(e,d.value))}function U(a,b){var c=a.handler;a=a.response,c.errored||(c.errored=!0,c.value=null,c.reason=b,null!==(c=c.chunk)&&"blocked"===c.status&&I(a,c,b))}function V(a,b,c,d,e,f){if(N){var g=N;g.deps++}else g=N={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1};return b={response:d,handler:g,parentObject:b,key:c,map:e,path:f},null===a.value?a.value=[b]:a.value.push(b),null===a.reason?a.reason=[b]:a.reason.push(b),null}function W(a,b,c,d){if(!a._serverReferenceConfig)return function(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);return f?"fulfilled"===f.status?b(e,f.value.concat(a)):Promise.resolve(f).then(function(c){return b(e,c.concat(a))}):b(e,a)}var e=a.id,f=a.bound;return y(d,e,f,c),d}(b,a._callServer,a._encodeFormAction);var e=function(a,b){var c="",d=a[b];if(d)c=d.name;else{var e=b.lastIndexOf("#");if(-1!==e&&(c=b.slice(e+1),d=a[b.slice(0,e)]),!d)throw Error('Could not find the module "'+b+'" in the React Server Manifest. This is probably a bug in the React Server Components bundler.')}return d.async?[d.id,d.chunks,c,1]:[d.id,d.chunks,c]}(a._serverReferenceConfig,b.id),f=j(e);if(f)b.bound&&(f=Promise.all([f,b.bound]));else{if(!b.bound)return y(f=k(e),b.id,b.bound,a._encodeFormAction),f;f=Promise.resolve(b.bound)}if(N){var g=N;g.deps++}else g=N={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1};return f.then(function(){var f=k(e);if(b.bound){var h=b.bound.value.slice(0);h.unshift(null),f=f.bind.apply(f,h)}y(f,b.id,b.bound,a._encodeFormAction),c[d]=f,""===d&&null===g.value&&(g.value=f),c[0]===m&&"object"==typeof g.value&&null!==g.value&&g.value.$$typeof===m&&(h=g.value,"3"===d)&&(h.props=f),g.deps--,0===g.deps&&null!==(f=g.chunk)&&"blocked"===f.status&&(h=f.value,f.status="fulfilled",f.value=g.value,null!==h&&E(h,g.value))},function(b){if(!g.errored){g.errored=!0,g.value=null,g.reason=b;var c=g.chunk;null!==c&&"blocked"===c.status&&I(a,c,b)}}),null}function X(a,b,c,d,e){var f=parseInt((b=b.split(":"))[0],16);switch((f=S(a,f)).status){case"resolved_model":O(f);break;case"resolved_module":P(f)}switch(f.status){case"fulfilled":var g=f.value;for(f=1;f<b.length;f++){for(;g.$$typeof===n;){switch((g=g._payload).status){case"resolved_model":O(g);break;case"resolved_module":P(g)}switch(g.status){case"fulfilled":g=g.value;break;case"blocked":case"pending":return V(g,c,d,a,e,b.slice(f-1));case"halted":return N?(a=N,a.deps++):N={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1},null;default:return N?(N.errored=!0,N.value=null,N.reason=g.reason):N={parent:null,chunk:null,value:null,reason:g.reason,deps:0,errored:!0},null}}g=g[b[f]]}return e(a,g,c,d);case"pending":case"blocked":return V(f,c,d,a,e,b);case"halted":return N?(a=N,a.deps++):N={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1},null;default:return N?(N.errored=!0,N.value=null,N.reason=f.reason):N={parent:null,chunk:null,value:null,reason:f.reason,deps:0,errored:!0},null}}function Y(a,b){return new Map(b)}function Z(a,b){return new Set(b)}function _(a,b){return new Blob(b.slice(1),{type:b[0]})}function aa(a,b){a=new FormData;for(var c=0;c<b.length;c++)a.append(b[c][0],b[c][1]);return a}function ab(a,b){return b[Symbol.iterator]()}function ac(a,b){return b}function ad(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function ae(a,b,c,e,f,g,h){var i,j=new Map;this._bundlerConfig=a,this._serverReferenceConfig=b,this._moduleLoading=c,this._callServer=void 0!==e?e:ad,this._encodeFormAction=f,this._nonce=g,this._chunks=j,this._stringDecoder=new d.TextDecoder,this._fromJSON=null,this._closed=!1,this._closedReason=null,this._tempRefs=h,this._fromJSON=(i=this,function(a,b){if("string"==typeof b){var c=i,d=this,e=a,f=b;if("$"===f[0]){if("$"===f)return null!==N&&"0"===e&&(N={parent:N,chunk:null,value:null,reason:null,deps:0,errored:!1}),m;switch(f[1]){case"$":return f.slice(1);case"L":return R(c=S(c,d=parseInt(f.slice(2),16)));case"@":return S(c,d=parseInt(f.slice(2),16));case"S":return Symbol.for(f.slice(2));case"F":return X(c,f=f.slice(2),d,e,W);case"T":if(d="$"+f.slice(2),null==(c=c._tempRefs))throw Error("Missing a temporary reference set but the RSC response returned a temporary reference. Pass a temporaryReference option with the set that was used with the reply.");return c.get(d);case"Q":return X(c,f=f.slice(2),d,e,Y);case"W":return X(c,f=f.slice(2),d,e,Z);case"B":return X(c,f=f.slice(2),d,e,_);case"K":return X(c,f=f.slice(2),d,e,aa);case"Z":return al();case"i":return X(c,f=f.slice(2),d,e,ab);case"I":return 1/0;case"-":return"$-0"===f?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(f.slice(2)));case"n":return BigInt(f.slice(2));default:return X(c,f=f.slice(1),d,e,ac)}}return f}if("object"==typeof b&&null!==b){if(b[0]===m){if(a={$$typeof:m,type:b[1],key:b[2],ref:null,props:b[3]},null!==N){if(N=(b=N).parent,b.errored)a=R(a=new C("rejected",null,b.reason));else if(0<b.deps){var g=new C("blocked",null,null);b.value=a,b.chunk=g,a=R(g)}}}else a=b;return a}return b})}function af(){return{_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]}}function ag(a,b,c){var d=(a=a._chunks).get(b);d&&"pending"!==d.status?d.reason.enqueueValue(c):a.set(b,new C("fulfilled",c,null))}function ah(a,b,c,d){var e=a._chunks;(a=e.get(b))?"pending"===a.status&&(b=a.value,a.status="fulfilled",a.value=c,a.reason=d,null!==b&&E(b,a.value)):e.set(b,new C("fulfilled",c,d))}function ai(a,b,c){var d=null;c=new ReadableStream({type:c,start:function(a){d=a}});var e=null;ah(a,b,c,{enqueueValue:function(a){null===e?d.enqueue(a):e.then(function(){d.enqueue(a)})},enqueueModel:function(b){if(null===e){var c=new C("resolved_model",b,a);O(c),"fulfilled"===c.status?d.enqueue(c.value):(c.then(function(a){return d.enqueue(a)},function(a){return d.error(a)}),e=c)}else{c=e;var f=new C("pending",null,null);f.then(function(a){return d.enqueue(a)},function(a){return d.error(a)}),e=f,c.then(function(){e===f&&(e=null),L(a,f,b)})}},close:function(){if(null===e)d.close();else{var a=e;e=null,a.then(function(){return d.close()})}},error:function(a){if(null===e)d.error(a);else{var b=e;e=null,b.then(function(){return d.error(a)})}}})}function aj(){return this}function ak(a,b,c){var d=[],e=!1,f=0,g={};g[p]=function(){var a,b=0;return(a={next:a=function(a){if(void 0!==a)throw Error("Values cannot be passed to next() of AsyncIterables passed to Client Components.");if(b===d.length){if(e)return new C("fulfilled",{done:!0,value:void 0},null);d[b]=new C("pending",null,null)}return d[b++]}})[p]=aj,a},ah(a,b,c?g[p]():g,{enqueueValue:function(a){if(f===d.length)d[f]=new C("fulfilled",{done:!1,value:a},null);else{var b=d[f],c=b.value,e=b.reason;b.status="fulfilled",b.value={done:!1,value:a},null!==c&&H(b,c,e)}f++},enqueueModel:function(b){f===d.length?d[f]=J(a,b,!1):K(a,d[f],b,!1),f++},close:function(b){for(e=!0,f===d.length?d[f]=J(a,b,!0):K(a,d[f],b,!0),f++;f<d.length;)K(a,d[f++],'"$undefined"',!0)},error:function(b){for(e=!0,f===d.length&&(d[f]=new C("pending",null,null));f<d.length;)I(a,d[f++],b)}})}function al(){var a=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.");return a.stack="Error: "+a.message,a}function am(a,b){for(var c=a.length,d=b.length,e=0;e<c;e++)d+=a[e].byteLength;d=new Uint8Array(d);for(var f=e=0;f<c;f++){var g=a[f];d.set(g,e),e+=g.byteLength}return d.set(b,e),d}function an(a,b,c,d,e,f){ag(a,b,e=new e((c=0===c.length&&0==d.byteOffset%f?d:am(c,d)).buffer,c.byteOffset,c.byteLength/f))}function ao(a,b,c,d){switch(c){case 73:var e=a,f=b,g=d,h=e._chunks,i=h.get(f);g=JSON.parse(g,e._fromJSON);var k=function(a,b){if(a){var c=a[b[0]];if(a=c&&c[b[2]])c=a.name;else{if(!(a=c&&c["*"]))throw Error('Could not find the module "'+b[0]+'" in the React Server Consumer Manifest. This is probably a bug in the React Server Components bundler.');c=b[2]}return 4===b.length?[a.id,a.chunks,c,1]:[a.id,a.chunks,c]}return b}(e._bundlerConfig,g);if(!function(a,b,c){if(null!==a)for(var d=1;d<b.length;d+=2){var e=l.d,f=e.X,g=a.prefix+b[d],h=a.crossOrigin;h="string"==typeof h?"use-credentials"===h?h:"":void 0,f.call(e,g,{crossOrigin:h,nonce:c})}}(e._moduleLoading,g[1],e._nonce),g=j(k)){if(i){var m=i;m.status="blocked"}else m=new C("blocked",null,null),h.set(f,m);g.then(function(){return M(e,m,k)},function(a){return I(e,m,a)})}else i?M(e,i,k):h.set(f,new C("resolved_module",k,null));break;case 72:switch(b=d[0],a=JSON.parse(d=d.slice(1),a._fromJSON),d=l.d,b){case"D":d.D(a);break;case"C":"string"==typeof a?d.C(a):d.C(a[0],a[1]);break;case"L":b=a[0],c=a[1],3===a.length?d.L(b,c,a[2]):d.L(b,c);break;case"m":"string"==typeof a?d.m(a):d.m(a[0],a[1]);break;case"X":"string"==typeof a?d.X(a):d.X(a[0],a[1]);break;case"S":"string"==typeof a?d.S(a):d.S(a[0],0===a[1]?void 0:a[1],3===a.length?a[2]:void 0);break;case"M":"string"==typeof a?d.M(a):d.M(a[0],a[1])}break;case 69:var n=(c=a._chunks).get(b);d=JSON.parse(d);var o=al();o.digest=d.digest,n?I(a,n,o):c.set(b,new C("rejected",null,o));break;case 84:(c=(a=a._chunks).get(b))&&"pending"!==c.status?c.reason.enqueueValue(d):a.set(b,new C("fulfilled",d,null));break;case 78:case 68:case 74:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");case 82:ai(a,b,void 0);break;case 114:ai(a,b,"bytes");break;case 88:ak(a,b,!1);break;case 120:ak(a,b,!0);break;case 67:(a=a._chunks.get(b))&&"fulfilled"===a.status&&a.reason.close(""===d?'"$undefined"':d);break;default:(n=(c=a._chunks).get(b))?L(a,n,d):c.set(b,new C("resolved_model",d,a))}}function ap(a,b,c){for(var d=0,e=b._rowState,g=b._rowID,h=b._rowTag,i=b._rowLength,j=b._buffer,k=c.length;d<k;){var l=-1;switch(e){case 0:58===(l=c[d++])?e=1:g=g<<4|(96<l?l-87:l-48);continue;case 1:84===(e=c[d])||65===e||79===e||111===e||85===e||83===e||115===e||76===e||108===e||71===e||103===e||77===e||109===e||86===e?(h=e,e=2,d++):64<e&&91>e||35===e||114===e||120===e?(h=e,e=3,d++):(h=0,e=3);continue;case 2:44===(l=c[d++])?e=4:i=i<<4|(96<l?l-87:l-48);continue;case 3:l=c.indexOf(10,d);break;case 4:(l=d+i)>c.length&&(l=-1)}var m=c.byteOffset+d;if(-1<l)(function(a,b,c,d,e){switch(c){case 65:ag(a,b,am(d,e).buffer);return;case 79:an(a,b,d,e,Int8Array,1);return;case 111:ag(a,b,0===d.length?e:am(d,e));return;case 85:an(a,b,d,e,Uint8ClampedArray,1);return;case 83:an(a,b,d,e,Int16Array,2);return;case 115:an(a,b,d,e,Uint16Array,2);return;case 76:an(a,b,d,e,Int32Array,4);return;case 108:an(a,b,d,e,Uint32Array,4);return;case 71:an(a,b,d,e,Float32Array,4);return;case 103:an(a,b,d,e,Float64Array,8);return;case 77:an(a,b,d,e,BigInt64Array,8);return;case 109:an(a,b,d,e,BigUint64Array,8);return;case 86:an(a,b,d,e,DataView,1);return}for(var g=a._stringDecoder,h="",i=0;i<d.length;i++)h+=g.decode(d[i],f);ao(a,b,c,h+=g.decode(e))})(a,g,h,j,i=new Uint8Array(c.buffer,m,l-d)),d=l,3===e&&d++,i=g=h=e=0,j.length=0;else{a=new Uint8Array(c.buffer,m,c.byteLength-d),j.push(a),i-=a.byteLength;break}}b._rowState=e,b._rowID=g,b._rowTag=h,b._rowLength=i}function aq(a){Q(a,Error("Connection closed."))}function ar(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function as(a){return new ae(a.serverConsumerManifest.moduleMap,a.serverConsumerManifest.serverModuleMap,a.serverConsumerManifest.moduleLoading,ar,a.encodeFormAction,"string"==typeof a.nonce?a.nonce:void 0,a&&a.temporaryReferences?a.temporaryReferences:void 0)}function at(a,b){function c(b){Q(a,b)}var d=af(),e=b.getReader();e.read().then(function b(f){var g=f.value;if(!f.done)return ap(a,d,g),e.read().then(b).catch(c);aq(a)}).catch(c)}function au(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}b.createFromFetch=function(a,b){var c=as(b);return a.then(function(a){at(c,a.body)},function(a){Q(c,a)}),S(c,0)},b.createFromNodeStream=function(a,b,c){var d=new ae(b.moduleMap,b.serverModuleMap,b.moduleLoading,au,c?c.encodeFormAction:void 0,c&&"string"==typeof c.nonce?c.nonce:void 0,void 0),e=af();return a.on("data",function(a){if("string"==typeof a){for(var b=0,c=e._rowState,f=e._rowID,g=e._rowTag,h=e._rowLength,i=e._buffer,j=a.length;b<j;){var k=-1;switch(c){case 0:58===(k=a.charCodeAt(b++))?c=1:f=f<<4|(96<k?k-87:k-48);continue;case 1:84===(c=a.charCodeAt(b))||65===c||79===c||111===c||85===c||83===c||115===c||76===c||108===c||71===c||103===c||77===c||109===c||86===c?(g=c,c=2,b++):64<c&&91>c||114===c||120===c?(g=c,c=3,b++):(g=0,c=3);continue;case 2:44===(k=a.charCodeAt(b++))?c=4:h=h<<4|(96<k?k-87:k-48);continue;case 3:k=a.indexOf("\n",b);break;case 4:if(84!==g)throw Error("Binary RSC chunks cannot be encoded as strings. This is a bug in the wiring of the React streams.");if(h<a.length||a.length>3*h)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.");k=a.length}if(-1<k){if(0<i.length)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.");ao(d,f,g,b=a.slice(b,k)),b=k,3===c&&b++,h=f=g=c=0,i.length=0}else if(a.length!==b)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.")}e._rowState=c,e._rowID=f,e._rowTag=g,e._rowLength=h}else ap(d,e,a)}),a.on("error",function(a){Q(d,a)}),a.on("end",function(){return aq(d)}),S(d,0)},b.createFromReadableStream=function(a,b){return at(b=as(b),a),S(b,0)},b.createServerReference=function(a){function b(){var b=Array.prototype.slice.call(arguments);return ar(a,b)}return y(b,a,null,void 0),b},b.createTemporaryReferenceSet=function(){return new Map},b.encodeReply=function(a,b){return new Promise(function(c,d){var e=u(a,"",b&&b.temporaryReferences?b.temporaryReferences:void 0,c,d);if(b&&b.signal){var f=b.signal;if(f.aborted)e(f.reason);else{var g=function(){e(f.reason),f.removeEventListener("abort",g)};f.addEventListener("abort",g)}}})},b.registerServerReference=function(a,b,c){return y(a,b,null,c),a}},10407:(a,b,c)=>{"use strict";a.exports=c(49754).vendored["react-rsc"].ReactDOM},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11515:function(a,b,c){"use strict";var d=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.parseProxyResponse=void 0;let e=(0,d(c(90064)).default)("https-proxy-agent:parse-proxy-response");b.parseProxyResponse=function(a){return new Promise((b,c)=>{let d=0,f=[];function g(){let i=a.read();i?function(i){f.push(i),d+=i.length;let j=Buffer.concat(f,d),k=j.indexOf("\r\n\r\n");if(-1===k){e("have not received end of HTTP headers yet..."),g();return}let l=j.slice(0,k).toString("ascii").split("\r\n"),m=l.shift();if(!m)return a.destroy(),c(Error("No header received from proxy CONNECT response"));let n=m.split(" "),o=+n[1],p=n.slice(2).join(" "),q={};for(let b of l){if(!b)continue;let d=b.indexOf(":");if(-1===d)return a.destroy(),c(Error(`Invalid header from proxy CONNECT response: "${b}"`));let e=b.slice(0,d).toLowerCase(),f=b.slice(d+1).trimStart(),g=q[e];"string"==typeof g?q[e]=[g,f]:Array.isArray(g)?g.push(f):q[e]=f}e("got proxy server response: %o %o",m,q),h(),b({connect:{statusCode:o,statusText:p,headers:q},buffered:j})}(i):a.once("readable",g)}function h(){a.removeListener("end",i),a.removeListener("error",j),a.removeListener("readable",g)}function i(){h(),e("onend"),c(Error("Proxy connection ended before receiving CONNECT response"))}function j(a){h(),e("onerror %o",a),c(a)}a.on("error",j),a.on("end",i),g()})}},12132:(a,b,c)=>{a.exports=c(16260).satisfies(process.version,"^6.12.0 || >=8.0.0")},12412:a=>{"use strict";a.exports=require("assert")},14620:(a,b,c)=>{b.formatArgs=function(b){if(b[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+b[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;b.splice(1,0,c,"color: inherit");let d=0,e=0;b[0].replace(/%[a-zA-Z%]/g,a=>{"%%"!==a&&(d++,"%c"===a&&(e=d))}),b.splice(e,0,c)},b.save=function(a){try{a?b.storage.setItem("debug",a):b.storage.removeItem("debug")}catch(a){}},b.load=function(){let a;try{a=b.storage.getItem("debug")||b.storage.getItem("DEBUG")}catch(a){}return!a&&"undefined"!=typeof process&&"env"in process&&(a=process.env.DEBUG),a},b.useColors=function(){let a;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(a=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(a[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage=function(){try{return localStorage}catch(a){}}(),b.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||(()=>{}),a.exports=c(70179)(b);let{formatters:d}=a.exports;d.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}},16260:(a,b,c)=>{"use strict";let d=c(40329),e=c(45053),f=c(78871),g=c(59218),h=c(71635),i=c(71780),j=c(57593),k=c(86038),l=c(73575),m=c(58337),n=c(57317),o=c(33160),p=c(57976),q=c(96775),r=c(8265),s=c(28570),t=c(26220),u=c(30430),v=c(5852),w=c(85327),x=c(59366),y=c(23948),z=c(97106),A=c(94764),B=c(97579),C=c(67418),D=c(21609),E=c(50403),F=c(24346),G=c(32665),H=c(34906),I=c(32843),J=c(37905),K=c(17376),L=c(28581),M=c(74502),N=c(69774),O=c(93689),P=c(47443);a.exports={parse:h,valid:i,clean:j,inc:k,diff:l,major:m,minor:n,patch:o,prerelease:p,compare:q,rcompare:r,compareLoose:s,compareBuild:t,sort:u,rsort:v,gt:w,lt:x,eq:y,neq:z,gte:A,lte:B,cmp:C,coerce:D,Comparator:E,Range:F,satisfies:G,toComparators:H,maxSatisfying:I,minSatisfying:J,minVersion:K,validRange:L,outside:M,gtr:N,ltr:O,intersects:P,simplifyRange:c(7588),subset:c(23439),SemVer:f,re:d.re,src:d.src,tokens:d.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:g.compareIdentifiers,rcompareIdentifiers:g.rcompareIdentifiers}},17376:(a,b,c)=>{"use strict";let d=c(78871),e=c(24346),f=c(85327);a.exports=(a,b)=>{a=new e(a,b);let c=new d("0.0.0");if(a.test(c)||(c=new d("0.0.0-0"),a.test(c)))return c;c=null;for(let b=0;b<a.set.length;++b){let e=a.set[b],g=null;e.forEach(a=>{let b=new d(a.semver.version);switch(a.operator){case">":0===b.prerelease.length?b.patch++:b.prerelease.push(0),b.raw=b.format();case"":case">=":(!g||f(b,g))&&(g=b);break;case"<":case"<=":break;default:throw Error(`Unexpected operation: ${a.operator}`)}}),g&&(!c||f(c,g))&&(c=g)}return c&&a.test(c)?c:null}},17916:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{normalizeAppPath:function(){return f},normalizeRscURL:function(){return g}});let d=c(8991),e=c(8625);function f(a){return(0,d.ensureLeadingSlash)(a.split("/").reduce((a,b,c,d)=>!b||(0,e.isGroupSegment)(b)||"@"===b[0]||("page"===b||"route"===b)&&c===d.length-1?a:a+"/"+b,""))}function g(a){return a.replace(/\.rsc($|\?)/,"$1")}},18633:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{METADATA_BOUNDARY_NAME:function(){return c},OUTLET_BOUNDARY_NAME:function(){return e},ROOT_LAYOUT_BOUNDARY_NAME:function(){return f},VIEWPORT_BOUNDARY_NAME:function(){return d}});let c="__next_metadata_boundary__",d="__next_viewport_boundary__",e="__next_outlet_boundary__",f="__next_root_layout_boundary__"},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21609:(a,b,c)=>{"use strict";let d=c(78871),e=c(71635),{safeRe:f,t:g}=c(40329);a.exports=(a,b)=>{if(a instanceof d)return a;if("number"==typeof a&&(a=String(a)),"string"!=typeof a)return null;let c=null;if((b=b||{}).rtl){let d,e=b.includePrerelease?f[g.COERCERTLFULL]:f[g.COERCERTL];for(;(d=e.exec(a))&&(!c||c.index+c[0].length!==a.length);)c&&d.index+d[0].length===c.index+c[0].length||(c=d),e.lastIndex=d.index+d[1].length+d[2].length;e.lastIndex=-1}else c=a.match(b.includePrerelease?f[g.COERCEFULL]:f[g.COERCE]);if(null===c)return null;let h=c[2],i=c[3]||"0",j=c[4]||"0",k=b.includePrerelease&&c[5]?`-${c[5]}`:"",l=b.includePrerelease&&c[6]?`+${c[6]}`:"";return e(`${h}.${i}.${j}${k}${l}`,b)}},21820:a=>{"use strict";a.exports=require("os")},23435:(a,b,c)=>{a.exports={decode:c(45663),verify:c(374),sign:c(54590),JsonWebTokenError:c(42596),NotBeforeError:c(55017),TokenExpiredError:c(39379)}},23439:(a,b,c)=>{"use strict";let d=c(24346),e=c(50403),{ANY:f}=e,g=c(32665),h=c(96775),i=[new e(">=0.0.0-0")],j=[new e(">=0.0.0")],k=(a,b,c)=>{let d,e,k,n,o,p,q;if(a===b)return!0;if(1===a.length&&a[0].semver===f)if(1===b.length&&b[0].semver===f)return!0;else a=c.includePrerelease?i:j;if(1===b.length&&b[0].semver===f)if(c.includePrerelease)return!0;else b=j;let r=new Set;for(let b of a)">"===b.operator||">="===b.operator?d=l(d,b,c):"<"===b.operator||"<="===b.operator?e=m(e,b,c):r.add(b.semver);if(r.size>1)return null;if(d&&e&&((k=h(d.semver,e.semver,c))>0||0===k&&(">="!==d.operator||"<="!==e.operator)))return null;for(let a of r){if(d&&!g(a,String(d),c)||e&&!g(a,String(e),c))return null;for(let d of b)if(!g(a,String(d),c))return!1;return!0}let s=!!e&&!c.includePrerelease&&!!e.semver.prerelease.length&&e.semver,t=!!d&&!c.includePrerelease&&!!d.semver.prerelease.length&&d.semver;for(let a of(s&&1===s.prerelease.length&&"<"===e.operator&&0===s.prerelease[0]&&(s=!1),b)){if(q=q||">"===a.operator||">="===a.operator,p=p||"<"===a.operator||"<="===a.operator,d){if(t&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===t.major&&a.semver.minor===t.minor&&a.semver.patch===t.patch&&(t=!1),">"===a.operator||">="===a.operator){if((n=l(d,a,c))===a&&n!==d)return!1}else if(">="===d.operator&&!g(d.semver,String(a),c))return!1}if(e){if(s&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===s.major&&a.semver.minor===s.minor&&a.semver.patch===s.patch&&(s=!1),"<"===a.operator||"<="===a.operator){if((o=m(e,a,c))===a&&o!==e)return!1}else if("<="===e.operator&&!g(e.semver,String(a),c))return!1}if(!a.operator&&(e||d)&&0!==k)return!1}return(!d||!p||!!e||0===k)&&(!e||!q||!!d||0===k)&&!t&&!s&&!0},l=(a,b,c)=>{if(!a)return b;let d=h(a.semver,b.semver,c);return d>0?a:d<0||">"===b.operator&&">="===a.operator?b:a},m=(a,b,c)=>{if(!a)return b;let d=h(a.semver,b.semver,c);return d<0?a:d>0||"<"===b.operator&&"<="===a.operator?b:a};a.exports=(a,b,c={})=>{if(a===b)return!0;a=new d(a,c),b=new d(b,c);let e=!1;a:for(let d of a.set){for(let a of b.set){let b=k(d,a,c);if(e=e||null!==b,b)continue a}if(e)return!1}return!0}},23948:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>0===d(a,b,c)},23998:(a,b)=>{"use strict";function c(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isThenable",{enumerable:!0,get:function(){return c}})},24346:(a,b,c)=>{"use strict";let d=/\s+/g;class e{constructor(a,b){if(b=g(b),a instanceof e)if(!!b.loose===a.loose&&!!b.includePrerelease===a.includePrerelease)return a;else return new e(a.raw,b);if(a instanceof h)return this.raw=a.value,this.set=[[a]],this.formatted=void 0,this;if(this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease,this.raw=a.trim().replace(d," "),this.set=this.raw.split("||").map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let a=this.set[0];if(this.set=this.set.filter(a=>!r(a[0])),0===this.set.length)this.set=[a];else if(this.set.length>1){for(let a of this.set)if(1===a.length&&s(a[0])){this.set=[a];break}}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let a=0;a<this.set.length;a++){a>0&&(this.formatted+="||");let b=this.set[a];for(let a=0;a<b.length;a++)a>0&&(this.formatted+=" "),this.formatted+=b[a].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(a){let b=((this.options.includePrerelease&&p)|(this.options.loose&&q))+":"+a,c=f.get(b);if(c)return c;let d=this.options.loose,e=d?k[l.HYPHENRANGELOOSE]:k[l.HYPHENRANGE];i("hyphen replace",a=a.replace(e,E(this.options.includePrerelease))),i("comparator trim",a=a.replace(k[l.COMPARATORTRIM],m)),i("tilde trim",a=a.replace(k[l.TILDETRIM],n)),i("caret trim",a=a.replace(k[l.CARETTRIM],o));let g=a.split(" ").map(a=>u(a,this.options)).join(" ").split(/\s+/).map(a=>D(a,this.options));d&&(g=g.filter(a=>(i("loose invalid filter",a,this.options),!!a.match(k[l.COMPARATORLOOSE])))),i("range list",g);let j=new Map;for(let a of g.map(a=>new h(a,this.options))){if(r(a))return[a];j.set(a.value,a)}j.size>1&&j.has("")&&j.delete("");let s=[...j.values()];return f.set(b,s),s}intersects(a,b){if(!(a instanceof e))throw TypeError("a Range is required");return this.set.some(c=>t(c,b)&&a.set.some(a=>t(a,b)&&c.every(c=>a.every(a=>c.intersects(a,b)))))}test(a){if(!a)return!1;if("string"==typeof a)try{a=new j(a,this.options)}catch(a){return!1}for(let b=0;b<this.set.length;b++)if(F(this.set[b],a,this.options))return!0;return!1}}a.exports=e;let f=new(c(92869)),g=c(47586),h=c(50403),i=c(50627),j=c(78871),{safeRe:k,t:l,comparatorTrimReplace:m,tildeTrimReplace:n,caretTrimReplace:o}=c(40329),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:q}=c(45053),r=a=>"<0.0.0-0"===a.value,s=a=>""===a.value,t=(a,b)=>{let c=!0,d=a.slice(),e=d.pop();for(;c&&d.length;)c=d.every(a=>e.intersects(a,b)),e=d.pop();return c},u=(a,b)=>(i("comp",a=a.replace(k[l.BUILD],""),b),i("caret",a=y(a,b)),i("tildes",a=w(a,b)),i("xrange",a=A(a,b)),i("stars",a=C(a,b)),a),v=a=>!a||"x"===a.toLowerCase()||"*"===a,w=(a,b)=>a.trim().split(/\s+/).map(a=>x(a,b)).join(" "),x=(a,b)=>{let c=b.loose?k[l.TILDELOOSE]:k[l.TILDE];return a.replace(c,(b,c,d,e,f)=>{let g;return i("tilde",a,b,c,d,e,f),v(c)?g="":v(d)?g=`>=${c}.0.0 <${+c+1}.0.0-0`:v(e)?g=`>=${c}.${d}.0 <${c}.${+d+1}.0-0`:f?(i("replaceTilde pr",f),g=`>=${c}.${d}.${e}-${f} <${c}.${+d+1}.0-0`):g=`>=${c}.${d}.${e} <${c}.${+d+1}.0-0`,i("tilde return",g),g})},y=(a,b)=>a.trim().split(/\s+/).map(a=>z(a,b)).join(" "),z=(a,b)=>{i("caret",a,b);let c=b.loose?k[l.CARETLOOSE]:k[l.CARET],d=b.includePrerelease?"-0":"";return a.replace(c,(b,c,e,f,g)=>{let h;return i("caret",a,b,c,e,f,g),v(c)?h="":v(e)?h=`>=${c}.0.0${d} <${+c+1}.0.0-0`:v(f)?h="0"===c?`>=${c}.${e}.0${d} <${c}.${+e+1}.0-0`:`>=${c}.${e}.0${d} <${+c+1}.0.0-0`:g?(i("replaceCaret pr",g),h="0"===c?"0"===e?`>=${c}.${e}.${f}-${g} <${c}.${e}.${+f+1}-0`:`>=${c}.${e}.${f}-${g} <${c}.${+e+1}.0-0`:`>=${c}.${e}.${f}-${g} <${+c+1}.0.0-0`):(i("no pr"),h="0"===c?"0"===e?`>=${c}.${e}.${f}${d} <${c}.${e}.${+f+1}-0`:`>=${c}.${e}.${f}${d} <${c}.${+e+1}.0-0`:`>=${c}.${e}.${f} <${+c+1}.0.0-0`),i("caret return",h),h})},A=(a,b)=>(i("replaceXRanges",a,b),a.split(/\s+/).map(a=>B(a,b)).join(" ")),B=(a,b)=>{a=a.trim();let c=b.loose?k[l.XRANGELOOSE]:k[l.XRANGE];return a.replace(c,(c,d,e,f,g,h)=>{i("xRange",a,c,d,e,f,g,h);let j=v(e),k=j||v(f),l=k||v(g);return"="===d&&l&&(d=""),h=b.includePrerelease?"-0":"",j?c=">"===d||"<"===d?"<0.0.0-0":"*":d&&l?(k&&(f=0),g=0,">"===d?(d=">=",k?(e=+e+1,f=0):f=+f+1,g=0):"<="===d&&(d="<",k?e=+e+1:f=+f+1),"<"===d&&(h="-0"),c=`${d+e}.${f}.${g}${h}`):k?c=`>=${e}.0.0${h} <${+e+1}.0.0-0`:l&&(c=`>=${e}.${f}.0${h} <${e}.${+f+1}.0-0`),i("xRange return",c),c})},C=(a,b)=>(i("replaceStars",a,b),a.trim().replace(k[l.STAR],"")),D=(a,b)=>(i("replaceGTE0",a,b),a.trim().replace(k[b.includePrerelease?l.GTE0PRE:l.GTE0],"")),E=a=>(b,c,d,e,f,g,h,i,j,k,l,m)=>(c=v(d)?"":v(e)?`>=${d}.0.0${a?"-0":""}`:v(f)?`>=${d}.${e}.0${a?"-0":""}`:g?`>=${c}`:`>=${c}${a?"-0":""}`,i=v(j)?"":v(k)?`<${+j+1}.0.0-0`:v(l)?`<${j}.${+k+1}.0-0`:m?`<=${j}.${k}.${l}-${m}`:a?`<${j}.${k}.${+l+1}-0`:`<=${i}`,`${c} ${i}`.trim()),F=(a,b,c)=>{for(let c=0;c<a.length;c++)if(!a[c].test(b))return!1;if(b.prerelease.length&&!c.includePrerelease){for(let c=0;c<a.length;c++)if(i(a[c].semver),a[c].semver!==h.ANY&&a[c].semver.prerelease.length>0){let d=a[c].semver;if(d.major===b.major&&d.minor===b.minor&&d.patch===b.patch)return!0}return!1}return!0}},25386:(a,b,c)=>{"use strict";let d,e=c(21820),f=c(83997),g=c(63535),{env:h}=process;function i(a){return 0!==a&&{level:a,hasBasic:!0,has256:a>=2,has16m:a>=3}}function j(a,b){if(0===d)return 0;if(g("color=16m")||g("color=full")||g("color=truecolor"))return 3;if(g("color=256"))return 2;if(a&&!b&&void 0===d)return 0;let c=d||0;if("dumb"===h.TERM)return c;if("win32"===process.platform){let a=e.release().split(".");return Number(a[0])>=10&&Number(a[2])>=10586?Number(a[2])>=14931?3:2:1}if("CI"in h)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(a=>a in h)||"codeship"===h.CI_NAME?1:c;if("TEAMCITY_VERSION"in h)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(h.TEAMCITY_VERSION);if("truecolor"===h.COLORTERM)return 3;if("TERM_PROGRAM"in h){let a=parseInt((h.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(h.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(h.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(h.TERM)||"COLORTERM"in h?1:c}g("no-color")||g("no-colors")||g("color=false")||g("color=never")?d=0:(g("color")||g("colors")||g("color=true")||g("color=always"))&&(d=1),"FORCE_COLOR"in h&&(d="true"===h.FORCE_COLOR?1:"false"===h.FORCE_COLOR?0:0===h.FORCE_COLOR.length?1:Math.min(parseInt(h.FORCE_COLOR,10),3)),a.exports={supportsColor:function(a){return i(j(a,a&&a.isTTY))},stdout:i(j(!0,f.isatty(1))),stderr:i(j(!0,f.isatty(2)))}},25553:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,60967)),"/Users/macramzi/Documents/rfpcopilot/src/app/page.tsx"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"/Users/macramzi/Documents/rfpcopilot/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["/Users/macramzi/Documents/rfpcopilot/src/app/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:_,isDraftMode:aa,resolvedPathname:ab,revalidateOnlyGenerated:ac,routerServerContext:ad,nextConfig:ae,interceptionRoutePatterns:af}=O,ag=S.pathname||"/",ah=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ai}=O,aj=K.match(ag,_),ak=!!_.routes[ab],al=!!(aj||ak||_.routes[ah]),am=a.headers["user-agent"]||"",an=(0,u.getBotType)(am),ao=(0,p.isHtmlBotRequest)(a),ap=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],aq=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],ar=(0,s.getIsPossibleServerAction)(a),as=(0,m.checkIsAppPPREnabled)(ae.experimental.ppr)&&(null==(C=_.routes[ah]??_.dynamicRoutes[ah])?void 0:C.renderingMode)==="PARTIALLY_STATIC",at=!1,au=!1,av=as?M:void 0,aw=as&&aq&&!ap,ax=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ay=!am||(0,p.shouldServeStreamingMetadata)(am,ae.htmlLimitedBots);ao&&as&&(al=!1,ay=!1);let az=!0===K.isDev||!al||"string"==typeof M||aw,aA=ao&&as,aB=null;aa||!al||az||ar||av||aw||(aB=ab);let aC=aB;!aC&&K.isDev&&(aC=ab),K.isDev||aa||!al||!aq||aw||(0,k.d)(a.headers);let aD={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aE=a.method||"GET",aF=(0,g.getTracer)(),aG=aF.getActiveScopeSpan();try{let f=K.getVaryHeader(ab,af);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aF.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aE} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aE} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ah,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aD,Component:(0,j.T)(aD),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:aA,serveStreamingMetadata:ay,supportsDynamicResponse:"string"==typeof f||az,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ad?void 0:ad.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:aa,isRevalidate:al&&!f&&!aw,botType:an,isOnDemandRevalidate:ai,isPossibleServerAction:ar,assetPrefix:ae.assetPrefix,nextConfigOutput:ae.output,crossOrigin:ae.crossOrigin,trailingSlash:ae.trailingSlash,previewProps:_.preview,deploymentId:ae.deploymentId,enableTainting:ae.experimental.taint,htmlLimitedBots:ae.htmlLimitedBots,devtoolSegmentExplorer:ae.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ae.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ae.experimental.cacheLife,basePath:ae.basePath,serverActions:ae.experimental.serverActions,...at?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:at}:{},experimental:{isRoutePPREnabled:as,expireTime:ae.expireTime,staleTimes:ae.experimental.staleTimes,cacheComponents:!!ae.experimental.cacheComponents,clientSegmentCache:!!ae.experimental.clientSegmentCache,clientParamParsing:!!ae.experimental.clientParamParsing,dynamicOnHover:!!ae.experimental.dynamicOnHover,inlineCss:!!ae.experimental.inlineCss,authInterrupts:!!ae.experimental.authInterrupts,clientTraceMetadata:ae.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ad),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,al&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!as){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${ab}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ai&&ac&&!f&&!N)return(null==ad?void 0:ad.render404)?await ad.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(aj&&(j=(0,w.parseFallbackField)(aj.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(am)&&(!as||ao)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ai=!0),ai&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aC&&!l&&!aa&&T&&(k||!ak)){let b;if((k||aj)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(as&&!aq){let c="string"==typeof(null==aj?void 0:aj.fallback)?aj.fallback:k?ah:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ae,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:_,isRoutePPREnabled:as,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||au?(0,n.u)(ah):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ai||g||!av?void 0:av;if(at&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&as&&((0,h.getRequestMeta)(a,"renderFallbackShell")||au)?(0,n.u)(ag):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aB,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ai,isRoutePPREnabled:as,req:a,nextConfig:ae,prerenderManifest:_,waitUntil:d.waitUntil});if(aa&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aB)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;al&&!aw&&(!p||ap)&&(N||b.setHeader("x-nextjs-cache",ai?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(av)l={revalidate:0,expire:void 0};else if(N&&aq&&!ap&&as)l={revalidate:0,expire:void 0};else if(!K.isDev)if(aa)l={revalidate:0,expire:void 0};else if(al){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ae.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof ax&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&al&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(ax);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&av)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&al||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&al&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||aq&&as||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&aq&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),aq&&!aa){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:q.html,cacheControl:aw?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||aq)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:n.cacheControl});if(at)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aG)return await aF.withPropagatedContext(a.headers,()=>aF.trace(i.BaseServerSpan.handleRequest,{spanName:`${aE} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aE,"http.target":a.url}},p));await p(aG)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:al,isOnDemandRevalidate:ai})},ad),b}}},25825:(a,b,c)=>{"use strict";c.d(b,{Toaster:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/macramzi/Documents/rfpcopilot/src/components/ui/sonner.tsx","Toaster")},26220:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b,c)=>{let e=new d(a,c),f=new d(b,c);return e.compare(f)||e.compareBuild(f)}},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},26855:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b};Object.defineProperty(b,"__esModule",{value:!0}),b.req=b.json=b.toBuffer=void 0;let g=f(c(81630)),h=f(c(55591));async function i(a){let b=0,c=[];for await(let d of a)b+=d.length,c.push(d);return Buffer.concat(c,b)}b.toBuffer=i,b.json=async function(a){let b=(await i(a)).toString("utf8");try{return JSON.parse(b)}catch(a){throw a.message+=` (input: ${b})`,a}},b.req=function(a,b={}){let c=(("string"==typeof a?a:a.href).startsWith("https:")?h:g).request(a,b),d=new Promise((a,b)=>{c.once("response",a).once("error",b).end()});return c.then=d.then.bind(d),c}},27806:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{decryptActionBoundArgs:function(){return s},encryptActionBoundArgs:function(){return r}}),c(95818);let d=c(83183),e=c(51318),f=c(50931),g=c(54210),h=c(63033),i=c(90151),j=function(a){return a&&a.__esModule?a:{default:a}}(c(46204)),k=new TextEncoder,l=new TextDecoder,m=void 0,n=void 0;async function o(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),h=l.decode(await (0,g.decrypt)(c,(0,g.stringToUint8Array)(e),(0,g.stringToUint8Array)(f)));if(!h.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return h.slice(a.length)}async function p(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);h.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,g.arrayBufferToString)(d.buffer),f=await (0,g.encrypt)(c,d,k.encode(a+b));return btoa(e+(0,g.arrayBufferToString)(f))}var q=function(a){return a[a.Ready=0]="Ready",a[a.Pending=1]="Pending",a[a.Complete=2]="Complete",a}(q||{});let r=j.default.cache(async function a(b,...c){let e=h.workUnitAsyncStorage.getStore(),j=e?(0,h.getCacheSignal)(e):void 0,{clientModules:k}=(0,g.getClientReferenceManifestForRsc)(),l=Error();Error.captureStackTrace(l,a);let n=!1,o=e?(0,i.createHangingInputAbortSignal)(e):void 0,q=0;function r(){0===q&&(q=1,null==j||j.beginRead())}function s(){1===q&&(null==j||j.endRead()),q=2}o&&j&&o.addEventListener("abort",r,{once:!0});let t=await (0,f.streamToString)((0,d.renderToReadableStream)(c,k,{filterStackFrame:m,signal:o,onError(a){(null==o||!o.aborted)&&(n||(n=!0,l.message=a instanceof Error?a.message:String(a)))}}),o);if(n)throw s(),l;if(!e)return p(b,t);r();let u=(0,h.getPrerenderResumeDataCache)(e),v=(0,h.getRenderResumeDataCache)(e),w=b+t,x=(null==u?void 0:u.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await p(b,t);return s(),null==u||u.encryptedBoundArgs.set(w,y),y});async function s(a,b){let c,d=await b,f=h.workUnitAsyncStorage.getStore();if(f){let b=(0,h.getCacheSignal)(f),e=(0,h.getPrerenderResumeDataCache)(f),g=(0,h.getRenderResumeDataCache)(f);(c=(null==e?void 0:e.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await o(a,d),null==b||b.endRead(),null==e||e.decryptedBoundArgs.set(d,c))}else c=await o(a,d);let{edgeRscModuleMapping:i,rscModuleMapping:j}=(0,g.getClientReferenceManifestForRsc)();return await (0,e.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(k.encode(c)),null==f?void 0:f.type){case"prerender":case"prerender-runtime":f.renderSignal.aborted?a.close():f.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:n,serverConsumerManifest:{moduleLoading:null,moduleMap:j,serverModuleMap:(0,g.getServerModuleMap)()}})}},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},28570:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b)=>d(a,b,!0)},28581:(a,b,c)=>{"use strict";let d=c(24346);a.exports=(a,b)=>{try{return new d(a,b).range||"*"}catch(a){return null}}},29089:a=>{(()=>{"use strict";var b={491:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ContextAPI=void 0;let d=c(223),e=c(172),f=c(930),g="context",h=new d.NoopContextManager;class i{constructor(){}static getInstance(){return this._instance||(this._instance=new i),this._instance}setGlobalContextManager(a){return(0,e.registerGlobal)(g,a,f.DiagAPI.instance())}active(){return this._getContextManager().active()}with(a,b,c,...d){return this._getContextManager().with(a,b,c,...d)}bind(a,b){return this._getContextManager().bind(a,b)}_getContextManager(){return(0,e.getGlobal)(g)||h}disable(){this._getContextManager().disable(),(0,e.unregisterGlobal)(g,f.DiagAPI.instance())}}b.ContextAPI=i},930:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagAPI=void 0;let d=c(56),e=c(912),f=c(957),g=c(172);class h{constructor(){function a(a){return function(...b){let c=(0,g.getGlobal)("diag");if(c)return c[a](...b)}}let b=this;b.setLogger=(a,c={logLevel:f.DiagLogLevel.INFO})=>{var d,h,i;if(a===b){let a=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return b.error(null!=(d=a.stack)?d:a.message),!1}"number"==typeof c&&(c={logLevel:c});let j=(0,g.getGlobal)("diag"),k=(0,e.createLogLevelDiagLogger)(null!=(h=c.logLevel)?h:f.DiagLogLevel.INFO,a);if(j&&!c.suppressOverrideMessage){let a=null!=(i=Error().stack)?i:"<failed to generate stacktrace>";j.warn(`Current logger will be overwritten from ${a}`),k.warn(`Current logger will overwrite one already registered from ${a}`)}return(0,g.registerGlobal)("diag",k,b,!0)},b.disable=()=>{(0,g.unregisterGlobal)("diag",b)},b.createComponentLogger=a=>new d.DiagComponentLogger(a),b.verbose=a("verbose"),b.debug=a("debug"),b.info=a("info"),b.warn=a("warn"),b.error=a("error")}static instance(){return this._instance||(this._instance=new h),this._instance}}b.DiagAPI=h},653:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MetricsAPI=void 0;let d=c(660),e=c(172),f=c(930),g="metrics";class h{constructor(){}static getInstance(){return this._instance||(this._instance=new h),this._instance}setGlobalMeterProvider(a){return(0,e.registerGlobal)(g,a,f.DiagAPI.instance())}getMeterProvider(){return(0,e.getGlobal)(g)||d.NOOP_METER_PROVIDER}getMeter(a,b,c){return this.getMeterProvider().getMeter(a,b,c)}disable(){(0,e.unregisterGlobal)(g,f.DiagAPI.instance())}}b.MetricsAPI=h},181:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PropagationAPI=void 0;let d=c(172),e=c(874),f=c(194),g=c(277),h=c(369),i=c(930),j="propagation",k=new e.NoopTextMapPropagator;class l{constructor(){this.createBaggage=h.createBaggage,this.getBaggage=g.getBaggage,this.getActiveBaggage=g.getActiveBaggage,this.setBaggage=g.setBaggage,this.deleteBaggage=g.deleteBaggage}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalPropagator(a){return(0,d.registerGlobal)(j,a,i.DiagAPI.instance())}inject(a,b,c=f.defaultTextMapSetter){return this._getGlobalPropagator().inject(a,b,c)}extract(a,b,c=f.defaultTextMapGetter){return this._getGlobalPropagator().extract(a,b,c)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,d.unregisterGlobal)(j,i.DiagAPI.instance())}_getGlobalPropagator(){return(0,d.getGlobal)(j)||k}}b.PropagationAPI=l},997:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceAPI=void 0;let d=c(172),e=c(846),f=c(139),g=c(607),h=c(930),i="trace";class j{constructor(){this._proxyTracerProvider=new e.ProxyTracerProvider,this.wrapSpanContext=f.wrapSpanContext,this.isSpanContextValid=f.isSpanContextValid,this.deleteSpan=g.deleteSpan,this.getSpan=g.getSpan,this.getActiveSpan=g.getActiveSpan,this.getSpanContext=g.getSpanContext,this.setSpan=g.setSpan,this.setSpanContext=g.setSpanContext}static getInstance(){return this._instance||(this._instance=new j),this._instance}setGlobalTracerProvider(a){let b=(0,d.registerGlobal)(i,this._proxyTracerProvider,h.DiagAPI.instance());return b&&this._proxyTracerProvider.setDelegate(a),b}getTracerProvider(){return(0,d.getGlobal)(i)||this._proxyTracerProvider}getTracer(a,b){return this.getTracerProvider().getTracer(a,b)}disable(){(0,d.unregisterGlobal)(i,h.DiagAPI.instance()),this._proxyTracerProvider=new e.ProxyTracerProvider}}b.TraceAPI=j},277:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.deleteBaggage=b.setBaggage=b.getActiveBaggage=b.getBaggage=void 0;let d=c(491),e=(0,c(780).createContextKey)("OpenTelemetry Baggage Key");function f(a){return a.getValue(e)||void 0}b.getBaggage=f,b.getActiveBaggage=function(){return f(d.ContextAPI.getInstance().active())},b.setBaggage=function(a,b){return a.setValue(e,b)},b.deleteBaggage=function(a){return a.deleteValue(e)}},993:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BaggageImpl=void 0;class c{constructor(a){this._entries=a?new Map(a):new Map}getEntry(a){let b=this._entries.get(a);if(b)return Object.assign({},b)}getAllEntries(){return Array.from(this._entries.entries()).map(([a,b])=>[a,b])}setEntry(a,b){let d=new c(this._entries);return d._entries.set(a,b),d}removeEntry(a){let b=new c(this._entries);return b._entries.delete(a),b}removeEntries(...a){let b=new c(this._entries);for(let c of a)b._entries.delete(c);return b}clear(){return new c}}b.BaggageImpl=c},830:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.baggageEntryMetadataSymbol=void 0,b.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.baggageEntryMetadataFromString=b.createBaggage=void 0;let d=c(930),e=c(993),f=c(830),g=d.DiagAPI.instance();b.createBaggage=function(a={}){return new e.BaggageImpl(new Map(Object.entries(a)))},b.baggageEntryMetadataFromString=function(a){return"string"!=typeof a&&(g.error(`Cannot create baggage metadata from unknown type: ${typeof a}`),a=""),{__TYPE__:f.baggageEntryMetadataSymbol,toString:()=>a}}},67:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.context=void 0,b.context=c(491).ContextAPI.getInstance()},223:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopContextManager=void 0;let d=c(780);class e{active(){return d.ROOT_CONTEXT}with(a,b,c,...d){return b.call(c,...d)}bind(a,b){return b}enable(){return this}disable(){return this}}b.NoopContextManager=e},780:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ROOT_CONTEXT=b.createContextKey=void 0,b.createContextKey=function(a){return Symbol.for(a)};class c{constructor(a){let b=this;b._currentContext=a?new Map(a):new Map,b.getValue=a=>b._currentContext.get(a),b.setValue=(a,d)=>{let e=new c(b._currentContext);return e._currentContext.set(a,d),e},b.deleteValue=a=>{let d=new c(b._currentContext);return d._currentContext.delete(a),d}}}b.ROOT_CONTEXT=new c},506:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.diag=void 0,b.diag=c(930).DiagAPI.instance()},56:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagComponentLogger=void 0;let d=c(172);class e{constructor(a){this._namespace=a.namespace||"DiagComponentLogger"}debug(...a){return f("debug",this._namespace,a)}error(...a){return f("error",this._namespace,a)}info(...a){return f("info",this._namespace,a)}warn(...a){return f("warn",this._namespace,a)}verbose(...a){return f("verbose",this._namespace,a)}}function f(a,b,c){let e=(0,d.getGlobal)("diag");if(e)return c.unshift(b),e[a](...c)}b.DiagComponentLogger=e},972:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagConsoleLogger=void 0;let c=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class d{constructor(){for(let a=0;a<c.length;a++)this[c[a].n]=function(a){return function(...b){if(console){let c=console[a];if("function"!=typeof c&&(c=console.log),"function"==typeof c)return c.apply(console,b)}}}(c[a].c)}}b.DiagConsoleLogger=d},912:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createLogLevelDiagLogger=void 0;let d=c(957);b.createLogLevelDiagLogger=function(a,b){function c(c,d){let e=b[c];return"function"==typeof e&&a>=d?e.bind(b):function(){}}return a<d.DiagLogLevel.NONE?a=d.DiagLogLevel.NONE:a>d.DiagLogLevel.ALL&&(a=d.DiagLogLevel.ALL),b=b||{},{error:c("error",d.DiagLogLevel.ERROR),warn:c("warn",d.DiagLogLevel.WARN),info:c("info",d.DiagLogLevel.INFO),debug:c("debug",d.DiagLogLevel.DEBUG),verbose:c("verbose",d.DiagLogLevel.VERBOSE)}}},957:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagLogLevel=void 0,function(a){a[a.NONE=0]="NONE",a[a.ERROR=30]="ERROR",a[a.WARN=50]="WARN",a[a.INFO=60]="INFO",a[a.DEBUG=70]="DEBUG",a[a.VERBOSE=80]="VERBOSE",a[a.ALL=9999]="ALL"}(b.DiagLogLevel||(b.DiagLogLevel={}))},172:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.unregisterGlobal=b.getGlobal=b.registerGlobal=void 0;let d=c(200),e=c(521),f=c(130),g=e.VERSION.split(".")[0],h=Symbol.for(`opentelemetry.js.api.${g}`),i=d._globalThis;b.registerGlobal=function(a,b,c,d=!1){var f;let g=i[h]=null!=(f=i[h])?f:{version:e.VERSION};if(!d&&g[a]){let b=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${a}`);return c.error(b.stack||b.message),!1}if(g.version!==e.VERSION){let b=Error(`@opentelemetry/api: Registration of version v${g.version} for ${a} does not match previously registered API v${e.VERSION}`);return c.error(b.stack||b.message),!1}return g[a]=b,c.debug(`@opentelemetry/api: Registered a global for ${a} v${e.VERSION}.`),!0},b.getGlobal=function(a){var b,c;let d=null==(b=i[h])?void 0:b.version;if(d&&(0,f.isCompatible)(d))return null==(c=i[h])?void 0:c[a]},b.unregisterGlobal=function(a,b){b.debug(`@opentelemetry/api: Unregistering a global for ${a} v${e.VERSION}.`);let c=i[h];c&&delete c[a]}},130:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.isCompatible=b._makeCompatibilityCheck=void 0;let d=c(521),e=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function f(a){let b=new Set([a]),c=new Set,d=a.match(e);if(!d)return()=>!1;let f={major:+d[1],minor:+d[2],patch:+d[3],prerelease:d[4]};if(null!=f.prerelease)return function(b){return b===a};function g(a){return c.add(a),!1}return function(a){if(b.has(a))return!0;if(c.has(a))return!1;let d=a.match(e);if(!d)return g(a);let h={major:+d[1],minor:+d[2],patch:+d[3],prerelease:d[4]};if(null!=h.prerelease||f.major!==h.major)return g(a);if(0===f.major)return f.minor===h.minor&&f.patch<=h.patch?(b.add(a),!0):g(a);return f.minor<=h.minor?(b.add(a),!0):g(a)}}b._makeCompatibilityCheck=f,b.isCompatible=f(d.VERSION)},886:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.metrics=void 0,b.metrics=c(653).MetricsAPI.getInstance()},901:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ValueType=void 0,function(a){a[a.INT=0]="INT",a[a.DOUBLE=1]="DOUBLE"}(b.ValueType||(b.ValueType={}))},102:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createNoopMeter=b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=b.NOOP_OBSERVABLE_GAUGE_METRIC=b.NOOP_OBSERVABLE_COUNTER_METRIC=b.NOOP_UP_DOWN_COUNTER_METRIC=b.NOOP_HISTOGRAM_METRIC=b.NOOP_COUNTER_METRIC=b.NOOP_METER=b.NoopObservableUpDownCounterMetric=b.NoopObservableGaugeMetric=b.NoopObservableCounterMetric=b.NoopObservableMetric=b.NoopHistogramMetric=b.NoopUpDownCounterMetric=b.NoopCounterMetric=b.NoopMetric=b.NoopMeter=void 0;class c{constructor(){}createHistogram(a,c){return b.NOOP_HISTOGRAM_METRIC}createCounter(a,c){return b.NOOP_COUNTER_METRIC}createUpDownCounter(a,c){return b.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(a,c){return b.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(a,c){return b.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(a,c){return b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(a,b){}removeBatchObservableCallback(a){}}b.NoopMeter=c;class d{}b.NoopMetric=d;class e extends d{add(a,b){}}b.NoopCounterMetric=e;class f extends d{add(a,b){}}b.NoopUpDownCounterMetric=f;class g extends d{record(a,b){}}b.NoopHistogramMetric=g;class h{addCallback(a){}removeCallback(a){}}b.NoopObservableMetric=h;class i extends h{}b.NoopObservableCounterMetric=i;class j extends h{}b.NoopObservableGaugeMetric=j;class k extends h{}b.NoopObservableUpDownCounterMetric=k,b.NOOP_METER=new c,b.NOOP_COUNTER_METRIC=new e,b.NOOP_HISTOGRAM_METRIC=new g,b.NOOP_UP_DOWN_COUNTER_METRIC=new f,b.NOOP_OBSERVABLE_COUNTER_METRIC=new i,b.NOOP_OBSERVABLE_GAUGE_METRIC=new j,b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new k,b.createNoopMeter=function(){return b.NOOP_METER}},660:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NOOP_METER_PROVIDER=b.NoopMeterProvider=void 0;let d=c(102);class e{getMeter(a,b,c){return d.NOOP_METER}}b.NoopMeterProvider=e,b.NOOP_METER_PROVIDER=new e},200:function(a,b,c){var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c(46),b)},651:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b._globalThis=void 0,b._globalThis="object"==typeof globalThis?globalThis:global},46:function(a,b,c){var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c(651),b)},939:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.propagation=void 0,b.propagation=c(181).PropagationAPI.getInstance()},874:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTextMapPropagator=void 0;class c{inject(a,b){}extract(a,b){return a}fields(){return[]}}b.NoopTextMapPropagator=c},194:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.defaultTextMapSetter=b.defaultTextMapGetter=void 0,b.defaultTextMapGetter={get(a,b){if(null!=a)return a[b]},keys:a=>null==a?[]:Object.keys(a)},b.defaultTextMapSetter={set(a,b,c){null!=a&&(a[b]=c)}}},845:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.trace=void 0,b.trace=c(997).TraceAPI.getInstance()},403:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NonRecordingSpan=void 0;let d=c(476);class e{constructor(a=d.INVALID_SPAN_CONTEXT){this._spanContext=a}spanContext(){return this._spanContext}setAttribute(a,b){return this}setAttributes(a){return this}addEvent(a,b){return this}setStatus(a){return this}updateName(a){return this}end(a){}isRecording(){return!1}recordException(a,b){}}b.NonRecordingSpan=e},614:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTracer=void 0;let d=c(491),e=c(607),f=c(403),g=c(139),h=d.ContextAPI.getInstance();class i{startSpan(a,b,c=h.active()){var d;if(null==b?void 0:b.root)return new f.NonRecordingSpan;let i=c&&(0,e.getSpanContext)(c);return"object"==typeof(d=i)&&"string"==typeof d.spanId&&"string"==typeof d.traceId&&"number"==typeof d.traceFlags&&(0,g.isSpanContextValid)(i)?new f.NonRecordingSpan(i):new f.NonRecordingSpan}startActiveSpan(a,b,c,d){let f,g,i;if(arguments.length<2)return;2==arguments.length?i=b:3==arguments.length?(f=b,i=c):(f=b,g=c,i=d);let j=null!=g?g:h.active(),k=this.startSpan(a,f,j),l=(0,e.setSpan)(j,k);return h.with(l,i,void 0,k)}}b.NoopTracer=i},124:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTracerProvider=void 0;let d=c(614);class e{getTracer(a,b,c){return new d.NoopTracer}}b.NoopTracerProvider=e},125:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ProxyTracer=void 0;let d=new(c(614)).NoopTracer;class e{constructor(a,b,c,d){this._provider=a,this.name=b,this.version=c,this.options=d}startSpan(a,b,c){return this._getTracer().startSpan(a,b,c)}startActiveSpan(a,b,c,d){let e=this._getTracer();return Reflect.apply(e.startActiveSpan,e,arguments)}_getTracer(){if(this._delegate)return this._delegate;let a=this._provider.getDelegateTracer(this.name,this.version,this.options);return a?(this._delegate=a,this._delegate):d}}b.ProxyTracer=e},846:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ProxyTracerProvider=void 0;let d=c(125),e=new(c(124)).NoopTracerProvider;class f{getTracer(a,b,c){var e;return null!=(e=this.getDelegateTracer(a,b,c))?e:new d.ProxyTracer(this,a,b,c)}getDelegate(){var a;return null!=(a=this._delegate)?a:e}setDelegate(a){this._delegate=a}getDelegateTracer(a,b,c){var d;return null==(d=this._delegate)?void 0:d.getTracer(a,b,c)}}b.ProxyTracerProvider=f},996:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SamplingDecision=void 0,function(a){a[a.NOT_RECORD=0]="NOT_RECORD",a[a.RECORD=1]="RECORD",a[a.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(b.SamplingDecision||(b.SamplingDecision={}))},607:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.getSpanContext=b.setSpanContext=b.deleteSpan=b.setSpan=b.getActiveSpan=b.getSpan=void 0;let d=c(780),e=c(403),f=c(491),g=(0,d.createContextKey)("OpenTelemetry Context Key SPAN");function h(a){return a.getValue(g)||void 0}function i(a,b){return a.setValue(g,b)}b.getSpan=h,b.getActiveSpan=function(){return h(f.ContextAPI.getInstance().active())},b.setSpan=i,b.deleteSpan=function(a){return a.deleteValue(g)},b.setSpanContext=function(a,b){return i(a,new e.NonRecordingSpan(b))},b.getSpanContext=function(a){var b;return null==(b=h(a))?void 0:b.spanContext()}},325:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceStateImpl=void 0;let d=c(564);class e{constructor(a){this._internalState=new Map,a&&this._parse(a)}set(a,b){let c=this._clone();return c._internalState.has(a)&&c._internalState.delete(a),c._internalState.set(a,b),c}unset(a){let b=this._clone();return b._internalState.delete(a),b}get(a){return this._internalState.get(a)}serialize(){return this._keys().reduce((a,b)=>(a.push(b+"="+this.get(b)),a),[]).join(",")}_parse(a){!(a.length>512)&&(this._internalState=a.split(",").reverse().reduce((a,b)=>{let c=b.trim(),e=c.indexOf("=");if(-1!==e){let f=c.slice(0,e),g=c.slice(e+1,b.length);(0,d.validateKey)(f)&&(0,d.validateValue)(g)&&a.set(f,g)}return a},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let a=new e;return a._internalState=new Map(this._internalState),a}}b.TraceStateImpl=e},564:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.validateValue=b.validateKey=void 0;let c="[_0-9a-z-*/]",d=`[a-z]${c}{0,255}`,e=`[a-z0-9]${c}{0,240}@[a-z]${c}{0,13}`,f=RegExp(`^(?:${d}|${e})$`),g=/^[ -~]{0,255}[!-~]$/,h=/,|=/;b.validateKey=function(a){return f.test(a)},b.validateValue=function(a){return g.test(a)&&!h.test(a)}},98:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createTraceState=void 0;let d=c(325);b.createTraceState=function(a){return new d.TraceStateImpl(a)}},476:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.INVALID_SPAN_CONTEXT=b.INVALID_TRACEID=b.INVALID_SPANID=void 0;let d=c(475);b.INVALID_SPANID="0000000000000000",b.INVALID_TRACEID="00000000000000000000000000000000",b.INVALID_SPAN_CONTEXT={traceId:b.INVALID_TRACEID,spanId:b.INVALID_SPANID,traceFlags:d.TraceFlags.NONE}},357:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SpanKind=void 0,function(a){a[a.INTERNAL=0]="INTERNAL",a[a.SERVER=1]="SERVER",a[a.CLIENT=2]="CLIENT",a[a.PRODUCER=3]="PRODUCER",a[a.CONSUMER=4]="CONSUMER"}(b.SpanKind||(b.SpanKind={}))},139:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.wrapSpanContext=b.isSpanContextValid=b.isValidSpanId=b.isValidTraceId=void 0;let d=c(476),e=c(403),f=/^([0-9a-f]{32})$/i,g=/^[0-9a-f]{16}$/i;function h(a){return f.test(a)&&a!==d.INVALID_TRACEID}function i(a){return g.test(a)&&a!==d.INVALID_SPANID}b.isValidTraceId=h,b.isValidSpanId=i,b.isSpanContextValid=function(a){return h(a.traceId)&&i(a.spanId)},b.wrapSpanContext=function(a){return new e.NonRecordingSpan(a)}},847:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SpanStatusCode=void 0,function(a){a[a.UNSET=0]="UNSET",a[a.OK=1]="OK",a[a.ERROR=2]="ERROR"}(b.SpanStatusCode||(b.SpanStatusCode={}))},475:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceFlags=void 0,function(a){a[a.NONE=0]="NONE",a[a.SAMPLED=1]="SAMPLED"}(b.TraceFlags||(b.TraceFlags={}))},521:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.VERSION=void 0,b.VERSION="1.6.0"}},c={};function d(a){var e=c[a];if(void 0!==e)return e.exports;var f=c[a]={exports:{}},g=!0;try{b[a].call(f.exports,f,f.exports,d),g=!1}finally{g&&delete c[a]}return f.exports}d.ab=__dirname+"/";var e={};(()=>{Object.defineProperty(e,"__esModule",{value:!0}),e.trace=e.propagation=e.metrics=e.diag=e.context=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.isValidSpanId=e.isValidTraceId=e.isSpanContextValid=e.createTraceState=e.TraceFlags=e.SpanStatusCode=e.SpanKind=e.SamplingDecision=e.ProxyTracerProvider=e.ProxyTracer=e.defaultTextMapSetter=e.defaultTextMapGetter=e.ValueType=e.createNoopMeter=e.DiagLogLevel=e.DiagConsoleLogger=e.ROOT_CONTEXT=e.createContextKey=e.baggageEntryMetadataFromString=void 0;var a=d(369);Object.defineProperty(e,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return a.baggageEntryMetadataFromString}});var b=d(780);Object.defineProperty(e,"createContextKey",{enumerable:!0,get:function(){return b.createContextKey}}),Object.defineProperty(e,"ROOT_CONTEXT",{enumerable:!0,get:function(){return b.ROOT_CONTEXT}});var c=d(972);Object.defineProperty(e,"DiagConsoleLogger",{enumerable:!0,get:function(){return c.DiagConsoleLogger}});var f=d(957);Object.defineProperty(e,"DiagLogLevel",{enumerable:!0,get:function(){return f.DiagLogLevel}});var g=d(102);Object.defineProperty(e,"createNoopMeter",{enumerable:!0,get:function(){return g.createNoopMeter}});var h=d(901);Object.defineProperty(e,"ValueType",{enumerable:!0,get:function(){return h.ValueType}});var i=d(194);Object.defineProperty(e,"defaultTextMapGetter",{enumerable:!0,get:function(){return i.defaultTextMapGetter}}),Object.defineProperty(e,"defaultTextMapSetter",{enumerable:!0,get:function(){return i.defaultTextMapSetter}});var j=d(125);Object.defineProperty(e,"ProxyTracer",{enumerable:!0,get:function(){return j.ProxyTracer}});var k=d(846);Object.defineProperty(e,"ProxyTracerProvider",{enumerable:!0,get:function(){return k.ProxyTracerProvider}});var l=d(996);Object.defineProperty(e,"SamplingDecision",{enumerable:!0,get:function(){return l.SamplingDecision}});var m=d(357);Object.defineProperty(e,"SpanKind",{enumerable:!0,get:function(){return m.SpanKind}});var n=d(847);Object.defineProperty(e,"SpanStatusCode",{enumerable:!0,get:function(){return n.SpanStatusCode}});var o=d(475);Object.defineProperty(e,"TraceFlags",{enumerable:!0,get:function(){return o.TraceFlags}});var p=d(98);Object.defineProperty(e,"createTraceState",{enumerable:!0,get:function(){return p.createTraceState}});var q=d(139);Object.defineProperty(e,"isSpanContextValid",{enumerable:!0,get:function(){return q.isSpanContextValid}}),Object.defineProperty(e,"isValidTraceId",{enumerable:!0,get:function(){return q.isValidTraceId}}),Object.defineProperty(e,"isValidSpanId",{enumerable:!0,get:function(){return q.isValidSpanId}});var r=d(476);Object.defineProperty(e,"INVALID_SPANID",{enumerable:!0,get:function(){return r.INVALID_SPANID}}),Object.defineProperty(e,"INVALID_TRACEID",{enumerable:!0,get:function(){return r.INVALID_TRACEID}}),Object.defineProperty(e,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return r.INVALID_SPAN_CONTEXT}});let s=d(67);Object.defineProperty(e,"context",{enumerable:!0,get:function(){return s.context}});let t=d(506);Object.defineProperty(e,"diag",{enumerable:!0,get:function(){return t.diag}});let u=d(886);Object.defineProperty(e,"metrics",{enumerable:!0,get:function(){return u.metrics}});let v=d(939);Object.defineProperty(e,"propagation",{enumerable:!0,get:function(){return v.propagation}});let w=d(845);Object.defineProperty(e,"trace",{enumerable:!0,get:function(){return w.trace}}),e.default={context:s.context,diag:t.diag,metrics:u.metrics,propagation:v.propagation,trace:w.trace}})(),a.exports=e})()},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30430:(a,b,c)=>{"use strict";let d=c(26220);a.exports=(a,b)=>a.sort((a,c)=>d(a,c,b))},31421:a=>{"use strict";a.exports=require("node:child_process")},32665:(a,b,c)=>{"use strict";let d=c(24346);a.exports=(a,b,c)=>{try{b=new d(b,c)}catch(a){return!1}return b.test(a)}},32843:(a,b,c)=>{"use strict";let d=c(78871),e=c(24346);a.exports=(a,b,c)=>{let f=null,g=null,h=null;try{h=new e(b,c)}catch(a){return null}return a.forEach(a=>{h.test(a)&&(!f||-1===g.compare(a))&&(g=new d(f=a,c))}),f}},33160:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b)=>new d(a,b).patch},33851:a=>{var b=1/0,c=0/0,d=/^\s+|\s+$/g,e=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,g=/^0o[0-7]+$/i,h=parseInt,i=Object.prototype.toString;function j(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}a.exports=function(a){var k,l,m;return"number"==typeof a&&a==(m=(l=(k=a)?(k=function(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==i.call(b))return c;if(j(a)){var b,k="function"==typeof a.valueOf?a.valueOf():a;a=j(k)?k+"":k}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(d,"");var l=f.test(a);return l||g.test(a)?h(a.slice(2),l?2:8):e.test(a)?c:+a}(k))===b||k===-b?(k<0?-1:1)*17976931348623157e292:k==k?k:0:0===k?k:0)%1,l==l?m?l-m:l:0)}},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},34906:(a,b,c)=>{"use strict";let d=c(24346);a.exports=(a,b)=>new d(a,b).set.map(a=>a.map(a=>a.value).join(" ").trim().split(" "))},35119:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{StaticGenBailoutError:function(){return d},isStaticGenBailoutError:function(){return e}});let c="NEXT_STATIC_GEN_BAILOUT";class d extends Error{constructor(...a){super(...a),this.code=c}}function e(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===c}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},36616:(a,b,c)=>{Promise.resolve().then(c.bind(c,48911))},36821:(a,b,c)=>{"use strict";let d;Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BubbledError:function(){return m},SpanKind:function(){return k},SpanStatusCode:function(){return j},getTracer:function(){return u},isBubbledError:function(){return n}});let e=c(45441),f=c(23998);try{d=c(29089)}catch(a){d=c(29089)}let{context:g,propagation:h,trace:i,SpanStatusCode:j,SpanKind:k,ROOT_CONTEXT:l}=d;class m extends Error{constructor(a,b){super(),this.bubble=a,this.result=b}}function n(a){return"object"==typeof a&&null!==a&&a instanceof m}let o=(a,b)=>{n(b)&&b.bubble?a.setAttribute("next.bubble",!0):(b&&(a.recordException(b),a.setAttribute("error.type",b.name)),a.setStatus({code:j.ERROR,message:null==b?void 0:b.message})),a.end()},p=new Map,q=d.createContextKey("next.rootSpanId"),r=0,s={set(a,b,c){a.push({key:b,value:c})}};class t{getTracerInstance(){return i.getTracer("next.js","0.0.1")}getContext(){return g}getTracePropagationData(){let a=g.active(),b=[];return h.inject(a,b,s),b}getActiveScopeSpan(){return i.getSpan(null==g?void 0:g.active())}withPropagatedContext(a,b,c){let d=g.active();if(i.getSpanContext(d))return b();let e=h.extract(d,a,c);return g.with(e,b)}trace(...a){var b;let[c,d,h]=a,{fn:j,options:k}="function"==typeof d?{fn:d,options:{}}:{fn:h,options:{...d}},m=k.spanName??c;if(!e.NextVanillaSpanAllowlist.includes(c)&&"1"!==process.env.NEXT_OTEL_VERBOSE||k.hideSpan)return j();let n=this.getSpanContext((null==k?void 0:k.parentSpan)??this.getActiveScopeSpan()),s=!1;n?(null==(b=i.getSpanContext(n))?void 0:b.isRemote)&&(s=!0):(n=(null==g?void 0:g.active())??l,s=!0);let t=r++;return k.attributes={"next.span_name":m,"next.span_type":c,...k.attributes},g.with(n.setValue(q,t),()=>this.getTracerInstance().startActiveSpan(m,k,a=>{let b="performance"in globalThis&&"measure"in performance?globalThis.performance.now():void 0,d=()=>{p.delete(t),b&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&e.LogSpanAllowList.includes(c||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(c.split(".").pop()||"").replace(/[A-Z]/g,a=>"-"+a.toLowerCase())}`,{start:b,end:performance.now()})};s&&p.set(t,new Map(Object.entries(k.attributes??{})));try{if(j.length>1)return j(a,b=>o(a,b));let b=j(a);if((0,f.isThenable)(b))return b.then(b=>(a.end(),b)).catch(b=>{throw o(a,b),b}).finally(d);return a.end(),d(),b}catch(b){throw o(a,b),d(),b}}))}wrap(...a){let b=this,[c,d,f]=3===a.length?a:[a[0],{},a[1]];return e.NextVanillaSpanAllowlist.includes(c)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let a=d;"function"==typeof a&&"function"==typeof f&&(a=a.apply(this,arguments));let e=arguments.length-1,h=arguments[e];if("function"!=typeof h)return b.trace(c,a,()=>f.apply(this,arguments));{let d=b.getContext().bind(g.active(),h);return b.trace(c,a,(a,b)=>(arguments[e]=function(a){return null==b||b(a),d.apply(this,arguments)},f.apply(this,arguments)))}}:f}startSpan(...a){let[b,c]=a,d=this.getSpanContext((null==c?void 0:c.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(b,c,d)}getSpanContext(a){return a?i.setSpan(g.active(),a):void 0}getRootSpanAttributes(){let a=g.active().getValue(q);return p.get(a)}setRootSpanAttribute(a,b){let c=g.active().getValue(q),d=p.get(c);d&&d.set(a,b)}}let u=(()=>{let a=new t;return()=>a})()},37905:(a,b,c)=>{"use strict";let d=c(78871),e=c(24346);a.exports=(a,b,c)=>{let f=null,g=null,h=null;try{h=new e(b,c)}catch(a){return null}return a.forEach(a=>{h.test(a)&&(!f||1===g.compare(a))&&(g=new d(f=a,c))}),f}},39379:(a,b,c)=>{var d=c(42596),e=function(a,b){d.call(this,a),this.name="TokenExpiredError",this.expiredAt=b};e.prototype=Object.create(d.prototype),e.prototype.constructor=e,a.exports=e},40329:(a,b,c)=>{"use strict";let{MAX_SAFE_COMPONENT_LENGTH:d,MAX_SAFE_BUILD_LENGTH:e,MAX_LENGTH:f}=c(45053),g=c(50627),h=(b=a.exports={}).re=[],i=b.safeRe=[],j=b.src=[],k=b.safeSrc=[],l=b.t={},m=0,n="[a-zA-Z0-9-]",o=[["\\s",1],["\\d",f],[n,e]],p=(a,b,c)=>{let d=(a=>{for(let[b,c]of o)a=a.split(`${b}*`).join(`${b}{0,${c}}`).split(`${b}+`).join(`${b}{1,${c}}`);return a})(b),e=m++;g(a,e,b),l[a]=e,j[e]=b,k[e]=d,h[e]=new RegExp(b,c?"g":void 0),i[e]=new RegExp(d,c?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${n}*`),p("MAINVERSION",`(${j[l.NUMERICIDENTIFIER]})\\.(${j[l.NUMERICIDENTIFIER]})\\.(${j[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${j[l.NUMERICIDENTIFIERLOOSE]})\\.(${j[l.NUMERICIDENTIFIERLOOSE]})\\.(${j[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${j[l.NONNUMERICIDENTIFIER]}|${j[l.NUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${j[l.NONNUMERICIDENTIFIER]}|${j[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASE",`(?:-(${j[l.PRERELEASEIDENTIFIER]}(?:\\.${j[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${j[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${j[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${n}+`),p("BUILD",`(?:\\+(${j[l.BUILDIDENTIFIER]}(?:\\.${j[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${j[l.MAINVERSION]}${j[l.PRERELEASE]}?${j[l.BUILD]}?`),p("FULL",`^${j[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${j[l.MAINVERSIONLOOSE]}${j[l.PRERELEASELOOSE]}?${j[l.BUILD]}?`),p("LOOSE",`^${j[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${j[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${j[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${j[l.XRANGEIDENTIFIER]})(?:\\.(${j[l.XRANGEIDENTIFIER]})(?:\\.(${j[l.XRANGEIDENTIFIER]})(?:${j[l.PRERELEASE]})?${j[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${j[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[l.XRANGEIDENTIFIERLOOSE]})(?:${j[l.PRERELEASELOOSE]})?${j[l.BUILD]}?)?)?`),p("XRANGE",`^${j[l.GTLT]}\\s*${j[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${j[l.GTLT]}\\s*${j[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${d}})(?:\\.(\\d{1,${d}}))?(?:\\.(\\d{1,${d}}))?`),p("COERCE",`${j[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",j[l.COERCEPLAIN]+`(?:${j[l.PRERELEASE]})?`+`(?:${j[l.BUILD]})?`+"(?:$|[^\\d])"),p("COERCERTL",j[l.COERCE],!0),p("COERCERTLFULL",j[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${j[l.LONETILDE]}\\s+`,!0),b.tildeTrimReplace="$1~",p("TILDE",`^${j[l.LONETILDE]}${j[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${j[l.LONETILDE]}${j[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${j[l.LONECARET]}\\s+`,!0),b.caretTrimReplace="$1^",p("CARET",`^${j[l.LONECARET]}${j[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${j[l.LONECARET]}${j[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${j[l.GTLT]}\\s*(${j[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${j[l.GTLT]}\\s*(${j[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${j[l.GTLT]}\\s*(${j[l.LOOSEPLAIN]}|${j[l.XRANGEPLAIN]})`,!0),b.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${j[l.XRANGEPLAIN]})\\s+-\\s+(${j[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${j[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${j[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},40410:(a,b)=>{"use strict";function c(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(b,"D",{enumerable:!0,get:function(){return c}})},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},42474:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"DetachedPromise",{enumerable:!0,get:function(){return c}});class c{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c,b=d}),this.resolve=a,this.reject=b}}},42596:a=>{var b=function(a,b){Error.call(this,a),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=a,b&&(this.inner=b)};b.prototype=Object.create(Error.prototype),b.prototype.constructor=b,a.exports=b},44456:(a,b,c)=>{Promise.resolve().then(c.bind(c,60967))},44650:a=>{var b=1/0,c=0/0,d=/^\s+|\s+$/g,e=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,g=/^0o[0-7]+$/i,h=parseInt,i=Object.prototype.toString;function j(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}a.exports=function(a){var k,l,m,n,o=2,p=a;if("function"!=typeof p)throw TypeError("Expected a function");return m=(l=(k=o)?(k=function(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==i.call(b))return c;if(j(a)){var b,k="function"==typeof a.valueOf?a.valueOf():a;a=j(k)?k+"":k}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(d,"");var l=f.test(a);return l||g.test(a)?h(a.slice(2),l?2:8):e.test(a)?c:+a}(k))===b||k===-b?(k<0?-1:1)*17976931348623157e292:k==k?k:0:0===k?k:0)%1,o=l==l?m?l-m:l:0,function(){return--o>0&&(n=p.apply(this,arguments)),o<=1&&(p=void 0),n}}},45053:a=>{"use strict";a.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||0x1fffffffffffff,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},45441:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{AppRenderSpan:function(){return i},AppRouteRouteHandlersSpan:function(){return l},BaseServerSpan:function(){return c},LoadComponentsSpan:function(){return d},LogSpanAllowList:function(){return p},MiddlewareSpan:function(){return n},NextNodeServerSpan:function(){return f},NextServerSpan:function(){return e},NextVanillaSpanAllowlist:function(){return o},NodeSpan:function(){return k},RenderSpan:function(){return h},ResolveMetadataSpan:function(){return m},RouterSpan:function(){return j},StartServerSpan:function(){return g}});var c=function(a){return a.handleRequest="BaseServer.handleRequest",a.run="BaseServer.run",a.pipe="BaseServer.pipe",a.getStaticHTML="BaseServer.getStaticHTML",a.render="BaseServer.render",a.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",a.renderToResponse="BaseServer.renderToResponse",a.renderToHTML="BaseServer.renderToHTML",a.renderError="BaseServer.renderError",a.renderErrorToResponse="BaseServer.renderErrorToResponse",a.renderErrorToHTML="BaseServer.renderErrorToHTML",a.render404="BaseServer.render404",a}(c||{}),d=function(a){return a.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",a.loadComponents="LoadComponents.loadComponents",a}(d||{}),e=function(a){return a.getRequestHandler="NextServer.getRequestHandler",a.getServer="NextServer.getServer",a.getServerRequestHandler="NextServer.getServerRequestHandler",a.createServer="createServer.createServer",a}(e||{}),f=function(a){return a.compression="NextNodeServer.compression",a.getBuildId="NextNodeServer.getBuildId",a.createComponentTree="NextNodeServer.createComponentTree",a.clientComponentLoading="NextNodeServer.clientComponentLoading",a.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",a.generateStaticRoutes="NextNodeServer.generateStaticRoutes",a.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",a.generatePublicRoutes="NextNodeServer.generatePublicRoutes",a.generateImageRoutes="NextNodeServer.generateImageRoutes.route",a.sendRenderResult="NextNodeServer.sendRenderResult",a.proxyRequest="NextNodeServer.proxyRequest",a.runApi="NextNodeServer.runApi",a.render="NextNodeServer.render",a.renderHTML="NextNodeServer.renderHTML",a.imageOptimizer="NextNodeServer.imageOptimizer",a.getPagePath="NextNodeServer.getPagePath",a.getRoutesManifest="NextNodeServer.getRoutesManifest",a.findPageComponents="NextNodeServer.findPageComponents",a.getFontManifest="NextNodeServer.getFontManifest",a.getServerComponentManifest="NextNodeServer.getServerComponentManifest",a.getRequestHandler="NextNodeServer.getRequestHandler",a.renderToHTML="NextNodeServer.renderToHTML",a.renderError="NextNodeServer.renderError",a.renderErrorToHTML="NextNodeServer.renderErrorToHTML",a.render404="NextNodeServer.render404",a.startResponse="NextNodeServer.startResponse",a.route="route",a.onProxyReq="onProxyReq",a.apiResolver="apiResolver",a.internalFetch="internalFetch",a}(f||{}),g=function(a){return a.startServer="startServer.startServer",a}(g||{}),h=function(a){return a.getServerSideProps="Render.getServerSideProps",a.getStaticProps="Render.getStaticProps",a.renderToString="Render.renderToString",a.renderDocument="Render.renderDocument",a.createBodyResult="Render.createBodyResult",a}(h||{}),i=function(a){return a.renderToString="AppRender.renderToString",a.renderToReadableStream="AppRender.renderToReadableStream",a.getBodyResult="AppRender.getBodyResult",a.fetch="AppRender.fetch",a}(i||{}),j=function(a){return a.executeRoute="Router.executeRoute",a}(j||{}),k=function(a){return a.runHandler="Node.runHandler",a}(k||{}),l=function(a){return a.runHandler="AppRouteRouteHandlers.runHandler",a}(l||{}),m=function(a){return a.generateMetadata="ResolveMetadata.generateMetadata",a.generateViewport="ResolveMetadata.generateViewport",a}(m||{}),n=function(a){return a.execute="Middleware.execute",a}(n||{});let o=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],p=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"]},45663:(a,b,c)=>{var d=c(60174);a.exports=function(a,b){b=b||{};var c=d.decode(a,b);if(!c)return null;var e=c.payload;if("string"==typeof e)try{var f=JSON.parse(e);null!==f&&"object"==typeof f&&(e=f)}catch(a){}return!0===b.complete?{header:c.header,payload:e,signature:c.signature}:e}},46204:(a,b,c)=>{"use strict";a.exports=c(49754).vendored["react-rsc"].React},47443:(a,b,c)=>{"use strict";let d=c(24346);a.exports=(a,b,c)=>(a=new d(a,c),b=new d(b,c),a.intersects(b,c))},47586:a=>{"use strict";let b=Object.freeze({loose:!0}),c=Object.freeze({});a.exports=a=>a?"object"!=typeof a?b:a:c},47706:(a,b,c)=>{let d=c(75692),e=c(98038),f={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},g={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};a.exports=function(a,b){if(!a||!b)return;let c=b.asymmetricKeyType;if(!c)return;let h=f[c];if(!h)throw Error(`Unknown key type "${c}".`);if(!h.includes(a))throw Error(`"alg" parameter for "${c}" key type must be one of: ${h.join(", ")}.`);if(d)switch(c){case"ec":let i=b.asymmetricKeyDetails.namedCurve,j=g[a];if(i!==j)throw Error(`"alg" parameter "${a}" requires curve "${j}".`);break;case"rsa-pss":if(e){let c=parseInt(a.slice(-3),10),{hashAlgorithm:d,mgf1HashAlgorithm:e,saltLength:f}=b.asymmetricKeyDetails;if(d!==`sha${c}`||e!==d)throw Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}.`);if(void 0!==f&&f>c>>3)throw Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}.`)}}}},48161:a=>{"use strict";a.exports=require("node:os")},48604:(a,b,c)=>{var d,e=c(74364).Buffer,f=c(55511),g=c(63489),h=c(28354),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw p(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw p("key must be a string, a buffer or an object")}function n(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function p(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function q(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function r(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw p(i)}}}(c),b=q(b);var d=f.createHmac("sha"+a,c);return n((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var s="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(a,b){return d||(d=c(76204)),d(a,b)};function t(a){return function(b,c,d){var f=r(a)(b,d);return s(e.from(c),e.from(f))}}function u(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign(c,"base64")))}}function v(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function w(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function y(a){var b=u(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function z(a){var b=v(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function A(){return function(){return""}}function B(){return function(a,b){return""===b}}a.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:r,rs:u,ps:w,es:y,none:A})[c](d),verify:({hs:t,rs:v,ps:x,es:z,none:B})[c](d)}}},48911:(a,b,c)=>{"use strict";c.d(b,{Toaster:()=>l});var d=c(21124),e=c(59268),f=c(71117),g=c(16945),h=c(56899),i=c(14263),j=c(45523),k=c(42830);let l=({...a})=>{let{theme:b="system"}=(0,j.D)();return(0,d.jsx)(k.l$,{theme:b,className:"toaster group",icons:{success:(0,d.jsx)(e.A,{className:"size-4"}),info:(0,d.jsx)(f.A,{className:"size-4"}),warning:(0,d.jsx)(g.A,{className:"size-4"}),error:(0,d.jsx)(h.A,{className:"size-4"}),loading:(0,d.jsx)(i.A,{className:"size-4 animate-spin"})},style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},...a})}},49622:(a,b,c)=>{var d=c(74088);a.exports=function(a,b){var c=b||Math.floor(Date.now()/1e3);if("string"==typeof a){var e=d(a);if(void 0===e)return;return Math.floor(c+e/1e3)}if("number"==typeof a)return c+a}},49768:(a,b,c)=>{Promise.resolve().then(c.bind(c,25825))},50403:(a,b,c)=>{"use strict";let d=Symbol("SemVer ANY");class e{static get ANY(){return d}constructor(a,b){if(b=f(b),a instanceof e)if(!!b.loose===a.loose)return a;else a=a.value;j("comparator",a=a.trim().split(/\s+/).join(" "),b),this.options=b,this.loose=!!b.loose,this.parse(a),this.semver===d?this.value="":this.value=this.operator+this.semver.version,j("comp",this)}parse(a){let b=this.options.loose?g[h.COMPARATORLOOSE]:g[h.COMPARATOR],c=a.match(b);if(!c)throw TypeError(`Invalid comparator: ${a}`);this.operator=void 0!==c[1]?c[1]:"","="===this.operator&&(this.operator=""),c[2]?this.semver=new k(c[2],this.options.loose):this.semver=d}toString(){return this.value}test(a){if(j("Comparator.test",a,this.options.loose),this.semver===d||a===d)return!0;if("string"==typeof a)try{a=new k(a,this.options)}catch(a){return!1}return i(a,this.operator,this.semver,this.options)}intersects(a,b){if(!(a instanceof e))throw TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(a.value,b).test(this.value):""===a.operator?""===a.value||new l(this.value,b).test(a.semver):!((b=f(b)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===a.value)||!b.includePrerelease&&(this.value.startsWith("<0.0.0")||a.value.startsWith("<0.0.0")))&&!!(this.operator.startsWith(">")&&a.operator.startsWith(">")||this.operator.startsWith("<")&&a.operator.startsWith("<")||this.semver.version===a.semver.version&&this.operator.includes("=")&&a.operator.includes("=")||i(this.semver,"<",a.semver,b)&&this.operator.startsWith(">")&&a.operator.startsWith("<")||i(this.semver,">",a.semver,b)&&this.operator.startsWith("<")&&a.operator.startsWith(">"))}}a.exports=e;let f=c(47586),{safeRe:g,t:h}=c(40329),i=c(67418),j=c(50627),k=c(78871),l=c(24346)},50627:a=>{"use strict";a.exports="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...a)=>console.error("SEMVER",...a):()=>{}},50931:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{chainStreams:function(){return n},continueDynamicHTMLResume:function(){return E},continueDynamicPrerender:function(){return C},continueFizzStream:function(){return B},continueStaticPrerender:function(){return D},createBufferedTransformStream:function(){return s},createDocumentClosingStream:function(){return F},createRootLayoutValidatorStream:function(){return A},renderToInitialFizzStream:function(){return u},streamFromBuffer:function(){return p},streamFromString:function(){return o},streamToBuffer:function(){return q},streamToString:function(){return r}});let d=c(36821),e=c(45441),f=c(42474),g=c(86331),h=c(93047),i=c(53476),j=c(57941),k=c(54353);function l(){}let m=new TextEncoder;function n(...a){if(0===a.length)return new ReadableStream({start(a){a.close()}});if(1===a.length)return a[0];let{readable:b,writable:c}=new TransformStream,d=a[0].pipeTo(c,{preventClose:!0}),e=1;for(;e<a.length-1;e++){let b=a[e];d=d.then(()=>b.pipeTo(c,{preventClose:!0}))}let f=a[e];return(d=d.then(()=>f.pipeTo(c))).catch(l),b}function o(a){return new ReadableStream({start(b){b.enqueue(m.encode(a)),b.close()}})}function p(a){return new ReadableStream({start(b){b.enqueue(a),b.close()}})}async function q(a){let b=a.getReader(),c=[];for(;;){let{done:a,value:d}=await b.read();if(a)break;c.push(d)}return Buffer.concat(c)}async function r(a,b){let c=new TextDecoder("utf-8",{fatal:!0}),d="";for await(let e of a){if(null==b?void 0:b.aborted)return d;d+=c.decode(e,{stream:!0})}return d+c.decode()}function s(){let a,b=[],c=0;return new TransformStream({transform(d,e){b.push(d),c+=d.byteLength,(d=>{if(a)return;let e=new f.DetachedPromise;a=e,(0,g.scheduleImmediate)(()=>{try{let a=new Uint8Array(c),e=0;for(let c=0;c<b.length;c++){let d=b[c];a.set(d,e),e+=d.byteLength}b.length=0,c=0,d.enqueue(a)}catch{}finally{a=void 0,e.resolve()}})})(e)},flush(){if(a)return a.promise}})}function t(a,b){let c=!1;return new TransformStream({transform(d,e){if(a&&!c){c=!0;let a=new TextDecoder("utf-8",{fatal:!0}).decode(d,{stream:!0}),f=(0,k.insertBuildIdComment)(a,b);e.enqueue(m.encode(f));return}e.enqueue(d)}})}function u({ReactDOMServer:a,element:b,streamOptions:c}){return(0,d.getTracer)().trace(e.AppRenderSpan.renderToReadableStream,async()=>a.renderToReadableStream(b,c))}function v(a){let b=-1,c=!1;return new TransformStream({async transform(d,e){let f=-1,g=-1;if(b++,c)return void e.enqueue(d);let j=0;if(-1===f){if(-1===(f=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.META.ICON_MARK)))return void e.enqueue(d);47===d[f+(j=h.ENCODED_TAGS.META.ICON_MARK.length)]?j+=2:j++}if(0===b){if(g=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.CLOSED.HEAD),-1!==f){if(f<g){let a=new Uint8Array(d.length-j);a.set(d.subarray(0,f)),a.set(d.subarray(f+j),f),d=a}else{let b=await a(),c=m.encode(b),e=c.length,g=new Uint8Array(d.length-j+e);g.set(d.subarray(0,f)),g.set(c,f),g.set(d.subarray(f+j),f+e),d=g}c=!0}}else{let b=await a(),e=m.encode(b),g=e.length,h=new Uint8Array(d.length-j+g);h.set(d.subarray(0,f)),h.set(e,f),h.set(d.subarray(f+j),f+g),d=h,c=!0}e.enqueue(d)}})}function w(a){let b=!1,c=!1;return new TransformStream({async transform(d,e){c=!0;let f=await a();if(b){if(f){let a=m.encode(f);e.enqueue(a)}e.enqueue(d)}else{let a=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.CLOSED.HEAD);if(-1!==a){if(f){let b=m.encode(f),c=new Uint8Array(d.length+b.length);c.set(d.slice(0,a)),c.set(b,a),c.set(d.slice(a),a+b.length),e.enqueue(c)}else e.enqueue(d);b=!0}else f&&e.enqueue(m.encode(f)),e.enqueue(d),b=!0}},async flush(b){if(c){let c=await a();c&&b.enqueue(m.encode(c))}}})}function x(a,b){let c=!1,d=null,e=!1;function f(a){return d||(d=h(a)),d}async function h(d){let f=a.getReader();b&&await (0,g.atLeastOneTask)();try{for(;;){let{done:a,value:h}=await f.read();if(a){e=!0;return}b||c||await (0,g.atLeastOneTask)(),d.enqueue(h)}}catch(a){d.error(a)}}return new TransformStream({start(a){b||f(a)},transform(a,c){c.enqueue(a),b&&f(c)},flush(a){if(c=!0,!e)return f(a)}})}let y="</body></html>";function z(){let a=!1;return new TransformStream({transform(b,c){if(a)return c.enqueue(b);let d=(0,i.indexOfUint8Array)(b,h.ENCODED_TAGS.CLOSED.BODY_AND_HTML);if(d>-1){if(a=!0,b.length===h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length)return;let e=b.slice(0,d);if(c.enqueue(e),b.length>h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length+d){let a=b.slice(d+h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length);c.enqueue(a)}}else c.enqueue(b)},flush(a){a.enqueue(h.ENCODED_TAGS.CLOSED.BODY_AND_HTML)}})}function A(){let a=!1,b=!1;return new TransformStream({async transform(c,d){!a&&(0,i.indexOfUint8Array)(c,h.ENCODED_TAGS.OPENING.HTML)>-1&&(a=!0),!b&&(0,i.indexOfUint8Array)(c,h.ENCODED_TAGS.OPENING.BODY)>-1&&(b=!0),d.enqueue(c)},flush(c){let d=[];a||d.push("html"),b||d.push("body"),d.length&&c.enqueue(m.encode(`<html id="__next_error__">
            <template
              data-next-error-message="Missing ${d.map(a=>`<${a}>`).join(d.length>1?" and ":"")} tags in the root layout.
Read more at https://nextjs.org/docs/messages/missing-root-layout-tags"
              data-next-error-digest="${j.MISSING_ROOT_TAGS_ERROR}"
              data-next-error-stack=""
            ></template>
          `))}})}async function B(a,{suffix:b,inlinedDataStream:c,isStaticGeneration:d,isBuildTimePrerendering:e,buildId:h,getServerInsertedHTML:i,getServerInsertedMetadata:j,validateRootLayout:k}){let l,n,o=b?b.split(y,1)[0]:null;d&&await a.allReady;var p=[s(),t(e,h),v(j),null!=o&&o.length>0?(n=!1,new TransformStream({transform(a,b){if(b.enqueue(a),!n){n=!0;let a=new f.DetachedPromise;l=a,(0,g.scheduleImmediate)(()=>{try{b.enqueue(m.encode(o))}catch{}finally{l=void 0,a.resolve()}})}},flush(a){if(l)return l.promise;n||a.enqueue(m.encode(o))}})):null,c?x(c,!0):null,k?A():null,z(),w(i)];let q=a;for(let a of p)a&&(q=q.pipeThrough(a));return q}async function C(a,{getServerInsertedHTML:b,getServerInsertedMetadata:c}){return a.pipeThrough(s()).pipeThrough(new TransformStream({transform(a,b){(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.BODY)||(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.HTML)||(a=(0,i.removeFromUint8Array)(a,h.ENCODED_TAGS.CLOSED.BODY),a=(0,i.removeFromUint8Array)(a,h.ENCODED_TAGS.CLOSED.HTML),b.enqueue(a))}})).pipeThrough(w(b)).pipeThrough(v(c))}async function D(a,{inlinedDataStream:b,getServerInsertedHTML:c,getServerInsertedMetadata:d,isBuildTimePrerendering:e,buildId:f}){return a.pipeThrough(s()).pipeThrough(t(e,f)).pipeThrough(w(c)).pipeThrough(v(d)).pipeThrough(x(b,!0)).pipeThrough(z())}async function E(a,{delayDataUntilFirstHtmlChunk:b,inlinedDataStream:c,getServerInsertedHTML:d,getServerInsertedMetadata:e}){return a.pipeThrough(s()).pipeThrough(w(d)).pipeThrough(v(e)).pipeThrough(x(c,b)).pipeThrough(z())}function F(){return o(y)}},51318:(a,b,c)=>{"use strict";a.exports=c(9907)},51455:a=>{"use strict";a.exports=require("node:fs/promises")},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>i,metadata:()=>h});var d=c(75338),e=c(3305),f=c.n(e);c(61135);var g=c(25825);let h={title:"RFP Studio",description:"G\xe9n\xe9rez et validez des r\xe9ponses avanc\xe9es \xe0 grande \xe9chelle."};function i({children:a}){return(0,d.jsx)("html",{lang:"fr",children:(0,d.jsxs)("body",{className:f().className,children:[(0,d.jsx)("main",{children:a}),(0,d.jsx)(g.Toaster,{})]})})}},52318:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BailoutToCSRError:function(){return d},isBailoutToCSRError:function(){return e}});let c="BAILOUT_TO_CLIENT_SIDE_RENDERING";class d extends Error{constructor(a){super("Bail out to client-side rendering: "+a),this.reason=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===c}},52577:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DynamicServerError:function(){return d},isDynamicServerError:function(){return e}});let c="DYNAMIC_SERVER_USAGE";class d extends Error{constructor(a){super("Dynamic server usage: "+a),this.description=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===c}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},52979:(a,b,c)=>{"use strict";let d;c.r(b),c.d(b,{default:()=>rb});var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=c(21124),w=c(38301),x=c.t(w,2),y=c.n(w);let z=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f},A=a=>{let b=(a=>a?z(a):z)(a),c=a=>(function(a,b=a=>a){let c=w.useSyncExternalStore(a.subscribe,w.useCallback(()=>b(a.getState()),[a,b]),w.useCallback(()=>b(a.getInitialState()),[a,b]));return w.useDebugValue(c),c})(b,a);return Object.assign(c,b),c};function B(a,b){let c;try{c=a()}catch(a){return}return{getItem:a=>{var d;let e=a=>null===a?null:JSON.parse(a,null==b?void 0:b.reviver),f=null!=(d=c.getItem(a))?d:null;return f instanceof Promise?f.then(e):e(f)},setItem:(a,d)=>c.setItem(a,JSON.stringify(d,null==b?void 0:b.replacer)),removeItem:a=>c.removeItem(a)}}let C=a=>b=>{try{let c=a(b);if(c instanceof Promise)return c;return{then:a=>C(a)(c),catch(a){return this}}}catch(a){return{then(a){return this},catch:b=>C(b)(a)}}},D=(a=>a?A(a):A)()(((a,b)=>(c,d,e)=>{let f,g={storage:B(()=>localStorage),partialize:a=>a,version:0,merge:(a,b)=>({...b,...a}),...b},h=!1,i=new Set,j=new Set,k=g.storage;if(!k)return a((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${g.name}', the given storage is currently unavailable.`),c(...a)},d,e);let l=()=>{let a=g.partialize({...d()});return k.setItem(g.name,{state:a,version:g.version})},m=e.setState;e.setState=(a,b)=>(m(a,b),l());let n=a((...a)=>(c(...a),l()),d,e);e.getInitialState=()=>n;let o=()=>{var a,b;if(!k)return;h=!1,i.forEach(a=>{var b;return a(null!=(b=d())?b:n)});let e=(null==(b=g.onRehydrateStorage)?void 0:b.call(g,null!=(a=d())?a:n))||void 0;return C(k.getItem.bind(k))(g.name).then(a=>{if(a)if("number"!=typeof a.version||a.version===g.version)return[!1,a.state];else{if(g.migrate){let b=g.migrate(a.state,a.version);return b instanceof Promise?b.then(a=>[!0,a]):[!0,b]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(a=>{var b;let[e,h]=a;if(c(f=g.merge(h,null!=(b=d())?b:n),!0),e)return l()}).then(()=>{null==e||e(f,void 0),f=d(),h=!0,j.forEach(a=>a(f))}).catch(a=>{null==e||e(void 0,a)})};return e.persist={setOptions:a=>{g={...g,...a},a.storage&&(k=a.storage)},clearStorage:()=>{null==k||k.removeItem(g.name)},getOptions:()=>g,rehydrate:()=>o(),hasHydrated:()=>h,onHydrate:a=>(i.add(a),()=>{i.delete(a)}),onFinishHydration:a=>(j.add(a),()=>{j.delete(a)})},g.skipHydration||o(),f||n})(a=>({currentStep:1,llmConfigs:[],projectData:null,generationParams:{language:"Fran\xe7ais",responseLength:"Moyenne",persona:"Expert Dynamics 365 Sales",instructions:""},results:[],generationProgress:{current:0,total:0},selectedResultIndex:null,columnOrder:[],generationLogs:[],setCurrentStep:b=>a({currentStep:b}),addLlmConfig:()=>a(a=>({llmConfigs:[...a.llmConfigs,{id:Date.now().toString(),provider:"",apiKey:"",azureAuthMode:"apiKey",endpoint:"",apiVersion:"2025-01-01-preview",deployment:"",model:"gemini-1.5-flash",isValidated:!1}]})),updateLlmConfig:(b,c)=>a(a=>({llmConfigs:a.llmConfigs.map((a,d)=>d===b?{...a,...c}:a)})),removeLlmConfig:b=>a(a=>({llmConfigs:a.llmConfigs.filter((a,c)=>c!==b)})),loadLlmConfigs:b=>a({llmConfigs:b}),setProjectData:b=>a({projectData:b}),setMapping:(b,c,d)=>a(a=>{if(!a.projectData)return{};let e="question"===c?"questionColumn":"answerColumn",f=a.projectData.sheets.map(a=>a.name===b?{...a,[e]:d}:a);return{projectData:{...a.projectData,sheets:f}}}),setGenerationParams:b=>a(a=>({generationParams:{...a.generationParams,...b}})),setResults:b=>a({results:b}),setGenerationProgress:b=>a({generationProgress:b}),setSelectedResultIndex:b=>a({selectedResultIndex:b}),updateSingleResult:(b,c)=>a(a=>({results:a.results.map((a,d)=>d===b?c:a)})),setColumnOrder:b=>a({columnOrder:b}),addGenerationLog:b=>a(a=>({generationLogs:[...a.generationLogs,b]})),addMultipleGenerationLogs:b=>a(a=>({generationLogs:[...a.generationLogs,...b]})),clearGenerationLogs:()=>a({generationLogs:[]})}),{name:"prompt-studio-storage",storage:B(()=>localStorage)})),E=["Configuration","Contexte","Playground","R\xe9sultats"];function F(){let a=D(a=>a.currentStep);return(0,v.jsx)("div",{className:"w-full max-w-2xl mx-auto my-8",children:(0,v.jsx)("div",{className:"flex items-center justify-between",children:E.map((b,c)=>{let d=c+1,e=d===a,f=d<a;return(0,v.jsxs)("div",{className:"flex items-center flex-1",children:[(0,v.jsxs)("div",{className:"flex flex-col items-center",children:[(0,v.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                    ${f?"bg-green-500 text-white":""}
                    ${e?"bg-slate-900 text-white":""}
                    ${!f&&!e?"bg-slate-200 text-slate-500":""}
                  `,children:f?"":d}),(0,v.jsx)("p",{className:`mt-2 text-xs text-center font-semibold ${e?"text-slate-900":"text-slate-500"}`,children:b})]}),d<E.length&&(0,v.jsx)("div",{className:`flex-auto border-t-2 mx-4 
                  ${f?"border-green-500":"border-slate-200"}`})]},b)})})})}function G(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function H(...a){return b=>{let c=!1,d=a.map(a=>{let d=G(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():G(a[b],null)}}}}function I(...a){return w.useCallback(H(...a),a)}function J(a){let b=function(a){let b=w.forwardRef((a,b)=>{let{children:c,...d}=a;if(w.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),h=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==w.Fragment&&(h.ref=b?H(b,g):g),w.cloneElement(c,h)}return w.Children.count(c)>1?w.Children.only(null):null});return b.displayName=`${a}.SlotClone`,b}(a),c=w.forwardRef((a,c)=>{let{children:d,...e}=a,f=w.Children.toArray(d),g=f.find(M);if(g){let a=g.props.children,d=f.map(b=>b!==g?b:w.Children.count(a)>1?w.Children.only(null):w.isValidElement(a)?a.props.children:null);return(0,v.jsx)(b,{...e,ref:c,children:w.isValidElement(a)?w.cloneElement(a,void 0,d):null})}return(0,v.jsx)(b,{...e,ref:c,children:d})});return c.displayName=`${a}.Slot`,c}var K=J("Slot"),L=Symbol("radix.slottable");function M(a){return w.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===L}function N(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}let O=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,P=(a,b)=>c=>{var d;if((null==b?void 0:b.variants)==null)return N(a,null==c?void 0:c.class,null==c?void 0:c.className);let{variants:e,defaultVariants:f}=b,g=Object.keys(e).map(a=>{let b=null==c?void 0:c[a],d=null==f?void 0:f[a];if(null===b)return null;let g=O(b)||O(d);return e[a][g]}),h=c&&Object.entries(c).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return N(a,g,null==b||null==(d=b.compoundVariants)?void 0:d.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...f,...h}[b]):({...f,...h})[b]===c})?[...a,c,d]:a},[]),null==c?void 0:c.class,null==c?void 0:c.className)},Q=(a,b)=>{if(0===a.length)return b.classGroupId;let c=a[0],d=b.nextPart.get(c),e=d?Q(a.slice(1),d):void 0;if(e)return e;if(0===b.validators.length)return;let f=a.join("-");return b.validators.find(({validator:a})=>a(f))?.classGroupId},R=/^\[(.+)\]$/,S=(a,b,c,d)=>{a.forEach(a=>{if("string"==typeof a){(""===a?b:T(b,a)).classGroupId=c;return}if("function"==typeof a)return U(a)?void S(a(d),b,c,d):void b.validators.push({validator:a,classGroupId:c});Object.entries(a).forEach(([a,e])=>{S(e,T(b,a),c,d)})})},T=(a,b)=>{let c=a;return b.split("-").forEach(a=>{c.nextPart.has(a)||c.nextPart.set(a,{nextPart:new Map,validators:[]}),c=c.nextPart.get(a)}),c},U=a=>a.isThemeGetter,V=/\s+/;function W(){let a,b,c=0,d="";for(;c<arguments.length;)(a=arguments[c++])&&(b=X(a))&&(d&&(d+=" "),d+=b);return d}let X=a=>{let b;if("string"==typeof a)return a;let c="";for(let d=0;d<a.length;d++)a[d]&&(b=X(a[d]))&&(c&&(c+=" "),c+=b);return c},Y=a=>{let b=b=>b[a]||[];return b.isThemeGetter=!0,b},Z=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_=/^\((?:(\w[\w-]*):)?(.+)\)$/i,aa=/^\d+\/\d+$/,ab=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ac=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ad=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,ae=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,af=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ag=a=>aa.test(a),ah=a=>!!a&&!Number.isNaN(Number(a)),ai=a=>!!a&&Number.isInteger(Number(a)),aj=a=>a.endsWith("%")&&ah(a.slice(0,-1)),ak=a=>ab.test(a),al=()=>!0,am=a=>ac.test(a)&&!ad.test(a),an=()=>!1,ao=a=>ae.test(a),ap=a=>af.test(a),aq=a=>!as(a)&&!ay(a),ar=a=>aF(a,aJ,an),as=a=>Z.test(a),at=a=>aF(a,aK,am),au=a=>aF(a,aL,ah),av=a=>aF(a,aH,an),aw=a=>aF(a,aI,ap),ax=a=>aF(a,aN,ao),ay=a=>_.test(a),az=a=>aG(a,aK),aA=a=>aG(a,aM),aB=a=>aG(a,aH),aC=a=>aG(a,aJ),aD=a=>aG(a,aI),aE=a=>aG(a,aN,!0),aF=(a,b,c)=>{let d=Z.exec(a);return!!d&&(d[1]?b(d[1]):c(d[2]))},aG=(a,b,c=!1)=>{let d=_.exec(a);return!!d&&(d[1]?b(d[1]):c)},aH=a=>"position"===a||"percentage"===a,aI=a=>"image"===a||"url"===a,aJ=a=>"length"===a||"size"===a||"bg-size"===a,aK=a=>"length"===a,aL=a=>"number"===a,aM=a=>"family-name"===a,aN=a=>"shadow"===a;Symbol.toStringTag;let aO=function(a,...b){let c,d,e,f=function(h){let i;return d=(c={cache:(a=>{if(a<1)return{get:()=>void 0,set:()=>{}};let b=0,c=new Map,d=new Map,e=(e,f)=>{c.set(e,f),++b>a&&(b=0,d=c,c=new Map)};return{get(a){let b=c.get(a);return void 0!==b?b:void 0!==(b=d.get(a))?(e(a,b),b):void 0},set(a,b){c.has(a)?c.set(a,b):e(a,b)}}})((i=b.reduce((a,b)=>b(a),a())).cacheSize),parseClassName:(a=>{let{prefix:b,experimentalParseClassName:c}=a,d=a=>{let b,c,d=[],e=0,f=0,g=0;for(let c=0;c<a.length;c++){let h=a[c];if(0===e&&0===f){if(":"===h){d.push(a.slice(g,c)),g=c+1;continue}if("/"===h){b=c;continue}}"["===h?e++:"]"===h?e--:"("===h?f++:")"===h&&f--}let h=0===d.length?a:a.substring(g),i=(c=h).endsWith("!")?c.substring(0,c.length-1):c.startsWith("!")?c.substring(1):c;return{modifiers:d,hasImportantModifier:i!==h,baseClassName:i,maybePostfixModifierPosition:b&&b>g?b-g:void 0}};if(b){let a=b+":",c=d;d=b=>b.startsWith(a)?c(b.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:b,maybePostfixModifierPosition:void 0}}if(c){let a=d;d=b=>c({className:b,parseClassName:a})}return d})(i),sortModifiers:(a=>{let b=Object.fromEntries(a.orderSensitiveModifiers.map(a=>[a,!0]));return a=>{if(a.length<=1)return a;let c=[],d=[];return a.forEach(a=>{"["===a[0]||b[a]?(c.push(...d.sort(),a),d=[]):d.push(a)}),c.push(...d.sort()),c}})(i),...(a=>{let b=(a=>{let{theme:b,classGroups:c}=a,d={nextPart:new Map,validators:[]};for(let a in c)S(c[a],d,a,b);return d})(a),{conflictingClassGroups:c,conflictingClassGroupModifiers:d}=a;return{getClassGroupId:a=>{let c=a.split("-");return""===c[0]&&1!==c.length&&c.shift(),Q(c,b)||(a=>{if(R.test(a)){let b=R.exec(a)[1],c=b?.substring(0,b.indexOf(":"));if(c)return"arbitrary.."+c}})(a)},getConflictingClassGroupIds:(a,b)=>{let e=c[a]||[];return b&&d[a]?[...e,...d[a]]:e}}})(i)}).cache.get,e=c.cache.set,f=g,g(h)};function g(a){let b=d(a);if(b)return b;let f=((a,b)=>{let{parseClassName:c,getClassGroupId:d,getConflictingClassGroupIds:e,sortModifiers:f}=b,g=[],h=a.trim().split(V),i="";for(let a=h.length-1;a>=0;a-=1){let b=h[a],{isExternal:j,modifiers:k,hasImportantModifier:l,baseClassName:m,maybePostfixModifierPosition:n}=c(b);if(j){i=b+(i.length>0?" "+i:i);continue}let o=!!n,p=d(o?m.substring(0,n):m);if(!p){if(!o||!(p=d(m))){i=b+(i.length>0?" "+i:i);continue}o=!1}let q=f(k).join(":"),r=l?q+"!":q,s=r+p;if(g.includes(s))continue;g.push(s);let t=e(p,o);for(let a=0;a<t.length;++a){let b=t[a];g.push(r+b)}i=b+(i.length>0?" "+i:i)}return i})(a,c);return e(a,f),f}return function(){return f(W.apply(null,arguments))}}(()=>{let a=Y("color"),b=Y("font"),c=Y("text"),d=Y("font-weight"),e=Y("tracking"),f=Y("leading"),g=Y("breakpoint"),h=Y("container"),i=Y("spacing"),j=Y("radius"),k=Y("shadow"),l=Y("inset-shadow"),m=Y("text-shadow"),n=Y("drop-shadow"),o=Y("blur"),p=Y("perspective"),q=Y("aspect"),r=Y("ease"),s=Y("animate"),t=()=>["auto","avoid","all","avoid-page","page","left","right","column"],u=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...u(),ay,as],w=()=>["auto","hidden","clip","visible","scroll"],x=()=>["auto","contain","none"],y=()=>[ay,as,i],z=()=>[ag,"full","auto",...y()],A=()=>[ai,"none","subgrid",ay,as],B=()=>["auto",{span:["full",ai,ay,as]},ai,ay,as],C=()=>[ai,"auto",ay,as],D=()=>["auto","min","max","fr",ay,as],E=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],G=()=>["auto",...y()],H=()=>[ag,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...y()],I=()=>[a,ay,as],J=()=>[...u(),aB,av,{position:[ay,as]}],K=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",aC,ar,{size:[ay,as]}],M=()=>[aj,az,at],N=()=>["","none","full",j,ay,as],O=()=>["",ah,az,at],P=()=>["solid","dashed","dotted","double"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>[ah,aj,aB,av],S=()=>["","none",o,ay,as],T=()=>["none",ah,ay,as],U=()=>["none",ah,ay,as],V=()=>[ah,ay,as],W=()=>[ag,"full",...y()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ak],breakpoint:[ak],color:[al],container:[ak],"drop-shadow":[ak],ease:["in","out","in-out"],font:[aq],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ak],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ak],shadow:[ak],spacing:["px",ah],text:[ak],"text-shadow":[ak],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ag,as,ay,q]}],container:["container"],columns:[{columns:[ah,as,ay,h]}],"break-after":[{"break-after":t()}],"break-before":[{"break-before":t()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:x()}],"overscroll-x":[{"overscroll-x":x()}],"overscroll-y":[{"overscroll-y":x()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[ai,"auto",ay,as]}],basis:[{basis:[ag,"full","auto",h,...y()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ah,ag,"auto","initial","none",as]}],grow:[{grow:["",ah,ay,as]}],shrink:[{shrink:["",ah,ay,as]}],order:[{order:[ai,"first","last","none",ay,as]}],"grid-cols":[{"grid-cols":A()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":A()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:y()}],"gap-x":[{"gap-x":y()}],"gap-y":[{"gap-y":y()}],"justify-content":[{justify:[...E(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...E()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":E()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:y()}],px:[{px:y()}],py:[{py:y()}],ps:[{ps:y()}],pe:[{pe:y()}],pt:[{pt:y()}],pr:[{pr:y()}],pb:[{pb:y()}],pl:[{pl:y()}],m:[{m:G()}],mx:[{mx:G()}],my:[{my:G()}],ms:[{ms:G()}],me:[{me:G()}],mt:[{mt:G()}],mr:[{mr:G()}],mb:[{mb:G()}],ml:[{ml:G()}],"space-x":[{"space-x":y()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":y()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[h,"screen",...H()]}],"min-w":[{"min-w":[h,"screen","none",...H()]}],"max-w":[{"max-w":[h,"screen","none","prose",{screen:[g]},...H()]}],h:[{h:["screen","lh",...H()]}],"min-h":[{"min-h":["screen","lh","none",...H()]}],"max-h":[{"max-h":["screen","lh",...H()]}],"font-size":[{text:["base",c,az,at]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[d,ay,au]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",aj,as]}],"font-family":[{font:[aA,as,b]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[e,ay,as]}],"line-clamp":[{"line-clamp":[ah,"none",ay,au]}],leading:[{leading:[f,...y()]}],"list-image":[{"list-image":["none",ay,as]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ay,as]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:I()}],"text-color":[{text:I()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...P(),"wavy"]}],"text-decoration-thickness":[{decoration:[ah,"from-font","auto",ay,at]}],"text-decoration-color":[{decoration:I()}],"underline-offset":[{"underline-offset":[ah,"auto",ay,as]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ay,as]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ay,as]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:K()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ai,ay,as],radial:["",ay,as],conic:[ai,ay,as]},aD,aw]}],"bg-color":[{bg:I()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:I()}],"gradient-via":[{via:I()}],"gradient-to":[{to:I()}],rounded:[{rounded:N()}],"rounded-s":[{"rounded-s":N()}],"rounded-e":[{"rounded-e":N()}],"rounded-t":[{"rounded-t":N()}],"rounded-r":[{"rounded-r":N()}],"rounded-b":[{"rounded-b":N()}],"rounded-l":[{"rounded-l":N()}],"rounded-ss":[{"rounded-ss":N()}],"rounded-se":[{"rounded-se":N()}],"rounded-ee":[{"rounded-ee":N()}],"rounded-es":[{"rounded-es":N()}],"rounded-tl":[{"rounded-tl":N()}],"rounded-tr":[{"rounded-tr":N()}],"rounded-br":[{"rounded-br":N()}],"rounded-bl":[{"rounded-bl":N()}],"border-w":[{border:O()}],"border-w-x":[{"border-x":O()}],"border-w-y":[{"border-y":O()}],"border-w-s":[{"border-s":O()}],"border-w-e":[{"border-e":O()}],"border-w-t":[{"border-t":O()}],"border-w-r":[{"border-r":O()}],"border-w-b":[{"border-b":O()}],"border-w-l":[{"border-l":O()}],"divide-x":[{"divide-x":O()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":O()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...P(),"hidden","none"]}],"divide-style":[{divide:[...P(),"hidden","none"]}],"border-color":[{border:I()}],"border-color-x":[{"border-x":I()}],"border-color-y":[{"border-y":I()}],"border-color-s":[{"border-s":I()}],"border-color-e":[{"border-e":I()}],"border-color-t":[{"border-t":I()}],"border-color-r":[{"border-r":I()}],"border-color-b":[{"border-b":I()}],"border-color-l":[{"border-l":I()}],"divide-color":[{divide:I()}],"outline-style":[{outline:[...P(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ah,ay,as]}],"outline-w":[{outline:["",ah,az,at]}],"outline-color":[{outline:I()}],shadow:[{shadow:["","none",k,aE,ax]}],"shadow-color":[{shadow:I()}],"inset-shadow":[{"inset-shadow":["none",l,aE,ax]}],"inset-shadow-color":[{"inset-shadow":I()}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:I()}],"ring-offset-w":[{"ring-offset":[ah,at]}],"ring-offset-color":[{"ring-offset":I()}],"inset-ring-w":[{"inset-ring":O()}],"inset-ring-color":[{"inset-ring":I()}],"text-shadow":[{"text-shadow":["none",m,aE,ax]}],"text-shadow-color":[{"text-shadow":I()}],opacity:[{opacity:[ah,ay,as]}],"mix-blend":[{"mix-blend":[...Q(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Q()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ah]}],"mask-image-linear-from-pos":[{"mask-linear-from":R()}],"mask-image-linear-to-pos":[{"mask-linear-to":R()}],"mask-image-linear-from-color":[{"mask-linear-from":I()}],"mask-image-linear-to-color":[{"mask-linear-to":I()}],"mask-image-t-from-pos":[{"mask-t-from":R()}],"mask-image-t-to-pos":[{"mask-t-to":R()}],"mask-image-t-from-color":[{"mask-t-from":I()}],"mask-image-t-to-color":[{"mask-t-to":I()}],"mask-image-r-from-pos":[{"mask-r-from":R()}],"mask-image-r-to-pos":[{"mask-r-to":R()}],"mask-image-r-from-color":[{"mask-r-from":I()}],"mask-image-r-to-color":[{"mask-r-to":I()}],"mask-image-b-from-pos":[{"mask-b-from":R()}],"mask-image-b-to-pos":[{"mask-b-to":R()}],"mask-image-b-from-color":[{"mask-b-from":I()}],"mask-image-b-to-color":[{"mask-b-to":I()}],"mask-image-l-from-pos":[{"mask-l-from":R()}],"mask-image-l-to-pos":[{"mask-l-to":R()}],"mask-image-l-from-color":[{"mask-l-from":I()}],"mask-image-l-to-color":[{"mask-l-to":I()}],"mask-image-x-from-pos":[{"mask-x-from":R()}],"mask-image-x-to-pos":[{"mask-x-to":R()}],"mask-image-x-from-color":[{"mask-x-from":I()}],"mask-image-x-to-color":[{"mask-x-to":I()}],"mask-image-y-from-pos":[{"mask-y-from":R()}],"mask-image-y-to-pos":[{"mask-y-to":R()}],"mask-image-y-from-color":[{"mask-y-from":I()}],"mask-image-y-to-color":[{"mask-y-to":I()}],"mask-image-radial":[{"mask-radial":[ay,as]}],"mask-image-radial-from-pos":[{"mask-radial-from":R()}],"mask-image-radial-to-pos":[{"mask-radial-to":R()}],"mask-image-radial-from-color":[{"mask-radial-from":I()}],"mask-image-radial-to-color":[{"mask-radial-to":I()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":u()}],"mask-image-conic-pos":[{"mask-conic":[ah]}],"mask-image-conic-from-pos":[{"mask-conic-from":R()}],"mask-image-conic-to-pos":[{"mask-conic-to":R()}],"mask-image-conic-from-color":[{"mask-conic-from":I()}],"mask-image-conic-to-color":[{"mask-conic-to":I()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:K()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ay,as]}],filter:[{filter:["","none",ay,as]}],blur:[{blur:S()}],brightness:[{brightness:[ah,ay,as]}],contrast:[{contrast:[ah,ay,as]}],"drop-shadow":[{"drop-shadow":["","none",n,aE,ax]}],"drop-shadow-color":[{"drop-shadow":I()}],grayscale:[{grayscale:["",ah,ay,as]}],"hue-rotate":[{"hue-rotate":[ah,ay,as]}],invert:[{invert:["",ah,ay,as]}],saturate:[{saturate:[ah,ay,as]}],sepia:[{sepia:["",ah,ay,as]}],"backdrop-filter":[{"backdrop-filter":["","none",ay,as]}],"backdrop-blur":[{"backdrop-blur":S()}],"backdrop-brightness":[{"backdrop-brightness":[ah,ay,as]}],"backdrop-contrast":[{"backdrop-contrast":[ah,ay,as]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ah,ay,as]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ah,ay,as]}],"backdrop-invert":[{"backdrop-invert":["",ah,ay,as]}],"backdrop-opacity":[{"backdrop-opacity":[ah,ay,as]}],"backdrop-saturate":[{"backdrop-saturate":[ah,ay,as]}],"backdrop-sepia":[{"backdrop-sepia":["",ah,ay,as]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":y()}],"border-spacing-x":[{"border-spacing-x":y()}],"border-spacing-y":[{"border-spacing-y":y()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ay,as]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ah,"initial",ay,as]}],ease:[{ease:["linear","initial",r,ay,as]}],delay:[{delay:[ah,ay,as]}],animate:[{animate:["none",s,ay,as]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,ay,as]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:T()}],"rotate-x":[{"rotate-x":T()}],"rotate-y":[{"rotate-y":T()}],"rotate-z":[{"rotate-z":T()}],scale:[{scale:U()}],"scale-x":[{"scale-x":U()}],"scale-y":[{"scale-y":U()}],"scale-z":[{"scale-z":U()}],"scale-3d":["scale-3d"],skew:[{skew:V()}],"skew-x":[{"skew-x":V()}],"skew-y":[{"skew-y":V()}],transform:[{transform:[ay,as,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:I()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:I()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ay,as]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":y()}],"scroll-mx":[{"scroll-mx":y()}],"scroll-my":[{"scroll-my":y()}],"scroll-ms":[{"scroll-ms":y()}],"scroll-me":[{"scroll-me":y()}],"scroll-mt":[{"scroll-mt":y()}],"scroll-mr":[{"scroll-mr":y()}],"scroll-mb":[{"scroll-mb":y()}],"scroll-ml":[{"scroll-ml":y()}],"scroll-p":[{"scroll-p":y()}],"scroll-px":[{"scroll-px":y()}],"scroll-py":[{"scroll-py":y()}],"scroll-ps":[{"scroll-ps":y()}],"scroll-pe":[{"scroll-pe":y()}],"scroll-pt":[{"scroll-pt":y()}],"scroll-pr":[{"scroll-pr":y()}],"scroll-pb":[{"scroll-pb":y()}],"scroll-pl":[{"scroll-pl":y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ay,as]}],fill:[{fill:["none",...I()]}],"stroke-w":[{stroke:[ah,az,at,au]}],stroke:[{stroke:["none",...I()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function aP(...a){return aO(N(a))}let aQ=P("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function aR({className:a,variant:b,size:c,asChild:d=!1,...e}){return(0,v.jsx)(d?K:"button",{"data-slot":"button",className:aP(aQ({variant:b,size:c,className:a})),...e})}function aS({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"card",className:aP("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...b})}function aT({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"card-header",className:aP("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...b})}function aU({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"card-title",className:aP("leading-none font-semibold",a),...b})}function aV({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"card-content",className:aP("px-6",a),...b})}function aW({className:a,type:b,...c}){return(0,v.jsx)("input",{type:b,"data-slot":"input",className:aP("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...c})}var aX=c(23312);function aY(a,[b,c]){return Math.min(c,Math.max(b,a))}function aZ(a,b,{checkForDefaultPrevented:c=!0}={}){return function(d){if(a?.(d),!1===c||!d.defaultPrevented)return b?.(d)}}function a$(a,b=[]){let c=[],d=()=>{let b=c.map(a=>w.createContext(a));return function(c){let d=c?.[a]||b;return w.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return d.scopeName=a,[function(b,d){let e=w.createContext(d),f=c.length;c=[...c,d];let g=b=>{let{scope:c,children:d,...g}=b,h=c?.[a]?.[f]||e,i=w.useMemo(()=>g,Object.values(g));return(0,v.jsx)(h.Provider,{value:i,children:d})};return g.displayName=b+"Provider",[g,function(c,g){let h=g?.[a]?.[f]||e,i=w.useContext(h);if(i)return i;if(void 0!==d)return d;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return w.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(d,...b)]}function a_(a){let b=a+"CollectionProvider",[c,d]=a$(b),[e,f]=c(b,{collectionRef:{current:null},itemMap:new Map}),g=a=>{let{scope:b,children:c}=a,d=w.useRef(null),f=w.useRef(new Map).current;return(0,v.jsx)(e,{scope:b,itemMap:f,collectionRef:d,children:c})};g.displayName=b;let h=a+"CollectionSlot",i=J(h),j=w.forwardRef((a,b)=>{let{scope:c,children:d}=a,e=I(b,f(h,c).collectionRef);return(0,v.jsx)(i,{ref:e,children:d})});j.displayName=h;let k=a+"CollectionItemSlot",l="data-radix-collection-item",m=J(k),n=w.forwardRef((a,b)=>{let{scope:c,children:d,...e}=a,g=w.useRef(null),h=I(b,g),i=f(k,c);return w.useEffect(()=>(i.itemMap.set(g,{ref:g,...e}),()=>void i.itemMap.delete(g))),(0,v.jsx)(m,{...{[l]:""},ref:h,children:d})});return n.displayName=k,[{Provider:g,Slot:j,ItemSlot:n},function(b){let c=f(a+"CollectionConsumer",b);return w.useCallback(()=>{let a=c.collectionRef.current;if(!a)return[];let b=Array.from(a.querySelectorAll(`[${l}]`));return Array.from(c.itemMap.values()).sort((a,c)=>b.indexOf(a.ref.current)-b.indexOf(c.ref.current))},[c.collectionRef,c.itemMap])},d]}"undefined"!=typeof window&&window.document&&window.document.createElement;var a0=new WeakMap;function a1(a,b){if("at"in Array.prototype)return Array.prototype.at.call(a,b);let c=function(a,b){let c=a.length,d=a2(b),e=d>=0?d:c+d;return e<0||e>=c?-1:e}(a,b);return -1===c?void 0:a[c]}function a2(a){return a!=a||0===a?0:Math.trunc(a)}(class a extends Map{#a;constructor(a){super(a),this.#a=[...super.keys()],a0.set(this,!0)}set(a,b){return a0.get(this)&&(this.has(a)?this.#a[this.#a.indexOf(a)]=a:this.#a.push(a)),super.set(a,b),this}insert(a,b,c){let d,e=this.has(b),f=this.#a.length,g=a2(a),h=g>=0?g:f+g,i=h<0||h>=f?-1:h;if(i===this.size||e&&i===this.size-1||-1===i)return this.set(b,c),this;let j=this.size+ +!e;g<0&&h++;let k=[...this.#a],l=!1;for(let a=h;a<j;a++)if(h===a){let f=k[a];k[a]===b&&(f=k[a+1]),e&&this.delete(b),d=this.get(f),this.set(b,c)}else{l||k[a-1]!==b||(l=!0);let c=k[l?a:a-1],e=d;d=this.get(c),this.delete(c),this.set(c,e)}return this}with(b,c,d){let e=new a(this);return e.insert(b,c,d),e}before(a){let b=this.#a.indexOf(a)-1;if(!(b<0))return this.entryAt(b)}setBefore(a,b,c){let d=this.#a.indexOf(a);return -1===d?this:this.insert(d,b,c)}after(a){let b=this.#a.indexOf(a);if(-1!==(b=-1===b||b===this.size-1?-1:b+1))return this.entryAt(b)}setAfter(a,b,c){let d=this.#a.indexOf(a);return -1===d?this:this.insert(d+1,b,c)}first(){return this.entryAt(0)}last(){return this.entryAt(-1)}clear(){return this.#a=[],super.clear()}delete(a){let b=super.delete(a);return b&&this.#a.splice(this.#a.indexOf(a),1),b}deleteAt(a){let b=this.keyAt(a);return void 0!==b&&this.delete(b)}at(a){let b=a1(this.#a,a);if(void 0!==b)return this.get(b)}entryAt(a){let b=a1(this.#a,a);if(void 0!==b)return[b,this.get(b)]}indexOf(a){return this.#a.indexOf(a)}keyAt(a){return a1(this.#a,a)}from(a,b){let c=this.indexOf(a);if(-1===c)return;let d=c+b;return d<0&&(d=0),d>=this.size&&(d=this.size-1),this.at(d)}keyFrom(a,b){let c=this.indexOf(a);if(-1===c)return;let d=c+b;return d<0&&(d=0),d>=this.size&&(d=this.size-1),this.keyAt(d)}find(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return d;c++}}findIndex(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return c;c++}return -1}filter(b,c){let d=[],e=0;for(let a of this)Reflect.apply(b,c,[a,e,this])&&d.push(a),e++;return new a(d)}map(b,c){let d=[],e=0;for(let a of this)d.push([a[0],Reflect.apply(b,c,[a,e,this])]),e++;return new a(d)}reduce(...a){let[b,c]=a,d=0,e=c??this.at(0);for(let c of this)e=0===d&&1===a.length?c:Reflect.apply(b,this,[e,c,d,this]),d++;return e}reduceRight(...a){let[b,c]=a,d=c??this.at(-1);for(let c=this.size-1;c>=0;c--){let e=this.at(c);d=c===this.size-1&&1===a.length?e:Reflect.apply(b,this,[d,e,c,this])}return d}toSorted(b){return new a([...this.entries()].sort(b))}toReversed(){let b=new a;for(let a=this.size-1;a>=0;a--){let c=this.keyAt(a),d=this.get(c);b.set(c,d)}return b}toSpliced(...b){let c=[...this.entries()];return c.splice(...b),new a(c)}slice(b,c){let d=new a,e=this.size-1;if(void 0===b)return d;b<0&&(b+=this.size),void 0!==c&&c>0&&(e=c-1);for(let a=b;a<=e;a++){let b=this.keyAt(a),c=this.get(b);d.set(b,c)}return d}every(a,b){let c=0;for(let d of this){if(!Reflect.apply(a,b,[d,c,this]))return!1;c++}return!0}some(a,b){let c=0;for(let d of this){if(Reflect.apply(a,b,[d,c,this]))return!0;c++}return!1}});var a3=w.createContext(void 0);function a4(a){let b=w.useContext(a3);return a||b||"ltr"}var a5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=J(`Primitive.${b}`),d=w.forwardRef((a,d)=>{let{asChild:e,...f}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,v.jsx)(e?c:b,{...f,ref:d})});return d.displayName=`Primitive.${b}`,{...a,[b]:d}},{});function a6(a){let b=w.useRef(a);return w.useEffect(()=>{b.current=a}),w.useMemo(()=>(...a)=>b.current?.(...a),[])}var a7="dismissableLayer.update",a8=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),a9=w.forwardRef((a,b)=>{let{disableOutsidePointerEvents:c=!1,onEscapeKeyDown:d,onPointerDownOutside:e,onFocusOutside:g,onInteractOutside:h,onDismiss:i,...j}=a,k=w.useContext(a8),[l,m]=w.useState(null),n=l?.ownerDocument??globalThis?.document,[,o]=w.useState({}),p=I(b,a=>m(a)),q=Array.from(k.layers),[r]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),s=q.indexOf(r),t=l?q.indexOf(l):-1,u=k.layersWithOutsidePointerEventsDisabled.size>0,x=t>=s,y=function(a,b=globalThis?.document){let c=a6(a),d=w.useRef(!1),e=w.useRef(()=>{});return w.useEffect(()=>{let a=a=>{if(a.target&&!d.current){let d=function(){bb("dismissableLayer.pointerDownOutside",c,f,{discrete:!0})},f={originalEvent:a};"touch"===a.pointerType?(b.removeEventListener("click",e.current),e.current=d,b.addEventListener("click",e.current,{once:!0})):d()}else b.removeEventListener("click",e.current);d.current=!1},f=window.setTimeout(()=>{b.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(f),b.removeEventListener("pointerdown",a),b.removeEventListener("click",e.current)}},[b,c]),{onPointerDownCapture:()=>d.current=!0}}(a=>{let b=a.target,c=[...k.branches].some(a=>a.contains(b));x&&!c&&(e?.(a),h?.(a),a.defaultPrevented||i?.())},n),z=function(a,b=globalThis?.document){let c=a6(a),d=w.useRef(!1);return w.useEffect(()=>{let a=a=>{a.target&&!d.current&&bb("dismissableLayer.focusOutside",c,{originalEvent:a},{discrete:!1})};return b.addEventListener("focusin",a),()=>b.removeEventListener("focusin",a)},[b,c]),{onFocusCapture:()=>d.current=!0,onBlurCapture:()=>d.current=!1}}(a=>{let b=a.target;![...k.branches].some(a=>a.contains(b))&&(g?.(a),h?.(a),a.defaultPrevented||i?.())},n);return!function(a,b=globalThis?.document){let c=a6(a);w.useEffect(()=>{let a=a=>{"Escape"===a.key&&c(a)};return b.addEventListener("keydown",a,{capture:!0}),()=>b.removeEventListener("keydown",a,{capture:!0})},[c,b])}(a=>{t===k.layers.size-1&&(d?.(a),!a.defaultPrevented&&i&&(a.preventDefault(),i()))},n),w.useEffect(()=>{if(l)return c&&(0===k.layersWithOutsidePointerEventsDisabled.size&&(f=n.body.style.pointerEvents,n.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(l)),k.layers.add(l),ba(),()=>{c&&1===k.layersWithOutsidePointerEventsDisabled.size&&(n.body.style.pointerEvents=f)}},[l,n,c,k]),w.useEffect(()=>()=>{l&&(k.layers.delete(l),k.layersWithOutsidePointerEventsDisabled.delete(l),ba())},[l,k]),w.useEffect(()=>{let a=()=>o({});return document.addEventListener(a7,a),()=>document.removeEventListener(a7,a)},[]),(0,v.jsx)(a5.div,{...j,ref:p,style:{pointerEvents:u?x?"auto":"none":void 0,...a.style},onFocusCapture:aZ(a.onFocusCapture,z.onFocusCapture),onBlurCapture:aZ(a.onBlurCapture,z.onBlurCapture),onPointerDownCapture:aZ(a.onPointerDownCapture,y.onPointerDownCapture)})});function ba(){let a=new CustomEvent(a7);document.dispatchEvent(a)}function bb(a,b,c,{discrete:d}){let e=c.originalEvent.target,f=new CustomEvent(a,{bubbles:!1,cancelable:!0,detail:c});if(b&&e.addEventListener(a,b,{once:!0}),d)e&&aX.flushSync(()=>e.dispatchEvent(f));else e.dispatchEvent(f)}a9.displayName="DismissableLayer",w.forwardRef((a,b)=>{let c=w.useContext(a8),d=w.useRef(null),e=I(b,d);return w.useEffect(()=>{let a=d.current;if(a)return c.branches.add(a),()=>{c.branches.delete(a)}},[c.branches]),(0,v.jsx)(a5.div,{...a,ref:e})}).displayName="DismissableLayerBranch";var bc=0;function bd(){w.useEffect(()=>{let a=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",a[0]??be()),document.body.insertAdjacentElement("beforeend",a[1]??be()),bc++,()=>{1===bc&&document.querySelectorAll("[data-radix-focus-guard]").forEach(a=>a.remove()),bc--}},[])}function be(){let a=document.createElement("span");return a.setAttribute("data-radix-focus-guard",""),a.tabIndex=0,a.style.outline="none",a.style.opacity="0",a.style.position="fixed",a.style.pointerEvents="none",a}var bf="focusScope.autoFocusOnMount",bg="focusScope.autoFocusOnUnmount",bh={bubbles:!1,cancelable:!0},bi=w.forwardRef((a,b)=>{let{loop:c=!1,trapped:d=!1,onMountAutoFocus:e,onUnmountAutoFocus:f,...g}=a,[h,i]=w.useState(null),j=a6(e),k=a6(f),l=w.useRef(null),m=I(b,a=>i(a)),n=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(d){let a=function(a){if(n.paused||!h)return;let b=a.target;h.contains(b)?l.current=b:bl(l.current,{select:!0})},b=function(a){if(n.paused||!h)return;let b=a.relatedTarget;null!==b&&(h.contains(b)||bl(l.current,{select:!0}))};document.addEventListener("focusin",a),document.addEventListener("focusout",b);let c=new MutationObserver(function(a){if(document.activeElement===document.body)for(let b of a)b.removedNodes.length>0&&bl(h)});return h&&c.observe(h,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",a),document.removeEventListener("focusout",b),c.disconnect()}}},[d,h,n.paused]),w.useEffect(()=>{if(h){bm.add(n);let a=document.activeElement;if(!h.contains(a)){let b=new CustomEvent(bf,bh);h.addEventListener(bf,j),h.dispatchEvent(b),b.defaultPrevented||(function(a,{select:b=!1}={}){let c=document.activeElement;for(let d of a)if(bl(d,{select:b}),document.activeElement!==c)return}(bj(h).filter(a=>"A"!==a.tagName),{select:!0}),document.activeElement===a&&bl(h))}return()=>{h.removeEventListener(bf,j),setTimeout(()=>{let b=new CustomEvent(bg,bh);h.addEventListener(bg,k),h.dispatchEvent(b),b.defaultPrevented||bl(a??document.body,{select:!0}),h.removeEventListener(bg,k),bm.remove(n)},0)}}},[h,j,k,n]);let o=w.useCallback(a=>{if(!c&&!d||n.paused)return;let b="Tab"===a.key&&!a.altKey&&!a.ctrlKey&&!a.metaKey,e=document.activeElement;if(b&&e){let b=a.currentTarget,[d,f]=function(a){let b=bj(a);return[bk(b,a),bk(b.reverse(),a)]}(b);d&&f?a.shiftKey||e!==f?a.shiftKey&&e===d&&(a.preventDefault(),c&&bl(f,{select:!0})):(a.preventDefault(),c&&bl(d,{select:!0})):e===b&&a.preventDefault()}},[c,d,n.paused]);return(0,v.jsx)(a5.div,{tabIndex:-1,...g,ref:m,onKeyDown:o})});function bj(a){let b=[],c=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{let b="INPUT"===a.tagName&&"hidden"===a.type;return a.disabled||a.hidden||b?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;c.nextNode();)b.push(c.currentNode);return b}function bk(a,b){for(let c of a)if(!function(a,{upTo:b}){if("hidden"===getComputedStyle(a).visibility)return!0;for(;a&&(void 0===b||a!==b);){if("none"===getComputedStyle(a).display)return!0;a=a.parentElement}return!1}(c,{upTo:b}))return c}function bl(a,{select:b=!1}={}){if(a&&a.focus){var c;let d=document.activeElement;a.focus({preventScroll:!0}),a!==d&&(c=a)instanceof HTMLInputElement&&"select"in c&&b&&a.select()}}bi.displayName="FocusScope";var bm=function(){let a=[];return{add(b){let c=a[0];b!==c&&c?.pause(),(a=bn(a,b)).unshift(b)},remove(b){a=bn(a,b),a[0]?.resume()}}}();function bn(a,b){let c=[...a],d=c.indexOf(b);return -1!==d&&c.splice(d,1),c}var bo=globalThis?.document?w.useLayoutEffect:()=>{},bp=x[" useId ".trim().toString()]||(()=>void 0),bq=0;function br(a){let[b,c]=w.useState(bp());return bo(()=>{a||c(a=>a??String(bq++))},[a]),a||(b?`radix-${b}`:"")}let bs=["top","right","bottom","left"],bt=Math.min,bu=Math.max,bv=Math.round,bw=Math.floor,bx=a=>({x:a,y:a}),by={left:"right",right:"left",bottom:"top",top:"bottom"},bz={start:"end",end:"start"};function bA(a,b){return"function"==typeof a?a(b):a}function bB(a){return a.split("-")[0]}function bC(a){return a.split("-")[1]}function bD(a){return"x"===a?"y":"x"}function bE(a){return"y"===a?"height":"width"}let bF=new Set(["top","bottom"]);function bG(a){return bF.has(bB(a))?"y":"x"}function bH(a){return a.replace(/start|end/g,a=>bz[a])}let bI=["left","right"],bJ=["right","left"],bK=["top","bottom"],bL=["bottom","top"];function bM(a){return a.replace(/left|right|bottom|top/g,a=>by[a])}function bN(a){return"number"!=typeof a?{top:0,right:0,bottom:0,left:0,...a}:{top:a,right:a,bottom:a,left:a}}function bO(a){let{x:b,y:c,width:d,height:e}=a;return{width:d,height:e,top:c,left:b,right:b+d,bottom:c+e,x:b,y:c}}function bP(a,b,c){let d,{reference:e,floating:f}=a,g=bG(b),h=bD(bG(b)),i=bE(h),j=bB(b),k="y"===g,l=e.x+e.width/2-f.width/2,m=e.y+e.height/2-f.height/2,n=e[i]/2-f[i]/2;switch(j){case"top":d={x:l,y:e.y-f.height};break;case"bottom":d={x:l,y:e.y+e.height};break;case"right":d={x:e.x+e.width,y:m};break;case"left":d={x:e.x-f.width,y:m};break;default:d={x:e.x,y:e.y}}switch(bC(b)){case"start":d[h]-=n*(c&&k?-1:1);break;case"end":d[h]+=n*(c&&k?-1:1)}return d}let bQ=async(a,b,c)=>{let{placement:d="bottom",strategy:e="absolute",middleware:f=[],platform:g}=c,h=f.filter(Boolean),i=await (null==g.isRTL?void 0:g.isRTL(b)),j=await g.getElementRects({reference:a,floating:b,strategy:e}),{x:k,y:l}=bP(j,d,i),m=d,n={},o=0;for(let c=0;c<h.length;c++){let{name:f,fn:p}=h[c],{x:q,y:r,data:s,reset:t}=await p({x:k,y:l,initialPlacement:d,placement:m,strategy:e,middlewareData:n,rects:j,platform:g,elements:{reference:a,floating:b}});k=null!=q?q:k,l=null!=r?r:l,n={...n,[f]:{...n[f],...s}},t&&o<=50&&(o++,"object"==typeof t&&(t.placement&&(m=t.placement),t.rects&&(j=!0===t.rects?await g.getElementRects({reference:a,floating:b,strategy:e}):t.rects),{x:k,y:l}=bP(j,m,i)),c=-1)}return{x:k,y:l,placement:m,strategy:e,middlewareData:n}};async function bR(a,b){var c;void 0===b&&(b={});let{x:d,y:e,platform:f,rects:g,elements:h,strategy:i}=a,{boundary:j="clippingAncestors",rootBoundary:k="viewport",elementContext:l="floating",altBoundary:m=!1,padding:n=0}=bA(b,a),o=bN(n),p=h[m?"floating"===l?"reference":"floating":l],q=bO(await f.getClippingRect({element:null==(c=await (null==f.isElement?void 0:f.isElement(p)))||c?p:p.contextElement||await (null==f.getDocumentElement?void 0:f.getDocumentElement(h.floating)),boundary:j,rootBoundary:k,strategy:i})),r="floating"===l?{x:d,y:e,width:g.floating.width,height:g.floating.height}:g.reference,s=await (null==f.getOffsetParent?void 0:f.getOffsetParent(h.floating)),t=await (null==f.isElement?void 0:f.isElement(s))&&await (null==f.getScale?void 0:f.getScale(s))||{x:1,y:1},u=bO(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:h,rect:r,offsetParent:s,strategy:i}):r);return{top:(q.top-u.top+o.top)/t.y,bottom:(u.bottom-q.bottom+o.bottom)/t.y,left:(q.left-u.left+o.left)/t.x,right:(u.right-q.right+o.right)/t.x}}function bS(a,b){return{top:a.top-b.height,right:a.right-b.width,bottom:a.bottom-b.height,left:a.left-b.width}}function bT(a){return bs.some(b=>a[b]>=0)}let bU=new Set(["left","top"]);async function bV(a,b){let{placement:c,platform:d,elements:e}=a,f=await (null==d.isRTL?void 0:d.isRTL(e.floating)),g=bB(c),h=bC(c),i="y"===bG(c),j=bU.has(g)?-1:1,k=f&&i?-1:1,l=bA(b,a),{mainAxis:m,crossAxis:n,alignmentAxis:o}="number"==typeof l?{mainAxis:l,crossAxis:0,alignmentAxis:null}:{mainAxis:l.mainAxis||0,crossAxis:l.crossAxis||0,alignmentAxis:l.alignmentAxis};return h&&"number"==typeof o&&(n="end"===h?-1*o:o),i?{x:n*k,y:m*j}:{x:m*j,y:n*k}}function bW(){return"undefined"!=typeof window}function bX(a){return b$(a)?(a.nodeName||"").toLowerCase():"#document"}function bY(a){var b;return(null==a||null==(b=a.ownerDocument)?void 0:b.defaultView)||window}function bZ(a){var b;return null==(b=(b$(a)?a.ownerDocument:a.document)||window.document)?void 0:b.documentElement}function b$(a){return!!bW()&&(a instanceof Node||a instanceof bY(a).Node)}function b_(a){return!!bW()&&(a instanceof Element||a instanceof bY(a).Element)}function b0(a){return!!bW()&&(a instanceof HTMLElement||a instanceof bY(a).HTMLElement)}function b1(a){return!!bW()&&"undefined"!=typeof ShadowRoot&&(a instanceof ShadowRoot||a instanceof bY(a).ShadowRoot)}let b2=new Set(["inline","contents"]);function b3(a){let{overflow:b,overflowX:c,overflowY:d,display:e}=ce(a);return/auto|scroll|overlay|hidden|clip/.test(b+d+c)&&!b2.has(e)}let b4=new Set(["table","td","th"]),b5=[":popover-open",":modal"];function b6(a){return b5.some(b=>{try{return a.matches(b)}catch(a){return!1}})}let b7=["transform","translate","scale","rotate","perspective"],b8=["transform","translate","scale","rotate","perspective","filter"],b9=["paint","layout","strict","content"];function ca(a){let b=cb(),c=b_(a)?ce(a):a;return b7.some(a=>!!c[a]&&"none"!==c[a])||!!c.containerType&&"normal"!==c.containerType||!b&&!!c.backdropFilter&&"none"!==c.backdropFilter||!b&&!!c.filter&&"none"!==c.filter||b8.some(a=>(c.willChange||"").includes(a))||b9.some(a=>(c.contain||"").includes(a))}function cb(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let cc=new Set(["html","body","#document"]);function cd(a){return cc.has(bX(a))}function ce(a){return bY(a).getComputedStyle(a)}function cf(a){return b_(a)?{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}:{scrollLeft:a.scrollX,scrollTop:a.scrollY}}function cg(a){if("html"===bX(a))return a;let b=a.assignedSlot||a.parentNode||b1(a)&&a.host||bZ(a);return b1(b)?b.host:b}function ch(a,b,c){var d;void 0===b&&(b=[]),void 0===c&&(c=!0);let e=function a(b){let c=cg(b);return cd(c)?b.ownerDocument?b.ownerDocument.body:b.body:b0(c)&&b3(c)?c:a(c)}(a),f=e===(null==(d=a.ownerDocument)?void 0:d.body),g=bY(e);if(f){let a=ci(g);return b.concat(g,g.visualViewport||[],b3(e)?e:[],a&&c?ch(a):[])}return b.concat(e,ch(e,[],c))}function ci(a){return a.parent&&Object.getPrototypeOf(a.parent)?a.frameElement:null}function cj(a){let b=ce(a),c=parseFloat(b.width)||0,d=parseFloat(b.height)||0,e=b0(a),f=e?a.offsetWidth:c,g=e?a.offsetHeight:d,h=bv(c)!==f||bv(d)!==g;return h&&(c=f,d=g),{width:c,height:d,$:h}}function ck(a){return b_(a)?a:a.contextElement}function cl(a){let b=ck(a);if(!b0(b))return bx(1);let c=b.getBoundingClientRect(),{width:d,height:e,$:f}=cj(b),g=(f?bv(c.width):c.width)/d,h=(f?bv(c.height):c.height)/e;return g&&Number.isFinite(g)||(g=1),h&&Number.isFinite(h)||(h=1),{x:g,y:h}}let cm=bx(0);function cn(a){let b=bY(a);return cb()&&b.visualViewport?{x:b.visualViewport.offsetLeft,y:b.visualViewport.offsetTop}:cm}function co(a,b,c,d){var e;void 0===b&&(b=!1),void 0===c&&(c=!1);let f=a.getBoundingClientRect(),g=ck(a),h=bx(1);b&&(d?b_(d)&&(h=cl(d)):h=cl(a));let i=(void 0===(e=c)&&(e=!1),d&&(!e||d===bY(g))&&e)?cn(g):bx(0),j=(f.left+i.x)/h.x,k=(f.top+i.y)/h.y,l=f.width/h.x,m=f.height/h.y;if(g){let a=bY(g),b=d&&b_(d)?bY(d):d,c=a,e=ci(c);for(;e&&d&&b!==c;){let a=cl(e),b=e.getBoundingClientRect(),d=ce(e),f=b.left+(e.clientLeft+parseFloat(d.paddingLeft))*a.x,g=b.top+(e.clientTop+parseFloat(d.paddingTop))*a.y;j*=a.x,k*=a.y,l*=a.x,m*=a.y,j+=f,k+=g,e=ci(c=bY(e))}}return bO({width:l,height:m,x:j,y:k})}function cp(a,b){let c=cf(a).scrollLeft;return b?b.left+c:co(bZ(a)).left+c}function cq(a,b){let c=a.getBoundingClientRect();return{x:c.left+b.scrollLeft-cp(a,c),y:c.top+b.scrollTop}}let cr=new Set(["absolute","fixed"]);function cs(a,b,c){let d;if("viewport"===b)d=function(a,b){let c=bY(a),d=bZ(a),e=c.visualViewport,f=d.clientWidth,g=d.clientHeight,h=0,i=0;if(e){f=e.width,g=e.height;let a=cb();(!a||a&&"fixed"===b)&&(h=e.offsetLeft,i=e.offsetTop)}let j=cp(d);if(j<=0){let a=d.ownerDocument,b=a.body,c=getComputedStyle(b),e="CSS1Compat"===a.compatMode&&parseFloat(c.marginLeft)+parseFloat(c.marginRight)||0,g=Math.abs(d.clientWidth-b.clientWidth-e);g<=25&&(f-=g)}else j<=25&&(f+=j);return{width:f,height:g,x:h,y:i}}(a,c);else if("document"===b)d=function(a){let b=bZ(a),c=cf(a),d=a.ownerDocument.body,e=bu(b.scrollWidth,b.clientWidth,d.scrollWidth,d.clientWidth),f=bu(b.scrollHeight,b.clientHeight,d.scrollHeight,d.clientHeight),g=-c.scrollLeft+cp(a),h=-c.scrollTop;return"rtl"===ce(d).direction&&(g+=bu(b.clientWidth,d.clientWidth)-e),{width:e,height:f,x:g,y:h}}(bZ(a));else if(b_(b))d=function(a,b){let c=co(a,!0,"fixed"===b),d=c.top+a.clientTop,e=c.left+a.clientLeft,f=b0(a)?cl(a):bx(1),g=a.clientWidth*f.x,h=a.clientHeight*f.y;return{width:g,height:h,x:e*f.x,y:d*f.y}}(b,c);else{let c=cn(a);d={x:b.x-c.x,y:b.y-c.y,width:b.width,height:b.height}}return bO(d)}function ct(a){return"static"===ce(a).position}function cu(a,b){if(!b0(a)||"fixed"===ce(a).position)return null;if(b)return b(a);let c=a.offsetParent;return bZ(a)===c&&(c=c.ownerDocument.body),c}function cv(a,b){var c;let d=bY(a);if(b6(a))return d;if(!b0(a)){let b=cg(a);for(;b&&!cd(b);){if(b_(b)&&!ct(b))return b;b=cg(b)}return d}let e=cu(a,b);for(;e&&(c=e,b4.has(bX(c)))&&ct(e);)e=cu(e,b);return e&&cd(e)&&ct(e)&&!ca(e)?d:e||function(a){let b=cg(a);for(;b0(b)&&!cd(b);){if(ca(b))return b;if(b6(b))break;b=cg(b)}return null}(a)||d}let cw=async function(a){let b=this.getOffsetParent||cv,c=this.getDimensions,d=await c(a.floating);return{reference:function(a,b,c){let d=b0(b),e=bZ(b),f="fixed"===c,g=co(a,!0,f,b),h={scrollLeft:0,scrollTop:0},i=bx(0);if(d||!d&&!f)if(("body"!==bX(b)||b3(e))&&(h=cf(b)),d){let a=co(b,!0,f,b);i.x=a.x+b.clientLeft,i.y=a.y+b.clientTop}else e&&(i.x=cp(e));f&&!d&&e&&(i.x=cp(e));let j=!e||d||f?bx(0):cq(e,h);return{x:g.left+h.scrollLeft-i.x-j.x,y:g.top+h.scrollTop-i.y-j.y,width:g.width,height:g.height}}(a.reference,await b(a.floating),a.strategy),floating:{x:0,y:0,width:d.width,height:d.height}}},cx={convertOffsetParentRelativeRectToViewportRelativeRect:function(a){let{elements:b,rect:c,offsetParent:d,strategy:e}=a,f="fixed"===e,g=bZ(d),h=!!b&&b6(b.floating);if(d===g||h&&f)return c;let i={scrollLeft:0,scrollTop:0},j=bx(1),k=bx(0),l=b0(d);if((l||!l&&!f)&&(("body"!==bX(d)||b3(g))&&(i=cf(d)),b0(d))){let a=co(d);j=cl(d),k.x=a.x+d.clientLeft,k.y=a.y+d.clientTop}let m=!g||l||f?bx(0):cq(g,i);return{width:c.width*j.x,height:c.height*j.y,x:c.x*j.x-i.scrollLeft*j.x+k.x+m.x,y:c.y*j.y-i.scrollTop*j.y+k.y+m.y}},getDocumentElement:bZ,getClippingRect:function(a){let{element:b,boundary:c,rootBoundary:d,strategy:e}=a,f=[..."clippingAncestors"===c?b6(b)?[]:function(a,b){let c=b.get(a);if(c)return c;let d=ch(a,[],!1).filter(a=>b_(a)&&"body"!==bX(a)),e=null,f="fixed"===ce(a).position,g=f?cg(a):a;for(;b_(g)&&!cd(g);){let b=ce(g),c=ca(g);c||"fixed"!==b.position||(e=null),(f?!c&&!e:!c&&"static"===b.position&&!!e&&cr.has(e.position)||b3(g)&&!c&&function a(b,c){let d=cg(b);return!(d===c||!b_(d)||cd(d))&&("fixed"===ce(d).position||a(d,c))}(a,g))?d=d.filter(a=>a!==g):e=b,g=cg(g)}return b.set(a,d),d}(b,this._c):[].concat(c),d],g=f[0],h=f.reduce((a,c)=>{let d=cs(b,c,e);return a.top=bu(d.top,a.top),a.right=bt(d.right,a.right),a.bottom=bt(d.bottom,a.bottom),a.left=bu(d.left,a.left),a},cs(b,g,e));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}},getOffsetParent:cv,getElementRects:cw,getClientRects:function(a){return Array.from(a.getClientRects())},getDimensions:function(a){let{width:b,height:c}=cj(a);return{width:b,height:c}},getScale:cl,isElement:b_,isRTL:function(a){return"rtl"===ce(a).direction}};function cy(a,b){return a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height}let cz=a=>({name:"arrow",options:a,async fn(b){let{x:c,y:d,placement:e,rects:f,platform:g,elements:h,middlewareData:i}=b,{element:j,padding:k=0}=bA(a,b)||{};if(null==j)return{};let l=bN(k),m={x:c,y:d},n=bD(bG(e)),o=bE(n),p=await g.getDimensions(j),q="y"===n,r=q?"clientHeight":"clientWidth",s=f.reference[o]+f.reference[n]-m[n]-f.floating[o],t=m[n]-f.reference[n],u=await (null==g.getOffsetParent?void 0:g.getOffsetParent(j)),v=u?u[r]:0;v&&await (null==g.isElement?void 0:g.isElement(u))||(v=h.floating[r]||f.floating[o]);let w=v/2-p[o]/2-1,x=bt(l[q?"top":"left"],w),y=bt(l[q?"bottom":"right"],w),z=v-p[o]-y,A=v/2-p[o]/2+(s/2-t/2),B=bu(x,bt(A,z)),C=!i.arrow&&null!=bC(e)&&A!==B&&f.reference[o]/2-(A<x?x:y)-p[o]/2<0,D=C?A<x?A-x:A-z:0;return{[n]:m[n]+D,data:{[n]:B,centerOffset:A-B-D,...C&&{alignmentOffset:D}},reset:C}}});var cA="undefined"!=typeof document?w.useLayoutEffect:function(){};function cB(a,b){let c,d,e;if(a===b)return!0;if(typeof a!=typeof b)return!1;if("function"==typeof a&&a.toString()===b.toString())return!0;if(a&&b&&"object"==typeof a){if(Array.isArray(a)){if((c=a.length)!==b.length)return!1;for(d=c;0!=d--;)if(!cB(a[d],b[d]))return!1;return!0}if((c=(e=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(d=c;0!=d--;)if(!({}).hasOwnProperty.call(b,e[d]))return!1;for(d=c;0!=d--;){let c=e[d];if(("_owner"!==c||!a.$$typeof)&&!cB(a[c],b[c]))return!1}return!0}return a!=a&&b!=b}function cC(a){return"undefined"==typeof window?1:(a.ownerDocument.defaultView||window).devicePixelRatio||1}function cD(a,b){let c=cC(a);return Math.round(b*c)/c}function cE(a){let b=w.useRef(a);return cA(()=>{b.current=a}),b}var cF=w.forwardRef((a,b)=>{let{children:c,width:d=10,height:e=5,...f}=a;return(0,v.jsx)(a5.svg,{...f,ref:b,width:d,height:e,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:a.asChild?c:(0,v.jsx)("polygon",{points:"0,0 30,0 15,10"})})});function cG(a){let[b,c]=w.useState(void 0);return bo(()=>{if(a){c({width:a.offsetWidth,height:a.offsetHeight});let b=new ResizeObserver(b=>{let d,e;if(!Array.isArray(b)||!b.length)return;let f=b[0];if("borderBoxSize"in f){let a=f.borderBoxSize,b=Array.isArray(a)?a[0]:a;d=b.inlineSize,e=b.blockSize}else d=a.offsetWidth,e=a.offsetHeight;c({width:d,height:e})});return b.observe(a,{box:"border-box"}),()=>b.unobserve(a)}c(void 0)},[a]),b}cF.displayName="Arrow";var cH="Popper",[cI,cJ]=a$(cH),[cK,cL]=cI(cH),cM=a=>{let{__scopePopper:b,children:c}=a,[d,e]=w.useState(null);return(0,v.jsx)(cK,{scope:b,anchor:d,onAnchorChange:e,children:c})};cM.displayName=cH;var cN="PopperAnchor",cO=w.forwardRef((a,b)=>{let{__scopePopper:c,virtualRef:d,...e}=a,f=cL(cN,c),g=w.useRef(null),h=I(b,g),i=w.useRef(null);return w.useEffect(()=>{let a=i.current;i.current=d?.current||g.current,a!==i.current&&f.onAnchorChange(i.current)}),d?null:(0,v.jsx)(a5.div,{...e,ref:h})});cO.displayName=cN;var cP="PopperContent",[cQ,cR]=cI(cP),cS=w.forwardRef((a,b)=>{let{__scopePopper:c,side:d="bottom",sideOffset:e=0,align:f="center",alignOffset:g=0,arrowPadding:h=0,avoidCollisions:i=!0,collisionBoundary:j=[],collisionPadding:k=0,sticky:l="partial",hideWhenDetached:m=!1,updatePositionStrategy:n="optimized",onPlaced:o,...p}=a,q=cL(cP,c),[r,s]=w.useState(null),t=I(b,a=>s(a)),[u,x]=w.useState(null),y=cG(u),z=y?.width??0,A=y?.height??0,B="number"==typeof k?k:{top:0,right:0,bottom:0,left:0,...k},C=Array.isArray(j)?j:[j],D=C.length>0,E={padding:B,boundary:C.filter(cW),altBoundary:D},{refs:F,floatingStyles:G,placement:H,isPositioned:J,middlewareData:K}=function(a){void 0===a&&(a={});let{placement:b="bottom",strategy:c="absolute",middleware:d=[],platform:e,elements:{reference:f,floating:g}={},transform:h=!0,whileElementsMounted:i,open:j}=a,[k,l]=w.useState({x:0,y:0,strategy:c,placement:b,middlewareData:{},isPositioned:!1}),[m,n]=w.useState(d);cB(m,d)||n(d);let[o,p]=w.useState(null),[q,r]=w.useState(null),s=w.useCallback(a=>{a!==x.current&&(x.current=a,p(a))},[]),t=w.useCallback(a=>{a!==y.current&&(y.current=a,r(a))},[]),u=f||o,v=g||q,x=w.useRef(null),y=w.useRef(null),z=w.useRef(k),A=null!=i,B=cE(i),C=cE(e),D=cE(j),E=w.useCallback(()=>{if(!x.current||!y.current)return;let a={placement:b,strategy:c,middleware:m};C.current&&(a.platform=C.current),((a,b,c)=>{let d=new Map,e={platform:cx,...c},f={...e.platform,_c:d};return bQ(a,b,{...e,platform:f})})(x.current,y.current,a).then(a=>{let b={...a,isPositioned:!1!==D.current};F.current&&!cB(z.current,b)&&(z.current=b,aX.flushSync(()=>{l(b)}))})},[m,b,c,C,D]);cA(()=>{!1===j&&z.current.isPositioned&&(z.current.isPositioned=!1,l(a=>({...a,isPositioned:!1})))},[j]);let F=w.useRef(!1);cA(()=>(F.current=!0,()=>{F.current=!1}),[]),cA(()=>{if(u&&(x.current=u),v&&(y.current=v),u&&v){if(B.current)return B.current(u,v,E);E()}},[u,v,E,B,A]);let G=w.useMemo(()=>({reference:x,floating:y,setReference:s,setFloating:t}),[s,t]),H=w.useMemo(()=>({reference:u,floating:v}),[u,v]),I=w.useMemo(()=>{let a={position:c,left:0,top:0};if(!H.floating)return a;let b=cD(H.floating,k.x),d=cD(H.floating,k.y);return h?{...a,transform:"translate("+b+"px, "+d+"px)",...cC(H.floating)>=1.5&&{willChange:"transform"}}:{position:c,left:b,top:d}},[c,h,H.floating,k.x,k.y]);return w.useMemo(()=>({...k,update:E,refs:G,elements:H,floatingStyles:I}),[k,E,G,H,I])}({strategy:"fixed",placement:d+("center"!==f?"-"+f:""),whileElementsMounted:(...a)=>(function(a,b,c,d){let e;void 0===d&&(d={});let{ancestorScroll:f=!0,ancestorResize:g=!0,elementResize:h="function"==typeof ResizeObserver,layoutShift:i="function"==typeof IntersectionObserver,animationFrame:j=!1}=d,k=ck(a),l=f||g?[...k?ch(k):[],...ch(b)]:[];l.forEach(a=>{f&&a.addEventListener("scroll",c,{passive:!0}),g&&a.addEventListener("resize",c)});let m=k&&i?function(a,b){let c,d=null,e=bZ(a);function f(){var a;clearTimeout(c),null==(a=d)||a.disconnect(),d=null}return!function g(h,i){void 0===h&&(h=!1),void 0===i&&(i=1),f();let j=a.getBoundingClientRect(),{left:k,top:l,width:m,height:n}=j;if(h||b(),!m||!n)return;let o=bw(l),p=bw(e.clientWidth-(k+m)),q={rootMargin:-o+"px "+-p+"px "+-bw(e.clientHeight-(l+n))+"px "+-bw(k)+"px",threshold:bu(0,bt(1,i))||1},r=!0;function s(b){let d=b[0].intersectionRatio;if(d!==i){if(!r)return g();d?g(!1,d):c=setTimeout(()=>{g(!1,1e-7)},1e3)}1!==d||cy(j,a.getBoundingClientRect())||g(),r=!1}try{d=new IntersectionObserver(s,{...q,root:e.ownerDocument})}catch(a){d=new IntersectionObserver(s,q)}d.observe(a)}(!0),f}(k,c):null,n=-1,o=null;h&&(o=new ResizeObserver(a=>{let[d]=a;d&&d.target===k&&o&&(o.unobserve(b),cancelAnimationFrame(n),n=requestAnimationFrame(()=>{var a;null==(a=o)||a.observe(b)})),c()}),k&&!j&&o.observe(k),o.observe(b));let p=j?co(a):null;return j&&function b(){let d=co(a);p&&!cy(p,d)&&c(),p=d,e=requestAnimationFrame(b)}(),c(),()=>{var a;l.forEach(a=>{f&&a.removeEventListener("scroll",c),g&&a.removeEventListener("resize",c)}),null==m||m(),null==(a=o)||a.disconnect(),o=null,j&&cancelAnimationFrame(e)}})(...a,{animationFrame:"always"===n}),elements:{reference:q.anchor},middleware:[((a,b)=>({...function(a){return void 0===a&&(a=0),{name:"offset",options:a,async fn(b){var c,d;let{x:e,y:f,placement:g,middlewareData:h}=b,i=await bV(b,a);return g===(null==(c=h.offset)?void 0:c.placement)&&null!=(d=h.arrow)&&d.alignmentOffset?{}:{x:e+i.x,y:f+i.y,data:{...i,placement:g}}}}}(a),options:[a,b]}))({mainAxis:e+A,alignmentAxis:g}),i&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"shift",options:a,async fn(b){let{x:c,y:d,placement:e}=b,{mainAxis:f=!0,crossAxis:g=!1,limiter:h={fn:a=>{let{x:b,y:c}=a;return{x:b,y:c}}},...i}=bA(a,b),j={x:c,y:d},k=await bR(b,i),l=bG(bB(e)),m=bD(l),n=j[m],o=j[l];if(f){let a="y"===m?"top":"left",b="y"===m?"bottom":"right",c=n+k[a],d=n-k[b];n=bu(c,bt(n,d))}if(g){let a="y"===l?"top":"left",b="y"===l?"bottom":"right",c=o+k[a],d=o-k[b];o=bu(c,bt(o,d))}let p=h.fn({...b,[m]:n,[l]:o});return{...p,data:{x:p.x-c,y:p.y-d,enabled:{[m]:f,[l]:g}}}}}}(a),options:[a,b]}))({mainAxis:!0,crossAxis:!1,limiter:"partial"===l?((a,b)=>({...function(a){return void 0===a&&(a={}),{options:a,fn(b){let{x:c,y:d,placement:e,rects:f,middlewareData:g}=b,{offset:h=0,mainAxis:i=!0,crossAxis:j=!0}=bA(a,b),k={x:c,y:d},l=bG(e),m=bD(l),n=k[m],o=k[l],p=bA(h,b),q="number"==typeof p?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(i){let a="y"===m?"height":"width",b=f.reference[m]-f.floating[a]+q.mainAxis,c=f.reference[m]+f.reference[a]-q.mainAxis;n<b?n=b:n>c&&(n=c)}if(j){var r,s;let a="y"===m?"width":"height",b=bU.has(bB(e)),c=f.reference[l]-f.floating[a]+(b&&(null==(r=g.offset)?void 0:r[l])||0)+(b?0:q.crossAxis),d=f.reference[l]+f.reference[a]+(b?0:(null==(s=g.offset)?void 0:s[l])||0)-(b?q.crossAxis:0);o<c?o=c:o>d&&(o=d)}return{[m]:n,[l]:o}}}}(a),options:[a,b]}))():void 0,...E}),i&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"flip",options:a,async fn(b){var c,d,e,f,g;let{placement:h,middlewareData:i,rects:j,initialPlacement:k,platform:l,elements:m}=b,{mainAxis:n=!0,crossAxis:o=!0,fallbackPlacements:p,fallbackStrategy:q="bestFit",fallbackAxisSideDirection:r="none",flipAlignment:s=!0,...t}=bA(a,b);if(null!=(c=i.arrow)&&c.alignmentOffset)return{};let u=bB(h),v=bG(k),w=bB(k)===k,x=await (null==l.isRTL?void 0:l.isRTL(m.floating)),y=p||(w||!s?[bM(k)]:function(a){let b=bM(a);return[bH(a),b,bH(b)]}(k)),z="none"!==r;!p&&z&&y.push(...function(a,b,c,d){let e=bC(a),f=function(a,b,c){switch(a){case"top":case"bottom":if(c)return b?bJ:bI;return b?bI:bJ;case"left":case"right":return b?bK:bL;default:return[]}}(bB(a),"start"===c,d);return e&&(f=f.map(a=>a+"-"+e),b&&(f=f.concat(f.map(bH)))),f}(k,s,r,x));let A=[k,...y],B=await bR(b,t),C=[],D=(null==(d=i.flip)?void 0:d.overflows)||[];if(n&&C.push(B[u]),o){let a=function(a,b,c){void 0===c&&(c=!1);let d=bC(a),e=bD(bG(a)),f=bE(e),g="x"===e?d===(c?"end":"start")?"right":"left":"start"===d?"bottom":"top";return b.reference[f]>b.floating[f]&&(g=bM(g)),[g,bM(g)]}(h,j,x);C.push(B[a[0]],B[a[1]])}if(D=[...D,{placement:h,overflows:C}],!C.every(a=>a<=0)){let a=((null==(e=i.flip)?void 0:e.index)||0)+1,b=A[a];if(b&&("alignment"!==o||v===bG(b)||D.every(a=>bG(a.placement)!==v||a.overflows[0]>0)))return{data:{index:a,overflows:D},reset:{placement:b}};let c=null==(f=D.filter(a=>a.overflows[0]<=0).sort((a,b)=>a.overflows[1]-b.overflows[1])[0])?void 0:f.placement;if(!c)switch(q){case"bestFit":{let a=null==(g=D.filter(a=>{if(z){let b=bG(a.placement);return b===v||"y"===b}return!0}).map(a=>[a.placement,a.overflows.filter(a=>a>0).reduce((a,b)=>a+b,0)]).sort((a,b)=>a[1]-b[1])[0])?void 0:g[0];a&&(c=a);break}case"initialPlacement":c=k}if(h!==c)return{reset:{placement:c}}}return{}}}}(a),options:[a,b]}))({...E}),((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"size",options:a,async fn(b){var c,d;let e,f,{placement:g,rects:h,platform:i,elements:j}=b,{apply:k=()=>{},...l}=bA(a,b),m=await bR(b,l),n=bB(g),o=bC(g),p="y"===bG(g),{width:q,height:r}=h.floating;"top"===n||"bottom"===n?(e=n,f=o===(await (null==i.isRTL?void 0:i.isRTL(j.floating))?"start":"end")?"left":"right"):(f=n,e="end"===o?"top":"bottom");let s=r-m.top-m.bottom,t=q-m.left-m.right,u=bt(r-m[e],s),v=bt(q-m[f],t),w=!b.middlewareData.shift,x=u,y=v;if(null!=(c=b.middlewareData.shift)&&c.enabled.x&&(y=t),null!=(d=b.middlewareData.shift)&&d.enabled.y&&(x=s),w&&!o){let a=bu(m.left,0),b=bu(m.right,0),c=bu(m.top,0),d=bu(m.bottom,0);p?y=q-2*(0!==a||0!==b?a+b:bu(m.left,m.right)):x=r-2*(0!==c||0!==d?c+d:bu(m.top,m.bottom))}await k({...b,availableWidth:y,availableHeight:x});let z=await i.getDimensions(j.floating);return q!==z.width||r!==z.height?{reset:{rects:!0}}:{}}}}(a),options:[a,b]}))({...E,apply:({elements:a,rects:b,availableWidth:c,availableHeight:d})=>{let{width:e,height:f}=b.reference,g=a.floating.style;g.setProperty("--radix-popper-available-width",`${c}px`),g.setProperty("--radix-popper-available-height",`${d}px`),g.setProperty("--radix-popper-anchor-width",`${e}px`),g.setProperty("--radix-popper-anchor-height",`${f}px`)}}),u&&((a,b)=>({...(a=>({name:"arrow",options:a,fn(b){let{element:c,padding:d}="function"==typeof a?a(b):a;return c&&({}).hasOwnProperty.call(c,"current")?null!=c.current?cz({element:c.current,padding:d}).fn(b):{}:c?cz({element:c,padding:d}).fn(b):{}}}))(a),options:[a,b]}))({element:u,padding:h}),cX({arrowWidth:z,arrowHeight:A}),m&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"hide",options:a,async fn(b){let{rects:c}=b,{strategy:d="referenceHidden",...e}=bA(a,b);switch(d){case"referenceHidden":{let a=bS(await bR(b,{...e,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:bT(a)}}}case"escaped":{let a=bS(await bR(b,{...e,altBoundary:!0}),c.floating);return{data:{escapedOffsets:a,escaped:bT(a)}}}default:return{}}}}}(a),options:[a,b]}))({strategy:"referenceHidden",...E})]}),[L,M]=cY(H),N=a6(o);bo(()=>{J&&N?.()},[J,N]);let O=K.arrow?.x,P=K.arrow?.y,Q=K.arrow?.centerOffset!==0,[R,S]=w.useState();return bo(()=>{r&&S(window.getComputedStyle(r).zIndex)},[r]),(0,v.jsx)("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:J?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:R,"--radix-popper-transform-origin":[K.transformOrigin?.x,K.transformOrigin?.y].join(" "),...K.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:a.dir,children:(0,v.jsx)(cQ,{scope:c,placedSide:L,onArrowChange:x,arrowX:O,arrowY:P,shouldHideArrow:Q,children:(0,v.jsx)(a5.div,{"data-side":L,"data-align":M,...p,ref:t,style:{...p.style,animation:J?void 0:"none"}})})})});cS.displayName=cP;var cT="PopperArrow",cU={top:"bottom",right:"left",bottom:"top",left:"right"},cV=w.forwardRef(function(a,b){let{__scopePopper:c,...d}=a,e=cR(cT,c),f=cU[e.placedSide];return(0,v.jsx)("span",{ref:e.onArrowChange,style:{position:"absolute",left:e.arrowX,top:e.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[e.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[e.placedSide],visibility:e.shouldHideArrow?"hidden":void 0},children:(0,v.jsx)(cF,{...d,ref:b,style:{...d.style,display:"block"}})})});function cW(a){return null!==a}cV.displayName=cT;var cX=a=>({name:"transformOrigin",options:a,fn(b){let{placement:c,rects:d,middlewareData:e}=b,f=e.arrow?.centerOffset!==0,g=f?0:a.arrowWidth,h=f?0:a.arrowHeight,[i,j]=cY(c),k={start:"0%",center:"50%",end:"100%"}[j],l=(e.arrow?.x??0)+g/2,m=(e.arrow?.y??0)+h/2,n="",o="";return"bottom"===i?(n=f?k:`${l}px`,o=`${-h}px`):"top"===i?(n=f?k:`${l}px`,o=`${d.floating.height+h}px`):"right"===i?(n=`${-h}px`,o=f?k:`${m}px`):"left"===i&&(n=`${d.floating.width+h}px`,o=f?k:`${m}px`),{data:{x:n,y:o}}}});function cY(a){let[b,c="center"]=a.split("-");return[b,c]}var cZ=w.forwardRef((a,b)=>{let{container:c,...d}=a,[e,f]=w.useState(!1);bo(()=>f(!0),[]);let g=c||e&&globalThis?.document?.body;return g?aX.createPortal((0,v.jsx)(a5.div,{...d,ref:b}),g):null});cZ.displayName="Portal";var c$=x[" useInsertionEffect ".trim().toString()]||bo;function c_({prop:a,defaultProp:b,onChange:c=()=>{},caller:d}){let[e,f,g]=function({defaultProp:a,onChange:b}){let[c,d]=w.useState(a),e=w.useRef(c),f=w.useRef(b);return c$(()=>{f.current=b},[b]),w.useEffect(()=>{e.current!==c&&(f.current?.(c),e.current=c)},[c,e]),[c,d,f]}({defaultProp:b,onChange:c}),h=void 0!==a,i=h?a:e;{let b=w.useRef(void 0!==a);w.useEffect(()=>{let a=b.current;if(a!==h){let b=h?"controlled":"uncontrolled";console.warn(`${d} is changing from ${a?"controlled":"uncontrolled"} to ${b}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}b.current=h},[h,d])}return[i,w.useCallback(b=>{if(h){let c="function"==typeof b?b(a):b;c!==a&&g.current?.(c)}else f(b)},[h,a,f,g])]}function c0(a){let b=w.useRef({value:a,previous:a});return w.useMemo(()=>(b.current.value!==a&&(b.current.previous=b.current.value,b.current.value=a),b.current.previous),[a])}Symbol("RADIX:SYNC_STATE");var c1=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"});w.forwardRef((a,b)=>(0,v.jsx)(a5.span,{...a,ref:b,style:{...c1,...a.style}})).displayName="VisuallyHidden";var c2=new WeakMap,c3=new WeakMap,c4={},c5=0,c6=function(a){return a&&(a.host||c6(a.parentNode))},c7=function(a,b,c,d){var e=(Array.isArray(a)?a:[a]).map(function(a){if(b.contains(a))return a;var c=c6(a);return c&&b.contains(c)?c:(console.error("aria-hidden",a,"in not contained inside",b,". Doing nothing"),null)}).filter(function(a){return!!a});c4[c]||(c4[c]=new WeakMap);var f=c4[c],g=[],h=new Set,i=new Set(e),j=function(a){!a||h.has(a)||(h.add(a),j(a.parentNode))};e.forEach(j);var k=function(a){!a||i.has(a)||Array.prototype.forEach.call(a.children,function(a){if(h.has(a))k(a);else try{var b=a.getAttribute(d),e=null!==b&&"false"!==b,i=(c2.get(a)||0)+1,j=(f.get(a)||0)+1;c2.set(a,i),f.set(a,j),g.push(a),1===i&&e&&c3.set(a,!0),1===j&&a.setAttribute(c,"true"),e||a.setAttribute(d,"true")}catch(b){console.error("aria-hidden: cannot operate on ",a,b)}})};return k(b),h.clear(),c5++,function(){g.forEach(function(a){var b=c2.get(a)-1,e=f.get(a)-1;c2.set(a,b),f.set(a,e),b||(c3.has(a)||a.removeAttribute(d),c3.delete(a)),e||a.removeAttribute(c)}),--c5||(c2=new WeakMap,c2=new WeakMap,c3=new WeakMap,c4={})}},c8=function(a,b,c){void 0===c&&(c="data-aria-hidden");var d=Array.from(Array.isArray(a)?a:[a]),e=b||("undefined"==typeof document?null:(Array.isArray(a)?a[0]:a).ownerDocument.body);return e?(d.push.apply(d,Array.from(e.querySelectorAll("[aria-live], script"))),c7(d,e,c,"aria-hidden")):function(){return null}},c9=function(){return(c9=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function da(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}Object.create;Object.create;var db=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),dc="width-before-scroll-bar";function dd(a,b){return"function"==typeof a?a(b):a&&(a.current=b),a}var de="undefined"!=typeof window?w.useLayoutEffect:w.useEffect,df=new WeakMap;function dg(a){return a}var dh=function(a){void 0===a&&(a={});var b,c,d,e=(void 0===b&&(b=dg),c=[],d=!1,{read:function(){if(d)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return c.length?c[c.length-1]:null},useMedium:function(a){var e=b(a,d);return c.push(e),function(){c=c.filter(function(a){return a!==e})}},assignSyncMedium:function(a){for(d=!0;c.length;){var b=c;c=[],b.forEach(a)}c={push:function(b){return a(b)},filter:function(){return c}}},assignMedium:function(a){d=!0;var b=[];if(c.length){var e=c;c=[],e.forEach(a),b=c}var f=function(){var c=b;b=[],c.forEach(a)},g=function(){return Promise.resolve().then(f)};g(),c={push:function(a){b.push(a),g()},filter:function(a){return b=b.filter(a),c}}}});return e.options=c9({async:!0,ssr:!1},a),e}(),di=function(){},dj=w.forwardRef(function(a,b){var c,d,e,f,g=w.useRef(null),h=w.useState({onScrollCapture:di,onWheelCapture:di,onTouchMoveCapture:di}),i=h[0],j=h[1],k=a.forwardProps,l=a.children,m=a.className,n=a.removeScrollBar,o=a.enabled,p=a.shards,q=a.sideCar,r=a.noRelative,s=a.noIsolation,t=a.inert,u=a.allowPinchZoom,v=a.as,x=a.gapMode,y=da(a,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),z=(c=[g,b],d=function(a){return c.forEach(function(b){return dd(b,a)})},(e=(0,w.useState)(function(){return{value:null,callback:d,facade:{get current(){return e.value},set current(value){var a=e.value;a!==value&&(e.value=value,e.callback(value,a))}}}})[0]).callback=d,f=e.facade,de(function(){var a=df.get(f);if(a){var b=new Set(a),d=new Set(c),e=f.current;b.forEach(function(a){d.has(a)||dd(a,null)}),d.forEach(function(a){b.has(a)||dd(a,e)})}df.set(f,c)},[c]),f),A=c9(c9({},y),i);return w.createElement(w.Fragment,null,o&&w.createElement(q,{sideCar:dh,removeScrollBar:n,shards:p,noRelative:r,noIsolation:s,inert:t,setCallbacks:j,allowPinchZoom:!!u,lockRef:g,gapMode:x}),k?w.cloneElement(w.Children.only(l),c9(c9({},A),{ref:z})):w.createElement(void 0===v?"div":v,c9({},A,{className:m,ref:z}),l))});dj.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},dj.classNames={fullWidth:dc,zeroRight:db};var dk=function(a){var b=a.sideCar,c=da(a,["sideCar"]);if(!b)throw Error("Sidecar: please provide `sideCar` property to import the right car");var d=b.read();if(!d)throw Error("Sidecar medium not found");return w.createElement(d,c9({},c))};dk.isSideCarExport=!0;var dl=function(){var a=0,b=null;return{add:function(d){if(0==a&&(b=function(){if(!document)return null;var a=document.createElement("style");a.type="text/css";var b=g||c.nc;return b&&a.setAttribute("nonce",b),a}())){var e,f;(e=b).styleSheet?e.styleSheet.cssText=d:e.appendChild(document.createTextNode(d)),f=b,(document.head||document.getElementsByTagName("head")[0]).appendChild(f)}a++},remove:function(){--a||!b||(b.parentNode&&b.parentNode.removeChild(b),b=null)}}},dm=function(){var a=dl();return function(b,c){w.useEffect(function(){return a.add(b),function(){a.remove()}},[b&&c])}},dn=function(){var a=dm();return function(b){return a(b.styles,b.dynamic),null}},dp={left:0,top:0,right:0,gap:0},dq=function(a){return parseInt(a||"",10)||0},dr=function(a){var b=window.getComputedStyle(document.body),c=b["padding"===a?"paddingLeft":"marginLeft"],d=b["padding"===a?"paddingTop":"marginTop"],e=b["padding"===a?"paddingRight":"marginRight"];return[dq(c),dq(d),dq(e)]},ds=function(a){if(void 0===a&&(a="margin"),"undefined"==typeof window)return dp;var b=dr(a),c=document.documentElement.clientWidth,d=window.innerWidth;return{left:b[0],top:b[1],right:b[2],gap:Math.max(0,d-c+b[2]-b[0])}},dt=dn(),du="data-scroll-locked",dv=function(a,b,c,d){var e=a.left,f=a.top,g=a.right,h=a.gap;return void 0===c&&(c="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(d,";\n   padding-right: ").concat(h,"px ").concat(d,";\n  }\n  body[").concat(du,"] {\n    overflow: hidden ").concat(d,";\n    overscroll-behavior: contain;\n    ").concat([b&&"position: relative ".concat(d,";"),"margin"===c&&"\n    padding-left: ".concat(e,"px;\n    padding-top: ").concat(f,"px;\n    padding-right: ").concat(g,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(h,"px ").concat(d,";\n    "),"padding"===c&&"padding-right: ".concat(h,"px ").concat(d,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(db," {\n    right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(dc," {\n    margin-right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(db," .").concat(db," {\n    right: 0 ").concat(d,";\n  }\n  \n  .").concat(dc," .").concat(dc," {\n    margin-right: 0 ").concat(d,";\n  }\n  \n  body[").concat(du,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(h,"px;\n  }\n")},dw=function(){var a=parseInt(document.body.getAttribute(du)||"0",10);return isFinite(a)?a:0},dx=function(){w.useEffect(function(){return document.body.setAttribute(du,(dw()+1).toString()),function(){var a=dw()-1;a<=0?document.body.removeAttribute(du):document.body.setAttribute(du,a.toString())}},[])},dy=function(a){var b=a.noRelative,c=a.noImportant,d=a.gapMode,e=void 0===d?"margin":d;dx();var f=w.useMemo(function(){return ds(e)},[e]);return w.createElement(dt,{styles:dv(f,!b,e,c?"":"!important")})},dz=!1;if("undefined"!=typeof window)try{var dA=Object.defineProperty({},"passive",{get:function(){return dz=!0,!0}});window.addEventListener("test",dA,dA),window.removeEventListener("test",dA,dA)}catch(a){dz=!1}var dB=!!dz&&{passive:!1},dC=function(a,b){if(!(a instanceof Element))return!1;var c=window.getComputedStyle(a);return"hidden"!==c[b]&&(c.overflowY!==c.overflowX||"TEXTAREA"===a.tagName||"visible"!==c[b])},dD=function(a,b){var c=b.ownerDocument,d=b;do{if("undefined"!=typeof ShadowRoot&&d instanceof ShadowRoot&&(d=d.host),dE(a,d)){var e=dF(a,d);if(e[1]>e[2])return!0}d=d.parentNode}while(d&&d!==c.body);return!1},dE=function(a,b){return"v"===a?dC(b,"overflowY"):dC(b,"overflowX")},dF=function(a,b){return"v"===a?[b.scrollTop,b.scrollHeight,b.clientHeight]:[b.scrollLeft,b.scrollWidth,b.clientWidth]},dG=function(a,b,c,d,e){var f,g=(f=window.getComputedStyle(b).direction,"h"===a&&"rtl"===f?-1:1),h=g*d,i=c.target,j=b.contains(i),k=!1,l=h>0,m=0,n=0;do{if(!i)break;var o=dF(a,i),p=o[0],q=o[1]-o[2]-g*p;(p||q)&&dE(a,i)&&(m+=q,n+=p);var r=i.parentNode;i=r&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r}while(!j&&i!==document.body||j&&(b.contains(i)||b===i));return l&&(e&&1>Math.abs(m)||!e&&h>m)?k=!0:!l&&(e&&1>Math.abs(n)||!e&&-h>n)&&(k=!0),k},dH=function(a){return"changedTouches"in a?[a.changedTouches[0].clientX,a.changedTouches[0].clientY]:[0,0]},dI=function(a){return[a.deltaX,a.deltaY]},dJ=function(a){return a&&"current"in a?a.current:a},dK=0,dL=[];let dM=(e=function(a){var b=w.useRef([]),c=w.useRef([0,0]),d=w.useRef(),e=w.useState(dK++)[0],f=w.useState(dn)[0],g=w.useRef(a);w.useEffect(function(){g.current=a},[a]),w.useEffect(function(){if(a.inert){document.body.classList.add("block-interactivity-".concat(e));var b=(function(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))})([a.lockRef.current],(a.shards||[]).map(dJ),!0).filter(Boolean);return b.forEach(function(a){return a.classList.add("allow-interactivity-".concat(e))}),function(){document.body.classList.remove("block-interactivity-".concat(e)),b.forEach(function(a){return a.classList.remove("allow-interactivity-".concat(e))})}}},[a.inert,a.lockRef.current,a.shards]);var h=w.useCallback(function(a,b){if("touches"in a&&2===a.touches.length||"wheel"===a.type&&a.ctrlKey)return!g.current.allowPinchZoom;var e,f=dH(a),h=c.current,i="deltaX"in a?a.deltaX:h[0]-f[0],j="deltaY"in a?a.deltaY:h[1]-f[1],k=a.target,l=Math.abs(i)>Math.abs(j)?"h":"v";if("touches"in a&&"h"===l&&"range"===k.type)return!1;var m=dD(l,k);if(!m)return!0;if(m?e=l:(e="v"===l?"h":"v",m=dD(l,k)),!m)return!1;if(!d.current&&"changedTouches"in a&&(i||j)&&(d.current=e),!e)return!0;var n=d.current||e;return dG(n,b,a,"h"===n?i:j,!0)},[]),i=w.useCallback(function(a){if(dL.length&&dL[dL.length-1]===f){var c="deltaY"in a?dI(a):dH(a),d=b.current.filter(function(b){var d;return b.name===a.type&&(b.target===a.target||a.target===b.shadowParent)&&(d=b.delta,d[0]===c[0]&&d[1]===c[1])})[0];if(d&&d.should){a.cancelable&&a.preventDefault();return}if(!d){var e=(g.current.shards||[]).map(dJ).filter(Boolean).filter(function(b){return b.contains(a.target)});(e.length>0?h(a,e[0]):!g.current.noIsolation)&&a.cancelable&&a.preventDefault()}}},[]),j=w.useCallback(function(a,c,d,e){var f={name:a,delta:c,target:d,should:e,shadowParent:function(a){for(var b=null;null!==a;)a instanceof ShadowRoot&&(b=a.host,a=a.host),a=a.parentNode;return b}(d)};b.current.push(f),setTimeout(function(){b.current=b.current.filter(function(a){return a!==f})},1)},[]),k=w.useCallback(function(a){c.current=dH(a),d.current=void 0},[]),l=w.useCallback(function(b){j(b.type,dI(b),b.target,h(b,a.lockRef.current))},[]),m=w.useCallback(function(b){j(b.type,dH(b),b.target,h(b,a.lockRef.current))},[]);w.useEffect(function(){return dL.push(f),a.setCallbacks({onScrollCapture:l,onWheelCapture:l,onTouchMoveCapture:m}),document.addEventListener("wheel",i,dB),document.addEventListener("touchmove",i,dB),document.addEventListener("touchstart",k,dB),function(){dL=dL.filter(function(a){return a!==f}),document.removeEventListener("wheel",i,dB),document.removeEventListener("touchmove",i,dB),document.removeEventListener("touchstart",k,dB)}},[]);var n=a.removeScrollBar,o=a.inert;return w.createElement(w.Fragment,null,o?w.createElement(f,{styles:"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")}):null,n?w.createElement(dy,{noRelative:a.noRelative,gapMode:a.gapMode}):null)},dh.useMedium(e),dk);var dN=w.forwardRef(function(a,b){return w.createElement(dj,c9({},a,{ref:b,sideCar:dM}))});dN.classNames=dj.classNames;var dO=[" ","Enter","ArrowUp","ArrowDown"],dP=[" ","Enter"],dQ="Select",[dR,dS,dT]=a_(dQ),[dU,dV]=a$(dQ,[dT,cJ]),dW=cJ(),[dX,dY]=dU(dQ),[dZ,d$]=dU(dQ),d_=a=>{let{__scopeSelect:b,children:c,open:d,defaultOpen:e,onOpenChange:f,value:g,defaultValue:h,onValueChange:i,dir:j,name:k,autoComplete:l,disabled:m,required:n,form:o}=a,p=dW(b),[q,r]=w.useState(null),[s,t]=w.useState(null),[u,x]=w.useState(!1),y=a4(j),[z,A]=c_({prop:d,defaultProp:e??!1,onChange:f,caller:dQ}),[B,C]=c_({prop:g,defaultProp:h,onChange:i,caller:dQ}),D=w.useRef(null),E=!q||o||!!q.closest("form"),[F,G]=w.useState(new Set),H=Array.from(F).map(a=>a.props.value).join(";");return(0,v.jsx)(cM,{...p,children:(0,v.jsxs)(dX,{required:n,scope:b,trigger:q,onTriggerChange:r,valueNode:s,onValueNodeChange:t,valueNodeHasChildren:u,onValueNodeHasChildrenChange:x,contentId:br(),value:B,onValueChange:C,open:z,onOpenChange:A,dir:y,triggerPointerDownPosRef:D,disabled:m,children:[(0,v.jsx)(dR.Provider,{scope:b,children:(0,v.jsx)(dZ,{scope:a.__scopeSelect,onNativeOptionAdd:w.useCallback(a=>{G(b=>new Set(b).add(a))},[]),onNativeOptionRemove:w.useCallback(a=>{G(b=>{let c=new Set(b);return c.delete(a),c})},[]),children:c})}),E?(0,v.jsxs)(eA,{"aria-hidden":!0,required:n,tabIndex:-1,name:k,autoComplete:l,value:B,onChange:a=>C(a.target.value),disabled:m,form:o,children:[void 0===B?(0,v.jsx)("option",{value:""}):null,Array.from(F)]},H):null]})})};d_.displayName=dQ;var d0="SelectTrigger",d1=w.forwardRef((a,b)=>{let{__scopeSelect:c,disabled:d=!1,...e}=a,f=dW(c),g=dY(d0,c),h=g.disabled||d,i=I(b,g.onTriggerChange),j=dS(c),k=w.useRef("touch"),[l,m,n]=eC(a=>{let b=j().filter(a=>!a.disabled),c=b.find(a=>a.value===g.value),d=eD(b,a,c);void 0!==d&&g.onValueChange(d.value)}),o=a=>{h||(g.onOpenChange(!0),n()),a&&(g.triggerPointerDownPosRef.current={x:Math.round(a.pageX),y:Math.round(a.pageY)})};return(0,v.jsx)(cO,{asChild:!0,...f,children:(0,v.jsx)(a5.button,{type:"button",role:"combobox","aria-controls":g.contentId,"aria-expanded":g.open,"aria-required":g.required,"aria-autocomplete":"none",dir:g.dir,"data-state":g.open?"open":"closed",disabled:h,"data-disabled":h?"":void 0,"data-placeholder":eB(g.value)?"":void 0,...e,ref:i,onClick:aZ(e.onClick,a=>{a.currentTarget.focus(),"mouse"!==k.current&&o(a)}),onPointerDown:aZ(e.onPointerDown,a=>{k.current=a.pointerType;let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),0===a.button&&!1===a.ctrlKey&&"mouse"===a.pointerType&&(o(a),a.preventDefault())}),onKeyDown:aZ(e.onKeyDown,a=>{let b=""!==l.current;a.ctrlKey||a.altKey||a.metaKey||1!==a.key.length||m(a.key),(!b||" "!==a.key)&&dO.includes(a.key)&&(o(),a.preventDefault())})})})});d1.displayName=d0;var d2="SelectValue",d3=w.forwardRef((a,b)=>{let{__scopeSelect:c,className:d,style:e,children:f,placeholder:g="",...h}=a,i=dY(d2,c),{onValueNodeHasChildrenChange:j}=i,k=void 0!==f,l=I(b,i.onValueNodeChange);return bo(()=>{j(k)},[j,k]),(0,v.jsx)(a5.span,{...h,ref:l,style:{pointerEvents:"none"},children:eB(i.value)?(0,v.jsx)(v.Fragment,{children:g}):f})});d3.displayName=d2;var d4=w.forwardRef((a,b)=>{let{__scopeSelect:c,children:d,...e}=a;return(0,v.jsx)(a5.span,{"aria-hidden":!0,...e,ref:b,children:d||""})});d4.displayName="SelectIcon";var d5=a=>(0,v.jsx)(cZ,{asChild:!0,...a});d5.displayName="SelectPortal";var d6="SelectContent",d7=w.forwardRef((a,b)=>{let c=dY(d6,a.__scopeSelect),[d,e]=w.useState();return(bo(()=>{e(new DocumentFragment)},[]),c.open)?(0,v.jsx)(eb,{...a,ref:b}):d?aX.createPortal((0,v.jsx)(d8,{scope:a.__scopeSelect,children:(0,v.jsx)(dR.Slot,{scope:a.__scopeSelect,children:(0,v.jsx)("div",{children:a.children})})}),d):null});d7.displayName=d6;var[d8,d9]=dU(d6),ea=J("SelectContent.RemoveScroll"),eb=w.forwardRef((a,b)=>{let{__scopeSelect:c,position:d="item-aligned",onCloseAutoFocus:e,onEscapeKeyDown:f,onPointerDownOutside:g,side:h,sideOffset:i,align:j,alignOffset:k,arrowPadding:l,collisionBoundary:m,collisionPadding:n,sticky:o,hideWhenDetached:p,avoidCollisions:q,...r}=a,s=dY(d6,c),[t,u]=w.useState(null),[x,y]=w.useState(null),z=I(b,a=>u(a)),[A,B]=w.useState(null),[C,D]=w.useState(null),E=dS(c),[F,G]=w.useState(!1),H=w.useRef(!1);w.useEffect(()=>{if(t)return c8(t)},[t]),bd();let J=w.useCallback(a=>{let[b,...c]=E().map(a=>a.ref.current),[d]=c.slice(-1),e=document.activeElement;for(let c of a)if(c===e||(c?.scrollIntoView({block:"nearest"}),c===b&&x&&(x.scrollTop=0),c===d&&x&&(x.scrollTop=x.scrollHeight),c?.focus(),document.activeElement!==e))return},[E,x]),K=w.useCallback(()=>J([A,t]),[J,A,t]);w.useEffect(()=>{F&&K()},[F,K]);let{onOpenChange:L,triggerPointerDownPosRef:M}=s;w.useEffect(()=>{if(t){let a={x:0,y:0},b=b=>{a={x:Math.abs(Math.round(b.pageX)-(M.current?.x??0)),y:Math.abs(Math.round(b.pageY)-(M.current?.y??0))}},c=c=>{a.x<=10&&a.y<=10?c.preventDefault():t.contains(c.target)||L(!1),document.removeEventListener("pointermove",b),M.current=null};return null!==M.current&&(document.addEventListener("pointermove",b),document.addEventListener("pointerup",c,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",c,{capture:!0})}}},[t,L,M]),w.useEffect(()=>{let a=()=>L(!1);return window.addEventListener("blur",a),window.addEventListener("resize",a),()=>{window.removeEventListener("blur",a),window.removeEventListener("resize",a)}},[L]);let[N,O]=eC(a=>{let b=E().filter(a=>!a.disabled),c=b.find(a=>a.ref.current===document.activeElement),d=eD(b,a,c);d&&setTimeout(()=>d.ref.current.focus())}),P=w.useCallback((a,b,c)=>{let d=!H.current&&!c;(void 0!==s.value&&s.value===b||d)&&(B(a),d&&(H.current=!0))},[s.value]),Q=w.useCallback(()=>t?.focus(),[t]),R=w.useCallback((a,b,c)=>{let d=!H.current&&!c;(void 0!==s.value&&s.value===b||d)&&D(a)},[s.value]),S="popper"===d?ed:ec,T=S===ed?{side:h,sideOffset:i,align:j,alignOffset:k,arrowPadding:l,collisionBoundary:m,collisionPadding:n,sticky:o,hideWhenDetached:p,avoidCollisions:q}:{};return(0,v.jsx)(d8,{scope:c,content:t,viewport:x,onViewportChange:y,itemRefCallback:P,selectedItem:A,onItemLeave:Q,itemTextRefCallback:R,focusSelectedItem:K,selectedItemText:C,position:d,isPositioned:F,searchRef:N,children:(0,v.jsx)(dN,{as:ea,allowPinchZoom:!0,children:(0,v.jsx)(bi,{asChild:!0,trapped:s.open,onMountAutoFocus:a=>{a.preventDefault()},onUnmountAutoFocus:aZ(e,a=>{s.trigger?.focus({preventScroll:!0}),a.preventDefault()}),children:(0,v.jsx)(a9,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:f,onPointerDownOutside:g,onFocusOutside:a=>a.preventDefault(),onDismiss:()=>s.onOpenChange(!1),children:(0,v.jsx)(S,{role:"listbox",id:s.contentId,"data-state":s.open?"open":"closed",dir:s.dir,onContextMenu:a=>a.preventDefault(),...r,...T,onPlaced:()=>G(!0),ref:z,style:{display:"flex",flexDirection:"column",outline:"none",...r.style},onKeyDown:aZ(r.onKeyDown,a=>{let b=a.ctrlKey||a.altKey||a.metaKey;if("Tab"===a.key&&a.preventDefault(),b||1!==a.key.length||O(a.key),["ArrowUp","ArrowDown","Home","End"].includes(a.key)){let b=E().filter(a=>!a.disabled).map(a=>a.ref.current);if(["ArrowUp","End"].includes(a.key)&&(b=b.slice().reverse()),["ArrowUp","ArrowDown"].includes(a.key)){let c=a.target,d=b.indexOf(c);b=b.slice(d+1)}setTimeout(()=>J(b)),a.preventDefault()}})})})})})})});eb.displayName="SelectContentImpl";var ec=w.forwardRef((a,b)=>{let{__scopeSelect:c,onPlaced:d,...e}=a,f=dY(d6,c),g=d9(d6,c),[h,i]=w.useState(null),[j,k]=w.useState(null),l=I(b,a=>k(a)),m=dS(c),n=w.useRef(!1),o=w.useRef(!0),{viewport:p,selectedItem:q,selectedItemText:r,focusSelectedItem:s}=g,t=w.useCallback(()=>{if(f.trigger&&f.valueNode&&h&&j&&p&&q&&r){let a=f.trigger.getBoundingClientRect(),b=j.getBoundingClientRect(),c=f.valueNode.getBoundingClientRect(),e=r.getBoundingClientRect();if("rtl"!==f.dir){let d=e.left-b.left,f=c.left-d,g=a.left-f,i=a.width+g,j=Math.max(i,b.width),k=aY(f,[10,Math.max(10,window.innerWidth-10-j)]);h.style.minWidth=i+"px",h.style.left=k+"px"}else{let d=b.right-e.right,f=window.innerWidth-c.right-d,g=window.innerWidth-a.right-f,i=a.width+g,j=Math.max(i,b.width),k=aY(f,[10,Math.max(10,window.innerWidth-10-j)]);h.style.minWidth=i+"px",h.style.right=k+"px"}let g=m(),i=window.innerHeight-20,k=p.scrollHeight,l=window.getComputedStyle(j),o=parseInt(l.borderTopWidth,10),s=parseInt(l.paddingTop,10),t=parseInt(l.borderBottomWidth,10),u=o+s+k+parseInt(l.paddingBottom,10)+t,v=Math.min(5*q.offsetHeight,u),w=window.getComputedStyle(p),x=parseInt(w.paddingTop,10),y=parseInt(w.paddingBottom,10),z=a.top+a.height/2-10,A=q.offsetHeight/2,B=o+s+(q.offsetTop+A);if(B<=z){let a=g.length>0&&q===g[g.length-1].ref.current;h.style.bottom="0px";let b=Math.max(i-z,A+(a?y:0)+(j.clientHeight-p.offsetTop-p.offsetHeight)+t);h.style.height=B+b+"px"}else{let a=g.length>0&&q===g[0].ref.current;h.style.top="0px";let b=Math.max(z,o+p.offsetTop+(a?x:0)+A);h.style.height=b+(u-B)+"px",p.scrollTop=B-z+p.offsetTop}h.style.margin="10px 0",h.style.minHeight=v+"px",h.style.maxHeight=i+"px",d?.(),requestAnimationFrame(()=>n.current=!0)}},[m,f.trigger,f.valueNode,h,j,p,q,r,f.dir,d]);bo(()=>t(),[t]);let[u,x]=w.useState();bo(()=>{j&&x(window.getComputedStyle(j).zIndex)},[j]);let y=w.useCallback(a=>{a&&!0===o.current&&(t(),s?.(),o.current=!1)},[t,s]);return(0,v.jsx)(ee,{scope:c,contentWrapper:h,shouldExpandOnScrollRef:n,onScrollButtonChange:y,children:(0,v.jsx)("div",{ref:i,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:u},children:(0,v.jsx)(a5.div,{...e,ref:l,style:{boxSizing:"border-box",maxHeight:"100%",...e.style}})})})});ec.displayName="SelectItemAlignedPosition";var ed=w.forwardRef((a,b)=>{let{__scopeSelect:c,align:d="start",collisionPadding:e=10,...f}=a,g=dW(c);return(0,v.jsx)(cS,{...g,...f,ref:b,align:d,collisionPadding:e,style:{boxSizing:"border-box",...f.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ed.displayName="SelectPopperPosition";var[ee,ef]=dU(d6,{}),eg="SelectViewport",eh=w.forwardRef((a,b)=>{let{__scopeSelect:c,nonce:d,...e}=a,f=d9(eg,c),g=ef(eg,c),h=I(b,f.onViewportChange),i=w.useRef(0);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:d}),(0,v.jsx)(dR.Slot,{scope:c,children:(0,v.jsx)(a5.div,{"data-radix-select-viewport":"",role:"presentation",...e,ref:h,style:{position:"relative",flex:1,overflow:"hidden auto",...e.style},onScroll:aZ(e.onScroll,a=>{let b=a.currentTarget,{contentWrapper:c,shouldExpandOnScrollRef:d}=g;if(d?.current&&c){let a=Math.abs(i.current-b.scrollTop);if(a>0){let d=window.innerHeight-20,e=Math.max(parseFloat(c.style.minHeight),parseFloat(c.style.height));if(e<d){let f=e+a,g=Math.min(d,f),h=f-g;c.style.height=g+"px","0px"===c.style.bottom&&(b.scrollTop=h>0?h:0,c.style.justifyContent="flex-end")}}}i.current=b.scrollTop})})})]})});eh.displayName=eg;var ei="SelectGroup",[ej,ek]=dU(ei);w.forwardRef((a,b)=>{let{__scopeSelect:c,...d}=a,e=br();return(0,v.jsx)(ej,{scope:c,id:e,children:(0,v.jsx)(a5.div,{role:"group","aria-labelledby":e,...d,ref:b})})}).displayName=ei;var el="SelectLabel";w.forwardRef((a,b)=>{let{__scopeSelect:c,...d}=a,e=ek(el,c);return(0,v.jsx)(a5.div,{id:e.id,...d,ref:b})}).displayName=el;var em="SelectItem",[en,eo]=dU(em),ep=w.forwardRef((a,b)=>{let{__scopeSelect:c,value:d,disabled:e=!1,textValue:f,...g}=a,h=dY(em,c),i=d9(em,c),j=h.value===d,[k,l]=w.useState(f??""),[m,n]=w.useState(!1),o=I(b,a=>i.itemRefCallback?.(a,d,e)),p=br(),q=w.useRef("touch"),r=()=>{e||(h.onValueChange(d),h.onOpenChange(!1))};if(""===d)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,v.jsx)(en,{scope:c,value:d,disabled:e,textId:p,isSelected:j,onItemTextChange:w.useCallback(a=>{l(b=>b||(a?.textContent??"").trim())},[]),children:(0,v.jsx)(dR.ItemSlot,{scope:c,value:d,disabled:e,textValue:k,children:(0,v.jsx)(a5.div,{role:"option","aria-labelledby":p,"data-highlighted":m?"":void 0,"aria-selected":j&&m,"data-state":j?"checked":"unchecked","aria-disabled":e||void 0,"data-disabled":e?"":void 0,tabIndex:e?void 0:-1,...g,ref:o,onFocus:aZ(g.onFocus,()=>n(!0)),onBlur:aZ(g.onBlur,()=>n(!1)),onClick:aZ(g.onClick,()=>{"mouse"!==q.current&&r()}),onPointerUp:aZ(g.onPointerUp,()=>{"mouse"===q.current&&r()}),onPointerDown:aZ(g.onPointerDown,a=>{q.current=a.pointerType}),onPointerMove:aZ(g.onPointerMove,a=>{q.current=a.pointerType,e?i.onItemLeave?.():"mouse"===q.current&&a.currentTarget.focus({preventScroll:!0})}),onPointerLeave:aZ(g.onPointerLeave,a=>{a.currentTarget===document.activeElement&&i.onItemLeave?.()}),onKeyDown:aZ(g.onKeyDown,a=>{(i.searchRef?.current===""||" "!==a.key)&&(dP.includes(a.key)&&r()," "===a.key&&a.preventDefault())})})})})});ep.displayName=em;var eq="SelectItemText",er=w.forwardRef((a,b)=>{let{__scopeSelect:c,className:d,style:e,...f}=a,g=dY(eq,c),h=d9(eq,c),i=eo(eq,c),j=d$(eq,c),[k,l]=w.useState(null),m=I(b,a=>l(a),i.onItemTextChange,a=>h.itemTextRefCallback?.(a,i.value,i.disabled)),n=k?.textContent,o=w.useMemo(()=>(0,v.jsx)("option",{value:i.value,disabled:i.disabled,children:n},i.value),[i.disabled,i.value,n]),{onNativeOptionAdd:p,onNativeOptionRemove:q}=j;return bo(()=>(p(o),()=>q(o)),[p,q,o]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(a5.span,{id:i.textId,...f,ref:m}),i.isSelected&&g.valueNode&&!g.valueNodeHasChildren?aX.createPortal(f.children,g.valueNode):null]})});er.displayName=eq;var es="SelectItemIndicator",et=w.forwardRef((a,b)=>{let{__scopeSelect:c,...d}=a;return eo(es,c).isSelected?(0,v.jsx)(a5.span,{"aria-hidden":!0,...d,ref:b}):null});et.displayName=es;var eu="SelectScrollUpButton",ev=w.forwardRef((a,b)=>{let c=d9(eu,a.__scopeSelect),d=ef(eu,a.__scopeSelect),[e,f]=w.useState(!1),g=I(b,d.onScrollButtonChange);return bo(()=>{if(c.viewport&&c.isPositioned){let a=function(){f(b.scrollTop>0)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),e?(0,v.jsx)(ey,{...a,ref:g,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop-b.offsetHeight)}}):null});ev.displayName=eu;var ew="SelectScrollDownButton",ex=w.forwardRef((a,b)=>{let c=d9(ew,a.__scopeSelect),d=ef(ew,a.__scopeSelect),[e,f]=w.useState(!1),g=I(b,d.onScrollButtonChange);return bo(()=>{if(c.viewport&&c.isPositioned){let a=function(){let a=b.scrollHeight-b.clientHeight;f(Math.ceil(b.scrollTop)<a)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),e?(0,v.jsx)(ey,{...a,ref:g,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop+b.offsetHeight)}}):null});ex.displayName=ew;var ey=w.forwardRef((a,b)=>{let{__scopeSelect:c,onAutoScroll:d,...e}=a,f=d9("SelectScrollButton",c),g=w.useRef(null),h=dS(c),i=w.useCallback(()=>{null!==g.current&&(window.clearInterval(g.current),g.current=null)},[]);return w.useEffect(()=>()=>i(),[i]),bo(()=>{let a=h().find(a=>a.ref.current===document.activeElement);a?.ref.current?.scrollIntoView({block:"nearest"})},[h]),(0,v.jsx)(a5.div,{"aria-hidden":!0,...e,ref:b,style:{flexShrink:0,...e.style},onPointerDown:aZ(e.onPointerDown,()=>{null===g.current&&(g.current=window.setInterval(d,50))}),onPointerMove:aZ(e.onPointerMove,()=>{f.onItemLeave?.(),null===g.current&&(g.current=window.setInterval(d,50))}),onPointerLeave:aZ(e.onPointerLeave,()=>{i()})})});w.forwardRef((a,b)=>{let{__scopeSelect:c,...d}=a;return(0,v.jsx)(a5.div,{"aria-hidden":!0,...d,ref:b})}).displayName="SelectSeparator";var ez="SelectArrow";w.forwardRef((a,b)=>{let{__scopeSelect:c,...d}=a,e=dW(c),f=dY(ez,c),g=d9(ez,c);return f.open&&"popper"===g.position?(0,v.jsx)(cV,{...e,...d,ref:b}):null}).displayName=ez;var eA=w.forwardRef(({__scopeSelect:a,value:b,...c},d)=>{let e=w.useRef(null),f=I(d,e),g=c0(b);return w.useEffect(()=>{let a=e.current;if(!a)return;let c=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(g!==b&&c){let d=new Event("change",{bubbles:!0});c.call(a,b),a.dispatchEvent(d)}},[g,b]),(0,v.jsx)(a5.select,{...c,style:{...c1,...c.style},ref:f,defaultValue:b})});function eB(a){return""===a||void 0===a}function eC(a){let b=a6(a),c=w.useRef(""),d=w.useRef(0),e=w.useCallback(a=>{let e=c.current+a;b(e),function a(b){c.current=b,window.clearTimeout(d.current),""!==b&&(d.current=window.setTimeout(()=>a(""),1e3))}(e)},[b]),f=w.useCallback(()=>{c.current="",window.clearTimeout(d.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(d.current),[]),[c,e,f]}function eD(a,b,c){var d,e;let f=b.length>1&&Array.from(b).every(a=>a===b[0])?b[0]:b,g=c?a.indexOf(c):-1,h=(d=a,e=Math.max(g,0),d.map((a,b)=>d[(e+b)%d.length]));1===f.length&&(h=h.filter(a=>a!==c));let i=h.find(a=>a.textValue.toLowerCase().startsWith(f.toLowerCase()));return i!==c?i:void 0}eA.displayName="SelectBubbleInput";var eE=c(23339);let eF=(0,eE.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),eG=(0,eE.A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),eH=(0,eE.A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function eI({...a}){return(0,v.jsx)(d_,{"data-slot":"select",...a})}function eJ({...a}){return(0,v.jsx)(d3,{"data-slot":"select-value",...a})}function eK({className:a,size:b="default",children:c,...d}){return(0,v.jsxs)(d1,{"data-slot":"select-trigger","data-size":b,className:aP("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...d,children:[c,(0,v.jsx)(d4,{asChild:!0,children:(0,v.jsx)(eF,{className:"size-4 opacity-50"})})]})}function eL({className:a,children:b,position:c="popper",align:d="center",...e}){return(0,v.jsx)(d5,{children:(0,v.jsxs)(d7,{"data-slot":"select-content",className:aP("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,align:d,...e,children:[(0,v.jsx)(eN,{}),(0,v.jsx)(eh,{className:aP("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:b}),(0,v.jsx)(eO,{})]})})}function eM({className:a,children:b,...c}){return(0,v.jsxs)(ep,{"data-slot":"select-item",className:aP("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...c,children:[(0,v.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,v.jsx)(et,{children:(0,v.jsx)(eG,{className:"size-4"})})}),(0,v.jsx)(er,{children:b})]})}function eN({className:a,...b}){return(0,v.jsx)(ev,{"data-slot":"select-scroll-up-button",className:aP("flex cursor-default items-center justify-center py-1",a),...b,children:(0,v.jsx)(eH,{className:"size-4"})})}function eO({className:a,...b}){return(0,v.jsx)(ex,{"data-slot":"select-scroll-down-button",className:aP("flex cursor-default items-center justify-center py-1",a),...b,children:(0,v.jsx)(eF,{className:"size-4"})})}var eP=a=>{let{present:b,children:c}=a,d=function(a){var b,c;let[d,e]=w.useState(),f=w.useRef(null),g=w.useRef(a),h=w.useRef("none"),[i,j]=(b=a?"mounted":"unmounted",c={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},w.useReducer((a,b)=>c[a][b]??a,b));return w.useEffect(()=>{let a=eQ(f.current);h.current="mounted"===i?a:"none"},[i]),bo(()=>{let b=f.current,c=g.current;if(c!==a){let d=h.current,e=eQ(b);a?j("MOUNT"):"none"===e||b?.display==="none"?j("UNMOUNT"):c&&d!==e?j("ANIMATION_OUT"):j("UNMOUNT"),g.current=a}},[a,j]),bo(()=>{if(d){let a,b=d.ownerDocument.defaultView??window,c=c=>{let e=eQ(f.current).includes(CSS.escape(c.animationName));if(c.target===d&&e&&(j("ANIMATION_END"),!g.current)){let c=d.style.animationFillMode;d.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===d.style.animationFillMode&&(d.style.animationFillMode=c)})}},e=a=>{a.target===d&&(h.current=eQ(f.current))};return d.addEventListener("animationstart",e),d.addEventListener("animationcancel",c),d.addEventListener("animationend",c),()=>{b.clearTimeout(a),d.removeEventListener("animationstart",e),d.removeEventListener("animationcancel",c),d.removeEventListener("animationend",c)}}j("ANIMATION_END")},[d,j]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:w.useCallback(a=>{f.current=a?getComputedStyle(a):null,e(a)},[])}}(b),e="function"==typeof c?c({present:d.isPresent}):w.Children.only(c),f=I(d.ref,function(a){let b=Object.getOwnPropertyDescriptor(a.props,"ref")?.get,c=b&&"isReactWarning"in b&&b.isReactWarning;return c?a.ref:(c=(b=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in b&&b.isReactWarning)?a.props.ref:a.props.ref||a.ref}(e));return"function"==typeof c||d.isPresent?w.cloneElement(e,{ref:f}):null};function eQ(a){return a?.animationName||"none"}eP.displayName="Presence";var eR="Dialog",[eS,eT]=a$(eR),[eU,eV]=eS(eR),eW=a=>{let{__scopeDialog:b,children:c,open:d,defaultOpen:e,onOpenChange:f,modal:g=!0}=a,h=w.useRef(null),i=w.useRef(null),[j,k]=c_({prop:d,defaultProp:e??!1,onChange:f,caller:eR});return(0,v.jsx)(eU,{scope:b,triggerRef:h,contentRef:i,contentId:br(),titleId:br(),descriptionId:br(),open:j,onOpenChange:k,onOpenToggle:w.useCallback(()=>k(a=>!a),[k]),modal:g,children:c})};eW.displayName=eR;var eX="DialogTrigger",eY=w.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=eV(eX,c),f=I(b,e.triggerRef);return(0,v.jsx)(a5.button,{type:"button","aria-haspopup":"dialog","aria-expanded":e.open,"aria-controls":e.contentId,"data-state":ff(e.open),...d,ref:f,onClick:aZ(a.onClick,e.onOpenToggle)})});eY.displayName=eX;var eZ="DialogPortal",[e$,e_]=eS(eZ,{forceMount:void 0}),e0=a=>{let{__scopeDialog:b,forceMount:c,children:d,container:e}=a,f=eV(eZ,b);return(0,v.jsx)(e$,{scope:b,forceMount:c,children:w.Children.map(d,a=>(0,v.jsx)(eP,{present:c||f.open,children:(0,v.jsx)(cZ,{asChild:!0,container:e,children:a})}))})};e0.displayName=eZ;var e1="DialogOverlay",e2=w.forwardRef((a,b)=>{let c=e_(e1,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=eV(e1,a.__scopeDialog);return f.modal?(0,v.jsx)(eP,{present:d||f.open,children:(0,v.jsx)(e4,{...e,ref:b})}):null});e2.displayName=e1;var e3=J("DialogOverlay.RemoveScroll"),e4=w.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=eV(e1,c);return(0,v.jsx)(dN,{as:e3,allowPinchZoom:!0,shards:[e.contentRef],children:(0,v.jsx)(a5.div,{"data-state":ff(e.open),...d,ref:b,style:{pointerEvents:"auto",...d.style}})})}),e5="DialogContent",e6=w.forwardRef((a,b)=>{let c=e_(e5,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=eV(e5,a.__scopeDialog);return(0,v.jsx)(eP,{present:d||f.open,children:f.modal?(0,v.jsx)(e7,{...e,ref:b}):(0,v.jsx)(e8,{...e,ref:b})})});e6.displayName=e5;var e7=w.forwardRef((a,b)=>{let c=eV(e5,a.__scopeDialog),d=w.useRef(null),e=I(b,c.contentRef,d);return w.useEffect(()=>{let a=d.current;if(a)return c8(a)},[]),(0,v.jsx)(e9,{...a,ref:e,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:aZ(a.onCloseAutoFocus,a=>{a.preventDefault(),c.triggerRef.current?.focus()}),onPointerDownOutside:aZ(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;(2===b.button||c)&&a.preventDefault()}),onFocusOutside:aZ(a.onFocusOutside,a=>a.preventDefault())})}),e8=w.forwardRef((a,b)=>{let c=eV(e5,a.__scopeDialog),d=w.useRef(!1),e=w.useRef(!1);return(0,v.jsx)(e9,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(d.current||c.triggerRef.current?.focus(),b.preventDefault()),d.current=!1,e.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(d.current=!0,"pointerdown"===b.detail.originalEvent.type&&(e.current=!0));let f=b.target;c.triggerRef.current?.contains(f)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&e.current&&b.preventDefault()}})}),e9=w.forwardRef((a,b)=>{let{__scopeDialog:c,trapFocus:d,onOpenAutoFocus:e,onCloseAutoFocus:f,...g}=a,h=eV(e5,c),i=w.useRef(null),j=I(b,i);return bd(),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(bi,{asChild:!0,loop:!0,trapped:d,onMountAutoFocus:e,onUnmountAutoFocus:f,children:(0,v.jsx)(a9,{role:"dialog",id:h.contentId,"aria-describedby":h.descriptionId,"aria-labelledby":h.titleId,"data-state":ff(h.open),...g,ref:j,onDismiss:()=>h.onOpenChange(!1)})}),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(fj,{titleId:h.titleId}),(0,v.jsx)(fk,{contentRef:i,descriptionId:h.descriptionId})]})]})}),fa="DialogTitle",fb=w.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=eV(fa,c);return(0,v.jsx)(a5.h2,{id:e.titleId,...d,ref:b})});fb.displayName=fa;var fc="DialogDescription";w.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=eV(fc,c);return(0,v.jsx)(a5.p,{id:e.descriptionId,...d,ref:b})}).displayName=fc;var fd="DialogClose",fe=w.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=eV(fd,c);return(0,v.jsx)(a5.button,{type:"button",...d,ref:b,onClick:aZ(a.onClick,()=>e.onOpenChange(!1))})});function ff(a){return a?"open":"closed"}fe.displayName=fd;var fg="DialogTitleWarning",[fh,fi]=function(a,b){let c=w.createContext(b),d=a=>{let{children:b,...d}=a,e=w.useMemo(()=>d,Object.values(d));return(0,v.jsx)(c.Provider,{value:e,children:b})};return d.displayName=a+"Provider",[d,function(d){let e=w.useContext(c);if(e)return e;if(void 0!==b)return b;throw Error(`\`${d}\` must be used within \`${a}\``)}]}(fg,{contentName:e5,titleName:fa,docsSlug:"dialog"}),fj=({titleId:a})=>{let b=fi(fg),c=`\`${b.contentName}\` requires a \`${b.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${b.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${b.docsSlug}`;return w.useEffect(()=>{a&&(document.getElementById(a)||console.error(c))},[c,a]),null},fk=({contentRef:a,descriptionId:b})=>{let c=fi("DialogDescriptionWarning"),d=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${c.contentName}}.`;return w.useEffect(()=>{let c=a.current?.getAttribute("aria-describedby");b&&c&&(document.getElementById(b)||console.warn(d))},[d,a,b]),null};let fl=(0,eE.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function fm({...a}){return(0,v.jsx)(eW,{"data-slot":"dialog",...a})}function fn({...a}){return(0,v.jsx)(eY,{"data-slot":"dialog-trigger",...a})}function fo({...a}){return(0,v.jsx)(e0,{"data-slot":"dialog-portal",...a})}function fp({...a}){return(0,v.jsx)(fe,{"data-slot":"dialog-close",...a})}function fq({className:a,...b}){return(0,v.jsx)(e2,{"data-slot":"dialog-overlay",className:aP("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function fr({className:a,children:b,showCloseButton:c=!0,...d}){return(0,v.jsxs)(fo,{"data-slot":"dialog-portal",children:[(0,v.jsx)(fq,{}),(0,v.jsxs)(e6,{"data-slot":"dialog-content",className:aP("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...d,children:[b,c&&(0,v.jsxs)(fe,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,v.jsx)(fl,{}),(0,v.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function fs({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"dialog-header",className:aP("flex flex-col gap-2 text-center sm:text-left",a),...b})}function ft({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"dialog-footer",className:aP("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...b})}function fu({className:a,...b}){return(0,v.jsx)(fb,{"data-slot":"dialog-title",className:aP("text-lg leading-none font-semibold",a),...b})}let fv=(0,eE.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),fw=(0,eE.A)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),fx=(0,eE.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var fy=c(14263);let fz=(0,eE.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),fA=(0,eE.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),fB=(0,eE.A)("test-tube-diagonal",[["path",{d:"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3",key:"1ub6xw"}],["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"M12 16H4",key:"1cjfip"}]]),fC=(0,eE.A)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var fD=c(42830),fE=c(85708);let fF=(0,fE.createServerReference)("4077505fad787e7e08d33f9ed94e9c9d3f635581eb",fE.callServer,void 0,fE.findSourceMapURL,"testLLMConnection"),fG=(0,fE.createServerReference)("40872e551770e022325896aa5afeaa55e7ef5b1a6a",fE.callServer,void 0,fE.findSourceMapURL,"debugAzureConnection"),fH=["OpenAI","Azure OpenAI","Anthropic","Google","Mistral"],fI=["gemini-1.5-flash","gemini-pro","gemini-2.5-flash"],fJ=["border-l-sky-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500"];function fK(){let{llmConfigs:a,addLlmConfig:b,updateLlmConfig:c,removeLlmConfig:d,loadLlmConfigs:e}=D(),[f,g]=(0,w.useState)({}),[h,i]=(0,w.useState)({isLoading:!1,logs:[]}),j=(0,w.useRef)(null),k=async(b,d)=>{g(a=>({...a,[b]:"testing"}));let e={...a[d]};"Azure OpenAI"===e.provider&&"entraId"===e.azureAuthMode&&(e.apiKey="");let f=await fF(e);f.success?(c(d,{isValidated:!0}),g(a=>({...a,[b]:"success"})),fD.oR.success("Succ\xe8s",{description:f.message})):(c(d,{isValidated:!1}),g(a=>({...a,[b]:"error"})),fD.oR.error("\xc9chec",{description:f.message}))},l=async b=>{i({isLoading:!0,logs:[]});let c=a[b];i({isLoading:!1,logs:(await fG(c)).logs})};return(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold",children:"\xc9tape 1 : Connectez vos mod\xe8les (LLM)"}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsxs)(aR,{variant:"outline",size:"sm",onClick:()=>{let b="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a,null,2)),c=document.createElement("a");c.setAttribute("href",b),c.setAttribute("download","rfp-studio-config.json"),c.click(),fD.oR.success("Configuration sauvegard\xe9e !")},children:[(0,v.jsx)(fv,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]}),(0,v.jsxs)(aR,{variant:"outline",size:"sm",onClick:()=>j.current?.click(),children:[(0,v.jsx)(fw,{className:"h-4 w-4 mr-2"}),"Charger"]}),(0,v.jsx)("input",{type:"file",ref:j,className:"hidden",accept:".json",onChange:a=>{let b=a.target.files?.[0];if(!b)return;let c=new FileReader;c.onload=a=>{try{let b=a.target?.result,c=JSON.parse(b);e(c),fD.oR.success("Configuration charg\xe9e avec succ\xe8s !")}catch(a){fD.oR.error("Le fichier de configuration est invalide.")}},c.readAsText(b),j.current&&(j.current.value="")}})]})]}),a.map((a,b)=>(0,v.jsxs)(aS,{className:`border-l-4 ${fJ[b%fJ.length]}`,children:[(0,v.jsxs)(aT,{className:"flex flex-row items-center justify-between",children:[(0,v.jsxs)(aU,{className:"text-lg",children:["Configuration LLM #",b+1]}),(0,v.jsx)(aR,{variant:"ghost",size:"icon",onClick:()=>d(b),children:(0,v.jsx)(fx,{className:"h-4 w-4"})})]}),(0,v.jsxs)(aV,{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Fournisseur"}),(0,v.jsxs)(eI,{value:a.provider,onValueChange:a=>c(b,{provider:a,isValidated:!1}),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{placeholder:"Choisir..."})}),(0,v.jsx)(eL,{children:fH.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]}),"Azure OpenAI"===a.provider&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"M\xe9thode d'authentification"}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)(aR,{variant:"entraId"!==a.azureAuthMode?"default":"outline",size:"sm",onClick:()=>c(b,{azureAuthMode:"apiKey",apiKey:a.apiKey}),children:"API Key"}),(0,v.jsx)(aR,{variant:"entraId"===a.azureAuthMode?"default":"outline",size:"sm",onClick:()=>c(b,{azureAuthMode:"entraId"}),children:"Azure Entra ID"})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Endpoint URL"}),(0,v.jsx)(aW,{placeholder:"https://...",value:a.endpoint,onChange:a=>c(b,{endpoint:a.target.value})})]}),"entraId"!==a.azureAuthMode&&(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Cl\xe9 API"}),(0,v.jsx)(aW,{type:"password",value:a.apiKey,onChange:a=>c(b,{apiKey:a.target.value})})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"API Version"}),(0,v.jsx)(aW,{placeholder:"2025-01-01-preview",value:a.apiVersion,onChange:a=>c(b,{apiVersion:a.target.value})})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Deployment Name"}),(0,v.jsx)(aW,{placeholder:"gpt-5-miniRGH",value:a.deployment,onChange:a=>c(b,{deployment:a.target.value})})]})]})]}),"Google"===a.provider&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Cl\xe9 API"}),(0,v.jsx)(aW,{type:"password",value:a.apiKey,onChange:a=>c(b,{apiKey:a.target.value})})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Mod\xe8le"}),(0,v.jsxs)(eI,{value:a.model,onValueChange:a=>c(b,{model:a}),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{})}),(0,v.jsx)(eL,{children:fI.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]})]}),a.provider&&!["Azure OpenAI","Google"].includes(a.provider)&&(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Cl\xe9 API"}),(0,v.jsx)(aW,{type:"password",placeholder:"sk-...",value:a.apiKey,onChange:a=>c(b,{apiKey:a.target.value})})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsxs)(aR,{onClick:()=>k(a.id,b),disabled:!a.provider||"testing"===f[a.id],children:["testing"===f[a.id]&&(0,v.jsx)(fy.A,{className:"mr-2 h-4 w-4 animate-spin"}),"success"===f[a.id]&&(0,v.jsx)(fz,{className:"mr-2 h-4 w-4 text-green-500"}),"error"===f[a.id]&&(0,v.jsx)(fA,{className:"mr-2 h-4 w-4 text-red-500"}),"Tester la connexion"]}),"Azure OpenAI"===a.provider&&(0,v.jsxs)(fm,{children:[(0,v.jsx)(fn,{asChild:!0,children:(0,v.jsxs)(aR,{variant:"outline",onClick:()=>l(b),children:[(0,v.jsx)(fB,{className:"h-4 w-4 mr-2"}),"Advanced Debug"]})}),(0,v.jsxs)(fr,{className:"sm:max-w-[625px]",children:[(0,v.jsx)(fs,{children:(0,v.jsx)(fu,{children:"Journal de D\xe9bogage Azure OpenAI"})}),(0,v.jsxs)("div",{className:"h-96 overflow-y-auto bg-slate-900 text-white font-mono text-xs p-4 rounded-md",children:[h.isLoading&&(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)(fy.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,v.jsx)("span",{children:"Test en cours..."})]}),h.logs.map((a,b)=>(0,v.jsx)("p",{className:`${a.includes("")||a.includes("ERREUR")?"text-red-400":""} ${a.includes("")?"text-green-400":""}`,children:a},b))]}),(0,v.jsx)(ft,{children:(0,v.jsx)(aR,{onClick:()=>i({isLoading:!1,logs:[]}),children:"Fermer"})})]})]})]})]})]},a.id)),(0,v.jsxs)(aR,{variant:"outline",onClick:b,children:[(0,v.jsx)(fC,{className:"mr-2 h-4 w-4"})," Ajouter un mod\xe8le"]})]})}let fL=(0,eE.A)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),fM=(0,eE.A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var fN={};fN.version="0.18.5";var fO=1200,fP=1252,fQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fR={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fS=function(a){-1!=fQ.indexOf(a)&&(fP=fR[0]=a)},fT=function(a){fO=a,fS(a)};function fU(){fT(1200),fS(1252)}function fV(a){for(var b=[],c=0,d=a.length;c<d;++c)b[c]=a.charCodeAt(c);return b}function fW(a){for(var b=[],c=0;c<a.length>>1;++c)b[c]=String.fromCharCode(a.charCodeAt(2*c+1)+(a.charCodeAt(2*c)<<8));return b.join("")}var fX=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);if(255==b&&254==c){for(var d=a.slice(2),e=[],f=0;f<d.length>>1;++f)e[f]=String.fromCharCode(d.charCodeAt(2*f)+(d.charCodeAt(2*f+1)<<8));return e.join("")}return 254==b&&255==c?fW(a.slice(2)):65279==b?a.slice(1):a},fY=function(a){return String.fromCharCode(a)},fZ=function(a){return String.fromCharCode(a)},f$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function f_(a){for(var b="",c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0;j<a.length;)f=(c=a.charCodeAt(j++))>>2,g=(3&c)<<4|(d=a.charCodeAt(j++))>>4,h=(15&d)<<2|(e=a.charCodeAt(j++))>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),b+=f$.charAt(f)+f$.charAt(g)+f$.charAt(h)+f$.charAt(i);return b}function f0(a){var b="",c=0,d=0,e=0,f=0,g=0,h=0;a=a.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<a.length;)b+=String.fromCharCode((e=f$.indexOf(a.charAt(i++)))<<2|(f=f$.indexOf(a.charAt(i++)))>>4),c=(15&f)<<4|(g=f$.indexOf(a.charAt(i++)))>>2,64!==g&&(b+=String.fromCharCode(c)),d=(3&g)<<6|(h=f$.indexOf(a.charAt(i++))),64!==h&&(b+=String.fromCharCode(d));return b}var f1="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,f2=function(){if("undefined"!=typeof Buffer){var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch(b){a=!0}return a?function(a,b){return b?new Buffer(a,b):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}}();function f3(a){return f1?Buffer.alloc?Buffer.alloc(a):new Buffer(a):"undefined"!=typeof Uint8Array?new Uint8Array(a):Array(a)}function f4(a){return f1?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):"undefined"!=typeof Uint8Array?new Uint8Array(a):Array(a)}var f5=function(a){return f1?f2(a,"binary"):a.split("").map(function(a){return 255&a.charCodeAt(0)})};function f6(a){if("undefined"==typeof ArrayBuffer)return f5(a);for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}function f7(a){if(Array.isArray(a))return a.map(function(a){return String.fromCharCode(a)}).join("");for(var b=[],c=0;c<a.length;++c)b[c]=String.fromCharCode(a[c]);return b.join("")}function f8(a){if("undefined"==typeof ArrayBuffer)throw Error("Unsupported");if(a instanceof ArrayBuffer)return f8(new Uint8Array(a));for(var b=Array(a.length),c=0;c<a.length;++c)b[c]=a[c];return b}var f9=f1?function(a){return Buffer.concat(a.map(function(a){return Buffer.isBuffer(a)?a:f2(a)}))}:function(a){if("undefined"!=typeof Uint8Array){var b=0,c=0;for(b=0;b<a.length;++b)c+=a[b].length;var d=new Uint8Array(c),e=0;for(b=0,c=0;b<a.length;c+=e,++b)if(e=a[b].length,a[b]instanceof Uint8Array)d.set(a[b],c);else if("string"==typeof a[b])throw"wtf";else d.set(new Uint8Array(a[b]),c);return d}return[].concat.apply([],a.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))},ga=/\u0000/g,gb=/[\u0001-\u0006]/g;function gc(a){for(var b="",c=a.length-1;c>=0;)b+=a.charAt(c--);return b}function gd(a,b){var c=""+a;return c.length>=b?c:g7("0",b-c.length)+c}function ge(a,b){var c=""+a;return c.length>=b?c:g7(" ",b-c.length)+c}function gf(a,b){var c=""+a;return c.length>=b?c:c+g7(" ",b-c.length)}function gg(a,b){var c,d;return a>0x100000000||a<-0x100000000?(c=""+Math.round(a)).length>=b?c:g7("0",b-c.length)+c:(d=""+Math.round(a)).length>=b?d:g7("0",b-d.length)+d}function gh(a,b){return b=b||0,a.length>=7+b&&(32|a.charCodeAt(b))==103&&(32|a.charCodeAt(b+1))==101&&(32|a.charCodeAt(b+2))==110&&(32|a.charCodeAt(b+3))==101&&(32|a.charCodeAt(b+4))==114&&(32|a.charCodeAt(b+5))==97&&(32|a.charCodeAt(b+6))==108}var gi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gj=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],gk={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gl={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gm={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gn(a,b,c){for(var d=a<0?-1:1,e=a*d,f=0,g=1,h=0,i=1,j=0,k=0,l=Math.floor(e);j<b&&(h=(l=Math.floor(e))*g+f,k=l*j+i,!(e-l<5e-8));)e=1/(e-l),f=g,g=h,i=j,j=k;if(k>b&&(j>b?(k=i,h=f):(k=j,h=g)),!c)return[0,d*h,k];var m=Math.floor(d*h/k);return[m,d*h-m*k,k]}function go(a,b,c){if(a>2958465||a<0)return null;var d=0|a,e=Math.floor(86400*(a-d)),f=0,g=[],h={D:d,T:e,u:86400*(a-d)-e,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(h.u)&&(h.u=0),b&&b.date1904&&(d+=1462),h.u>.9999&&(h.u=0,86400==++e&&(h.T=e=0,++d,++h.D)),60===d)g=c?[1317,10,29]:[1900,2,29],f=3;else if(0===d)g=c?[1317,8,29]:[1900,1,0],f=6;else{d>60&&--d;var i,j,k,l=new Date(1900,0,1);l.setDate(l.getDate()+d-1),g=[l.getFullYear(),l.getMonth()+1,l.getDate()],f=l.getDay(),d<60&&(f=(f+6)%7),c&&(i=l,j=g,j[0]-=581,k=i.getDay(),i<60&&(k=(k+6)%7),f=k)}return h.y=g[0],h.m=g[1],h.d=g[2],h.S=e%60,h.M=(e=Math.floor(e/60))%60,h.H=e=Math.floor(e/60),h.q=f,h}var gp=new Date(1899,11,31,0,0,0),gq=gp.getTime(),gr=new Date(1900,2,1,0,0,0);function gs(a,b){var c=a.getTime();return b?c-=1262304e5:a>=gr&&(c+=864e5),(c-(gq+(a.getTimezoneOffset()-gp.getTimezoneOffset())*6e4))/864e5}function gt(a){return -1==a.indexOf(".")?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gu(a){var b,c,d,e,f,g=Math.floor(Math.log(Math.abs(a))*Math.LOG10E);return g>=-4&&g<=-1?f=a.toPrecision(10+g):9>=Math.abs(g)?(b=a<0?12:11,f=(c=gt(a.toFixed(12))).length<=b||(c=a.toPrecision(10)).length<=b?c:a.toExponential(5)):f=10===g?a.toFixed(10).substr(0,12):(d=gt(a.toFixed(11))).length>(a<0?12:11)||"0"===d||"-0"===d?a.toPrecision(6):d,gt(-1==(e=f.toUpperCase()).indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function gv(a,b){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(0|a)===a?a.toString(10):gu(a);case"undefined":return"";case"object":if(null==a)return"";if(a instanceof Date)return gK(14,gs(a,b&&b.date1904),b)}throw Error("unsupported value in General format: "+a)}function gw(a){if(a.length<=3)return a;for(var b=a.length%3,c=a.substr(0,b);b!=a.length;b+=3)c+=(c.length>0?",":"")+a.substr(b,3);return c}var gx=/%/g,gy=/# (\?+)( ?)\/( ?)(\d+)/,gz=/^#*0*\.([0#]+)/,gA=/\).*[0#]/,gB=/\(###\) ###\\?-####/;function gC(a){for(var b,c="",d=0;d!=a.length;++d)switch(b=a.charCodeAt(d)){case 35:break;case 63:c+=" ";break;case 48:c+="0";break;default:c+=String.fromCharCode(b)}return c}function gD(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c}function gE(a,b){var c=a-Math.floor(a),d=Math.pow(10,b);return b<(""+Math.round(c*d)).length?0:Math.round(c*d)}function gF(a,b,c){return(0|c)===c?function a(b,c,d){if(40===b.charCodeAt(0)&&!c.match(gA)){var e,f=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return d>=0?a("n",f,d):"("+a("n",f,-d)+")"}if(44===c.charCodeAt(c.length-1)){for(var g=c,h=g.length-1;44===g.charCodeAt(h-1);)--h;return gF(b,g.substr(0,h),d/Math.pow(10,3*(g.length-h)))}if(-1!==c.indexOf("%"))return j=(i=c).replace(gx,""),k=i.length-j.length,gF(b,j,d*Math.pow(10,2*k))+g7("%",k);if(-1!==c.indexOf("E"))return function a(b,c){var d,e=b.indexOf("E")-b.indexOf(".")-1;if(b.match(/^#+0.0E\+0$/)){if(0==c)return"0.0E+0";if(c<0)return"-"+a(b,-c);var f=b.indexOf(".");-1===f&&(f=b.indexOf("E"));var g=Math.floor(Math.log(c)*Math.LOG10E)%f;if(g<0&&(g+=f),!(d=(c/Math.pow(10,g)).toPrecision(e+1+(f+g)%f)).match(/[Ee]/)){var h=Math.floor(Math.log(c)*Math.LOG10E);-1===d.indexOf(".")?d=d.charAt(0)+"."+d.substr(1)+"E+"+(h-d.length+g):d+="E+"+(h-g),d=d.replace(/\+-/,"-")}d=d.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,b,c,d){return b+c+d.substr(0,(f+g)%f)+"."+d.substr(g)+"E"})}else d=c.toExponential(e);return b.match(/E\+00$/)&&d.match(/e[+-]\d$/)&&(d=d.substr(0,d.length-1)+"0"+d.charAt(d.length-1)),b.match(/E\-/)&&d.match(/e\+/)&&(d=d.replace(/e\+/,"e")),d.replace("e","E")}(c,d);if(36===c.charCodeAt(0))return"$"+a(b,c.substr(" "==c.charAt(1)?2:1),d);var i,j,k,l,m,n,o,p=Math.abs(d),q=d<0?"-":"";if(c.match(/^00+$/))return q+gd(p,c.length);if(c.match(/^[#?]+$/))return l=""+d,0===d&&(l=""),l.length>c.length?l:gC(c.substr(0,c.length-l.length))+l;if(m=c.match(gy))return q+(0===p?"":""+p)+g7(" ",(e=m)[1].length+2+e[4].length);if(c.match(/^#+0+$/))return q+gd(p,c.length-c.indexOf("0"));if(m=c.match(gz))return l=(l=(""+d).replace(/^([^\.]+)$/,"$1."+gC(m[1])).replace(/\.$/,"."+gC(m[1]))).replace(/\.(\d*)$/,function(a,b){return"."+b+g7("0",gC(m[1]).length-b.length)}),-1!==c.indexOf("0.")?l:l.replace(/^0\./,".");if(m=(c=c.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return q+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,m[1].length?"0.":".");if(m=c.match(/^#{1,3},##0(\.?)$/))return q+gw(""+p);if(m=c.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+a(b,c,-d):gw(""+d)+"."+g7("0",m[1].length);if(m=c.match(/^#,#*,#0/))return a(b,c.replace(/^#,#*,/,""),d);if(m=c.match(/^([0#]+)(\\?-([0#]+))+$/))return l=gc(a(b,c.replace(/[\\-]/g,""),d)),n=0,gc(gc(c.replace(/\\/g,"")).replace(/[0#]/g,function(a){return n<l.length?l.charAt(n++):"0"===a?"0":""}));if(c.match(gB))return"("+(l=a(b,"##########",d)).substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var r="";if(m=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=gn(p,Math.pow(10,n=Math.min(m[4].length,7))-1,!1),l=""+q," "==(r=gF("n",m[1],o[1])).charAt(r.length-1)&&(r=r.substr(0,r.length-1)+"0"),l+=r+m[2]+"/"+m[3],(r=gf(o[2],n)).length<m[4].length&&(r=gC(m[4].substr(m[4].length-r.length))+r),l+=r;if(m=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return q+((o=gn(p,Math.pow(10,n=Math.min(Math.max(m[1].length,m[4].length),7))-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?ge(o[1],n)+m[2]+"/"+m[3]+gf(o[2],n):g7(" ",2*n+1+m[2].length+m[3].length));if(m=c.match(/^[#0?]+$/))return(l=""+d,c.length<=l.length)?l:gC(c.substr(0,c.length-l.length))+l;if(m=c.match(/^([#0]+)\.([#0]+)$/)){n=(l=""+d.toFixed(Math.min(m[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var s=c.indexOf(".")-n,t=c.length-l.length-s;return gC(c.substr(0,s)+l+c.substr(c.length-t))}if(m=c.match(/^00,000\.([#0]*0)$/))return d<0?"-"+a(b,c,-d):gw(""+d).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(a){return"00,"+(a.length<3?gd(0,3-a.length):"")+a})+"."+gd(0,m[1].length);switch(c){case"###,###":case"##,###":case"#,###":var u=gw(""+p);return"0"!==u?q+u:"";default:if(c.match(/\.[0#?]*$/))return a(b,c.slice(0,c.lastIndexOf(".")),d)+gC(c.slice(c.lastIndexOf(".")))}throw Error("unsupported format |"+c+"|")}(a,b,c):function a(b,c,d){if(40===b.charCodeAt(0)&&!c.match(gA)){var e,f,g,h,i,j,k=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return d>=0?a("n",k,d):"("+a("n",k,-d)+")"}if(44===c.charCodeAt(c.length-1)){for(var l=c,m=l.length-1;44===l.charCodeAt(m-1);)--m;return gF(b,l.substr(0,m),d/Math.pow(10,3*(l.length-m)))}if(-1!==c.indexOf("%"))return o=(n=c).replace(gx,""),p=n.length-o.length,gF(b,o,d*Math.pow(10,2*p))+g7("%",p);if(-1!==c.indexOf("E"))return function a(b,c){var d,e=b.indexOf("E")-b.indexOf(".")-1;if(b.match(/^#+0.0E\+0$/)){if(0==c)return"0.0E+0";if(c<0)return"-"+a(b,-c);var f=b.indexOf(".");-1===f&&(f=b.indexOf("E"));var g=Math.floor(Math.log(c)*Math.LOG10E)%f;if(g<0&&(g+=f),-1===(d=(c/Math.pow(10,g)).toPrecision(e+1+(f+g)%f)).indexOf("e")){var h=Math.floor(Math.log(c)*Math.LOG10E);for(-1===d.indexOf(".")?d=d.charAt(0)+"."+d.substr(1)+"E+"+(h-d.length+g):d+="E+"+(h-g);"0."===d.substr(0,2);)d=(d=d.charAt(0)+d.substr(2,f)+"."+d.substr(2+f)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");d=d.replace(/\+-/,"-")}d=d.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,b,c,d){return b+c+d.substr(0,(f+g)%f)+"."+d.substr(g)+"E"})}else d=c.toExponential(e);return b.match(/E\+00$/)&&d.match(/e[+-]\d$/)&&(d=d.substr(0,d.length-1)+"0"+d.charAt(d.length-1)),b.match(/E\-/)&&d.match(/e\+/)&&(d=d.replace(/e\+/,"e")),d.replace("e","E")}(c,d);if(36===c.charCodeAt(0))return"$"+a(b,c.substr(" "==c.charAt(1)?2:1),d);var n,o,p,q,r,s,t,u=Math.abs(d),v=d<0?"-":"";if(c.match(/^00+$/))return v+gg(u,c.length);if(c.match(/^[#?]+$/))return"0"===(q=gg(d,0))&&(q=""),q.length>c.length?q:gC(c.substr(0,c.length-q.length))+q;if(r=c.match(gy))return h=Math.floor((g=Math.round(u*(f=parseInt((e=r)[4],10))))/f),i=g-h*f,v+(0===h?"":""+h)+" "+(0===i?g7(" ",e[1].length+1+e[4].length):ge(i,e[1].length)+e[2]+"/"+e[3]+gd(f,e[4].length));if(c.match(/^#+0+$/))return v+gg(u,c.length-c.indexOf("0"));if(r=c.match(gz))return q=gD(d,r[1].length).replace(/^([^\.]+)$/,"$1."+gC(r[1])).replace(/\.$/,"."+gC(r[1])).replace(/\.(\d*)$/,function(a,b){return"."+b+g7("0",gC(r[1]).length-b.length)}),-1!==c.indexOf("0.")?q:q.replace(/^0\./,".");if(r=(c=c.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return v+gD(u,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=c.match(/^#{1,3},##0(\.?)$/))return v+gw(gg(u,0));if(r=c.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+a(b,c,-d):gw(""+(Math.floor(d)+ +((j=r[1].length)<(""+Math.round((d-Math.floor(d))*Math.pow(10,j))).length)))+"."+gd(gE(d,r[1].length),r[1].length);if(r=c.match(/^#,#*,#0/))return a(b,c.replace(/^#,#*,/,""),d);if(r=c.match(/^([0#]+)(\\?-([0#]+))+$/))return q=gc(a(b,c.replace(/[\\-]/g,""),d)),s=0,gc(gc(c.replace(/\\/g,"")).replace(/[0#]/g,function(a){return s<q.length?q.charAt(s++):"0"===a?"0":""}));if(c.match(gB))return"("+(q=a(b,"##########",d)).substr(0,3)+") "+q.substr(3,3)+"-"+q.substr(6);var w="";if(r=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return t=gn(u,Math.pow(10,s=Math.min(r[4].length,7))-1,!1),q=""+v," "==(w=gF("n",r[1],t[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),q+=w+r[2]+"/"+r[3],(w=gf(t[2],s)).length<r[4].length&&(w=gC(r[4].substr(r[4].length-w.length))+w),q+=w;if(r=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v+((t=gn(u,Math.pow(10,s=Math.min(Math.max(r[1].length,r[4].length),7))-1,!0))[0]||(t[1]?"":"0"))+" "+(t[1]?ge(t[1],s)+r[2]+"/"+r[3]+gf(t[2],s):g7(" ",2*s+1+r[2].length+r[3].length));if(r=c.match(/^[#0?]+$/))return(q=gg(d,0),c.length<=q.length)?q:gC(c.substr(0,c.length-q.length))+q;if(r=c.match(/^([#0?]+)\.([#0]+)$/)){s=(q=""+d.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var x=c.indexOf(".")-s,y=c.length-q.length-x;return gC(c.substr(0,x)+q+c.substr(c.length-y))}if(r=c.match(/^00,000\.([#0]*0)$/))return s=gE(d,r[1].length),d<0?"-"+a(b,c,-d):gw(d<0x7fffffff&&d>-0x80000000?""+(d>=0?0|d:d-1|0):""+Math.floor(d)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(a){return"00,"+(a.length<3?gd(0,3-a.length):"")+a})+"."+gd(s,r[1].length);switch(c){case"###,##0.00":return a(b,"#,##0.00",d);case"###,###":case"##,###":case"#,###":var z=gw(gg(u,0));return"0"!==z?v+z:"";case"###,###.00":return a(b,"###,##0.00",d).replace(/^0\./,".");case"#,###.00":return a(b,"#,##0.00",d).replace(/^0\./,".")}throw Error("unsupported format |"+c+"|")}(a,b,c)}var gG=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function gH(a){for(var b=0,c="",d="";b<a.length;)switch(c=a.charAt(b)){case"G":gh(a,b)&&(b+=6),b++;break;case'"':for(;34!==a.charCodeAt(++b)&&b<a.length;);++b;break;case"\\":case"_":b+=2;break;case"@":++b;break;case"B":case"b":if("1"===a.charAt(b+1)||"2"===a.charAt(b+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if("A/P"===a.substr(b,3).toUpperCase()||"AM/PM"===a.substr(b,5).toUpperCase()||"/"===a.substr(b,5).toUpperCase())return!0;++b;break;case"[":for(d=c;"]"!==a.charAt(b++)&&b<a.length;)d+=a.charAt(b);if(d.match(gG))return!0;break;case".":case"0":case"#":for(;b<a.length&&("0#?.,E+-%".indexOf(c=a.charAt(++b))>-1||"\\"==c&&"-"==a.charAt(b+1)&&"0#".indexOf(a.charAt(b+2))>-1););break;case"?":for(;a.charAt(++b)===c;);break;case"*":++b,(" "==a.charAt(b)||"*"==a.charAt(b))&&++b;break;case"(":case")":case" ":default:++b;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;b<a.length&&"0123456789".indexOf(a.charAt(++b))>-1;);}return!1}var gI=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gJ(a,b){if(null==b)return!1;var c=parseFloat(b[2]);switch(b[1]){case"=":if(a==c)return!0;break;case">":if(a>c)return!0;break;case"<":if(a<c)return!0;break;case"<>":if(a!=c)return!0;break;case">=":if(a>=c)return!0;break;case"<=":if(a<=c)return!0}return!1}function gK(a,b,c){null==c&&(c={});var d="";switch(typeof a){case"string":d="m/d/yy"==a&&c.dateNF?c.dateNF:a;break;case"number":null==(d=14==a&&c.dateNF?c.dateNF:(null!=c.table?c.table:gk)[a])&&(d=c.table&&c.table[gl[a]]||gk[gl[a]]),null==d&&(d=gm[a]||"General")}if(gh(d,0))return gv(b,c);b instanceof Date&&(b=gs(b,c.date1904));var e=function(a,b){var c=function(a){for(var b=[],c=!1,d=0,e=0;d<a.length;++d)switch(a.charCodeAt(d)){case 34:c=!c;break;case 95:case 42:case 92:++d;break;case 59:b[b.length]=a.substr(e,d-e),e=d+1}if(b[b.length]=a.substr(e),!0===c)throw Error("Format |"+a+"| unterminated string ");return b}(a),d=c.length,e=c[d-1].indexOf("@");if(d<4&&e>-1&&--d,c.length>4)throw Error("cannot find right format for |"+c.join("|")+"|");if("number"!=typeof b)return[4,4===c.length||e>-1?c[c.length-1]:"@"];switch(c.length){case 1:c=e>-1?["General","General","General",c[0]]:[c[0],c[0],c[0],"@"];break;case 2:c=e>-1?[c[0],c[0],c[0],c[1]]:[c[0],c[1],c[0],"@"];break;case 3:c=e>-1?[c[0],c[1],c[0],c[2]]:[c[0],c[1],c[2],"@"]}var f=b>0?c[0]:b<0?c[1]:c[2];if(-1===c[0].indexOf("[")&&-1===c[1].indexOf("["))return[d,f];if(null!=c[0].match(/\[[=<>]/)||null!=c[1].match(/\[[=<>]/)){var g=c[0].match(gI),h=c[1].match(gI);return gJ(b,g)?[d,c[0]]:gJ(b,h)?[d,c[1]]:[d,c[null!=g&&null!=h?2:1]]}return[d,f]}(d,b);if(gh(e[1]))return gv(b,c);if(!0===b)b="TRUE";else if(!1===b)b="FALSE";else if(""===b||null==b)return"";return function(a,b,c,d){for(var e,f,g,h=[],i="",j=0,k="",l="t",m="H";j<a.length;)switch(k=a.charAt(j)){case"G":if(!gh(a,j))throw Error("unrecognized character "+k+" in "+a);h[h.length]={t:"G",v:"General"},j+=7;break;case'"':for(i="";34!==(g=a.charCodeAt(++j))&&j<a.length;)i+=String.fromCharCode(g);h[h.length]={t:"t",v:i},++j;break;case"\\":var n=a.charAt(++j),o="("===n||")"===n?n:"t";h[h.length]={t:o,v:n},++j;break;case"_":h[h.length]={t:"t",v:" "},j+=2;break;case"@":h[h.length]={t:"T",v:b},++j;break;case"B":case"b":if("1"===a.charAt(j+1)||"2"===a.charAt(j+1)){if(null==e&&null==(e=go(b,c,"2"===a.charAt(j+1))))return"";h[h.length]={t:"X",v:a.substr(j,2)},l=k,j+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":k=k.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(b<0||null==e&&null==(e=go(b,c)))return"";for(i=k;++j<a.length&&a.charAt(j).toLowerCase()===k;)i+=k;"m"===k&&"h"===l.toLowerCase()&&(k="M"),"h"===k&&(k=m),h[h.length]={t:k,v:i},l=k;break;case"A":case"a":case"":var p={t:k,v:k};if(null==e&&(e=go(b,c)),"A/P"===a.substr(j,3).toUpperCase()?(null!=e&&(p.v=e.H>=12?"P":"A"),p.t="T",m="h",j+=3):"AM/PM"===a.substr(j,5).toUpperCase()?(null!=e&&(p.v=e.H>=12?"PM":"AM"),p.t="T",j+=5,m="h"):"/"===a.substr(j,5).toUpperCase()?(null!=e&&(p.v=e.H>=12?"":""),p.t="T",j+=5,m="h"):(p.t="t",++j),null==e&&"T"===p.t)return"";h[h.length]=p,l=k;break;case"[":for(i=k;"]"!==a.charAt(j++)&&j<a.length;)i+=a.charAt(j);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(gG)){if(null==e&&null==(e=go(b,c)))return"";h[h.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",gH(a)||(h[h.length]={t:"t",v:i}));break;case".":if(null!=e){for(i=k;++j<a.length&&"0"===(k=a.charAt(j));)i+=k;h[h.length]={t:"s",v:i};break}case"0":case"#":for(i=k;++j<a.length&&"0#?.,E+-%".indexOf(k=a.charAt(j))>-1;)i+=k;h[h.length]={t:"n",v:i};break;case"?":for(i=k;a.charAt(++j)===k;)i+=k;h[h.length]={t:k,v:i},l=k;break;case"*":++j,(" "==a.charAt(j)||"*"==a.charAt(j))&&++j;break;case"(":case")":h[h.length]={t:1===d?"t":k,v:k},++j;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=k;j<a.length&&"0123456789".indexOf(a.charAt(++j))>-1;)i+=a.charAt(j);h[h.length]={t:"D",v:i};break;case" ":h[h.length]={t:k,v:k},++j;break;case"$":h[h.length]={t:"t",v:"$"},++j;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(k))throw Error("unrecognized character "+k+" in "+a);h[h.length]={t:"t",v:k},++j}var q,r=0,s=0;for(j=h.length-1,l="t";j>=0;--j)switch(h[j].t){case"h":case"H":h[j].t=m,l="h",r<1&&(r=1);break;case"s":(q=h[j].v.match(/\.0+$/))&&(s=Math.max(s,q[0].length-1)),r<3&&(r=3);case"d":case"y":case"M":case"e":l=h[j].t;break;case"m":"s"===l&&(h[j].t="M",r<2&&(r=2));break;case"X":break;case"Z":r<1&&h[j].v.match(/[Hh]/)&&(r=1),r<2&&h[j].v.match(/[Mm]/)&&(r=2),r<3&&h[j].v.match(/[Ss]/)&&(r=3)}switch(r){case 0:break;case 1:e.u>=.5&&(e.u=0,++e.S),e.S>=60&&(e.S=0,++e.M),e.M>=60&&(e.M=0,++e.H);break;case 2:e.u>=.5&&(e.u=0,++e.S),e.S>=60&&(e.S=0,++e.M)}var t,u="";for(j=0;j<h.length;++j)switch(h[j].t){case"t":case"T":case" ":case"D":break;case"X":h[j].v="",h[j].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":h[j].v=function(a,b,c,d){var e,f="",g=0,h=0,i=c.y,j=0;switch(a){case 98:i=c.y+543;case 121:switch(b.length){case 1:case 2:e=i%100,j=2;break;default:e=i%1e4,j=4}break;case 109:switch(b.length){case 1:case 2:e=c.m,j=b.length;break;case 3:return gj[c.m-1][1];case 5:return gj[c.m-1][0];default:return gj[c.m-1][2]}break;case 100:switch(b.length){case 1:case 2:e=c.d,j=b.length;break;case 3:return gi[c.q][0];default:return gi[c.q][1]}break;case 104:switch(b.length){case 1:case 2:e=1+(c.H+11)%12,j=b.length;break;default:throw"bad hour format: "+b}break;case 72:switch(b.length){case 1:case 2:e=c.H,j=b.length;break;default:throw"bad hour format: "+b}break;case 77:switch(b.length){case 1:case 2:e=c.M,j=b.length;break;default:throw"bad minute format: "+b}break;case 115:if("s"!=b&&"ss"!=b&&".0"!=b&&".00"!=b&&".000"!=b)throw"bad second format: "+b;if(0===c.u&&("s"==b||"ss"==b))return gd(c.S,b.length);if((g=Math.round((h=d>=2?3===d?1e3:100:1===d?10:1)*(c.S+c.u)))>=60*h&&(g=0),"s"===b)return 0===g?"0":""+g/h;if(f=gd(g,2+d),"ss"===b)return f.substr(0,2);return"."+f.substr(2,b.length-1);case 90:switch(b){case"[h]":case"[hh]":e=24*c.D+c.H;break;case"[m]":case"[mm]":e=(24*c.D+c.H)*60+c.M;break;case"[s]":case"[ss]":e=((24*c.D+c.H)*60+c.M)*60+Math.round(c.S+c.u);break;default:throw"bad abstime format: "+b}j=3===b.length?1:2;break;case 101:e=i,j=1}return j>0?gd(e,j):""}(h[j].t.charCodeAt(0),h[j].v,e,s),h[j].t="t";break;case"n":case"?":for(t=j+1;null!=h[t]&&("?"===(k=h[t].t)||"D"===k||(" "===k||"t"===k)&&null!=h[t+1]&&("?"===h[t+1].t||"t"===h[t+1].t&&"/"===h[t+1].v)||"("===h[j].t&&(" "===k||"n"===k||")"===k)||"t"===k&&("/"===h[t].v||" "===h[t].v&&null!=h[t+1]&&"?"==h[t+1].t));)h[j].v+=h[t].v,h[t]={v:"",t:";"},++t;u+=h[j].v,j=t-1;break;case"G":h[j].t="t",h[j].v=gv(b,c)}var v,w,x="";if(u.length>0){40==u.charCodeAt(0)?(v=b<0&&45===u.charCodeAt(0)?-b:b,w=gF("n",u,v)):(w=gF("n",u,v=b<0&&d>1?-b:b),v<0&&h[0]&&"t"==h[0].t&&(w=w.substr(1),h[0].v="-"+h[0].v)),t=w.length-1;var y=h.length;for(j=0;j<h.length;++j)if(null!=h[j]&&"t"!=h[j].t&&h[j].v.indexOf(".")>-1){y=j;break}var z=h.length;if(y===h.length&&-1===w.indexOf("E")){for(j=h.length-1;j>=0;--j)null!=h[j]&&-1!=="n?".indexOf(h[j].t)&&(t>=h[j].v.length-1?(t-=h[j].v.length,h[j].v=w.substr(t+1,h[j].v.length)):t<0?h[j].v="":(h[j].v=w.substr(0,t+1),t=-1),h[j].t="t",z=j);t>=0&&z<h.length&&(h[z].v=w.substr(0,t+1)+h[z].v)}else if(y!==h.length&&-1===w.indexOf("E")){for(t=w.indexOf(".")-1,j=y;j>=0;--j)if(null!=h[j]&&-1!=="n?".indexOf(h[j].t)){for(f=h[j].v.indexOf(".")>-1&&j===y?h[j].v.indexOf(".")-1:h[j].v.length-1,x=h[j].v.substr(f+1);f>=0;--f)t>=0&&("0"===h[j].v.charAt(f)||"#"===h[j].v.charAt(f))&&(x=w.charAt(t--)+x);h[j].v=x,h[j].t="t",z=j}for(t>=0&&z<h.length&&(h[z].v=w.substr(0,t+1)+h[z].v),t=w.indexOf(".")+1,j=y;j<h.length;++j)if(null!=h[j]&&(-1!=="n?(".indexOf(h[j].t)||j===y)){for(f=h[j].v.indexOf(".")>-1&&j===y?h[j].v.indexOf(".")+1:0,x=h[j].v.substr(0,f);f<h[j].v.length;++f)t<w.length&&(x+=w.charAt(t++));h[j].v=x,h[j].t="t",z=j}}}for(j=0;j<h.length;++j)null!=h[j]&&"n?".indexOf(h[j].t)>-1&&(v=d>1&&b<0&&j>0&&"-"===h[j-1].v?-b:b,h[j].v=gF(h[j].t,h[j].v,v),h[j].t="t");var A="";for(j=0;j!==h.length;++j)null!=h[j]&&(A+=h[j].v);return A}(e[1],b,c,e[0])}function gL(a,b){if("number"!=typeof b){b=+b||-1;for(var c=0;c<392;++c){if(void 0==gk[c]){b<0&&(b=c);continue}if(gk[c]==a){b=c;break}}b<0&&(b=391)}return gk[b]=a,b}function gM(a){for(var b=0;392!=b;++b)void 0!==a[b]&&gL(a[b],b)}function gN(){var a;a||(a={}),a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',gk=a}var gO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,gQ=function(){var a={};a.version="1.2.0";var b=function(){for(var a=0,b=Array(256),c=0;256!=c;++c)a=1&(a=1&(a=1&(a=1&(a=1&(a=1&(a=1&(a=1&(a=c)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1)?-0x12477ce0^a>>>1:a>>>1,b[c]=a;return"undefined"!=typeof Int32Array?new Int32Array(b):b}(),c=function(a){var b=0,c=0,d=0,e="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(d=0;256!=d;++d)e[d]=a[d];for(d=0;256!=d;++d)for(c=a[d],b=256+d;b<4096;b+=256)c=e[b]=c>>>8^a[255&c];var f=[];for(d=1;16!=d;++d)f[d-1]="undefined"!=typeof Int32Array?e.subarray(256*d,256*d+256):e.slice(256*d,256*d+256);return f}(b),d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14];return a.table=b,a.bstr=function(a,c){for(var d=-1^c,e=0,f=a.length;e<f;)d=d>>>8^b[(d^a.charCodeAt(e++))&255];return~d},a.buf=function(a,c){for(var s=-1^c,t=a.length-15,u=0;u<t;)s=r[a[u++]^255&s]^q[a[u++]^s>>8&255]^p[a[u++]^s>>16&255]^o[a[u++]^s>>>24]^n[a[u++]]^m[a[u++]]^l[a[u++]]^k[a[u++]]^j[a[u++]]^i[a[u++]]^h[a[u++]]^g[a[u++]]^f[a[u++]]^e[a[u++]]^d[a[u++]]^b[a[u++]];for(t+=15;u<t;)s=s>>>8^b[(s^a[u++])&255];return~s},a.str=function(a,c){for(var d=-1^c,e=0,f=a.length,g=0,h=0;e<f;)(g=a.charCodeAt(e++))<128?d=d>>>8^b[(d^g)&255]:g<2048?d=(d=d>>>8^b[(d^(192|g>>6&31))&255])>>>8^b[(d^(128|63&g))&255]:g>=55296&&g<57344?(g=(1023&g)+64,h=1023&a.charCodeAt(e++),d=(d=(d=(d=d>>>8^b[(d^(240|g>>8&7))&255])>>>8^b[(d^(128|g>>2&63))&255])>>>8^b[(d^(128|h>>6&15|(3&g)<<4))&255])>>>8^b[(d^(128|63&h))&255]):d=(d=(d=d>>>8^b[(d^(224|g>>12&15))&255])>>>8^b[(d^(128|g>>6&63))&255])>>>8^b[(d^(128|63&g))&255];return~d},a}(),gR=function(){var a,b,c={};function d(a){if("/"==a.charAt(a.length-1))return -1===a.slice(0,-1).indexOf("/")?a:d(a.slice(0,-1));var b=a.lastIndexOf("/");return -1===b?a:a.slice(0,b+1)}function e(a){if("/"==a.charAt(a.length-1))return e(a.slice(0,-1));var b=a.lastIndexOf("/");return -1===b?a:a.slice(b+1)}function f(a){iy(a,0);for(var b={},c=0;a.l<=a.length-4;){var d=a.read_shift(2),e=a.read_shift(2),f=a.l+e,g={};21589===d&&(1&(c=a.read_shift(1))&&(g.mtime=a.read_shift(4)),e>5&&(2&c&&(g.atime=a.read_shift(4)),4&c&&(g.ctime=a.read_shift(4))),g.mtime&&(g.mt=new Date(1e3*g.mtime))),a.l=f,b[d]=g}return b}function g(){return a||(a={})}function h(a,b){if(80==a[0]&&75==a[1])return Y(a,b);if((32|a[0])==109&&(32|a[1])==105)return function(a,b){if("mime-version:"!=s(a.slice(0,13)).toLowerCase())throw Error("Unsupported MAD header");var c=b&&b.root||"",d=(f1&&Buffer.isBuffer(a)?a.toString("binary"):s(a)).split("\r\n"),e=0,f="";for(e=0;e<d.length;++e)if((f=d[e],/^Content-Location:/i.test(f))&&(f=f.slice(f.indexOf("file")),c||(c=f.slice(0,f.lastIndexOf("/")+1)),f.slice(0,c.length)!=c))for(;c.length>0&&(c=(c=c.slice(0,c.length-1)).slice(0,c.lastIndexOf("/")+1),f.slice(0,c.length)!=c););var g=(d[1]||"").match(/boundary="(.*?)"/);if(!g)throw Error("MAD cannot find boundary");var h="--"+(g[1]||""),i={FileIndex:[],FullPaths:[]};j(i);var k,l=0;for(e=0;e<d.length;++e){var m=d[e];(m===h||m===h+"--")&&(l++&&function(a,b,c){for(var d,e="",f="",g="",h=0;h<10;++h){var i=b[h];if(!i||i.match(/^\s*$/))break;var j=i.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":e=j[2].trim();break;case"content-type":g=j[2].trim();break;case"content-transfer-encoding":f=j[2].trim()}}switch(++h,f.toLowerCase()){case"base64":d=f5(f0(b.slice(h).join("")));break;case"quoted-printable":d=function(a){for(var b=[],c=0;c<a.length;++c){for(var d=a[c];c<=a.length&&"="==d.charAt(d.length-1);)d=d.slice(0,d.length-1)+a[++c];b.push(d)}for(var e=0;e<b.length;++e)b[e]=b[e].replace(/[=][0-9A-Fa-f]{2}/g,function(a){return String.fromCharCode(parseInt(a.slice(1),16))});return f5(b.join("\r\n"))}(b.slice(h));break;default:throw Error("Unsupported Content-Transfer-Encoding "+f)}var k=_(a,e.slice(c.length),d,{unsafe:!0});g&&(k.ctype=g)}(i,d.slice(k,e),c),k=e)}return i}(a,b);if(a.length<512)throw Error("CFB file size "+a.length+" < 512");var c=3,d=512,e=0,f=0,g=0,h=0,k=0,l=[],p=a.slice(0,512);iy(p,0);var q=function(a){if(80==a[a.l]&&75==a[a.l+1])return[0,0];a.chk(o,"Header Signature: "),a.l+=16;var b=a.read_shift(2,"u");return[a.read_shift(2,"u"),b]}(p);switch(c=q[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==q[1])return Y(a,b);default:throw Error("Major Version: Expected 3 or 4 saw "+c)}512!==d&&iy(p=a.slice(0,d),28);var r=a.slice(0,d),t=p,u=c,v=9;switch(t.l+=2,v=t.read_shift(2)){case 9:if(3!=u)throw Error("Sector Shift: Expected 9 saw "+v);break;case 12:if(4!=u)throw Error("Sector Shift: Expected 12 saw "+v);break;default:throw Error("Sector Shift: Expected 9 or 12 saw "+v)}t.chk("0600","Mini Sector Shift: "),t.chk("000000000000","Reserved: ");var w=p.read_shift(4,"i");if(3===c&&0!==w)throw Error("# Directory Sectors: Expected 0 saw "+w);p.l+=4,g=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),h=p.read_shift(4,"i"),e=p.read_shift(4,"i"),k=p.read_shift(4,"i"),f=p.read_shift(4,"i");for(var x=-1,y=0;y<109&&!((x=p.read_shift(4,"i"))<0);++y)l[y]=x;var z=function(a,b){for(var c=Math.ceil(a.length/b)-1,d=[],e=1;e<c;++e)d[e-1]=a.slice(e*b,(e+1)*b);return d[c-1]=a.slice(c*b),d}(a,d);!function a(b,c,d,e,f){var g=n;if(b===n){if(0!==c)throw Error("DIFAT chain shorter than expected")}else if(-1!==b){var h=d[b],i=(e>>>2)-1;if(!h)return;for(var j=0;j<i&&(g=ir(h,4*j))!==n;++j)f.push(g);a(ir(h,e-4),c-1,d,e,f)}}(k,f,z,d,l);var A=function(a,b,c,d){var e=a.length,f=[],g=[],h=[],i=[],j=d-1,k=0,l=0,m=0,n=0;for(k=0;k<e;++k)if(h=[],(m=k+b)>=e&&(m-=e),!g[m]){i=[];var o=[];for(l=m;l>=0;){o[l]=!0,g[l]=!0,h[h.length]=l,i.push(a[l]);var p=c[Math.floor(4*l/d)];if(d<4+(n=4*l&j))throw Error("FAT boundary crossed: "+l+" 4 "+d);if(!a[p]||o[l=ir(a[p],n)])break}f[m]={nodes:h,data:h1([i])}}return f}(z,g,l,d);A[g].name="!Directory",e>0&&h!==n&&(A[h].name="!MiniFAT"),A[l[0]].name="!FAT",A.fat_addrs=l,A.ssz=d;var B=[],C=[],D=[];(function(a,b,c,d,e,f,g,h){for(var j,k=0,l=2*!!d.length,o=b[a].data,p=0,q=0;p<o.length;p+=128){var r=o.slice(p,p+128);iy(r,64),q=r.read_shift(2),j=h3(r,0,q-l),d.push(j);var s={name:j,type:r.read_shift(1),color:r.read_shift(1),L:r.read_shift(4,"i"),R:r.read_shift(4,"i"),C:r.read_shift(4,"i"),clsid:r.read_shift(16),state:r.read_shift(4,"i"),start:0,size:0};0!==r.read_shift(2)+r.read_shift(2)+r.read_shift(2)+r.read_shift(2)&&(s.ct=i(r,r.l-8)),0!==r.read_shift(2)+r.read_shift(2)+r.read_shift(2)+r.read_shift(2)&&(s.mt=i(r,r.l-8)),s.start=r.read_shift(4,"i"),s.size=r.read_shift(4,"i"),s.size<0&&s.start<0&&(s.size=s.type=0,s.start=n,s.name=""),5===s.type?(k=s.start,e>0&&k!==n&&(b[k].name="!StreamData")):s.size>=4096?(s.storage="fat",void 0===b[s.start]&&(b[s.start]=function(a,b,c,d,e){var f=[],g=[];e||(e=[]);var h=d-1,i=0,j=0;for(i=b;i>=0;){e[i]=!0,f[f.length]=i,g.push(a[i]);var k=c[Math.floor(4*i/d)];if(d<4+(j=4*i&h))throw Error("FAT boundary crossed: "+i+" 4 "+d);if(!a[k])break;i=ir(a[k],j)}return{nodes:f,data:h1([g])}}(c,s.start,b.fat_addrs,b.ssz)),b[s.start].name=s.name,s.content=b[s.start].data.slice(0,s.size)):(s.storage="minifat",s.size<0?s.size=0:k!==n&&s.start!==n&&b[k]&&(s.content=function(a,b,c){for(var d=a.start,e=a.size,f=[],g=d;c&&e>0&&g>=0;)f.push(b.slice(g*m,g*m+m)),e-=m,g=ir(c,4*g);return 0===f.length?iA(0):f9(f).slice(0,a.size)}(s,b[k].data,(b[h]||{}).data))),s.content&&iy(s.content,0),f[j]=s,g.push(s)}})(g,A,z,B,e,{},C,h),function(a,b,c){for(var d=0,e=0,f=0,g=0,h=0,i=c.length,j=[],k=[];d<i;++d)j[d]=k[d]=d,b[d]=c[d];for(;h<k.length;++h)e=a[d=k[h]].L,f=a[d].R,g=a[d].C,j[d]===d&&(-1!==e&&j[e]!==e&&(j[d]=j[e]),-1!==f&&j[f]!==f&&(j[d]=j[f])),-1!==g&&(j[g]=d),-1!==e&&d!=j[d]&&(j[e]=j[d],k.lastIndexOf(e)<h&&k.push(e)),-1!==f&&d!=j[d]&&(j[f]=j[d],k.lastIndexOf(f)<h&&k.push(f));for(d=1;d<i;++d)j[d]===d&&(-1!==f&&j[f]!==f?j[d]=j[f]:-1!==e&&j[e]!==e&&(j[d]=j[e]));for(d=1;d<i;++d)if(0!==a[d].type){if((h=d)!=j[h])do h=j[h],b[d]=b[h]+"/"+b[d];while(0!==h&&-1!==j[h]&&h!=j[h]);j[d]=-1}for(b[0]+="/",d=1;d<i;++d)2!==a[d].type&&(b[d]+="/")}(C,D,B),B.shift();var E={FileIndex:C,FullPaths:D};return b&&b.raw&&(E.raw={header:r,sectors:z}),E}function i(a,b){return new Date((iq(a,b+4)/1e7*0x100000000+iq(a,b)/1e7-0x2b6109100)*1e3)}function j(a,b){var c=b||{},d=c.root||"Root Entry";if(a.FullPaths||(a.FullPaths=[]),a.FileIndex||(a.FileIndex=[]),a.FullPaths.length!==a.FileIndex.length)throw Error("inconsistent CFB structure");0===a.FullPaths.length&&(a.FullPaths[0]=d+"/",a.FileIndex[0]={name:d,type:5}),c.CLSID&&(a.FileIndex[0].clsid=c.CLSID),function(a){var b="\x01Sh33tJ5";if(!gR.find(a,"/"+b)){var c=iA(4);c[0]=55,c[1]=c[3]=50,c[2]=54,a.FileIndex.push({name:b,type:2,content:c,size:4,L:69,R:69,C:69}),a.FullPaths.push(a.FullPaths[0]+b),k(a)}}(a)}function k(a,b){j(a);for(var c=!1,f=!1,g=a.FullPaths.length-1;g>=0;--g){var h=a.FileIndex[g];switch(h.type){case 0:f?c=!0:(a.FileIndex.pop(),a.FullPaths.pop());break;case 1:case 2:case 5:f=!0,isNaN(h.R*h.L*h.C)&&(c=!0),h.R>-1&&h.L>-1&&h.R==h.L&&(c=!0);break;default:c=!0}}if(c||b){var i=new Date(1987,1,19),k=0,l=Object.create?Object.create(null):{},m=[];for(g=0;g<a.FullPaths.length;++g)l[a.FullPaths[g]]=!0,0!==a.FileIndex[g].type&&m.push([a.FullPaths[g],a.FileIndex[g]]);for(g=0;g<m.length;++g){var n=d(m[g][0]);(f=l[n])||(m.push([n,{name:e(n).replace("/",""),type:1,clsid:q,ct:i,mt:i,content:null}]),l[n]=!0)}for(m.sort(function(a,b){return function(a,b){for(var c=a.split("/"),d=b.split("/"),e=0,f=0,g=Math.min(c.length,d.length);e<g;++e){if(f=c[e].length-d[e].length)return f;if(c[e]!=d[e])return c[e]<d[e]?-1:1}return c.length-d.length}(a[0],b[0])}),a.FullPaths=[],a.FileIndex=[],g=0;g<m.length;++g)a.FullPaths[g]=m[g][0],a.FileIndex[g]=m[g][1];for(g=0;g<m.length;++g){var o=a.FileIndex[g],p=a.FullPaths[g];if(o.name=e(p).replace("/",""),o.L=o.R=o.C=-(o.color=1),o.size=o.content?o.content.length:0,o.start=0,o.clsid=o.clsid||q,0===g)o.C=m.length>1?1:-1,o.size=0,o.type=5;else if("/"==p.slice(-1)){for(k=g+1;k<m.length&&d(a.FullPaths[k])!=p;++k);for(o.C=k>=m.length?-1:k,k=g+1;k<m.length&&d(a.FullPaths[k])!=d(p);++k);o.R=k>=m.length?-1:k,o.type=1}else d(a.FullPaths[g+1]||"")==d(p)&&(o.R=g+1),o.type=2}}}function l(a,c){var d=c||{};if("mad"==d.fileType)return function(a,b){for(var c=b||{},d=c.boundary||"SheetJS",e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(d="------="+d).slice(2)+'"',"","",""],f=a.FullPaths[0],g=f,h=a.FileIndex[0],i=1;i<a.FullPaths.length;++i)if(g=a.FullPaths[i].slice(f.length),(h=a.FileIndex[i]).size&&h.content&&"\x01Sh33tJ5"!=g){g=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(a){return"_x"+a.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(a){return"_u"+a.charCodeAt(0).toString(16)+"_"});for(var j=h.content,k=f1&&Buffer.isBuffer(j)?j.toString("binary"):s(j),l=0,m=Math.min(1024,k.length),n=0,o=0;o<=m;++o)(n=k.charCodeAt(o))>=32&&n<128&&++l;var p=l>=4*m/5;e.push(d),e.push("Content-Location: "+(c.root||"file:///C:/SheetJS/")+g),e.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),e.push("Content-Type: "+function(a,b){if(a.ctype)return a.ctype;var c=a.name||"",d=c.match(/\.([^\.]+)$/);return d&&Z[d[1]]||b&&(d=(c=b).match(/[\.\\]([^\.\\])+$/))&&Z[d[1]]?Z[d[1]]:"application/octet-stream"}(h,g)),e.push(""),e.push(p?function(a){var b=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(a){var b=a.charCodeAt(0).toString(16).toUpperCase();return"="+(1==b.length?"0"+b:b)});"\n"==(b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09")).charAt(0)&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,"\n=0A").replace(/([^\r\n])\n/mg,"$1=0A");for(var c=[],d=b.split("\r\n"),e=0;e<d.length;++e){var f=d[e];if(0==f.length){c.push("");continue}for(var g=0;g<f.length;){var h=76,i=f.slice(g,g+h);"="==i.charAt(h-1)?h--:"="==i.charAt(h-2)?h-=2:"="==i.charAt(h-3)&&(h-=3),i=f.slice(g,g+h),(g+=h)<f.length&&(i+="="),c.push(i)}}return c.join("\r\n")}(k):function(a){for(var b=f_(a),c=[],d=0;d<b.length;d+=76)c.push(b.slice(d,d+76));return c.join("\r\n")+"\r\n"}(k))}return e.push(d+"--\r\n"),e.join("\r\n")}(a,d);if(k(a),"zip"===d.fileType)return function(a,c){var d=[],e=[],f=iA(1),g=8*!!(c||{}).compression,h=0,i=0,j=0,k=0,l=a.FullPaths[0],m=l,n=a.FileIndex[0],o=[],p=0;for(h=1;h<a.FullPaths.length;++h)if(m=a.FullPaths[h].slice(l.length),(n=a.FileIndex[h]).size&&n.content&&"\x01Sh33tJ5"!=m){var q,r=j,s=iA(m.length);for(i=0;i<m.length;++i)s.write_shift(1,127&m.charCodeAt(i));s=s.slice(0,s.l),o[k]=gQ.buf(n.content,0);var t=n.content;8==g&&(q=t,t=b?b.deflateRawSync(q):Q(q)),(f=iA(30)).write_shift(4,0x4034b50),f.write_shift(2,20),f.write_shift(2,0),f.write_shift(2,g),n.mt?function(a,b){"string"==typeof b&&(b=new Date(b));var c=b.getHours();c=(c=c<<6|b.getMinutes())<<5|b.getSeconds()>>>1,a.write_shift(2,c);var d=b.getFullYear()-1980;d=(d=d<<4|b.getMonth()+1)<<5|b.getDate(),a.write_shift(2,d)}(f,n.mt):f.write_shift(4,0),f.write_shift(-4,(0,o[k])),f.write_shift(4,(0,t.length)),f.write_shift(4,(0,n.content.length)),f.write_shift(2,s.length),f.write_shift(2,0),j+=f.length,d.push(f),j+=s.length,d.push(s),j+=t.length,d.push(t),(f=iA(46)).write_shift(4,0x2014b50),f.write_shift(2,0),f.write_shift(2,20),f.write_shift(2,0),f.write_shift(2,g),f.write_shift(4,0),f.write_shift(-4,o[k]),f.write_shift(4,t.length),f.write_shift(4,n.content.length),f.write_shift(2,s.length),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(4,0),f.write_shift(4,r),p+=f.l,e.push(f),p+=s.length,e.push(s),++k}return(f=iA(22)).write_shift(4,0x6054b50),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(2,k),f.write_shift(2,k),f.write_shift(4,p),f.write_shift(4,j),f.write_shift(2,0),f9([f9(d),f9(e),f])}(a,d);var e=function(a){for(var b=0,c=0,d=0;d<a.FileIndex.length;++d){var e=a.FileIndex[d];if(e.content){var f=e.content.length;f>0&&(f<4096?b+=f+63>>6:c+=f+511>>9)}}for(var g=a.FullPaths.length+3>>2,h=b+7>>3,i=b+127>>7,j=h+c+g+i,k=j+127>>7,l=k<=109?0:Math.ceil((k-109)/127);j+k+l+127>>7>k;)l=++k<=109?0:Math.ceil((k-109)/127);var m=[1,l,k,i,g,c,b,0];return a.FileIndex[0].size=b<<6,m[7]=(a.FileIndex[0].start=m[0]+m[1]+m[2]+m[3]+m[4]+m[5])+(m[6]+7>>3),m}(a),f=iA(e[7]<<9),g=0,h=0;for(g=0;g<8;++g)f.write_shift(1,p[g]);for(g=0;g<8;++g)f.write_shift(2,0);for(f.write_shift(2,62),f.write_shift(2,3),f.write_shift(2,65534),f.write_shift(2,9),f.write_shift(2,6),g=0;g<3;++g)f.write_shift(2,0);for(f.write_shift(4,0),f.write_shift(4,e[2]),f.write_shift(4,e[0]+e[1]+e[2]+e[3]-1),f.write_shift(4,0),f.write_shift(4,4096),f.write_shift(4,e[3]?e[0]+e[1]+e[2]-1:n),f.write_shift(4,e[3]),f.write_shift(-4,e[1]?e[0]-1:n),f.write_shift(4,e[1]),g=0;g<109;++g)f.write_shift(-4,g<e[2]?e[1]+g:-1);if(e[1])for(h=0;h<e[1];++h){for(;g<236+127*h;++g)f.write_shift(-4,g<e[2]?e[1]+g:-1);f.write_shift(-4,h===e[1]-1?n:h+1)}var i=function(a){for(h+=a;g<h-1;++g)f.write_shift(-4,g+1);a&&(++g,f.write_shift(-4,n))};for(h=(g=0)+e[1];g<h;++g)f.write_shift(-4,r.DIFSECT);for(h+=e[2];g<h;++g)f.write_shift(-4,r.FATSECT);i(e[3]),i(e[4]);for(var j=0,l=0,m=a.FileIndex[0];j<a.FileIndex.length;++j)(m=a.FileIndex[j]).content&&((l=m.content.length)<4096||(m.start=h,i(l+511>>9)));for(i(e[6]+7>>3);511&f.l;)f.write_shift(-4,r.ENDOFCHAIN);for(j=0,h=g=0;j<a.FileIndex.length;++j)(m=a.FileIndex[j]).content&&(l=m.content.length)&&!(l>=4096)&&(m.start=h,i(l+63>>6));for(;511&f.l;)f.write_shift(-4,r.ENDOFCHAIN);for(g=0;g<e[4]<<2;++g){var o=a.FullPaths[g];if(!o||0===o.length){for(j=0;j<17;++j)f.write_shift(4,0);for(j=0;j<3;++j)f.write_shift(4,-1);for(j=0;j<12;++j)f.write_shift(4,0);continue}m=a.FileIndex[g],0===g&&(m.start=m.size?m.start-1:n);var q=0===g&&d.root||m.name;if(l=2*(q.length+1),f.write_shift(64,q,"utf16le"),f.write_shift(2,l),f.write_shift(1,m.type),f.write_shift(1,m.color),f.write_shift(-4,m.L),f.write_shift(-4,m.R),f.write_shift(-4,m.C),m.clsid)f.write_shift(16,m.clsid,"hex");else for(j=0;j<4;++j)f.write_shift(4,0);f.write_shift(4,m.state||0),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,m.start),f.write_shift(4,m.size),f.write_shift(4,0)}for(g=1;g<a.FileIndex.length;++g)if((m=a.FileIndex[g]).size>=4096)if(f.l=m.start+1<<9,f1&&Buffer.isBuffer(m.content))m.content.copy(f,f.l,0,m.size),f.l+=m.size+511&-512;else{for(j=0;j<m.size;++j)f.write_shift(1,m.content[j]);for(;511&j;++j)f.write_shift(1,0)}for(g=1;g<a.FileIndex.length;++g)if((m=a.FileIndex[g]).size>0&&m.size<4096)if(f1&&Buffer.isBuffer(m.content))m.content.copy(f,f.l,0,m.size),f.l+=m.size+63&-64;else{for(j=0;j<m.size;++j)f.write_shift(1,m.content[j]);for(;63&j;++j)f.write_shift(1,0)}if(f1)f.l=f.length;else for(;f.l<f.length;)f.write_shift(1,0);return f}c.version="1.2.1";var m=64,n=-2,o="d0cf11e0a1b11ae1",p=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",r={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:-2,FREESECT:-1,HEADER_SIGNATURE:o,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function s(a){for(var b=Array(a.length),c=0;c<a.length;++c)b[c]=String.fromCharCode(a[c]);return b.join("")}for(var t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],w="undefined"!=typeof Uint8Array,x=w?new Uint8Array(256):[],y=0;y<256;++y)x[y]=function(a){var b=(a<<1|a<<11)&139536|(a<<5|a<<15)&558144;return(b>>16|b>>8|b)&255}(y);function z(a,b){var c=7&b,d=b>>>3;return(a[d]|(c<=5?0:a[d+1]<<8))>>>c&7}function A(a,b){var c=7&b,d=b>>>3;return(a[d]|(c<=3?0:a[d+1]<<8))>>>c&31}function B(a,b){var c=7&b,d=b>>>3;return(a[d]|(c<=1?0:a[d+1]<<8))>>>c&127}function C(a,b,c){var d=7&b,e=b>>>3,f=(1<<c)-1,g=a[e]>>>d;return c<8-d||(g|=a[e+1]<<8-d,c<16-d||(g|=a[e+2]<<16-d,c<24-d))?g&f:(g|=a[e+3]<<24-d)&f}function D(a,b,c){var d=7&b,e=b>>>3;return d<=5?a[e]|=(7&c)<<d:(a[e]|=c<<d&255,a[e+1]=(7&c)>>8-d),b+3}function E(a,b,c){var d=b>>>3;return c<<=7&b,a[d]|=255&c,c>>>=8,a[d+1]=c,b+8}function F(a,b,c){var d=b>>>3;return c<<=7&b,a[d]|=255&c,c>>>=8,a[d+1]=255&c,a[d+2]=c>>>8,b+16}function G(a,b){var c=a.length,d=2*c>b?2*c:b+5,e=0;if(c>=b)return a;if(f1){var f=f4(d);if(a.copy)a.copy(f);else for(;e<a.length;++e)f[e]=a[e];return f}if(w){var g=new Uint8Array(d);if(g.set)g.set(a);else for(;e<c;++e)g[e]=a[e];return g}return a.length=d,a}function H(a){for(var b=Array(a),c=0;c<a;++c)b[c]=0;return b}function I(a,b,c){var d=1,e=0,f=0,g=0,h=0,i=a.length,j=w?new Uint16Array(32):H(32);for(f=0;f<32;++f)j[f]=0;for(f=i;f<c;++f)a[f]=0;i=a.length;var k=w?new Uint16Array(i):H(i);for(f=0;f<i;++f)j[e=a[f]]++,d<e&&(d=e),k[f]=0;for(f=1,j[0]=0;f<=d;++f)j[f+16]=h=h+j[f-1]<<1;for(f=0;f<i;++f)0!=(h=a[f])&&(k[f]=j[h+16]++);var l=0;for(f=0;f<i;++f)if(0!=(l=a[f]))for(h=function(a,b){var c=x[255&a];return b<=8?c>>>8-b:(c=c<<8|x[a>>8&255],b<=16)?c>>>16-b:(c=c<<8|x[a>>16&255])>>>24-b}(k[f],d)>>d-l,g=(1<<d+4-l)-1;g>=0;--g)b[h|g<<l]=15&l|f<<4;return d}var J=w?new Uint16Array(512):H(512),K=w?new Uint16Array(32):H(32);if(!w){for(var L=0;L<512;++L)J[L]=0;for(L=0;L<32;++L)K[L]=0}for(var M=[],N=0;N<32;N++)M.push(5);I(M,K,32);var O=[];for(N=0;N<=143;N++)O.push(8);for(;N<=255;N++)O.push(9);for(;N<=279;N++)O.push(7);for(;N<=287;N++)O.push(8);I(O,J,288);var P=function(){for(var a=w?new Uint8Array(32768):[],b=0,c=0;b<v.length-1;++b)for(;c<v[b+1];++c)a[c]=b;for(;c<32768;++c)a[c]=29;var d=w?new Uint8Array(259):[];for(b=0,c=0;b<u.length-1;++b)for(;c<u[b+1];++c)d[c]=b;return function(b,c){if(b.length<8){for(var e=0;e<b.length;){var f=Math.min(65535,b.length-e),g=e+f==b.length;for(c.write_shift(1,+g),c.write_shift(2,f),c.write_shift(2,65535&~f);f-- >0;)c[c.l++]=b[e++]}return c.l}return function(b,c){for(var e=0,f=0,g=w?new Uint16Array(32768):[];f<b.length;){var h=Math.min(65535,b.length-f);if(h<10){for(7&(e=D(c,e,+(f+h==b.length)))&&(e+=8-(7&e)),c.l=e/8|0,c.write_shift(2,h),c.write_shift(2,65535&~h);h-- >0;)c[c.l++]=b[f++];e=8*c.l;continue}e=D(c,e,+(f+h==b.length)+2);for(var i=0;h-- >0;){var j,k,l=b[f],m=-1,n=0;if((m=g[i=(i<<5^l)&32767])&&((m|=-32768&f)>f&&(m-=32768),m<f))for(;b[m+n]==b[f+n]&&n<250;)++n;if(n>2){(l=d[n])<=22?e=E(c,e,x[l+1]>>1)-1:(E(c,e,3),E(c,e+=5,x[l-23]>>5),e+=3);var o=l<8?0:l-4>>2;o>0&&(F(c,e,n-u[l]),e+=o),e=E(c,e,x[l=a[f-m]]>>3)-3;var p=l<4?0:l-2>>1;p>0&&(F(c,e,f-m-v[l]),e+=p);for(var q=0;q<n;++q)g[i]=32767&f,i=(i<<5^b[f])&32767,++f;h-=n-1}else l<=143?l+=48:(k=(1&(k=1))<<(7&(j=e)),c[j>>>3]|=k,e=j+1),e=E(c,e,x[l]),g[i]=32767&f,++f}e=E(c,e,0)-1}return c.l=(e+7)/8|0,c.l}(b,c)}}();function Q(a){var b=iA(50+Math.floor(1.1*a.length)),c=P(a,b);return b.slice(0,c)}var R=w?new Uint16Array(32768):H(32768),S=w?new Uint16Array(32768):H(32768),T=w?new Uint16Array(128):H(128),U=1,V=1;function W(a,b){var c=function(a,b){if(3==a[0]&&!(3&a[1]))return[f3(b),2];for(var c=0,d=0,e=f4(b||262144),f=0,g=e.length>>>0,h=0,i=0;(1&d)==0;){if(d=z(a,c),c+=3,d>>>1==0){7&c&&(c+=8-(7&c));var j=a[c>>>3]|a[(c>>>3)+1]<<8;if(c+=32,j>0)for(!b&&g<f+j&&(g=(e=G(e,f+j)).length);j-- >0;)e[f++]=a[c>>>3],c+=8;continue}for(d>>1==1?(h=9,i=5):(c=function(a,b){var c,d,e,f=A(a,b)+257,g=A(a,b+=5)+1;b+=5;var h=(d=7&(c=b),((a[e=c>>>3]|(d<=4?0:a[e+1]<<8))>>>d&15)+4);b+=4;for(var i=0,j=w?new Uint8Array(19):H(19),k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,m=w?new Uint8Array(8):H(8),n=w?new Uint8Array(8):H(8),o=j.length,p=0;p<h;++p)j[t[p]]=i=z(a,b),l<i&&(l=i),m[i]++,b+=3;var q=0;for(p=1,m[0]=0;p<=l;++p)n[p]=q=q+m[p-1]<<1;for(p=0;p<o;++p)0!=(q=j[p])&&(k[p]=n[q]++);var r=0;for(p=0;p<o;++p)if(0!=(r=j[p])){q=x[k[p]]>>8-r;for(var s=(1<<7-r)-1;s>=0;--s)T[q|s<<r]=7&r|p<<3}var u=[];for(l=1;u.length<f+g;)switch(q=T[B(a,b)],b+=7&q,q>>>=3){case 16:for(i=3+function(a,b){var c=7&b,d=b>>>3;return(a[d]|(c<=6?0:a[d+1]<<8))>>>c&3}(a,b),b+=2,q=u[u.length-1];i-- >0;)u.push(q);break;case 17:for(i=3+z(a,b),b+=3;i-- >0;)u.push(0);break;case 18:for(i=11+B(a,b),b+=7;i-- >0;)u.push(0);break;default:u.push(q),l<q&&(l=q)}var v=u.slice(0,f),y=u.slice(f);for(p=f;p<286;++p)v[p]=0;for(p=g;p<30;++p)y[p]=0;return U=I(v,R,286),V=I(y,S,30),b}(a,c),h=U,i=V);;){!b&&g<f+32767&&(g=(e=G(e,f+32767)).length);var k=C(a,c,h),l=d>>>1==1?J[k]:R[k];if(c+=15&l,((l>>>=4)>>>8&255)==0)e[f++]=l;else if(256==l)break;else{var m=(l-=257)<8?0:l-4>>2;m>5&&(m=0);var n=f+u[l];m>0&&(n+=C(a,c,m),c+=m),k=C(a,c,i),c+=15&(l=d>>>1==1?K[k]:S[k]);var o=(l>>>=4)<4?0:l-2>>1,p=v[l];for(o>0&&(p+=C(a,c,o),c+=o),!b&&g<n&&(g=(e=G(e,n+100)).length);f<n;)e[f]=e[f-p],++f}}}return b?[e,c+7>>>3]:[e.slice(0,f),c+7>>>3]}(a.slice(a.l||0),b);return a.l+=c[1],c[0]}function X(a,b){if(a)"undefined"!=typeof console&&console.error(b);else throw Error(b)}function Y(a,c){iy(a,0);var d={FileIndex:[],FullPaths:[]};j(d,{root:c.root});for(var e=a.length-4;(80!=a[e]||75!=a[e+1]||5!=a[e+2]||6!=a[e+3])&&e>=0;)--e;a.l=e+4,a.l+=4;var g=a.read_shift(2);a.l+=6;var h=a.read_shift(4);for(e=0,a.l=h;e<g;++e){a.l+=20;var i=a.read_shift(4),k=a.read_shift(4),l=a.read_shift(2),m=a.read_shift(2),n=a.read_shift(2);a.l+=8;var o=a.read_shift(4),p=f(a.slice(a.l+l,a.l+l+m));a.l+=l+m+n;var q=a.l;a.l=o+4,function(a,c,d,e,g){a.l+=2;var h,i,j,k,l,m,n,o=a.read_shift(2),p=a.read_shift(2),q=(h=65535&a.read_shift(2),i=65535&a.read_shift(2),j=new Date,k=31&i,l=15&(i>>>=5),i>>>=4,j.setMilliseconds(0),j.setFullYear(i+1980),j.setMonth(l-1),j.setDate(k),m=31&h,n=63&(h>>>=5),h>>>=6,j.setHours(h),j.setMinutes(n),j.setSeconds(m<<1),j);if(8257&o)throw Error("Unsupported ZIP encryption");for(var r=a.read_shift(4),s=a.read_shift(4),t=a.read_shift(4),u=a.read_shift(2),v=a.read_shift(2),w="",x=0;x<u;++x)w+=String.fromCharCode(a[a.l++]);if(v){var y=f(a.slice(a.l,a.l+v));(y[21589]||{}).mt&&(q=y[21589].mt),((g||{})[21589]||{}).mt&&(q=g[21589].mt)}a.l+=v;var z=a.slice(a.l,a.l+s);switch(p){case 8:z=function(a,c){if(!b)return W(a,c);var d=new b.InflateRaw,e=d._processChunk(a.slice(a.l),d._finishFlushFlag);return a.l+=d.bytesRead,e}(a,t);break;case 0:break;default:throw Error("Unsupported ZIP Compression method "+p)}var A=!1;8&o&&(0x8074b50==a.read_shift(4)&&(a.read_shift(4),A=!0),s=a.read_shift(4),t=a.read_shift(4)),s!=c&&X(A,"Bad compressed size: "+c+" != "+s),t!=d&&X(A,"Bad uncompressed size: "+d+" != "+t),_(e,w,z,{unsafe:!0,mt:q})}(a,i,k,d,p),a.l=q}return d}var Z={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _(a,b,c,d){var f=d&&d.unsafe;f||j(a);var g=!f&&gR.find(a,b);if(!g){var h=a.FullPaths[0];b.slice(0,h.length)==h?h=b:("/"!=h.slice(-1)&&(h+="/"),h=(h+b).replace("//","/")),g={name:e(b),type:2},a.FileIndex.push(g),a.FullPaths.push(h),f||gR.utils.cfb_gc(a)}return g.content=c,g.size=c?c.length:0,d&&(d.CLSID&&(g.clsid=d.CLSID),d.mt&&(g.mt=d.mt),d.ct&&(g.ct=d.ct)),g}return c.find=function(a,b){var c=a.FullPaths.map(function(a){return a.toUpperCase()}),d=c.map(function(a){var b=a.split("/");return b[b.length-("/"==a.slice(-1)?2:1)]}),e=!1;47===b.charCodeAt(0)?(e=!0,b=c[0].slice(0,-1)+b):e=-1!==b.indexOf("/");var f=b.toUpperCase(),g=!0===e?c.indexOf(f):d.indexOf(f);if(-1!==g)return a.FileIndex[g];var h=!f.match(gb);for(f=f.replace(ga,""),h&&(f=f.replace(gb,"!")),g=0;g<c.length;++g)if((h?c[g].replace(gb,"!"):c[g]).replace(ga,"")==f||(h?d[g].replace(gb,"!"):d[g]).replace(ga,"")==f)return a.FileIndex[g];return null},c.read=function(b,c){var d=c&&c.type;switch(!d&&f1&&Buffer.isBuffer(b)&&(d="buffer"),d||"base64"){case"file":return g(),h(a.readFileSync(b),c);case"base64":return h(f5(f0(b)),c);case"binary":return h(f5(b),c)}return h(b,c)},c.parse=h,c.write=function(b,c){var d=l(b,c);switch(c&&c.type||"buffer"){case"file":g(),a.writeFileSync(c.filename,d);break;case"binary":return"string"==typeof d?d:s(d);case"base64":return f_("string"==typeof d?d:s(d));case"buffer":if(f1)return Buffer.isBuffer(d)?d:f2(d);case"array":return"string"==typeof d?f5(d):d}return d},c.writeFile=function(b,c,d){g();var e=l(b,d);a.writeFileSync(c,e)},c.utils={cfb_new:function(a){var b={};return j(b,a),b},cfb_add:_,cfb_del:function(a,b){j(a);var c=gR.find(a,b);if(c){for(var d=0;d<a.FileIndex.length;++d)if(a.FileIndex[d]==c)return a.FileIndex.splice(d,1),a.FullPaths.splice(d,1),!0}return!1},cfb_mov:function(a,b,c){j(a);var d=gR.find(a,b);if(d){for(var f=0;f<a.FileIndex.length;++f)if(a.FileIndex[f]==d)return a.FileIndex[f].name=e(c),a.FullPaths[f]=c,!0}return!1},cfb_gc:function(a){k(a,!0)},ReadShift:is,CheckField:ix,prep_blob:iy,bconcat:f9,use_zlib:function(a){try{var c=new a.InflateRaw;if(c._processChunk(new Uint8Array([3,0]),c._finishFlushFlag),c.bytesRead)b=a;else throw Error("zlib does not expose bytesRead")}catch(a){console.error("cannot use native zlib: "+(a.message||a))}},_deflateRaw:Q,_inflateRaw:W,consts:r},c}();function gS(a,b,c){if(void 0!==d&&d.writeFileSync)return c?d.writeFileSync(a,b,c):d.writeFileSync(a,b);if("undefined"!=typeof Deno){if(c&&"string"==typeof b)switch(c){case"utf8":b=new TextEncoder(c).encode(b);break;case"binary":b=f6(b);break;default:throw Error("Unsupported encoding "+c)}return Deno.writeFileSync(a,b)}var e="utf8"==c?hL(b):b;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(e,a);if("undefined"!=typeof Blob){var f=new Blob([function(a){if("string"==typeof a)return f6(a);if(Array.isArray(a)){if("undefined"==typeof Uint8Array)throw Error("Unsupported");return new Uint8Array(a)}return a}(e)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(f,a);if("undefined"!=typeof saveAs)return saveAs(f,a);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(f);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:a,saveAs:!0});var h=document.createElement("a");if(null!=h.download)return h.download=a,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var i=File(a);return i.open("w"),i.encoding="binary",Array.isArray(b)&&(b=f7(b)),i.write(b),i.close(),b}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw Error("cannot save file "+a)}function gT(a){for(var b=Object.keys(a),c=[],d=0;d<b.length;++d)Object.prototype.hasOwnProperty.call(a,b[d])&&c.push(b[d]);return c}function gU(a,b){for(var c=[],d=gT(a),e=0;e!==d.length;++e)null==c[a[d[e]][b]]&&(c[a[d[e]][b]]=d[e]);return c}function gV(a){for(var b=[],c=gT(a),d=0;d!==c.length;++d)b[a[c[d]]]=c[d];return b}function gW(a){for(var b=[],c=gT(a),d=0;d!==c.length;++d)b[a[c[d]]]=parseInt(c[d],10);return b}var gX=new Date(1899,11,30,0,0,0);function gY(a,b){var c=a.getTime();return b&&(c-=1263168e5),(c-(gX.getTime()+(a.getTimezoneOffset()-gX.getTimezoneOffset())*6e4))/864e5}var gZ=new Date,g$=gX.getTime()+(gZ.getTimezoneOffset()-gX.getTimezoneOffset())*6e4,g_=gZ.getTimezoneOffset();function g0(a){var b=new Date;return b.setTime(24*a*36e5+g$),b.getTimezoneOffset()!==g_&&b.setTime(b.getTime()+(b.getTimezoneOffset()-g_)*6e4),b}var g1=new Date("2017-02-19T19:06:09.000Z"),g2=isNaN(g1.getFullYear())?new Date("2/19/17"):g1,g3=2017==g2.getFullYear();function g4(a,b){var c=new Date(a);if(g3)return b>0?c.setTime(c.getTime()+60*c.getTimezoneOffset()*1e3):b<0&&c.setTime(c.getTime()-60*c.getTimezoneOffset()*1e3),c;if(a instanceof Date)return a;if(1917==g2.getFullYear()&&!isNaN(c.getFullYear())){var d=c.getFullYear();return a.indexOf(""+d)>-1||c.setFullYear(c.getFullYear()+100),c}var e=a.match(/\d+/g)||["2017","2","19","0","0","0"],f=new Date(+e[0],e[1]-1,+e[2],+e[3]||0,+e[4]||0,+e[5]||0);return a.indexOf("Z")>-1&&(f=new Date(f.getTime()-60*f.getTimezoneOffset()*1e3)),f}function g5(a,b){if(f1&&Buffer.isBuffer(a)){if(b){if(255==a[0]&&254==a[1])return hL(a.slice(2).toString("utf16le"));if(254==a[1]&&255==a[2])return hL(fW(a.slice(2).toString("binary")))}return a.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(b){if(255==a[0]&&254==a[1])return hL(new TextDecoder("utf-16le").decode(a.slice(2)));if(254==a[0]&&255==a[1])return hL(new TextDecoder("utf-16be").decode(a.slice(2)))}var c={"":"\x80","":"\x82",:"\x83","":"\x84","":"\x85","":"\x86","":"\x87",:"\x88","":"\x89",:"\x8a","":"\x8b",:"\x8c",:"\x8e","":"\x91","":"\x92","":"\x93","":"\x94","":"\x95","":"\x96","":"\x97","":"\x98","":"\x99",:"\x9a","":"\x9b",:"\x9c",:"\x9e",:"\x9f"};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(a){return c[a]||a})}catch(a){}for(var d=[],e=0;e!=a.length;++e)d.push(String.fromCharCode(a[e]));return d.join("")}function g6(a){if("undefined"!=typeof JSON&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if("object"!=typeof a||null==a)return a;if(a instanceof Date)return new Date(a.getTime());var b={};for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=g6(a[c]));return b}function g7(a,b){for(var c="";c.length<b;)c+=a;return c}function g8(a){var b=Number(a);if(!isNaN(b))return isFinite(b)?b:NaN;if(!/\d/.test(a))return b;var c=1,d=a.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return c*=100,""});return isNaN(b=Number(d))&&isNaN(b=Number(d=d.replace(/[(](.*)[)]/,function(a,b){return c=-c,b})))?b:b/c}var g9=["january","february","march","april","may","june","july","august","september","october","november","december"];function ha(a){var b=new Date(a),c=new Date(NaN),d=b.getYear(),e=b.getMonth(),f=b.getDate();if(isNaN(f))return c;var g=a.toLowerCase();if(g.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((g=g.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==g9.indexOf(g))return c}else if(g.match(/[a-z]/))return c;return d<0||d>8099?c:(e>0||f>1)&&101!=d?b:a.match(/[^-0-9:,\/\\]/)?c:b}var hb=function(){var a=5=="abacaba".split(/(:?b)/i).length;return function(b,c,d){if(a||"string"==typeof c)return b.split(c);for(var e=b.split(c),f=[e[0]],g=1;g<e.length;++g)f.push(d),f.push(e[g]);return f}}();function hc(a){return a?a.content&&a.type?g5(a.content,!0):a.data?fX(a.data):a.asNodeBuffer&&f1?fX(a.asNodeBuffer().toString("binary")):a.asBinary?fX(a.asBinary()):a._data&&a._data.getContent?fX(g5(Array.prototype.slice.call(a._data.getContent(),0))):null:null}function hd(a){if(!a)return null;if(a.data)return fV(a.data);if(a.asNodeBuffer&&f1)return a.asNodeBuffer();if(a._data&&a._data.getContent){var b=a._data.getContent();return"string"==typeof b?fV(b):Array.prototype.slice.call(b)}return a.content&&a.type?a.content:null}function he(a,b){for(var c=a.FullPaths||gT(a.files),d=b.toLowerCase().replace(/[\/]/g,"\\"),e=d.replace(/\\/g,"/"),f=0;f<c.length;++f){var g=c[f].replace(/^Root Entry[\/]/,"").toLowerCase();if(d==g||e==g)return a.files?a.files[c[f]]:a.FileIndex[f]}return null}function hf(a,b){var c=he(a,b);if(null==c)throw Error("Cannot find file "+b+" in zip");return c}function hg(a,b,c){if(!c){var d;return(d=hf(a,b))&&".bin"===d.name.slice(-4)?hd(d):hc(d)}if(!b)return null;try{return hg(a,b)}catch(a){return null}}function hh(a,b,c){if(!c)return hc(hf(a,b));if(!b)return null;try{return hh(a,b)}catch(a){return null}}function hi(a){for(var b=a.FullPaths||gT(a.files),c=[],d=0;d<b.length;++d)"/"!=b[d].slice(-1)&&c.push(b[d].replace(/^Root Entry[\/]/,""));return c.sort()}function hj(a,b,c){if(a.FullPaths){if("string"==typeof c){var d;return d=f1?f2(c):function(a){for(var b=[],c=0,d=a.length+250,e=f3(a.length+255),f=0;f<a.length;++f){var g=a.charCodeAt(f);if(g<128)e[c++]=g;else if(g<2048)e[c++]=192|g>>6&31,e[c++]=128|63&g;else if(g>=55296&&g<57344){g=(1023&g)+64;var h=1023&a.charCodeAt(++f);e[c++]=240|g>>8&7,e[c++]=128|g>>2&63,e[c++]=128|h>>6&15|(3&g)<<4,e[c++]=128|63&h}else e[c++]=224|g>>12&15,e[c++]=128|g>>6&63,e[c++]=128|63&g;c>d&&(b.push(e.slice(0,c)),c=0,e=f3(65535),d=65530)}return b.push(e.slice(0,c)),f9(b)}(c),gR.utils.cfb_add(a,b,d)}gR.utils.cfb_add(a,b,c)}else a.file(b,c)}function hk(){return gR.utils.cfb_new()}function hl(a,b){switch(b.type){case"base64":return gR.read(a,{type:"base64"});case"binary":return gR.read(a,{type:"binary"});case"buffer":case"array":return gR.read(a,{type:"buffer"})}throw Error("Unrecognized type "+b.type)}function hm(a,b){if("/"==a.charAt(0))return a.slice(1);var c=b.split("/");"/"!=b.slice(-1)&&c.pop();for(var d=a.split("/");0!==d.length;){var e=d.shift();".."===e?c.pop():"."!==e&&c.push(e)}return c.join("/")}var hn='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ho=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,hp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hq=hn.match(hp)?hp:/<[^>]*>/g,hr=/<\w*:/,hs=/<(\/?)\w+:/;function ht(a,b,c){for(var d={},e=0,f=0;e!==a.length&&32!==(f=a.charCodeAt(e))&&10!==f&&13!==f;++e);if(b||(d[0]=a.slice(0,e)),e===a.length)return d;var g=a.match(ho),h=0,i="",j=0,k="",l="",m=1;if(g)for(j=0;j!=g.length;++j){for(f=0,l=g[j];f!=l.length&&61!==l.charCodeAt(f);++f);for(k=l.slice(0,f).trim();32==l.charCodeAt(f+1);)++f;for(h=0,m=+(34==(e=l.charCodeAt(f+1))||39==e),i=l.slice(f+1+m,l.length-m);h!=k.length&&58!==k.charCodeAt(h);++h);if(h===k.length)k.indexOf("_")>0&&(k=k.slice(0,k.indexOf("_"))),d[k]=i,c||(d[k.toLowerCase()]=i);else{var n=(5===h&&"xmlns"===k.slice(0,5)?"xmlns":"")+k.slice(h+1);if(d[n]&&"ext"==k.slice(h-3,h))continue;d[n]=i,c||(d[n.toLowerCase()]=i)}}return d}function hu(a){return a.replace(hs,"<$1")}var hv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},hw=gV(hv),hx=function(){var a=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,b=/_x([\da-fA-F]{4})_/ig;return function c(d){var e=d+"",f=e.indexOf("<![CDATA[");if(-1==f)return e.replace(a,function(a,b){return hv[a]||String.fromCharCode(parseInt(b,a.indexOf("x")>-1?16:10))||a}).replace(b,function(a,b){return String.fromCharCode(parseInt(b,16))});var g=e.indexOf("]]>");return c(e.slice(0,f))+e.slice(f+9,g)+c(e.slice(g+3))}}(),hy=/[&<>'"]/g,hz=/[\u0000-\u0008\u000b-\u001f]/g;function hA(a){return(a+"").replace(hy,function(a){return hw[a]}).replace(hz,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function hB(a){return hA(a).replace(/ /g,"_x0020_")}var hC=/[\u0000-\u001f]/g;function hD(a){return(a+"").replace(hy,function(a){return hw[a]}).replace(/\n/g,"<br/>").replace(hC,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var hE=function(){var a=/&#(\d+);/g;function b(a,b){return String.fromCharCode(parseInt(b,10))}return function(c){return c.replace(a,b)}}();function hF(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hG(a){for(var b="",c=0,d=0,e=0,f=0,g=0,h=0;c<a.length;){if((d=a.charCodeAt(c++))<128){b+=String.fromCharCode(d);continue}if(e=a.charCodeAt(c++),d>191&&d<224){b+=String.fromCharCode((31&d)<<6|63&e);continue}if(f=a.charCodeAt(c++),d<240){b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f);continue}b+=String.fromCharCode(55296+((h=((7&d)<<18|(63&e)<<12|(63&f)<<6|63&a.charCodeAt(c++))-65536)>>>10&1023)),b+=String.fromCharCode(56320+(1023&h))}return b}function hH(a){var b,c,d,e=f3(2*a.length),f=1,g=0,h=0;for(c=0;c<a.length;c+=f)f=1,(d=a.charCodeAt(c))<128?b=d:d<224?(b=(31&d)*64+(63&a.charCodeAt(c+1)),f=2):d<240?(b=(15&d)*4096+(63&a.charCodeAt(c+1))*64+(63&a.charCodeAt(c+2)),f=3):(f=4,h=55296+((b=(7&d)*262144+(63&a.charCodeAt(c+1))*4096+(63&a.charCodeAt(c+2))*64+(63&a.charCodeAt(c+3))-65536)>>>10&1023),b=56320+(1023&b)),0!==h&&(e[g++]=255&h,e[g++]=h>>>8,h=0),e[g++]=b%256,e[g++]=b>>>8;return e.slice(0,g).toString("ucs2")}function hI(a){return f2(a,"binary").toString("utf8")}var hJ="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",hK=f1&&(hI(hJ)==hG(hJ)&&hI||hH(hJ)==hG(hJ)&&hH)||hG,hL=f1?function(a){return f2(a,"utf8").toString("binary")}:function(a){for(var b=[],c=0,d=0,e=0;c<a.length;)switch(d=a.charCodeAt(c++),!0){case d<128:b.push(String.fromCharCode(d));break;case d<2048:b.push(String.fromCharCode(192+(d>>6))),b.push(String.fromCharCode(128+(63&d)));break;case d>=55296&&d<57344:d-=55296,b.push(String.fromCharCode(240+((e=a.charCodeAt(c++)-56320+(d<<10))>>18&7))),b.push(String.fromCharCode(144+(e>>12&63))),b.push(String.fromCharCode(128+(e>>6&63))),b.push(String.fromCharCode(128+(63&e)));break;default:b.push(String.fromCharCode(224+(d>>12))),b.push(String.fromCharCode(128+(d>>6&63))),b.push(String.fromCharCode(128+(63&d)))}return b.join("")},hM=function(){var a={};return function(b,c){var d=b+"|"+(c||"");return a[d]?a[d]:a[d]=RegExp("<(?:\\w+:)?"+b+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+b+">",c||"")}}(),hN=function(){var a=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[RegExp("&"+a[0]+";","ig"),a[1]]});return function(b){for(var c=b.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),d=0;d<a.length;++d)c=c.replace(a[d][0],a[d][1]);return c}}(),hO=function(){var a={};return function(b){return void 0!==a[b]?a[b]:a[b]=RegExp("<(?:vt:)?"+b+">([\\s\\S]*?)</(?:vt:)?"+b+">","g")}}(),hP=/<\/?(?:vt:)?variant>/g,hQ=/<(?:vt:)([^>]*)>([\s\S]*)</;function hR(a,b){var c=ht(a),d=a.match(hO(c.baseType))||[],e=[];if(d.length!=c.size){if(b.WTF)throw Error("unexpected vector length "+d.length+" != "+c.size);return e}return d.forEach(function(a){var b=a.replace(hP,"").match(hQ);b&&e.push({v:hK(b[2]),t:b[1]})}),e}var hS=/(^\s|\s$|\n)/;function hT(a,b){return"<"+a+(b.match(hS)?' xml:space="preserve"':"")+">"+b+"</"+a+">"}function hU(a){return gT(a).map(function(b){return" "+b+'="'+a[b]+'"'}).join("")}function hV(a,b,c){return"<"+a+(null!=c?hU(c):"")+(null!=b?(b.match(hS)?' xml:space="preserve"':"")+">"+b+"</"+a:"/")+">"}function hW(a,b){try{return a.toISOString().replace(/\.\d*/,"")}catch(a){if(b)throw a}return""}function hX(a){if(f1&&Buffer.isBuffer(a))return a.toString("utf8");if("string"==typeof a)return a;if("undefined"!=typeof Uint8Array&&a instanceof Uint8Array)return hK(f7(f8(a)));throw Error("Bad input format: expected Buffer or string")}var hY=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hZ={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},h$=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],h_={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},h0=function(a){for(var b=[],c=0;c<a[0].length;++c)if(a[0][c])for(var d=0,e=a[0][c].length;d<e;d+=10240)b.push.apply(b,a[0][c].slice(d,d+10240));return b},h1=f1?function(a){return a[0].length>0&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(a){return Buffer.isBuffer(a)?a:f2(a)})):h0(a)}:h0,h2=function(a,b,c){for(var d=[],e=b;e<c;e+=2)d.push(String.fromCharCode(io(a,e)));return d.join("").replace(ga,"")},h3=f1?function(a,b,c){return Buffer.isBuffer(a)?a.toString("utf16le",b,c).replace(ga,""):h2(a,b,c)}:h2,h4=function(a,b,c){for(var d=[],e=b;e<b+c;++e)d.push(("0"+a[e].toString(16)).slice(-2));return d.join("")},h5=f1?function(a,b,c){return Buffer.isBuffer(a)?a.toString("hex",b,b+c):h4(a,b,c)}:h4,h6=function(a,b,c){for(var d=[],e=b;e<c;e++)d.push(String.fromCharCode(im(a,e)));return d.join("")},h7=f1?function(a,b,c){return Buffer.isBuffer(a)?a.toString("utf8",b,c):h6(a,b,c)}:h6,h8=function(a,b){var c=iq(a,b);return c>0?h7(a,b+4,b+4+c-1):""},h9=h8,ia=function(a,b){var c=iq(a,b);return c>0?h7(a,b+4,b+4+c-1):""},ib=ia,ic=function(a,b){var c=2*iq(a,b);return c>0?h7(a,b+4,b+4+c-1):""},id=ic,ie=function(a,b){var c=iq(a,b);return c>0?h3(a,b+4,b+4+c):""},ig=ie,ih=function(a,b){var c=iq(a,b);return c>0?h7(a,b+4,b+4+c):""},ii=ih,ij=function(a,b){for(var c=1-2*(a[b+7]>>>7),d=((127&a[b+7])<<4)+(a[b+6]>>>4&15),e=15&a[b+6],f=5;f>=0;--f)e=256*e+a[b+f];return 2047==d?0==e?1/0*c:NaN:(0==d?d=-1022:(d-=1023,e+=0x10000000000000),c*Math.pow(2,d-52)*e)},ik=ij,il=function(a){return Array.isArray(a)||"undefined"!=typeof Uint8Array&&a instanceof Uint8Array};f1&&(h9=function(a,b){if(!Buffer.isBuffer(a))return h8(a,b);var c=a.readUInt32LE(b);return c>0?a.toString("utf8",b+4,b+4+c-1):""},ib=function(a,b){if(!Buffer.isBuffer(a))return ia(a,b);var c=a.readUInt32LE(b);return c>0?a.toString("utf8",b+4,b+4+c-1):""},id=function(a,b){if(!Buffer.isBuffer(a))return ic(a,b);var c=2*a.readUInt32LE(b);return a.toString("utf16le",b+4,b+4+c-1)},ig=function(a,b){if(!Buffer.isBuffer(a))return ie(a,b);var c=a.readUInt32LE(b);return a.toString("utf16le",b+4,b+4+c)},ii=function(a,b){if(!Buffer.isBuffer(a))return ih(a,b);var c=a.readUInt32LE(b);return a.toString("utf8",b+4,b+4+c)},ik=function(a,b){return Buffer.isBuffer(a)?a.readDoubleLE(b):ij(a,b)},il=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||"undefined"!=typeof Uint8Array&&a instanceof Uint8Array}),void 0!==h&&(h3=function(a,b,c){return h.utils.decode(1200,a.slice(b,c)).replace(ga,"")},h7=function(a,b,c){return h.utils.decode(65001,a.slice(b,c))},h9=function(a,b){var c=iq(a,b);return c>0?h.utils.decode(fP,a.slice(b+4,b+4+c-1)):""},ib=function(a,b){var c=iq(a,b);return c>0?h.utils.decode(fO,a.slice(b+4,b+4+c-1)):""},id=function(a,b){var c=2*iq(a,b);return c>0?h.utils.decode(1200,a.slice(b+4,b+4+c-1)):""},ig=function(a,b){var c=iq(a,b);return c>0?h.utils.decode(1200,a.slice(b+4,b+4+c)):""},ii=function(a,b){var c=iq(a,b);return c>0?h.utils.decode(65001,a.slice(b+4,b+4+c)):""});var im=function(a,b){return a[b]},io=function(a,b){return 256*a[b+1]+a[b]},ip=function(a,b){var c=256*a[b+1]+a[b];return c<32768?c:-((65535-c+1)*1)},iq=function(a,b){return 0x1000000*a[b+3]+(a[b+2]<<16)+(a[b+1]<<8)+a[b]},ir=function(a,b){return a[b+3]<<24|a[b+2]<<16|a[b+1]<<8|a[b]};function is(a,b){var c,d,e,f,g,i,j="",k=[];switch(b){case"dbcs":if(i=this.l,f1&&Buffer.isBuffer(this))j=this.slice(this.l,this.l+2*a).toString("utf16le");else for(g=0;g<a;++g)j+=String.fromCharCode(io(this,i)),i+=2;a*=2;break;case"utf8":j=h7(this,this.l,this.l+a);break;case"utf16le":a*=2,j=h3(this,this.l,this.l+a);break;case"wstr":if(void 0===h)return is.call(this,a,"dbcs");j=h.utils.decode(fO,this.slice(this.l,this.l+2*a)),a*=2;break;case"lpstr-ansi":j=h9(this,this.l),a=4+iq(this,this.l);break;case"lpstr-cp":j=ib(this,this.l),a=4+iq(this,this.l);break;case"lpwstr":j=id(this,this.l),a=4+2*iq(this,this.l);break;case"lpp4":a=4+iq(this,this.l),j=ig(this,this.l),2&a&&(a+=2);break;case"8lpp4":a=4+iq(this,this.l),j=ii(this,this.l),3&a&&(a+=4-(3&a));break;case"cstr":for(a=0,j="";0!==(e=im(this,this.l+a++));)k.push(fY(e));j=k.join("");break;case"_wstr":for(a=0,j="";0!==(e=io(this,this.l+a));)k.push(fY(e)),a+=2;a+=2,j=k.join("");break;case"dbcs-cont":for(g=0,j="",i=this.l;g<a;++g){if(this.lens&&-1!==this.lens.indexOf(i))return e=im(this,i),this.l=i+1,f=is.call(this,a-g,e?"dbcs-cont":"sbcs-cont"),k.join("")+f;k.push(fY(io(this,i))),i+=2}j=k.join(""),a*=2;break;case"cpstr":if(void 0!==h){j=h.utils.decode(fO,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(g=0,j="",i=this.l;g!=a;++g){if(this.lens&&-1!==this.lens.indexOf(i))return e=im(this,i),this.l=i+1,f=is.call(this,a-g,e?"dbcs-cont":"sbcs-cont"),k.join("")+f;k.push(fY(im(this,i))),i+=1}j=k.join("");break;default:switch(a){case 1:return c=im(this,this.l),this.l++,c;case 2:return c=("i"===b?ip:io)(this,this.l),this.l+=2,c;case 4:case -4:if("i"===b||(128&this[this.l+3])==0)return c=(a>0?ir:function(a,b){return a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3]})(this,this.l),this.l+=4,c;return d=iq(this,this.l),this.l+=4,d;case 8:case -8:if("f"===b)return d=8==a?ik(this,this.l):ik([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,d;a=8;case 16:j=h5(this,this.l,a)}}return this.l+=a,j}var it=function(a,b,c){a[c]=255&b,a[c+1]=b>>>8&255,a[c+2]=b>>>16&255,a[c+3]=b>>>24&255},iu=function(a,b,c){a[c]=255&b,a[c+1]=b>>8&255,a[c+2]=b>>16&255,a[c+3]=b>>24&255},iv=function(a,b,c){a[c]=255&b,a[c+1]=b>>>8&255};function iw(a,b,c){var d=0,e=0;if("dbcs"===c){for(e=0;e!=b.length;++e)iv(this,b.charCodeAt(e),this.l+2*e);d=2*b.length}else if("sbcs"===c){if(void 0!==h&&874==fP)for(e=0;e!=b.length;++e){var f=h.utils.encode(fP,b.charAt(e));this[this.l+e]=f[0]}else for(e=0,b=b.replace(/[^\x00-\x7F]/g,"_");e!=b.length;++e)this[this.l+e]=255&b.charCodeAt(e);d=b.length}else if("hex"===c){for(;e<a;++e)this[this.l++]=parseInt(b.slice(2*e,2*e+2),16)||0;return this}else if("utf16le"===c){var g=Math.min(this.l+a,this.length);for(e=0;e<Math.min(b.length,a);++e){var i=b.charCodeAt(e);this[this.l++]=255&i,this[this.l++]=i>>8}for(;this.l<g;)this[this.l++]=0;return this}else switch(a){case 1:d=1,this[this.l]=255&b;break;case 2:d=2,this[this.l]=255&b,b>>>=8,this[this.l+1]=255&b;break;case 3:d=3,this[this.l]=255&b,b>>>=8,this[this.l+1]=255&b,b>>>=8,this[this.l+2]=255&b;break;case 4:d=4,it(this,b,this.l);break;case 8:if(d=8,"f"===c){!function(a,b,c){var d=(b<0||1/b==-1/0)<<7,e=0,f=0,g=d?-b:b;isFinite(g)?0==g?e=f=0:(e=Math.floor(Math.log(g)/Math.LN2),f=g*Math.pow(2,52-e),e<=-1023&&(!isFinite(f)||f<0x10000000000000)?e=-1022:(f-=0x10000000000000,e+=1023)):(e=2047,f=26985*!!isNaN(b));for(var h=0;h<=5;++h,f/=256)a[c+h]=255&f;a[c+6]=(15&e)<<4|15&f,a[c+7]=e>>4|d}(this,b,this.l);break}case 16:break;case -4:d=4,iu(this,b,this.l)}return this.l+=d,this}function ix(a,b){var c=h5(this,this.l,a.length>>1);if(c!==a)throw Error(b+"Expected "+a+" saw "+c);this.l+=a.length>>1}function iy(a,b){a.l=b,a.read_shift=is,a.chk=ix,a.write_shift=iw}function iz(a,b){a.l+=b}function iA(a){var b=f3(a);return iy(b,0),b}function iB(a,b,c){if(a){iy(a,a.l||0);for(var d,e,f,g=a.length,h=0,i=0;a.l<g;){128&(h=a.read_shift(1))&&(h=(127&h)+((127&a.read_shift(1))<<7));var j=mN[h]||mN[65535];for(e=1,f=127&(d=a.read_shift(1));e<4&&128&d;++e)f+=(127&(d=a.read_shift(1)))<<7*e;i=a.l+f;var k=j.f&&j.f(a,f,c);if(a.l=i,b(k,j,h))return}}}function iC(){var a=[],b=f1?256:2048,c=function(a){var b=iA(a);return iy(b,0),b},d=c(b),e=function(){d&&(d.length>d.l&&((d=d.slice(0,d.l)).l=d.length),d.length>0&&a.push(d),d=null)},f=function(a){return d&&a<d.length-d.l?d:(e(),d=c(Math.max(a+1,b)))};return{next:f,push:function(a){e(),null==(d=a).l&&(d.l=d.length),f(b)},end:function(){return e(),f9(a)},_bufs:a}}function iD(a,b,c,d){var e,f=+b;if(!isNaN(f)){d||(d=mN[f].p||(c||[]).length||0),e=1+ +(f>=128)+1,d>=128&&++e,d>=16384&&++e,d>=2097152&&++e;var g=a.next(e);f<=127?g.write_shift(1,f):(g.write_shift(1,(127&f)+128),g.write_shift(1,f>>7));for(var h=0;4!=h;++h)if(d>=128)g.write_shift(1,(127&d)+128),d>>=7;else{g.write_shift(1,d);break}d>0&&il(c)&&a.push(c)}}function iE(a,b,c){var d=g6(a);if(b.s?(d.cRel&&(d.c+=b.s.c),d.rRel&&(d.r+=b.s.r)):(d.cRel&&(d.c+=b.c),d.rRel&&(d.r+=b.r)),!c||c.biff<12){for(;d.c>=256;)d.c-=256;for(;d.r>=65536;)d.r-=65536}return d}function iF(a,b,c){var d=g6(a);return d.s=iE(d.s,b.s,c),d.e=iE(d.e,b.s,c),d}function iG(a,b){if(a.cRel&&a.c<0)for(a=g6(a);a.c<0;)a.c+=b>8?16384:256;if(a.rRel&&a.r<0)for(a=g6(a);a.r<0;)a.r+=b>8?1048576:b>5?65536:16384;var c=iN(a);return a.cRel||null==a.cRel||(c=c.replace(/^([A-Z])/,"$$$1")),a.rRel||null==a.rRel||(c=c.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),c}function iH(a,b){return 0!=a.s.r||a.s.rRel||a.e.r!=(b.biff>=12?1048575:b.biff>=8?65536:16384)||a.e.rRel?0!=a.s.c||a.s.cRel||a.e.c!=(b.biff>=12?16383:255)||a.e.cRel?iG(a.s,b.biff)+":"+iG(a.e,b.biff):(a.s.rRel?"":"$")+iJ(a.s.r)+":"+(a.e.rRel?"":"$")+iJ(a.e.r):(a.s.cRel?"":"$")+iL(a.s.c)+":"+(a.e.cRel?"":"$")+iL(a.e.c)}function iI(a){return parseInt(a.replace(/\$(\d+)$/,"$1"),10)-1}function iJ(a){return""+(a+1)}function iK(a){for(var b=a.replace(/^\$([A-Z])/,"$1"),c=0,d=0;d!==b.length;++d)c=26*c+b.charCodeAt(d)-64;return c-1}function iL(a){if(a<0)throw Error("invalid column "+a);var b="";for(++a;a;a=Math.floor((a-1)/26))b=String.fromCharCode((a-1)%26+65)+b;return b}function iM(a){for(var b=0,c=0,d=0;d<a.length;++d){var e=a.charCodeAt(d);e>=48&&e<=57?b=10*b+(e-48):e>=65&&e<=90&&(c=26*c+(e-64))}return{c:c-1,r:b-1}}function iN(a){for(var b=a.c+1,c="";b;b=(b-1)/26|0)c=String.fromCharCode((b-1)%26+65)+c;return c+(a.r+1)}function iO(a){var b=a.indexOf(":");return -1==b?{s:iM(a),e:iM(a)}:{s:iM(a.slice(0,b)),e:iM(a.slice(b+1))}}function iP(a,b){return void 0===b||"number"==typeof b?iP(a.s,a.e):("string"!=typeof a&&(a=iN(a)),"string"!=typeof b&&(b=iN(b)),a==b?a:a+":"+b)}function iQ(a){var b={s:{c:0,r:0},e:{c:0,r:0}},c=0,d=0,e=0,f=a.length;for(c=0;d<f&&!((e=a.charCodeAt(d)-64)<1)&&!(e>26);++d)c=26*c+e;for(b.s.c=--c,c=0;d<f&&!((e=a.charCodeAt(d)-48)<0)&&!(e>9);++d)c=10*c+e;if(b.s.r=--c,d===f||10!=e)return b.e.c=b.s.c,b.e.r=b.s.r,b;for(++d,c=0;d!=f&&!((e=a.charCodeAt(d)-64)<1)&&!(e>26);++d)c=26*c+e;for(b.e.c=--c,c=0;d!=f&&!((e=a.charCodeAt(d)-48)<0)&&!(e>9);++d)c=10*c+e;return b.e.r=--c,b}function iR(a,b){var c="d"==a.t&&b instanceof Date;if(null!=a.z)try{return a.w=gK(a.z,c?gY(b):b)}catch(a){}try{return a.w=gK((a.XF||{}).numFmtId||14*!!c,c?gY(b):b)}catch(a){return""+b}}function iS(a,b,c){return null==a||null==a.t||"z"==a.t?"":void 0!==a.w?a.w:("d"==a.t&&!a.z&&c&&c.dateNF&&(a.z=c.dateNF),"e"==a.t)?jh[a.v]||a.v:void 0==b?iR(a,a.v):iR(a,b)}function iT(a,b){var c=b&&b.sheet?b.sheet:"Sheet1",d={};return d[c]=a,{SheetNames:[c],Sheets:d}}function iU(a,b){return function(a,b,c){var d=c||{},e=(0,d.dense),f=a||(e?[]:{}),g=0,h=0;if(f&&null!=d.origin){if("number"==typeof d.origin)g=d.origin;else{var i="string"==typeof d.origin?iM(d.origin):d.origin;g=i.r,h=i.c}f["!ref"]||(f["!ref"]="A1:A1")}var j={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var k=iQ(f["!ref"]);j.s.c=k.s.c,j.s.r=k.s.r,j.e.c=Math.max(j.e.c,k.e.c),j.e.r=Math.max(j.e.r,k.e.r),-1==g&&(j.e.r=g=k.e.r+1)}for(var l=0;l!=b.length;++l)if(b[l]){if(!Array.isArray(b[l]))throw Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=b[l].length;++m)if(void 0!==b[l][m]){var n={v:b[l][m]},o=g+l,p=h+m;if(j.s.r>o&&(j.s.r=o),j.s.c>p&&(j.s.c=p),j.e.r<o&&(j.e.r=o),j.e.c<p&&(j.e.c=p),!b[l][m]||"object"!=typeof b[l][m]||Array.isArray(b[l][m])||b[l][m]instanceof Date)if(Array.isArray(n.v)&&(n.f=b[l][m][1],n.v=n.v[0]),null===n.v)if(n.f)n.t="n";else if(d.nullError)n.t="e",n.v=0;else{if(!d.sheetStubs)continue;n.t="z"}else"number"==typeof n.v?n.t="n":"boolean"==typeof n.v?n.t="b":n.v instanceof Date?(n.z=d.dateNF||gk[14],d.cellDates?(n.t="d",n.w=gK(n.z,gY(n.v))):(n.t="n",n.v=gY(n.v),n.w=gK(n.z,n.v))):n.t="s";else n=b[l][m];if(e)f[o]||(f[o]=[]),f[o][p]&&f[o][p].z&&(n.z=f[o][p].z),f[o][p]=n;else{var q=iN({c:p,r:o});f[q]&&f[q].z&&(n.z=f[q].z),f[q]=n}}}return j.s.c<1e7&&(f["!ref"]=iP(j)),f}(null,a,b)}function iV(a,b){return b||(b=iA(4)),b.write_shift(4,a),b}function iW(a){var b=a.read_shift(4);return 0===b?"":a.read_shift(b,"dbcs")}function iX(a,b){var c=!1;return null==b&&(c=!0,b=iA(4+2*a.length)),b.write_shift(4,a.length),a.length>0&&b.write_shift(0,a,"dbcs"),c?b.slice(0,b.l):b}function iY(a,b){var c=a.l,d=a.read_shift(1),e=iW(a),f=[],g={t:e,h:e};if((1&d)!=0){for(var h=a.read_shift(4),i=0;i!=h;++i)f.push({ich:a.read_shift(2),ifnt:a.read_shift(2)});g.r=f}else g.r=[{ich:0,ifnt:0}];return a.l=c+b,g}function iZ(a){var b=a.read_shift(4),c=a.read_shift(2);return c+=a.read_shift(1)<<16,a.l++,{c:b,iStyleRef:c}}function i$(a,b){return null==b&&(b=iA(8)),b.write_shift(-4,a.c),b.write_shift(3,a.iStyleRef||a.s),b.write_shift(1,0),b}function i_(a){var b=a.read_shift(2);return b+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:b}}function i0(a,b){return null==b&&(b=iA(4)),b.write_shift(3,a.iStyleRef||a.s),b.write_shift(1,0),b}function i1(a){var b=a.read_shift(4);return 0===b||0xffffffff===b?"":a.read_shift(b,"dbcs")}function i2(a,b){var c=!1;return null==b&&(c=!0,b=iA(127)),b.write_shift(4,a.length>0?a.length:0xffffffff),a.length>0&&b.write_shift(0,a,"dbcs"),c?b.slice(0,b.l):b}function i3(a){var b=a.slice(a.l,a.l+4),c=1&b[0],d=2&b[0];a.l+=4;var e=0===d?ik([0,0,0,0,252&b[0],b[1],b[2],b[3]],0):ir(b,0)>>2;return c?e/100:e}function i4(a,b){null==b&&(b=iA(4));var c=0,d=0,e=100*a;if(a==(0|a)&&a>=-0x20000000&&a<0x20000000?d=1:e==(0|e)&&e>=-0x20000000&&e<0x20000000&&(d=1,c=1),d)b.write_shift(-4,((c?e:a)<<2)+(c+2));else throw Error("unsupported RkNumber "+a)}function i5(a){var b={s:{},e:{}};return b.s.r=a.read_shift(4),b.e.r=a.read_shift(4),b.s.c=a.read_shift(4),b.e.c=a.read_shift(4),b}var i6=function(a,b){return b||(b=iA(16)),b.write_shift(4,a.s.r),b.write_shift(4,a.e.r),b.write_shift(4,a.s.c),b.write_shift(4,a.e.c),b};function i7(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function i8(a,b){return(b||iA(8)).write_shift(8,a,"f")}function i9(a,b){if(b||(b=iA(8)),!a||a.auto)return b.write_shift(4,0),b.write_shift(4,0),b;null!=a.index?(b.write_shift(1,2),b.write_shift(1,a.index)):null!=a.theme?(b.write_shift(1,6),b.write_shift(1,a.theme)):(b.write_shift(1,5),b.write_shift(1,0));var c=a.tint||0;if(c>0?c*=32767:c<0&&(c*=32768),b.write_shift(2,c),a.rgb&&null==a.theme){var d=a.rgb||"FFFFFF";"number"==typeof d&&(d=("000000"+d.toString(16)).slice(-6)),b.write_shift(1,parseInt(d.slice(0,2),16)),b.write_shift(1,parseInt(d.slice(2,4),16)),b.write_shift(1,parseInt(d.slice(4,6),16)),b.write_shift(1,255)}else b.write_shift(2,0),b.write_shift(1,0),b.write_shift(1,0);return b}function ja(a,b){var c=a.read_shift(4);switch(c){case 0:return"";case 0xffffffff:case 0xfffffffe:return({2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"})[a.read_shift(4)]||""}if(c>400)throw Error("Unsupported Clipboard: "+c.toString(16));return a.l-=4,a.read_shift(0,1==b?"lpstr":"lpwstr")}var jb=[80,81],jc={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},jd={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},je={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jf=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jg=g6([0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,8388608,32768,128,8421376,8388736,32896,0xc0c0c0,8421504,0x9999ff,0x993366,0xffffcc,0xccffff,6684774,0xff8080,26316,0xccccff,128,0xff00ff,0xffff00,65535,8388736,8388608,32896,255,52479,0xccffff,0xccffcc,0xffff99,0x99ccff,0xff99cc,0xcc99ff,0xffcc99,3368703,3394764,0x99cc00,0xffcc00,0xff9900,0xff6600,6710937,9868950,13158,3381606,13056,3355392,0x993300,0x993366,3355545,3355443,0xffffff,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(a){return[a>>16&255,a>>8&255,255&a]})),jh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ji={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jk={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jm(a,b){var c,d=function(a){for(var b=[],c=gT(a),d=0;d!==c.length;++d)null==b[a[c[d]]]&&(b[a[c[d]]]=[]),b[a[c[d]]].push(c[d]);return b}(jj),e=[];e[e.length]=hn,e[e.length]=hV("Types",null,{xmlns:hZ.CT,"xmlns:xsd":hZ.xsd,"xmlns:xsi":hZ.xsi}),e=e.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return hV("Default",null,{Extension:a[0],ContentType:a[1]})}));var f=function(d){a[d]&&a[d].length>0&&(c=a[d][0],e[e.length]=hV("Override",null,{PartName:("/"==c[0]?"":"/")+c,ContentType:jk[d][b.bookType]||jk[d].xlsx}))},g=function(c){(a[c]||[]).forEach(function(a){e[e.length]=hV("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:jk[c][b.bookType]||jk[c].xlsx})})},h=function(b){(a[b]||[]).forEach(function(a){e[e.length]=hV("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:d[b][0]})})};return f("workbooks"),g("sheets"),g("charts"),h("themes"),["strs","styles"].forEach(f),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),g("metadata"),h("people"),e.length>2&&(e[e.length]="</Types>",e[1]=e[1].replace("/>",">")),e.join("")}var jn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jo(a){var b=a.lastIndexOf("/");return a.slice(0,b+1)+"_rels/"+a.slice(b+1)+".rels"}function jp(a,b){var c={"!id":{}};if(!a)return c;"/"!==b.charAt(0)&&(b="/"+b);var d={};return(a.match(hq)||[]).forEach(function(a){var e=ht(a);if("<Relationship"===e[0]){var f={};f.Type=e.Type,f.Target=e.Target,f.Id=e.Id,e.TargetMode&&(f.TargetMode=e.TargetMode),c["External"===e.TargetMode?e.Target:hm(e.Target,b)]=f,d[e.Id]=f}}),c["!id"]=d,c}function jq(a){var b=[hn,hV("Relationships",null,{xmlns:hZ.RELS})];return gT(a["!id"]).forEach(function(c){b[b.length]=hV("Relationship",null,a["!id"][c])}),b.length>2&&(b[b.length]="</Relationships>",b[1]=b[1].replace("/>",">")),b.join("")}function jr(a,b,c,d,e,f){if(e||(e={}),a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),b<0)for(b=a["!idx"];a["!id"]["rId"+b];++b);if(a["!idx"]=b+1,e.Id="rId"+b,e.Type=d,e.Target=c,f?e.TargetMode=f:[jn.HLINK,jn.XPATH,jn.XMISS].indexOf(e.Type)>-1&&(e.TargetMode="External"),a["!id"][e.Id])throw Error("Cannot rewrite rId "+b);return a["!id"][e.Id]=e,a[("/"+e.Target).replace("//","/")]=e,b}function js(a,b,c){return'  <rdf:Description rdf:about="'+a+'">\n'+('    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(c||"odf")+"#")+b+'"/>\n  </rdf:Description>\n'}function jt(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fN.version+"</meta:generator></office:meta></office:document-meta>"}var ju=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jv=function(){for(var a=Array(ju.length),b=0;b<ju.length;++b){var c=ju[b],d="(?:"+c[0].slice(0,c[0].indexOf(":"))+":)"+c[0].slice(c[0].indexOf(":")+1);a[b]=RegExp("<"+d+"[^>]*>([\\s\\S]*?)</"+d+">")}return a}();function jw(a){var b={};a=hK(a);for(var c=0;c<ju.length;++c){var d=ju[c],e=a.match(jv[c]);null!=e&&e.length>0&&(b[d[1]]=hx(e[1])),"date"===d[2]&&b[d[1]]&&(b[d[1]]=g4(b[d[1]]))}return b}function jx(a,b,c,d,e){null==e[a]&&null!=b&&""!==b&&(e[a]=b,b=hA(b),d[d.length]=c?hV(a,b,c):hT(a,b))}function jy(a,b){var c=b||{},d=[hn,hV("cp:coreProperties",null,{"xmlns:cp":hZ.CORE_PROPS,"xmlns:dc":hZ.dc,"xmlns:dcterms":hZ.dcterms,"xmlns:dcmitype":hZ.dcmitype,"xmlns:xsi":hZ.xsi})],e={};if(!a&&!c.Props)return d.join("");a&&(null!=a.CreatedDate&&jx("dcterms:created","string"==typeof a.CreatedDate?a.CreatedDate:hW(a.CreatedDate,c.WTF),{"xsi:type":"dcterms:W3CDTF"},d,e),null!=a.ModifiedDate&&jx("dcterms:modified","string"==typeof a.ModifiedDate?a.ModifiedDate:hW(a.ModifiedDate,c.WTF),{"xsi:type":"dcterms:W3CDTF"},d,e));for(var f=0;f!=ju.length;++f){var g=ju[f],h=c.Props&&null!=c.Props[g[1]]?c.Props[g[1]]:a?a[g[1]]:null;!0===h?h="1":!1===h?h="0":"number"==typeof h&&(h=String(h)),null!=h&&jx(g[0],h,null,d,e)}return d.length>2&&(d[d.length]="</cp:coreProperties>",d[1]=d[1].replace("/>",">")),d.join("")}var jz=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jB(a,b,c,d){var e=[];if("string"==typeof a)e=hR(a,d);else for(var f=0;f<a.length;++f)e=e.concat(a[f].map(function(a){return{v:a}}));var g="string"==typeof b?hR(b,d).map(function(a){return a.v}):b,h=0,i=0;if(g.length>0)for(var j=0;j!==e.length;j+=2){switch(i=+e[j+1].v,e[j].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbl\xe4tter":case"\xc7alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":c.Worksheets=i,c.SheetNames=g.slice(h,h+i);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omr\xe5der":c.NamedRanges=i,c.DefinedNames=g.slice(h,h+i);break;case"Charts":case"Diagramme":c.Chartsheets=i,c.ChartNames=g.slice(h,h+i)}h+=i}}function jC(a){var b=[];return a||(a={}),a.Application="SheetJS",b[b.length]=hn,b[b.length]=hV("Properties",null,{xmlns:hZ.EXT_PROPS,"xmlns:vt":hZ.vt}),jz.forEach(function(c){var d;if(void 0!==a[c[1]]){switch(c[2]){case"string":d=hA(String(a[c[1]]));break;case"bool":d=a[c[1]]?"true":"false"}void 0!==d&&(b[b.length]=hV(c[0],d))}}),b[b.length]=hV("HeadingPairs",hV("vt:vector",hV("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+hV("vt:variant",hV("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),b[b.length]=hV("TitlesOfParts",hV("vt:vector",a.SheetNames.map(function(a){return"<vt:lpstr>"+hA(a)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),b.length>2&&(b[b.length]="</Properties>",b[1]=b[1].replace("/>",">")),b.join("")}var jD=/<[^>]+>[^<]*/g;function jE(a){var b=[hn,hV("Properties",null,{xmlns:hZ.CUST_PROPS,"xmlns:vt":hZ.vt})];if(!a)return b.join("");var c=1;return gT(a).forEach(function(d){++c,b[b.length]=hV("property",function(a,b){switch(typeof a){case"string":var c=hV("vt:lpwstr",hA(a));return b&&(c=c.replace(/&quot;/g,"_x0022_")),c;case"number":return hV((0|a)==a?"vt:i4":"vt:r8",hA(String(a)));case"boolean":return hV("vt:bool",a?"true":"false")}if(a instanceof Date)return hV("vt:filetime",hW(a));throw Error("Unable to serialize "+a)}(a[d],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:c,name:hA(d)})}),b.length>2&&(b[b.length]="</Properties>",b[1]=b[1].replace("/>",">")),b.join("")}var jF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jG(a){var b=a.read_shift(4);return new Date((a.read_shift(4)/1e7*0x100000000+b/1e7-0x2b6109100)*1e3).toISOString().replace(/\.000/,"")}function jH(a,b,c){var d=a.l,e=a.read_shift(0,"lpstr-cp");if(c)for(;a.l-d&3;)++a.l;return e}function jI(a,b,c){var d=a.read_shift(0,"lpwstr");return c&&(a.l+=4-(d.length+1&3)&3),d}function jJ(a,b,c){return 31===b?jI(a):jH(a,b,c)}function jK(a,b,c){return jJ(a,b,4*(!1!==c))}function jL(a,b){for(var c=a.read_shift(4),d={},e=0;e!=c;++e){var f=a.read_shift(4),g=a.read_shift(4);d[f]=a.read_shift(g,1200===b?"utf16le":"utf8").replace(ga,"").replace(gb,"!"),1200===b&&g%2&&(a.l+=2)}return 3&a.l&&(a.l=a.l>>3<<2),d}function jM(a){var b=a.read_shift(4),c=a.slice(a.l,a.l+b);return a.l+=b,(3&b)>0&&(a.l+=4-(3&b)&3),c}function jN(a,b,c){var d,e,f=a.read_shift(2),g=c||{};if(a.l+=2,12!==b&&f!==b&&-1===jb.indexOf(b)&&((65534&b)!=4126||(65534&f)!=4126))throw Error("Expected type "+b+" saw "+f);switch(12===b?f:b){case 2:return e=a.read_shift(2,"i"),g.raw||(a.l+=2),e;case 3:return a.read_shift(4,"i");case 11:return 0!==a.read_shift(4);case 19:return a.read_shift(4);case 30:return jH(a,f,4).replace(ga,"");case 31:return jI(a);case 64:return jG(a);case 65:return jM(a);case 71:return(d={}).Size=a.read_shift(4),a.l+=d.Size+3-(d.Size-1)%4,d;case 80:return jK(a,f,!g.raw).replace(ga,"");case 81:return(function(a,b){if(!b)throw Error("VtUnalignedString must have positive length");return jJ(a,b,0)})(a,f).replace(ga,"");case 4108:for(var h=a.read_shift(4),i=[],j=0;j<h/2;++j)i.push(function(a){var b=a.l,c=jN(a,81);return 0==a[a.l]&&0==a[a.l+1]&&a.l-b&2&&(a.l+=2),[c,jN(a,3)]}(a));return i;case 4126:case 4127:return 4127==f?function(a){for(var b=a.read_shift(4),c=[],d=0;d!=b;++d){var e=a.l;c[d]=a.read_shift(0,"lpwstr").replace(ga,""),a.l-e&2&&(a.l+=2)}return c}(a):function(a){for(var b=a.read_shift(4),c=[],d=0;d!=b;++d)c[d]=a.read_shift(0,"lpstr-cp").replace(ga,"");return c}(a);default:throw Error("TypedPropertyValue unrecognized type "+b+" "+f)}}function jO(a,b){var c,d,e,f,g,h=iA(4),i=iA(4);switch(h.write_shift(4,80==a?31:a),a){case 3:i.write_shift(-4,b);break;case 5:(i=iA(8)).write_shift(8,b,"f");break;case 11:i.write_shift(4,+!!b);break;case 64:d=(c=("string"==typeof b?new Date(Date.parse(b)):b).getTime()/1e3+0x2b6109100)%0x100000000,e=(c-d)/0x100000000*1e7,(f=(d*=1e7)/0x100000000|0)>0&&(d%=0x100000000,e+=f),(g=iA(8)).write_shift(4,d),g.write_shift(4,e),i=g;break;case 31:case 80:for((i=iA(4+2*(b.length+1)+(b.length%2?0:2))).write_shift(4,b.length+1),i.write_shift(0,b,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw Error("TypedPropertyValue unrecognized type "+a+" "+b)}return f9([h,i])}function jP(a,b){var c=a.l,d=a.read_shift(4),e=a.read_shift(4),f=[],g=0,h=0,i=-1,j={};for(g=0;g!=e;++g){var k=a.read_shift(4),l=a.read_shift(4);f[g]=[k,l+c]}f.sort(function(a,b){return a[1]-b[1]});var m={};for(g=0;g!=e;++g){if(a.l!==f[g][1]){var n=!0;if(g>0&&b)switch(b[f[g-1][0]].t){case 2:a.l+2===f[g][1]&&(a.l+=2,n=!1);break;case 80:case 4108:a.l<=f[g][1]&&(a.l=f[g][1],n=!1)}if((!b||0==g)&&a.l<=f[g][1]&&(n=!1,a.l=f[g][1]),n)throw Error("Read Error: Expected address "+f[g][1]+" at "+a.l+" :"+g)}if(b){var o=b[f[g][0]];if(m[o.n]=jN(a,o.t,{raw:!0}),"version"===o.p&&(m[o.n]=String(m[o.n]>>16)+"."+("0000"+String(65535&m[o.n])).slice(-4)),"CodePage"==o.n)switch(m[o.n]){case 0:m[o.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case -536:case 65001:case -535:fT(h=m[o.n]>>>0&65535);break;default:throw Error("Unsupported CodePage: "+m[o.n])}}else if(1===f[g][0]){if(fT(h=m.CodePage=jN(a,2)),-1!==i){var p=a.l;a.l=f[i][1],j=jL(a,h),a.l=p}}else if(0===f[g][0]){if(0===h){i=g,a.l=f[g+1][1];continue}j=jL(a,h)}else{var q,r=j[f[g][0]];switch(a[a.l]){case 65:a.l+=4,q=jM(a);break;case 30:case 31:a.l+=4,q=jK(a,a[a.l-4]).replace(/\u0000+$/,"");break;case 3:a.l+=4,q=a.read_shift(4,"i");break;case 19:a.l+=4,q=a.read_shift(4);break;case 5:a.l+=4,q=a.read_shift(8,"f");break;case 11:a.l+=4,q=jV(a,4);break;case 64:a.l+=4,q=g4(jG(a));break;default:throw Error("unparsed value: "+a[a.l])}m[r]=q}}return a.l=c+d,m}var jQ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function jR(a,b,c){var d=iA(8),e=[],f=[],g=8,h=0,i=iA(8),j=iA(8);if(i.write_shift(4,2),i.write_shift(4,1200),j.write_shift(4,1),f.push(i),e.push(j),g+=8+i.length,!b){(j=iA(8)).write_shift(4,0),e.unshift(j);var k=[iA(4)];for(k[0].write_shift(4,a.length),h=0;h<a.length;++h){var l=a[h][0];for((i=iA(8+2*(l.length+1)+(l.length%2?0:2))).write_shift(4,h+2),i.write_shift(4,l.length+1),i.write_shift(0,l,"dbcs");i.l!=i.length;)i.write_shift(1,0);k.push(i)}i=f9(k),f.unshift(i),g+=8+i.length}for(h=0;h<a.length;++h)if(!(b&&!b[a[h][0]]||jQ.indexOf(a[h][0])>-1||jA.indexOf(a[h][0])>-1)&&null!=a[h][1]){var m=a[h][1],n=0;if(b){var o=c[n=+b[a[h][0]]];if("version"==o.p&&"string"==typeof m){var p=m.split(".");m=(p[0]<<16)+(+p[1]||0)}i=jO(o.t,m)}else{var q=function(a){switch(typeof a){case"boolean":return 11;case"number":return(0|a)==a?3:5;case"string":return 31;case"object":if(a instanceof Date)return 64}return -1}(m);-1==q&&(q=31,m=String(m)),i=jO(q,m)}f.push(i),(j=iA(8)).write_shift(4,b?n:2+h),e.push(j),g+=8+i.length}var r=8*(f.length+1);for(h=0;h<f.length;++h)e[h].write_shift(4,r),r+=f[h].length;return d.write_shift(4,g),d.write_shift(4,f.length),f9([d].concat(e).concat(f))}function jS(a,b,c){var d,e=a.content;if(!e)return{};iy(e,0);var f,g,h,i,j=0;e.chk("feff","Byte Order: "),e.read_shift(2);var k=e.read_shift(4),l=e.read_shift(16);if(l!==gR.utils.consts.HEADER_CLSID&&l!==c)throw Error("Bad PropertySet CLSID "+l);if(1!==(f=e.read_shift(4))&&2!==f)throw Error("Unrecognized #Sets: "+f);if(g=e.read_shift(16),i=e.read_shift(4),1===f&&i!==e.l)throw Error("Length mismatch: "+i+" !== "+e.l);2===f&&(h=e.read_shift(16),j=e.read_shift(4));var m=jP(e,b),n={SystemIdentifier:k};for(var o in m)n[o]=m[o];if(n.FMTID=g,1===f)return n;if(j-e.l==2&&(e.l+=2),e.l!==j)throw Error("Length mismatch 2: "+e.l+" !== "+j);try{d=jP(e,null)}catch(a){}for(o in d)n[o]=d[o];return n.FMTID=[g,h],n}function jT(a,b,c,d,e,f){var g=iA(e?68:48),h=[g];g.write_shift(2,65534),g.write_shift(2,0),g.write_shift(4,0x32363237),g.write_shift(16,gR.utils.consts.HEADER_CLSID,"hex"),g.write_shift(4,e?2:1),g.write_shift(16,b,"hex"),g.write_shift(4,e?68:48);var i=jR(a,c,d);if(h.push(i),e){var j=jR(e,null,null);g.write_shift(16,f,"hex"),g.write_shift(4,68+i.length),h.push(j)}return f9(h)}function jU(a,b){return a.read_shift(b),null}function jV(a,b){return 1===a.read_shift(b)}function jW(a,b){return b||(b=iA(2)),b.write_shift(2,+!!a),b}function jX(a){return a.read_shift(2,"u")}function jY(a,b){return b||(b=iA(2)),b.write_shift(2,a),b}function jZ(a,b){for(var c=[],d=a.l+b;a.l<d;)c.push(jX(a,d-a.l));if(d!==a.l)throw Error("Slurp error");return c}function j$(a,b,c){return c||(c=iA(2)),c.write_shift(1,"e"==b?+a:+!!a),c.write_shift(1,+("e"==b)),c}function j_(a,b,c){var d=a.read_shift(c&&c.biff>=12?2:1),e="sbcs-cont",f=fO;c&&c.biff>=8&&(fO=1200),c&&8!=c.biff?12==c.biff&&(e="wstr"):a.read_shift(1)&&(e="dbcs-cont"),c.biff>=2&&c.biff<=5&&(e="cpstr");var g=d?a.read_shift(d,e):"";return fO=f,g}function j0(a,b,c){if(c){if(c.biff>=2&&c.biff<=5)return a.read_shift(b,"cpstr");if(c.biff>=12)return a.read_shift(b,"dbcs-cont")}return 0===a.read_shift(1)?a.read_shift(b,"sbcs-cont"):a.read_shift(b,"dbcs-cont")}function j1(a,b,c){var d=a.read_shift(c&&2==c.biff?1:2);return 0===d?(a.l++,""):j0(a,d,c)}function j2(a,b,c){if(c.biff>5)return j1(a,b,c);var d=a.read_shift(1);return 0===d?(a.l++,""):a.read_shift(d,c.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function j3(a,b,c){return c||(c=iA(3+2*a.length)),c.write_shift(2,a.length),c.write_shift(1,1),c.write_shift(31,a,"utf16le"),c}function j4(a){var b=a.read_shift(4);return b>0?a.read_shift(b,"utf16le").replace(ga,""):""}function j5(a,b){b||(b=iA(6+2*a.length)),b.write_shift(4,1+a.length);for(var c=0;c<a.length;++c)b.write_shift(2,a.charCodeAt(c));return b.write_shift(2,0),b}function j6(a){return[a.read_shift(1),a.read_shift(1),a.read_shift(1),a.read_shift(1)]}function j7(a,b){var c=j6(a,b);return c[3]=0,c}function j8(a){return{r:a.read_shift(2),c:a.read_shift(2),ixfe:a.read_shift(2)}}function j9(a,b,c,d){return d||(d=iA(6)),d.write_shift(2,a),d.write_shift(2,b),d.write_shift(2,c||0),d}function ka(a){return[a.read_shift(2),i3(a)]}function kb(a){var b=a.read_shift(2),c=a.read_shift(2);return{s:{c:a.read_shift(2),r:b},e:{c:a.read_shift(2),r:c}}}function kc(a,b){return b||(b=iA(8)),b.write_shift(2,a.s.r),b.write_shift(2,a.e.r),b.write_shift(2,a.s.c),b.write_shift(2,a.e.c),b}function kd(a){var b=a.read_shift(2),c=a.read_shift(2);return{s:{c:a.read_shift(1),r:b},e:{c:a.read_shift(1),r:c}}}function ke(a){a.l+=4;var b=a.read_shift(2),c=a.read_shift(2),d=a.read_shift(2);return a.l+=12,[c,b,d]}function kf(a){a.l+=2,a.l+=a.read_shift(2)}var kg={0:kf,4:kf,5:kf,6:kf,7:function(a){return a.l+=4,a.cf=a.read_shift(2),{}},8:kf,9:kf,10:kf,11:kf,12:kf,13:function(a){var b={};return a.l+=4,a.l+=16,b.fSharedNote=a.read_shift(2),a.l+=4,b},14:kf,15:kf,16:kf,17:kf,18:kf,19:kf,20:kf,21:ke};function kh(a,b){var c={BIFFVer:0,dt:0};switch(c.BIFFVer=a.read_shift(2),(b-=2)>=2&&(c.dt=a.read_shift(2),a.l-=2),c.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(b>6)throw Error("Unexpected BIFF Ver "+c.BIFFVer)}return a.read_shift(b),c}function ki(a,b,c){var d=1536,e=16;switch(c.bookType){case"biff8":case"xla":break;case"biff5":d=1280,e=8;break;case"biff4":d=4,e=6;break;case"biff3":d=3,e=6;break;case"biff2":d=2,e=4;break;default:throw Error("unsupported BIFF version")}var f=iA(e);return f.write_shift(2,d),f.write_shift(2,b),e>4&&f.write_shift(2,29282),e>6&&f.write_shift(2,1997),e>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function kj(a,b,c){var d=0;c&&2==c.biff||(d=a.read_shift(2));var e=a.read_shift(2);return c&&2==c.biff&&(d=1-(e>>15),e&=32767),[{Unsynced:1&d,DyZero:(2&d)>>1,ExAsc:(4&d)>>2,ExDsc:(8&d)>>3},e]}function kk(a,b,c){var d=a.l+b,e=8!=c.biff&&c.biff?2:4,f=a.read_shift(e),g=a.read_shift(e),h=a.read_shift(2),i=a.read_shift(2);return a.l=d,{s:{r:f,c:h},e:{r:g,c:i}}}function kl(a,b,c,d){var e=c&&5==c.biff;d||(d=iA(e?16:20)),d.write_shift(2,0),a.style?(d.write_shift(2,a.numFmtId||0),d.write_shift(2,65524)):(d.write_shift(2,a.numFmtId||0),d.write_shift(2,b<<4));var f=0;return a.numFmtId>0&&e&&(f|=1024),d.write_shift(4,f),d.write_shift(4,0),e||d.write_shift(4,0),d.write_shift(2,0),d}function km(a,b,c){var d,e=j8(a,6);(2==c.biff||9==b)&&++a.l;var f=(d=a.read_shift(1),1===a.read_shift(1)?d:1===d);return e.val=f,e.t=!0===f||!1===f?"b":"e",e}var kn=function(a,b,c){return 0===b?"":j2(a,b,c)};function ko(a,b,c){var d,e=a.read_shift(2),f={fBuiltIn:1&e,fWantAdvise:e>>>1&1,fWantPict:e>>>2&1,fOle:e>>>3&1,fOleLink:e>>>4&1,cf:e>>>5&1023,fIcon:e>>>15&1};return 14849===c.sbcch&&(d=function(a,b,c){a.l+=4,b-=4;var d=a.l+b,e=j_(a,b,c),f=a.read_shift(2);if(f!==(d-=a.l))throw Error("Malformed AddinUdf: padding = "+d+" != "+f);return a.l+=f,e}(a,b-2,c)),f.body=d||a.read_shift(b-2),"string"==typeof d&&(f.Name=d),f}var kp=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kq(a,b,c){var d,e,f,g,h,i,j,k=a.l+b,l=a.read_shift(2),m=a.read_shift(1),n=a.read_shift(1),o=a.read_shift(c&&2==c.biff?1:2),p=0;(!c||c.biff>=5)&&(5!=c.biff&&(a.l+=2),p=a.read_shift(2),5==c.biff&&(a.l+=2),a.l+=4);var q=j0(a,n,c);32&l&&(q=kp[q.charCodeAt(0)]);var r=k-a.l;return c&&2==c.biff&&--r,{chKey:m,Name:q,itab:p,rgce:k!=a.l&&0!==o&&r>0?(d=a,e=r,f=c,g=o,i=d.l+e,j=lQ(d,g,f),i!==d.l&&(h=lP(d,i-d.l,j,f)),[j,h]):[]}}function kr(a,b,c){if(c.biff<8){var d,e,f,g;return d=a,e=b,f=c,3==d[d.l+1]&&d[d.l]++,3==(g=j_(d,e,f)).charCodeAt(0)?g.slice(1):g}for(var h=[],i=a.l+b,j=a.read_shift(c.biff>8?4:2);0!=j--;)h.push(function(a,b,c){var d=c.biff>8?4:2;return[a.read_shift(d),a.read_shift(d,"i"),a.read_shift(d,"i")]}(a,c.biff,c));if(a.l!=i)throw Error("Bad ExternSheet: "+a.l+" != "+i);return h}function ks(a,b,c){var d=kd(a,6);switch(c.biff){case 2:a.l++,b-=7;break;case 3:case 4:a.l+=2,b-=8;break;default:a.l+=6,b-=12}return[d,function(a,b,c){var d,e,f=a.l+b,g=2==c.biff?1:2,h=a.read_shift(g);if(65535==h)return[[],(d=b-2,void(a.l+=d))];var i=lQ(a,h,c);return b!==h+g&&(e=lP(a,b-h-g,i,c)),a.l=f,[i,e]}(a,b,c,d)]}var kt={8:function(a,b){var c=a.l+b;a.l+=10;var d=a.read_shift(2);a.l+=4,a.l+=2,a.l+=2,a.l+=2,a.l+=4;var e=a.read_shift(1);return a.l+=e,a.l=c,{fmt:d}}};function ku(a,b,c){if(!c.cellStyles)return void(a.l+=b);var d=c&&c.biff>=12?4:2,e=a.read_shift(d),f=a.read_shift(d),g=a.read_shift(d),h=a.read_shift(d),i=a.read_shift(2);2==d&&(a.l+=2);var j={s:e,e:f,w:g,ixfe:h,flags:i};return(c.biff>=5||!c.biff)&&(j.level=i>>8&7),j}var kv=[2,3,48,49,131,139,140,245],kw=function(){var a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},b=gV({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function c(b,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var e=iU(function(b,c){var d=[],e=f3(1);switch(c.type){case"base64":e=f5(f0(b));break;case"binary":e=f5(b);break;case"buffer":case"array":e=b}iy(e,0);var f=e.read_shift(1),g=!!(136&f),i=!1,j=!1;switch(f){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:i=!0,g=!0;break;case 140:j=!0;break;default:throw Error("DBF Unsupported Version: "+f.toString(16))}var k=0,l=521;2==f&&(k=e.read_shift(2)),e.l+=3,2!=f&&(k=e.read_shift(4)),k>1048576&&(k=1e6),2!=f&&(l=e.read_shift(2));var m=e.read_shift(2),n=c.codepage||1252;2!=f&&(e.l+=16,e.read_shift(1),0!==e[e.l]&&(n=a[e[e.l]]),e.l+=1,e.l+=2),j&&(e.l+=36);for(var o=[],p={},q=Math.min(e.length,2==f?521:l-10-264*!!i),r=j?32:11;e.l<q&&13!=e[e.l];)switch((p={}).name=h.utils.decode(n,e.slice(e.l,e.l+r)).replace(/[\u0000\r\n].*$/g,""),e.l+=r,p.type=String.fromCharCode(e.read_shift(1)),2!=f&&!j&&(p.offset=e.read_shift(4)),p.len=e.read_shift(1),2==f&&(p.offset=e.read_shift(2)),p.dec=e.read_shift(1),p.name.length&&o.push(p),2!=f&&(e.l+=j?13:14),p.type){case"B":(!i||8!=p.len)&&c.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw Error("Unknown Field Type: "+p.type)}if(13!==e[e.l]&&(e.l=l-1),13!==e.read_shift(1))throw Error("DBF Terminator not found "+e.l+" "+e[e.l]);e.l=l;var s=0,t=0;for(t=0,d[0]=[];t!=o.length;++t)d[0][t]=o[t].name;for(;k-- >0;){if(42===e[e.l]){e.l+=m;continue}for(++e.l,d[++s]=[],t=0,t=0;t!=o.length;++t){var u=e.slice(e.l,e.l+o[t].len);e.l+=o[t].len,iy(u,0);var v=h.utils.decode(n,u);switch(o[t].type){case"C":v.trim().length&&(d[s][t]=v.replace(/\s+$/,""));break;case"D":8===v.length?d[s][t]=new Date(+v.slice(0,4),v.slice(4,6)-1,+v.slice(6,8)):d[s][t]=v;break;case"F":d[s][t]=parseFloat(v.trim());break;case"+":case"I":d[s][t]=j?0x80000000^u.read_shift(-4,"i"):u.read_shift(4,"i");break;case"L":switch(v.trim().toUpperCase()){case"Y":case"T":d[s][t]=!0;break;case"N":case"F":d[s][t]=!1;break;case"":case"?":break;default:throw Error("DBF Unrecognized L:|"+v+"|")}break;case"M":if(!g)throw Error("DBF Unexpected MEMO for type "+f.toString(16));d[s][t]="##MEMO##"+(j?parseInt(v.trim(),10):u.read_shift(4));break;case"N":(v=v.replace(/\u0000/g,"").trim())&&"."!=v&&(d[s][t]=+v||0);break;case"@":d[s][t]=new Date(u.read_shift(-8,"f")-621356832e5);break;case"T":d[s][t]=new Date((u.read_shift(4)-2440588)*864e5+u.read_shift(4));break;case"Y":d[s][t]=u.read_shift(4,"i")/1e4+u.read_shift(4,"i")/1e4*0x100000000;break;case"O":d[s][t]=-u.read_shift(-8,"f");break;case"B":if(i&&8==o[t].len){d[s][t]=u.read_shift(8,"f");break}case"G":case"P":u.l+=o[t].len;break;case"0":if("_NullFlags"===o[t].name)break;default:throw Error("DBF Unsupported data type "+o[t].type)}}}if(2!=f&&e.l<e.length&&26!=e[e.l++])throw Error("DBF EOF Marker missing "+(e.l-1)+" of "+e.length+" "+e[e.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=o,d}(b,d),d);return e["!cols"]=d.DBF.map(function(a){return{wch:a.len,DBF:a}}),delete d.DBF,e}var d={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(a,b){try{return iT(c(a,b),b)}catch(a){if(b&&b.WTF)throw a}return{SheetNames:[],Sheets:{}}},to_sheet:c,from_sheet:function(a,c){var e=c||{};if(+e.codepage>=0&&fT(+e.codepage),"string"==e.type)throw Error("Cannot write DBF to JS string");var f=iC(),g=nq(a,{header:1,raw:!0,cellDates:!0}),h=g[0],i=g.slice(1),j=a["!cols"]||[],k=0,l=0,m=0,n=1;for(k=0;k<h.length;++k){if(((j[k]||{}).DBF||{}).name){h[k]=j[k].DBF.name,++m;continue}if(null!=h[k]){if(++m,"number"==typeof h[k]&&(h[k]=h[k].toString(10)),"string"!=typeof h[k])throw Error("DBF Invalid column name "+h[k]+" |"+typeof h[k]+"|");if(h.indexOf(h[k])!==k){for(l=0;l<1024;++l)if(-1==h.indexOf(h[k]+"_"+l)){h[k]+="_"+l;break}}}}var o=iQ(a["!ref"]),p=[],q=[],r=[];for(k=0;k<=o.e.c-o.s.c;++k){var s="",t="",u=0,v=[];for(l=0;l<i.length;++l)null!=i[l][k]&&v.push(i[l][k]);if(0==v.length||null==h[k]){p[k]="?";continue}for(l=0;l<v.length;++l){switch(typeof v[l]){case"number":t="B";break;case"string":default:t="C";break;case"boolean":t="L";break;case"object":t=v[l]instanceof Date?"D":"C"}u=Math.max(u,String(v[l]).length),s=s&&s!=t?"C":t}u>250&&(u=250),"C"==(t=((j[k]||{}).DBF||{}).type)&&j[k].DBF.len>u&&(u=j[k].DBF.len),"B"==s&&"N"==t&&(s="N",r[k]=j[k].DBF.dec,u=j[k].DBF.len),q[k]="C"==s||"N"==t?u:d[s]||0,n+=q[k],p[k]=s}var w=f.next(32);for(w.write_shift(4,0x13021130),w.write_shift(4,i.length),w.write_shift(2,296+32*m),w.write_shift(2,n),k=0;k<4;++k)w.write_shift(4,0);for(w.write_shift(4,(+b[fP]||3)<<8),k=0,l=0;k<h.length;++k)if(null!=h[k]){var x=f.next(32),y=(h[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,y,"sbcs"),x.write_shift(1,"?"==p[k]?"C":p[k],"sbcs"),x.write_shift(4,l),x.write_shift(1,q[k]||d[p[k]]||0),x.write_shift(1,r[k]||0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),l+=q[k]||d[p[k]]||0}var z=f.next(264);for(z.write_shift(4,13),k=0;k<65;++k)z.write_shift(4,0);for(k=0;k<i.length;++k){var A=f.next(n);for(A.write_shift(1,0),l=0;l<h.length;++l)if(null!=h[l])switch(p[l]){case"L":A.write_shift(1,null==i[k][l]?63:i[k][l]?84:70);break;case"B":A.write_shift(8,i[k][l]||0,"f");break;case"N":var B="0";for("number"==typeof i[k][l]&&(B=i[k][l].toFixed(r[l]||0)),m=0;m<q[l]-B.length;++m)A.write_shift(1,32);A.write_shift(1,B,"sbcs");break;case"D":i[k][l]?(A.write_shift(4,("0000"+i[k][l].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(i[k][l].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+i[k][l].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=i[k][l]?i[k][l]:"").slice(0,q[l]);for(A.write_shift(1,C,"sbcs"),m=0;m<q[l]-C.length;++m)A.write_shift(1,32)}}return f.next(1).write_shift(1,26),f.end()}}}(),kx=function(){var a={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"",a:"\xc6",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},b=RegExp("\x1bN("+gT(a).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),c=function(b,c){var d=a[c];return"number"==typeof d?fZ(d):d},d=function(a,b,c){var d=b.charCodeAt(0)-32<<4|c.charCodeAt(0)-48;return 59==d?a:fZ(d)};function e(a,e){var f,g=a.split(/[\n\r]+/),i=-1,j=-1,k=0,l=0,m=[],n=[],o=null,p={},q=[],r=[],s=[],t=0;for(+e.codepage>=0&&fT(+e.codepage);k!==g.length;++k){t=0;var u,v=g[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,d).replace(b,c),w=v.replace(/;;/g,"\0").split(";").map(function(a){return a.replace(/\u0000/g,";")}),x=w[0];if(v.length>0)switch(x){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&n.push(v.slice(3).replace(/;;/g,";"));break;case"C":var y=!1,z=!1,A=!1,B=!1,C=-1,D=-1;for(l=1;l<w.length;++l)switch(w[l].charAt(0)){case"A":case"G":break;case"X":j=parseInt(w[l].slice(1))-1,z=!0;break;case"Y":for(i=parseInt(w[l].slice(1))-1,z||(j=0),f=m.length;f<=i;++f)m[f]=[];break;case"K":'"'===(u=w[l].slice(1)).charAt(0)?u=u.slice(1,u.length-1):"TRUE"===u?u=!0:"FALSE"===u?u=!1:isNaN(g8(u))?isNaN(ha(u).getDate())||(u=g4(u)):(u=g8(u),null!==o&&gH(o)&&(u=g0(u))),void 0!==h&&"string"==typeof u&&"string"!=(e||{}).type&&(e||{}).codepage&&(u=h.utils.decode(e.codepage,u)),y=!0;break;case"E":B=!0;var E=lv(w[l].slice(1),{r:i,c:j});m[i][j]=[m[i][j],E];break;case"S":A=!0,m[i][j]=[m[i][j],"S5S"];break;case"R":C=parseInt(w[l].slice(1))-1;break;case"C":D=parseInt(w[l].slice(1))-1;break;default:if(e&&e.WTF)throw Error("SYLK bad record "+v)}if(y&&(m[i][j]&&2==m[i][j].length?m[i][j][0]=u:m[i][j]=u,o=null),A){if(B)throw Error("SYLK shared formula cannot have own formula");var F=C>-1&&m[C][D];if(!F||!F[1])throw Error("SYLK shared formula cannot find base");m[i][j][1]=ly(F[1],{r:i-C,c:j-D})}break;case"F":var G=0;for(l=1;l<w.length;++l)switch(w[l].charAt(0)){case"X":j=parseInt(w[l].slice(1))-1,++G;break;case"Y":for(i=parseInt(w[l].slice(1))-1,f=m.length;f<=i;++f)m[f]=[];break;case"M":t=parseInt(w[l].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":o=n[parseInt(w[l].slice(1))];break;case"W":for(f=parseInt((s=w[l].slice(1).split(" "))[0],10);f<=parseInt(s[1],10);++f)t=parseInt(s[2],10),r[f-1]=0===t?{hidden:!0}:{wch:t},k3(r[f-1]);break;case"C":r[j=parseInt(w[l].slice(1))-1]||(r[j]={});break;case"R":q[i=parseInt(w[l].slice(1))-1]||(q[i]={}),t>0?(q[i].hpt=t,q[i].hpx=k5(t)):0===t&&(q[i].hidden=!0);break;default:if(e&&e.WTF)throw Error("SYLK bad record "+v)}G<1&&(o=null);break;default:if(e&&e.WTF)throw Error("SYLK bad record "+v)}}return q.length>0&&(p["!rows"]=q),r.length>0&&(p["!cols"]=r),e&&e.sheetRows&&(m=m.slice(0,e.sheetRows)),[m,p]}function f(a,b){var c=function(a,b){switch(b.type){case"base64":return e(f0(a),b);case"binary":return e(a,b);case"buffer":return e(f1&&Buffer.isBuffer(a)?a.toString("binary"):f7(a),b);case"array":return e(g5(a),b)}throw Error("Unrecognized type "+b.type)}(a,b),d=c[0],f=c[1],g=iU(d,b);return gT(f).forEach(function(a){g[a]=f[a]}),g}return a["|"]=254,{to_workbook:function(a,b){return iT(f(a,b),b)},to_sheet:f,from_sheet:function(a,b){var c,d=["ID;PWXL;N;E"],e=[],f=iQ(a["!ref"]),g=Array.isArray(a);d.push("P;PGeneral"),d.push("F;P0;DG0G8;M255"),a["!cols"]&&a["!cols"].forEach(function(a,b){var c="F;W"+(b+1)+" "+(b+1)+" ";a.hidden?c+="0":("number"!=typeof a.width||a.wpx||(a.wpx=k$(a.width)),"number"!=typeof a.wpx||a.wch||(a.wch=k_(a.wpx)),"number"==typeof a.wch&&(c+=Math.round(a.wch)))," "!=c.charAt(c.length-1)&&d.push(c)}),a["!rows"]&&a["!rows"].forEach(function(a,b){var c="F;";a.hidden?c+="M0;":a.hpt?c+="M"+20*a.hpt+";":a.hpx&&(c+="M"+20*k4(a.hpx)+";"),c.length>2&&d.push(c+"R"+(b+1))}),d.push("B;Y"+(f.e.r-f.s.r+1)+";X"+(f.e.c-f.s.c+1)+";D"+[f.s.c,f.s.r,f.e.c,f.e.r].join(" "));for(var h=f.s.r;h<=f.e.r;++h)for(var i=f.s.c;i<=f.e.c;++i){var j=iN({r:h,c:i});(c=g?(a[h]||[])[i]:a[j])&&(null!=c.v||c.f&&!c.F)&&e.push(function(a,b,c,d){var e="C;Y"+(c+1)+";X"+(d+1)+";K";switch(a.t){case"n":e+=a.v||0,a.f&&!a.F&&(e+=";E"+lx(a.f,{r:c,c:d}));break;case"b":e+=a.v?"TRUE":"FALSE";break;case"e":e+=a.w||a.v;break;case"d":e+='"'+(a.w||a.v)+'"';break;case"s":e+='"'+a.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return e}(c,0,h,i,b))}return d.join("\r\n")+"\r\n"+e.join("\r\n")+"\r\nE\r\n"}}}(),ky=function(){var a,b;function c(a,b){for(var c=a.split("\n"),d=-1,e=-1,f=0,g=[];f!==c.length;++f){if("BOT"===c[f].trim()){g[++d]=[],e=0;continue}if(!(d<0)){for(var h=c[f].trim().split(","),i=h[0],j=h[1],k=c[++f]||"";1&(k.match(/["]/g)||[]).length&&f<c.length-1;)k+="\n"+c[++f];switch(k=k.trim(),+i){case -1:if("BOT"===k){g[++d]=[],e=0;continue}if("EOD"!==k)throw Error("Unrecognized DIF special command "+k);break;case 0:"TRUE"===k?g[d][e]=!0:"FALSE"===k?g[d][e]=!1:isNaN(g8(j))?isNaN(ha(j).getDate())?g[d][e]=j:g[d][e]=g4(j):g[d][e]=g8(j),++e;break;case 1:(k=(k=k.slice(1,k.length-1)).replace(/""/g,'"'))&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),g[d][e++]=""!==k?k:null}if("EOD"===k)break}}return b&&b.sheetRows&&(g=g.slice(0,b.sheetRows)),g}function d(a,b){return iU(function(a,b){switch(b.type){case"base64":return c(f0(a),b);case"binary":return c(a,b);case"buffer":return c(f1&&Buffer.isBuffer(a)?a.toString("binary"):f7(a),b);case"array":return c(g5(a),b)}throw Error("Unrecognized type "+b.type)}(a,b),b)}return{to_workbook:function(a,b){return iT(d(a,b),b)},to_sheet:d,from_sheet:(a=function(a,b,c,d,e){a.push(b),a.push(c+","+d),a.push('"'+e.replace(/"/g,'""')+'"')},b=function(a,b,c,d){a.push(b+","+c),a.push(1==b?'"'+d.replace(/"/g,'""')+'"':d)},function(c){var d,e=[],f=iQ(c["!ref"]),g=Array.isArray(c);a(e,"TABLE",0,1,"sheetjs"),a(e,"VECTORS",0,f.e.r-f.s.r+1,""),a(e,"TUPLES",0,f.e.c-f.s.c+1,""),a(e,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){b(e,-1,0,"BOT");for(var i=f.s.c;i<=f.e.c;++i){var j=iN({r:h,c:i});if(!(d=g?(c[h]||[])[i]:c[j])){b(e,1,0,"");continue}switch(d.t){case"n":var k=d.w;k||null==d.v||(k=d.v),null==k?!d.f||d.F?b(e,1,0,""):b(e,1,0,"="+d.f):b(e,0,k,"V");break;case"b":b(e,0,+!!d.v,d.v?"TRUE":"FALSE");break;case"s":b(e,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=gK(d.z||gk[14],gY(g4(d.v)))),b(e,0,d.w,"V");break;default:b(e,1,0,"")}}}return b(e,-1,0,"EOD"),e.join("\r\n")})}}(),kz=function(){function a(a){return a.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function b(a,b){return iU(function(a,b){for(var c=a.split("\n"),d=-1,e=-1,f=0,g=[];f!==c.length;++f){var h=c[f].trim().split(":");if("cell"===h[0]){var i=iM(h[1]);if(g.length<=i.r)for(d=g.length;d<=i.r;++d)g[d]||(g[d]=[]);switch(d=i.r,e=i.c,h[2]){case"t":g[d][e]=h[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":g[d][e]=+h[3];break;case"vtf":var j=h[h.length-1];case"vtc":"nl"===h[3]?g[d][e]=!!+h[4]:g[d][e]=+h[4],"vtf"==h[2]&&(g[d][e]=[g[d][e],j])}}}return b&&b.sheetRows&&(g=g.slice(0,b.sheetRows)),g}(a,b),b)}var c="--SocialCalcSpreadsheetControlSave\nContent-type: text/plain; charset=UTF-8\n";return{to_workbook:function(a,c){return iT(b(a,c),c)},to_sheet:b,from_sheet:function(b){return["socialcalc:version:1.5\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave",c,"# SocialCalc Spreadsheet Control Save\npart:sheet",c,function(b){if(!b||!b["!ref"])return"";for(var c,d=[],e=[],f="",g=iO(b["!ref"]),h=Array.isArray(b),i=g.s.r;i<=g.e.r;++i)for(var j=g.s.c;j<=g.e.c;++j)if(f=iN({r:i,c:j}),(c=h?(b[i]||[])[j]:b[f])&&null!=c.v&&"z"!==c.t){switch(e=["cell",f,"t"],c.t){case"s":case"str":e.push(a(c.v));break;case"n":c.f?(e[2]="vtf",e[3]="n",e[4]=c.v,e[5]=a(c.f)):(e[2]="v",e[3]=c.v);break;case"b":e[2]="vt"+(c.f?"f":"c"),e[3]="nl",e[4]=c.v?"1":"0",e[5]=a(c.f||(c.v?"TRUE":"FALSE"));break;case"d":var k=gY(g4(c.v));e[2]="vtc",e[3]="nd",e[4]=""+k,e[5]=c.w||gK(c.z||gk[14],k);break;case"e":continue}d.push(e.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join("\n")}(b),"--SocialCalcSpreadsheetControlSave--"].join("\n")}}}(),kA=function(){function a(a,b,c,d,e){e.raw?b[c][d]=a:""===a||("TRUE"===a?b[c][d]=!0:"FALSE"===a?b[c][d]=!1:isNaN(g8(a))?isNaN(ha(a).getDate())?b[c][d]=a:b[c][d]=g4(a):b[c][d]=g8(a))}var b={44:",",9:"	",59:";",124:"|"},c={44:3,9:2,59:1,124:0};function d(a){for(var d={},e=!1,f=0,g=0;f<a.length;++f)34==(g=a.charCodeAt(f))?e=!e:!e&&g in b&&(d[g]=(d[g]||0)+1);for(f in g=[],d)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f]);if(!g.length)for(f in d=c)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f]);return g.sort(function(a,b){return a[0]-b[0]||c[a[1]]-c[b[1]]}),b[g.pop()[1]]||44}function e(b,c){var e,f="",g="string"==c.type?[0,0,0,0]:nj(b,c);switch(c.type){case"base64":f=f0(b);break;case"binary":case"string":f=b;break;case"buffer":f=65001==c.codepage?b.toString("utf8"):c.codepage&&void 0!==h?h.utils.decode(c.codepage,b):f1&&Buffer.isBuffer(b)?b.toString("binary"):f7(b);break;case"array":f=g5(b);break;default:throw Error("Unrecognized type "+c.type)}return(239==g[0]&&187==g[1]&&191==g[2]?f=hK(f.slice(3)):"string"!=c.type&&"buffer"!=c.type&&65001==c.codepage?f=hK(f):"binary"==c.type&&void 0!==h&&c.codepage&&(f=h.utils.decode(c.codepage,h.utils.encode(28591,f))),"socialcalc:version:"==f.slice(0,19))?kz.to_sheet("string"==c.type?f:hK(f),c):(e=f,!(c&&c.PRN)||c.FS||"sep="==e.slice(0,4)||e.indexOf("	")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0?function(a,b){var c,e=b||{},f="",g=e.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};"sep="==a.slice(0,4)?13==a.charCodeAt(5)&&10==a.charCodeAt(6)?(f=a.charAt(4),a=a.slice(7)):13==a.charCodeAt(5)||10==a.charCodeAt(5)?(f=a.charAt(4),a=a.slice(6)):f=d(a.slice(0,1024)):f=e&&e.FS?e.FS:d(a.slice(0,1024));var i=0,j=0,k=0,l=0,m=0,n=f.charCodeAt(0),o=!1,p=0,q=a.charCodeAt(0);a=a.replace(/\r\n/mg,"\n");var r=null!=e.dateNF?RegExp("^"+("number"==typeof(c=e.dateNF)?gk[c]:c).replace(gP,"(\\d+)")+"$"):null;function s(){var b=a.slice(l,m),c={};if('"'==b.charAt(0)&&'"'==b.charAt(b.length-1)&&(b=b.slice(1,-1).replace(/""/g,'"')),0===b.length)c.t="z";else if(e.raw)c.t="s",c.v=b;else if(0===b.trim().length)c.t="s",c.v=b;else if(61==b.charCodeAt(0))34==b.charCodeAt(1)&&34==b.charCodeAt(b.length-1)?(c.t="s",c.v=b.slice(2,-1).replace(/""/g,'"')):1!=b.length?(c.t="n",c.f=b.slice(1)):(c.t="s",c.v=b);else if("TRUE"==b)c.t="b",c.v=!0;else if("FALSE"==b)c.t="b",c.v=!1;else if(isNaN(k=g8(b)))if(!isNaN(ha(b).getDate())||r&&b.match(r)){c.z=e.dateNF||gk[14];var d,f,o,s,t,u,v,w,x,y,z=0;r&&b.match(r)&&(d=e.dateNF,f=b.match(r)||[],o=-1,s=-1,t=-1,u=-1,v=-1,w=-1,(d.match(gP)||[]).forEach(function(a,b){var c=parseInt(f[b+1],10);switch(a.toLowerCase().charAt(0)){case"y":o=c;break;case"d":t=c;break;case"h":u=c;break;case"s":w=c;break;case"m":u>=0?v=c:s=c}}),w>=0&&-1==v&&s>=0&&(v=s,s=-1),7==(x=(""+(o>=0?o:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(t>=1?t:1)).slice(-2)).length&&(x="0"+x),8==x.length&&(x="20"+x),y=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(v>=0?v:0)).slice(-2)+":"+("00"+(w>=0?w:0)).slice(-2),b=-1==u&&-1==v&&-1==w?x:-1==o&&-1==s&&-1==t?y:x+"T"+y,z=1),e.cellDates?(c.t="d",c.v=g4(b,z)):(c.t="n",c.v=gY(g4(b,z))),!1!==e.cellText&&(c.w=gK(c.z,c.v instanceof Date?gY(c.v):c.v)),e.cellNF||delete c.z}else c.t="s",c.v=b;else c.t="n",!1!==e.cellText&&(c.w=b),c.v=k;if("z"==c.t||(e.dense?(g[i]||(g[i]=[]),g[i][j]=c):g[iN({c:j,r:i})]=c),l=m+1,q=a.charCodeAt(l),h.e.c<j&&(h.e.c=j),h.e.r<i&&(h.e.r=i),p==n)++j;else if(j=0,++i,e.sheetRows&&e.sheetRows<=i)return!0}b:for(;m<a.length;++m)switch(p=a.charCodeAt(m)){case 34:34===q&&(o=!o);break;case n:case 10:case 13:if(!o&&s())break b}return m-l>0&&s(),g["!ref"]=iP(h),g}(e,c):iU(function(b,c){var d=c||{},e=[];if(!b||0===b.length)return e;for(var f=b.split(/[\r\n]/),g=f.length-1;g>=0&&0===f[g].length;)--g;for(var h=10,i=0,j=0;j<=g;++j)-1==(i=f[j].indexOf(" "))?i=f[j].length:i++,h=Math.max(h,i);for(j=0;j<=g;++j){e[j]=[];var k=0;for(a(f[j].slice(0,h).trim(),e,j,k,d),k=1;k<=(f[j].length-h)/10+1;++k)a(f[j].slice(h+(k-1)*10,h+10*k).trim(),e,j,k,d)}return d.sheetRows&&(e=e.slice(0,d.sheetRows)),e}(e,c),c))}return{to_workbook:function(a,b){return iT(e(a,b),b)},to_sheet:e,from_sheet:function(a){for(var b,c=[],d=iQ(a["!ref"]),e=Array.isArray(a),f=d.s.r;f<=d.e.r;++f){for(var g=[],h=d.s.c;h<=d.e.c;++h){var i=iN({r:f,c:h});if(!(b=e?(a[f]||[])[h]:a[i])||null==b.v){g.push("          ");continue}for(var j=(b.w||(iS(b),b.w)||"").slice(0,10);j.length<10;)j+=" ";g.push(j+(0===h?" ":""))}c.push(g.join(""))}return c.join("\n")}}}(),kB=function(){function a(a,b,c){if(a){iy(a,a.l||0);for(var d=c.Enum||l;a.l<a.length;){var e=a.read_shift(2),f=d[e]||d[65535],g=a.read_shift(2),h=a.l+g,i=f.f&&f.f(a,g,c);if(a.l=h,b(i,f,e))return}}}function b(b,c){if(!b)return b;var d=c||{},e=d.dense?[]:{},f="Sheet1",g="",h=0,i={},j=[],k=[],n={s:{r:0,c:0},e:{r:0,c:0}},o=d.sheetRows||0;if(0==b[2]&&(8==b[3]||9==b[3])&&b.length>=16&&5==b[14]&&108===b[15])throw Error("Unsupported Works 3 for Mac file");if(2==b[2])d.Enum=l,a(b,function(a,b,c){switch(c){case 0:d.vers=a,a>=4096&&(d.qpro=!0);break;case 6:n=a;break;case 204:a&&(g=a);break;case 222:g=a;break;case 15:case 51:d.qpro||(a[1].v=a[1].v.slice(1));case 13:case 14:case 16:14==c&&(112&a[2])==112&&(15&a[2])>1&&(15&a[2])<15&&(a[1].z=d.dateNF||gk[14],d.cellDates&&(a[1].t="d",a[1].v=g0(a[1].v))),d.qpro&&a[3]>h&&(e["!ref"]=iP(n),i[f]=e,j.push(f),e=d.dense?[]:{},n={s:{r:0,c:0},e:{r:0,c:0}},h=a[3],f=g||"Sheet"+(h+1),g="");var k=d.dense?(e[a[0].r]||[])[a[0].c]:e[iN(a[0])];if(k){k.t=a[1].t,k.v=a[1].v,null!=a[1].z&&(k.z=a[1].z),null!=a[1].f&&(k.f=a[1].f);break}d.dense?(e[a[0].r]||(e[a[0].r]=[]),e[a[0].r][a[0].c]=a[1]):e[iN(a[0])]=a[1]}},d);else if(26==b[2]||14==b[2])d.Enum=m,14==b[2]&&(d.qpro=!0,b.l=0),a(b,function(a,b,c){switch(c){case 204:f=a;break;case 22:a[1].v=a[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(a[3]>h&&(e["!ref"]=iP(n),i[f]=e,j.push(f),e=d.dense?[]:{},n={s:{r:0,c:0},e:{r:0,c:0}},f="Sheet"+((h=a[3])+1)),o>0&&a[0].r>=o)break;d.dense?(e[a[0].r]||(e[a[0].r]=[]),e[a[0].r][a[0].c]=a[1]):e[iN(a[0])]=a[1],n.e.c<a[0].c&&(n.e.c=a[0].c),n.e.r<a[0].r&&(n.e.r=a[0].r);break;case 27:a[14e3]&&(k[a[14e3][0]]=a[14e3][1]);break;case 1537:k[a[0]]=a[1],a[0]==h&&(f=a[1])}},d);else throw Error("Unrecognized LOTUS BOF "+b[2]);if(e["!ref"]=iP(n),i[g||f]=e,j.push(g||f),!k.length)return{SheetNames:j,Sheets:i};for(var p={},q=[],r=0;r<k.length;++r)i[j[r]]?(q.push(k[r]||j[r]),p[k[r]]=i[k[r]]||i[j[r]]):(q.push(k[r]),p[k[r]]={"!ref":"A1"});return{SheetNames:q,Sheets:p}}function c(a,b,c){var d=[{c:0,r:0},{t:"n",v:0},0,0];return c.qpro&&20768!=c.vers?(d[0].c=a.read_shift(1),d[3]=a.read_shift(1),d[0].r=a.read_shift(2),a.l+=2):(d[2]=a.read_shift(1),d[0].c=a.read_shift(2),d[0].r=a.read_shift(2)),d}function d(a,b,d){var e=a.l+b,f=c(a,b,d);if(f[1].t="s",20768==d.vers){a.l++;var g=a.read_shift(1);return f[1].v=a.read_shift(g,"utf8"),f}return d.qpro&&a.l++,f[1].v=a.read_shift(e-a.l,"cstr"),f}function e(a,b,c){var d=32768&b;return b&=-32769,b=(d?a:0)+(b>=8192?b-16384:b),(d?"":"$")+(c?iL(b):iJ(b))}var f={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function h(a){var b=[{c:0,r:0},{t:"n",v:0},0];return b[0].r=a.read_shift(2),b[3]=a[a.l++],b[0].c=a[a.l++],b}function i(a,b){var c=h(a,b),d=a.read_shift(4),e=a.read_shift(4),f=a.read_shift(2);if(65535==f)return 0===d&&0xc0000000===e?(c[1].t="e",c[1].v=15):0===d&&0xd0000000===e?(c[1].t="e",c[1].v=42):c[1].v=0,c;var g=32768&f;return f=(32767&f)-16446,c[1].v=(1-2*g)*(e*Math.pow(2,f+32)+d*Math.pow(2,f)),c}function j(a,b){var c=h(a,b),d=a.read_shift(8,"f");return c[1].v=d,c}function k(a,b){return 0==a[a.l+b-1]?a.read_shift(b,"cstr"):""}var l={0:{n:"BOF",f:jX},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(a,b,c){var d={s:{c:0,r:0},e:{c:0,r:0}};return 8==b&&c.qpro?(d.s.c=a.read_shift(1),a.l++,d.s.r=a.read_shift(2),d.e.c=a.read_shift(1),a.l++,d.e.r=a.read_shift(2)):(d.s.c=a.read_shift(2),d.s.r=a.read_shift(2),12==b&&c.qpro&&(a.l+=2),d.e.c=a.read_shift(2),d.e.r=a.read_shift(2),12==b&&c.qpro&&(a.l+=2),65535==d.s.c&&(d.s.c=d.e.c=d.s.r=d.e.r=0)),d}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(a,b,d){var e=c(a,b,d);return e[1].v=a.read_shift(2,"i"),e}},14:{n:"NUMBER",f:function(a,b,d){var e=c(a,b,d);return e[1].v=a.read_shift(8,"f"),e}},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:function(a,b,d){var h=a.l+b,i=c(a,b,d);if(i[1].v=a.read_shift(8,"f"),d.qpro)a.l=h;else{var j=a.read_shift(2);(function(a,b){iy(a,0);for(var c=[],d=0,h="",i="",j="",k="";a.l<a.length;){var l=a[a.l++];switch(l){case 0:c.push(a.read_shift(8,"f"));break;case 1:i=e(b[0].c,a.read_shift(2),!0),h=e(b[0].r,a.read_shift(2),!1),c.push(i+h);break;case 2:var m=e(b[0].c,a.read_shift(2),!0),n=e(b[0].r,a.read_shift(2),!1);i=e(b[0].c,a.read_shift(2),!0),h=e(b[0].r,a.read_shift(2),!1),c.push(m+n+":"+i+h);break;case 3:if(a.l<a.length)return void console.error("WK1 premature formula end");break;case 4:c.push("("+c.pop()+")");break;case 5:c.push(a.read_shift(2));break;case 6:for(var o="";l=a[a.l++];)o+=String.fromCharCode(l);c.push('"'+o.replace(/"/g,'""')+'"');break;case 8:c.push("-"+c.pop());break;case 23:c.push("+"+c.pop());break;case 22:c.push("NOT("+c.pop()+")");break;case 20:case 21:k=c.pop(),j=c.pop(),c.push(["AND","OR"][l-20]+"("+j+","+k+")");break;default:if(l<32&&g[l])k=c.pop(),j=c.pop(),c.push(j+g[l]+k);else if(f[l]){if(69==(d=f[l][1])&&(d=a[a.l++]),d>c.length)return void console.error("WK1 bad formula parse 0x"+l.toString(16)+":|"+c.join("|")+"|");var p=c.slice(-d);c.length-=d,c.push(f[l][0]+"("+p.join(",")+")")}else if(l<=7)return console.error("WK1 invalid opcode "+l.toString(16));else if(l<=24)return console.error("WK1 unsupported op "+l.toString(16));else if(l<=30)return console.error("WK1 invalid opcode "+l.toString(16));else if(l<=115)return console.error("WK1 unsupported function opcode "+l.toString(16));else return console.error("WK1 unrecognized opcode "+l.toString(16))}}1==c.length?b[1].f=""+c[0]:console.error("WK1 bad formula parse |"+c.join("|")+"|")})(a.slice(a.l,a.l+j),i),a.l+=j}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:k},222:{n:"SHEETNAMELP",f:function(a,b){var c=a[a.l++];c>b-1&&(c=b-1);for(var d="";d.length<c;)d+=String.fromCharCode(a[a.l++]);return d}},65535:{n:""}},m={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(a,b){var c=h(a,b);return c[1].t="s",c[1].v=a.read_shift(b-4,"cstr"),c}},23:{n:"NUMBER17",f:i},24:{n:"NUMBER18",f:function(a,b){var c=h(a,b);c[1].v=a.read_shift(2);var d=c[1].v>>1;if(1&c[1].v)switch(7&d){case 0:d=(d>>3)*5e3;break;case 1:d=(d>>3)*500;break;case 2:d=(d>>3)/20;break;case 3:d=(d>>3)/200;break;case 4:d=(d>>3)/2e3;break;case 5:d=(d>>3)/2e4;break;case 6:d=(d>>3)/16;break;case 7:d=(d>>3)/64}return c[1].v=d,c}},25:{n:"FORMULA19",f:function(a,b){var c=i(a,14);return a.l+=b-14,c}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(a,b){for(var c={},d=a.l+b;a.l<d;){var e=a.read_shift(2);if(14e3==e){for(c[e]=[0,""],c[e][0]=a.read_shift(2);a[a.l];)c[e][1]+=String.fromCharCode(a[a.l]),a.l++;a.l++}}return c}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(a,b){var c=h(a,b),d=a.read_shift(4);return c[1].v=d>>6,c}},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:function(a,b){var c=j(a,14);return a.l+=b-10,c}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:k},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(a,b,c){if(c.qpro&&!(b<21)){var d=a.read_shift(1);return a.l+=17,a.l+=1,a.l+=2,[d,a.read_shift(b-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(a,b){var c,d,e,f,g=b||{};if(+g.codepage>=0&&fT(+g.codepage),"string"==g.type)throw Error("Cannot write WK1 to JS string");var h=iC(),i=iQ(a["!ref"]),j=Array.isArray(a),k=[];mP(h,0,(c=1030,(d=iA(2)).write_shift(2,1030),d)),mP(h,6,(e=i,(f=iA(8)).write_shift(2,e.s.c),f.write_shift(2,e.s.r),f.write_shift(2,e.e.c),f.write_shift(2,e.e.r),f));for(var l=Math.min(i.e.r,8191),m=i.s.r;m<=l;++m)for(var n=iJ(m),o=i.s.c;o<=i.e.c;++o){m===i.s.r&&(k[o]=iL(o));var p=k[o]+n,q=j?(a[m]||[])[o]:a[p];q&&"z"!=q.t&&("n"==q.t?(0|q.v)==q.v&&q.v>=-32768&&q.v<=32767?mP(h,13,function(a,b,c){var d=iA(7);return d.write_shift(1,255),d.write_shift(2,b),d.write_shift(2,a),d.write_shift(2,c,"i"),d}(m,o,q.v)):mP(h,14,function(a,b,c){var d=iA(13);return d.write_shift(1,255),d.write_shift(2,b),d.write_shift(2,a),d.write_shift(8,c,"f"),d}(m,o,q.v)):mP(h,15,function(a,b,c){var d=iA(7+c.length);d.write_shift(1,255),d.write_shift(2,b),d.write_shift(2,a),d.write_shift(1,39);for(var e=0;e<d.length;++e){var f=c.charCodeAt(e);d.write_shift(1,f>=128?95:f)}return d.write_shift(1,0),d}(m,o,iS(q).slice(0,239))))}return mP(h,1),h.end()},book_to_wk3:function(a,b){var c=b||{};if(+c.codepage>=0&&fT(+c.codepage),"string"==c.type)throw Error("Cannot write WK3 to JS string");var d=iC();mP(d,0,function(a){var b=iA(26);b.write_shift(2,4096),b.write_shift(2,4),b.write_shift(4,0);for(var c=0,d=0,e=0,f=0;f<a.SheetNames.length;++f){var g=a.SheetNames[f],h=a.Sheets[g];if(h&&h["!ref"]){++e;var i=iO(h["!ref"]);c<i.e.r&&(c=i.e.r),d<i.e.c&&(d=i.e.c)}}return c>8191&&(c=8191),b.write_shift(2,c),b.write_shift(1,e),b.write_shift(1,d),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(1,1),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(4,0),b}(a));for(var e=0,f=0;e<a.SheetNames.length;++e)(a.Sheets[a.SheetNames[e]]||{})["!ref"]&&mP(d,27,function(a,b){var c=iA(5+a.length);c.write_shift(2,14e3),c.write_shift(2,b);for(var d=0;d<a.length;++d){var e=a.charCodeAt(d);c[c.l++]=e>127?95:e}return c[c.l++]=0,c}(a.SheetNames[e],f++));var g=0;for(e=0;e<a.SheetNames.length;++e){var h=a.Sheets[a.SheetNames[e]];if(h&&h["!ref"]){for(var i=iQ(h["!ref"]),j=Array.isArray(h),k=[],l=Math.min(i.e.r,8191),m=i.s.r;m<=l;++m)for(var n=iJ(m),o=i.s.c;o<=i.e.c;++o){m===i.s.r&&(k[o]=iL(o));var p=k[o]+n,q=j?(h[m]||[])[o]:h[p];q&&"z"!=q.t&&("n"==q.t?mP(d,23,function(a,b,c,d){var e=iA(14);if(e.write_shift(2,a),e.write_shift(1,c),e.write_shift(1,b),0==d)return e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,65535),e;var f=0,g=0,h=0,i=0;return d<0&&(f=1,d=-d),g=0|Math.log2(d),d/=Math.pow(2,g-31),(0x80000000&(i=d>>>0))==0&&(d/=2,++g,i=d>>>0),d-=i,i|=0x80000000,i>>>=0,d*=0x100000000,h=d>>>0,e.write_shift(4,h),e.write_shift(4,i),g+=16383+32768*!!f,e.write_shift(2,g),e}(m,o,g,q.v)):mP(d,22,function(a,b,c,d){var e=iA(6+d.length);e.write_shift(2,a),e.write_shift(1,c),e.write_shift(1,b),e.write_shift(1,39);for(var f=0;f<d.length;++f){var g=d.charCodeAt(f);e.write_shift(1,g>=128?95:g)}return e.write_shift(1,0),e}(m,o,g,iS(q).slice(0,239))))}++g}}return mP(d,1),d.end()},to_workbook:function(a,c){switch(c.type){case"base64":return b(f5(f0(a)),c);case"binary":return b(f5(a),c);case"buffer":case"array":return b(a,c)}throw"Unsupported type "+c.type}}}(),kC=function(){var a=hM("t"),b=hM("rPr");function c(c){var d=c.match(a);if(!d)return{t:"s",v:""};var e={t:"s",v:hx(d[1])},f=c.match(b);return f&&(e.s=function(a){var b={},c=a.match(hq),d=0,e=!1;if(c)for(;d!=c.length;++d){var f=ht(c[d]);switch(f[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!f.val)break;case"<shadow>":case"<shadow/>":b.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==f.val)break;b.cp=fR[parseInt(f.val,10)];break;case"<outline":if(!f.val)break;case"<outline>":case"<outline/>":b.outline=1;break;case"</outline>":break;case"<rFont":b.name=f.val;break;case"<sz":b.sz=f.val;break;case"<strike":if(!f.val)break;case"<strike>":case"<strike/>":b.strike=1;break;case"</strike>":break;case"<u":if(!f.val)break;switch(f.val){case"double":b.uval="double";break;case"singleAccounting":b.uval="single-accounting";break;case"doubleAccounting":b.uval="double-accounting"}case"<u>":case"<u/>":b.u=1;break;case"</u>":break;case"<b":if("0"==f.val)break;case"<b>":case"<b/>":b.b=1;break;case"</b>":break;case"<i":if("0"==f.val)break;case"<i>":case"<i/>":b.i=1;break;case"</i>":case"<color>":case"<color/>":case"</color>":case"<family>":case"<family/>":case"</family>":case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<color":f.rgb&&(b.color=f.rgb.slice(2,8));break;case"<family":b.family=f.val;break;case"<vertAlign":b.valign=f.val;break;case"<ext":e=!0;break;case"</ext>":e=!1;break;default:if(47!==f[0].charCodeAt(1)&&!e)throw Error("Unrecognized rich format "+f[0])}}return b}(f[1])),e}var d=/<(?:\w+:)?r>/g,e=/<\/(?:\w+:)?r>/;return function(a){return a.replace(d,"").split(e).map(c).filter(function(a){return a.v})}}(),kD=function(){var a=/(\r\n|\n)/g;function b(b){var c,d,e,f,g,h=[[],b.v,[]];return b.v?(b.s&&(c=b.s,d=h[0],e=h[2],f=[],c.u&&f.push("text-decoration: underline;"),c.uval&&f.push("text-underline-style:"+c.uval+";"),c.sz&&f.push("font-size:"+c.sz+"pt;"),c.outline&&f.push("text-effect: outline;"),c.shadow&&f.push("text-shadow: auto;"),d.push('<span style="'+f.join("")+'">'),c.b&&(d.push("<b>"),e.push("</b>")),c.i&&(d.push("<i>"),e.push("</i>")),c.strike&&(d.push("<s>"),e.push("</s>")),"superscript"==(g=c.valign||"")||"super"==g?g="sup":"subscript"==g&&(g="sub"),""!=g&&(d.push("<"+g+">"),e.push("</"+g+">")),e.push("</span>")),h[0].join("")+h[1].replace(a,"<br/>")+h[2].join("")):""}return function(a){return a.map(b).join("")}}(),kE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,kF=/<(?:\w+:)?r>/,kG=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function kH(a,b){var c=!b||b.cellHTML,d={};return a?(a.match(/^\s*<(?:\w+:)?t[^>]*>/)?(d.t=hx(hK(a.slice(a.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),d.r=hK(a),c&&(d.h=hD(d.t))):a.match(kF)&&(d.r=hK(a),d.t=hx(hK((a.replace(kG,"").match(kE)||[]).join("").replace(hq,""))),c&&(d.h=kD(kC(d.r)))),d):{t:""}}var kI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kJ=/<(?:\w+:)?(?:si|sstItem)>/g,kK=/<\/(?:\w+:)?(?:si|sstItem)>/,kL=/^\s|\s$|[\t\n\r]/;function kM(a,b){if(!b.bookSST)return"";var c=[hn];c[c.length]=hV("sst",null,{xmlns:h$[0],count:a.Count,uniqueCount:a.Unique});for(var d=0;d!=a.length;++d)if(null!=a[d]){var e=a[d],f="<si>";e.r?f+=e.r:(f+="<t",e.t||(e.t=""),e.t.match(kL)&&(f+=' xml:space="preserve"'),f+=">"+hA(e.t)+"</t>"),f+="</si>",c[c.length]=f}return c.length>2&&(c[c.length]="</sst>",c[1]=c[1].replace("/>",">")),c.join("")}var kN=function(a,b){var c=!1;return null==b&&(c=!0,b=iA(15+4*a.t.length)),b.write_shift(1,0),iX(a.t,b),c?b.slice(0,b.l):b};function kO(a){if(void 0!==h)return h.utils.encode(fP,a);for(var b=[],c=a.split(""),d=0;d<c.length;++d)b[d]=c[d].charCodeAt(0);return b}function kP(a,b){var c={};return c.Major=a.read_shift(2),c.Minor=a.read_shift(2),b>=4&&(a.l+=b-4),c}function kQ(a,b){var c=a.l+b,d={};d.Flags=63&a.read_shift(4),a.l+=4,d.AlgID=a.read_shift(4);var e=!1;switch(d.AlgID){case 26126:case 26127:case 26128:e=36==d.Flags;break;case 26625:e=4==d.Flags;break;case 0:e=16==d.Flags||4==d.Flags||36==d.Flags;break;default:throw"Unrecognized encryption algorithm: "+d.AlgID}if(!e)throw Error("Encryption Flags/AlgID mismatch");return d.AlgIDHash=a.read_shift(4),d.KeySize=a.read_shift(4),d.ProviderType=a.read_shift(4),a.l+=8,d.CSPName=a.read_shift(c-a.l>>1,"utf16le"),a.l=c,d}function kR(a,b){var c={},d=a.l+b;return a.l+=4,c.Salt=a.slice(a.l,a.l+16),a.l+=16,c.Verifier=a.slice(a.l,a.l+16),a.l+=16,a.read_shift(4),c.VerifierHash=a.slice(a.l,d),a.l=d,c}function kS(a){var b,c,d=0,e=kO(a),f=e.length+1;for(c=1,(b=f3(f))[0]=e.length;c!=f;++c)b[c]=e[c-1];for(c=f-1;c>=0;--c)d=((16384&d)!=0|d<<1&32767)^b[c];return 52811^d}var kT=function(){var a=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],b=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],c=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],d=function(a,b){var c;return((c=a^b)/2|128*c)&255},e=function(a){for(var d=b[a.length-1],e=104,f=a.length-1;f>=0;--f)for(var g=a[f],h=0;7!=h;++h)64&g&&(d^=c[e]),g*=2,--e;return d};return function(b){for(var c,f,g,h=kO(b),i=e(h),j=h.length,k=f3(16),l=0;16!=l;++l)k[l]=0;for((1&j)==1&&(c=i>>8,k[j]=d(a[0],c),--j,c=255&i,f=h[h.length-1],k[j]=d(f,c));j>0;)--j,c=i>>8,k[j]=d(h[j],c),--j,c=255&i,k[j]=d(h[j],c);for(j=15,g=15-h.length;g>0;)c=i>>8,k[j]=d(a[g],c),--j,--g,c=255&i,k[j]=d(h[j],c),--j,--g;return k}}(),kU=function(a,b,c,d,e){var f,g;for(e||(e=b),d||(d=kT(a)),f=0;f!=b.length;++f)g=((g=b[f]^d[c])>>5|g<<3)&255,e[f]=g,++c;return[e,c,d]},kV=function(a){var b=0,c=kT(a);return function(a){var d=kU("",a,b,c);return b=d[1],d[0]}},kW=function(){function a(a,c){switch(c.type){case"base64":return b(f0(a),c);case"binary":return b(a,c);case"buffer":return b(f1&&Buffer.isBuffer(a)?a.toString("binary"):f7(a),c);case"array":return b(g5(a),c)}throw Error("Unrecognized type "+c.type)}function b(a,b){var c=(b||{}).dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw Error("RTF missing table");var e={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(a,b){Array.isArray(c)&&(c[b]=[]);for(var d,f=/\\\w+\b/g,g=0,h=-1;d=f.exec(a);){if("\\cell"===d[0]){var i=a.slice(g,f.lastIndex-d[0].length);if(" "==i[0]&&(i=i.slice(1)),++h,i.length){var j={v:i,t:"s"};Array.isArray(c)?c[b][h]=j:c[iN({r:b,c:h})]=j}}g=f.lastIndex}h>e.e.c&&(e.e.c=h)}),c["!ref"]=iP(e),c}return{to_workbook:function(b,c){return iT(a(b,c),c)},to_sheet:a,from_sheet:function(a){for(var b,c=["{\\rtf1\\ansi"],d=iQ(a["!ref"]),e=Array.isArray(a),f=d.s.r;f<=d.e.r;++f){c.push("\\trowd\\trautofit1");for(var g=d.s.c;g<=d.e.c;++g)c.push("\\cellx"+(g+1));for(c.push("\\pard\\intbl"),g=d.s.c;g<=d.e.c;++g){var h=iN({r:f,c:g});(b=e?(a[f]||[])[g]:a[h])&&(null!=b.v||b.f&&!b.F)&&(c.push(" "+(b.w||(iS(b),b.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}}}();function kX(a){for(var b=0,c=1;3!=b;++b)c=256*c+(a[b]>255?255:a[b]<0?0:a[b]);return c.toString(16).toUpperCase().slice(1)}function kY(a,b){if(0===b)return a;var c,d=function(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=e-f;if(0===g)return[0,0,b];var h=0,i=0,j=e+f;switch(i=g/(j>1?2-j:j),e){case b:h=((c-d)/g+6)%6;break;case c:h=(d-b)/g+2;break;case d:h=(b-c)/g+4}return[h/6,i,j/2]}([parseInt((c=a.slice(+("#"===a[0])).slice(0,6)).slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]);return b<0?d[2]=d[2]*(1+b):d[2]=1-(1-d[2])*(1-b),kX(function(a){var b,c=a[0],d=a[1],e=a[2],f=2*d*(e<.5?e:1-e),g=e-f/2,h=[g,g,g],i=6*c;if(0!==d)switch(0|i){case 0:case 6:b=f*i,h[0]+=f,h[1]+=b;break;case 1:b=f*(2-i),h[0]+=b,h[1]+=f;break;case 2:b=f*(i-2),h[1]+=f,h[2]+=b;break;case 3:b=f*(4-i),h[1]+=b,h[2]+=f;break;case 4:b=f*(i-4),h[2]+=f,h[0]+=b;break;case 5:b=f*(6-i),h[2]+=b,h[0]+=f}for(var j=0;3!=j;++j)h[j]=Math.round(255*h[j]);return h}(d))}var kZ=6;function k$(a){return Math.floor((a+Math.round(128/kZ)/256)*kZ)}function k_(a){return Math.floor((a-5)/kZ*100+.5)/100}function k0(a){return Math.round((a*kZ+5)/kZ*256)/256}function k1(a){return k0(k_(k$(a)))}function k2(a){var b=Math.abs(a-k1(a)),c=kZ;if(b>.005)for(kZ=1;kZ<15;++kZ)Math.abs(a-k1(a))<=b&&(b=Math.abs(a-k1(a)),c=kZ);kZ=c}function k3(a){a.width?(a.wpx=k$(a.width),a.wch=k_(a.wpx),a.MDW=kZ):a.wpx?(a.wch=k_(a.wpx),a.width=k0(a.wch),a.MDW=kZ):"number"==typeof a.wch&&(a.width=k0(a.wch),a.wpx=k$(a.width),a.MDW=kZ),a.customWidth&&delete a.customWidth}function k4(a){return 96*a/96}function k5(a){return 96*a/96}var k6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},k7=["numFmtId","fillId","fontId","borderId","xfId"],k8=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],k9=function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,b=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,c=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,d=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,e=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v={};return f?((u=(f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(a))&&function(a,b,c){b.NumberFmt=[];for(var d=gT(gk),e=0;e<d.length;++e)b.NumberFmt[d[e]]=gk[d[e]];var f=a[0].match(hq);if(f)for(e=0;e<f.length;++e){var g=ht(f[e]);switch(hu(g[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var h=hx(hK(g.formatCode)),i=parseInt(g.numFmtId,10);if(b.NumberFmt[i]=h,i>0){if(i>392){for(i=392;i>60&&null!=b.NumberFmt[i];--i);b.NumberFmt[i]=h}gL(h,i)}break;default:if(c.WTF)throw Error("unrecognized "+g[0]+" in numFmts")}}}(u,v,h),(u=f.match(d))&&(i=u,v.Fonts=[],j={},k=!1,(i[0].match(hq)||[]).forEach(function(a){var b=ht(a);switch(hu(b[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":v.Fonts.push(j),j={};break;case"<name":b.val&&(j.name=hK(b.val));break;case"<b":j.bold=b.val?hF(b.val):1;break;case"<b/>":j.bold=1;break;case"<i":j.italic=b.val?hF(b.val):1;break;case"<i/>":j.italic=1;break;case"<u":switch(b.val){case"none":j.underline=0;break;case"single":j.underline=1;break;case"double":j.underline=2;break;case"singleAccounting":j.underline=33;break;case"doubleAccounting":j.underline=34}break;case"<u/>":j.underline=1;break;case"<strike":j.strike=b.val?hF(b.val):1;break;case"<strike/>":j.strike=1;break;case"<outline":j.outline=b.val?hF(b.val):1;break;case"<outline/>":j.outline=1;break;case"<shadow":j.shadow=b.val?hF(b.val):1;break;case"<shadow/>":j.shadow=1;break;case"<condense":j.condense=b.val?hF(b.val):1;break;case"<condense/>":j.condense=1;break;case"<extend":j.extend=b.val?hF(b.val):1;break;case"<extend/>":j.extend=1;break;case"<sz":b.val&&(j.sz=+b.val);break;case"<vertAlign":b.val&&(j.vertAlign=b.val);break;case"<family":b.val&&(j.family=parseInt(b.val,10));break;case"<scheme":b.val&&(j.scheme=b.val);break;case"<charset":if("1"==b.val)break;b.codepage=fR[parseInt(b.val,10)];break;case"<color":if(j.color||(j.color={}),b.auto&&(j.color.auto=hF(b.auto)),b.rgb)j.color.rgb=b.rgb.slice(-6);else if(b.indexed){j.color.index=parseInt(b.indexed,10);var c=jg[j.color.index];81==j.color.index&&(c=jg[1]),c||(c=jg[1]),j.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else b.theme&&(j.color.theme=parseInt(b.theme,10),b.tint&&(j.color.tint=parseFloat(b.tint)),b.theme&&g.themeElements&&g.themeElements.clrScheme&&(j.color.rgb=kY(g.themeElements.clrScheme[j.color.theme].rgb,j.color.tint||0)));break;case"<AlternateContent":case"<ext":k=!0;break;case"</AlternateContent>":case"</ext>":k=!1;break;default:if(h&&h.WTF&&!k)throw Error("unrecognized "+b[0]+" in fonts")}})),(u=f.match(c))&&(l=u,v.Fills=[],m={},n=!1,(l[0].match(hq)||[]).forEach(function(a){var b=ht(a);switch(hu(b[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":m={},v.Fills.push(m);break;case"<gradientFill":case"</gradientFill>":v.Fills.push(m),m={};break;case"<patternFill":case"<patternFill>":b.patternType&&(m.patternType=b.patternType);break;case"<bgColor":m.bgColor||(m.bgColor={}),b.indexed&&(m.bgColor.indexed=parseInt(b.indexed,10)),b.theme&&(m.bgColor.theme=parseInt(b.theme,10)),b.tint&&(m.bgColor.tint=parseFloat(b.tint)),b.rgb&&(m.bgColor.rgb=b.rgb.slice(-6));break;case"<fgColor":m.fgColor||(m.fgColor={}),b.theme&&(m.fgColor.theme=parseInt(b.theme,10)),b.tint&&(m.fgColor.tint=parseFloat(b.tint)),null!=b.rgb&&(m.fgColor.rgb=b.rgb.slice(-6));break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(h&&h.WTF&&!n)throw Error("unrecognized "+b[0]+" in fills")}})),(u=f.match(e))&&(o=u,v.Borders=[],p={},q=!1,(o[0].match(hq)||[]).forEach(function(a){var b=ht(a);switch(hu(b[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":p={},b.diagonalUp&&(p.diagonalUp=hF(b.diagonalUp)),b.diagonalDown&&(p.diagonalDown=hF(b.diagonalDown)),v.Borders.push(p);break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(h&&h.WTF&&!q)throw Error("unrecognized "+b[0]+" in borders")}})),(u=f.match(b))&&(r=u,v.CellXf=[],t=!1,(r[0].match(hq)||[]).forEach(function(a){var b=ht(a),c=0;switch(hu(b[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(s=b,delete s[0],c=0;c<k7.length;++c)s[k7[c]]&&(s[k7[c]]=parseInt(s[k7[c]],10));for(c=0;c<k8.length;++c)s[k8[c]]&&(s[k8[c]]=hF(s[k8[c]]));if(v.NumberFmt&&s.numFmtId>392){for(c=392;c>60;--c)if(v.NumberFmt[s.numFmtId]==v.NumberFmt[c]){s.numFmtId=c;break}}v.CellXf.push(s);break;case"<alignment":case"<alignment/>":var d={};b.vertical&&(d.vertical=b.vertical),b.horizontal&&(d.horizontal=b.horizontal),null!=b.textRotation&&(d.textRotation=b.textRotation),b.indent&&(d.indent=b.indent),b.wrapText&&(d.wrapText=hF(b.wrapText)),s.alignment=d;break;case"<AlternateContent":case"<ext":t=!0;break;case"</AlternateContent>":case"</ext>":t=!1;break;default:if(h&&h.WTF&&!t)throw Error("unrecognized "+b[0]+" in cellXfs")}})),v):v}}();function la(a,b){var c,d,e,f,g,h=[hn,hV("styleSheet",null,{xmlns:h$[0],"xmlns:vt":hZ.vt})];return a.SSF&&null!=(c=a.SSF,d=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var b=a[0];b<=a[1];++b)null!=c[b]&&(d[d.length]=hV("numFmt",null,{numFmtId:b,formatCode:hA(c[b])}))}),g=1===d.length?"":(d[d.length]="</numFmts>",d[0]=hV("numFmts",null,{count:d.length-2}).replace("/>",">"),d.join("")))&&(h[h.length]=g),h[h.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',h[h.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',h[h.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',h[h.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',e=b.cellXfs,(f=[])[f.length]=hV("cellXfs",null),e.forEach(function(a){f[f.length]=hV("xf",null,a)}),f[f.length]="</cellXfs>",(g=2===f.length?"":(f[0]=hV("cellXfs",null,{count:f.length-2}).replace("/>",">"),f.join("")))&&(h[h.length]=g),h[h.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',h[h.length]='<dxfs count="0"/>',h[h.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',h.length>2&&(h[h.length]="</styleSheet>",h[1]=h[1].replace("/>",">")),h.join("")}var lb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lc(a,b){b||(b=iA(84)),j||(j=gV(lb));var c=j[a.patternType];null==c&&(c=40),b.write_shift(4,c);var d=0;if(40!=c)for(i9({auto:1},b),i9({auto:1},b);d<12;++d)b.write_shift(4,0);else{for(;d<4;++d)b.write_shift(4,0);for(;d<12;++d)b.write_shift(4,0)}return b.length>b.l?b.slice(0,b.l):b}function ld(a,b,c){return c||(c=iA(16)),c.write_shift(2,b||0),c.write_shift(2,a.numFmtId||0),c.write_shift(2,0),c.write_shift(2,0),c.write_shift(2,0),c.write_shift(1,0),c.write_shift(1,0),c.write_shift(1,0),c.write_shift(1,0),c.write_shift(1,0),c.write_shift(1,0),c}function le(a,b){return b||(b=iA(10)),b.write_shift(1,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),b}var lf=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function lg(a,b,c){b.themeElements.clrScheme=[];var d={};(a[0].match(hq)||[]).forEach(function(a){var e=ht(a);switch(e[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":d.rgb=e.val;break;case"<a:sysClr":d.rgb=e.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===e[0].charAt(1)?(b.themeElements.clrScheme[lf.indexOf(e[0])]=d,d={}):d.name=e[0].slice(3,e[0].length-1);break;default:if(c&&c.WTF)throw Error("Unrecognized "+e[0]+" in clrScheme")}})}function lh(){}function li(){}var lj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ll=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,lm=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ln(a,b){a&&0!==a.length||(a=lo());var c,d,e,f={};if(!(e=a.match(lm)))throw Error("themeElements not found in theme");return c=e[0],f.themeElements={},[["clrScheme",lj,lg],["fontScheme",lk,lh],["fmtScheme",ll,li]].forEach(function(a){if(!(d=c.match(a[1])))throw Error(a[0]+" not found in themeElements");a[2](d,f,b)}),f.raw=a,f}function lo(a,b){if(b&&b.themeXLSX)return b.themeXLSX;if(a&&"string"==typeof a.raw)return a.raw;var c=[hn];return c[c.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',c[c.length]="<a:themeElements>",c[c.length]='<a:clrScheme name="Office">',c[c.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',c[c.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',c[c.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',c[c.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',c[c.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',c[c.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',c[c.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',c[c.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',c[c.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',c[c.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',c[c.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',c[c.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',c[c.length]="</a:clrScheme>",c[c.length]='<a:fontScheme name="Office">',c[c.length]="<a:majorFont>",c[c.length]='<a:latin typeface="Cambria"/>',c[c.length]='<a:ea typeface=""/>',c[c.length]='<a:cs typeface=""/>',c[c.length]='<a:font script="Jpan" typeface=" "/>',c[c.length]='<a:font script="Hang" typeface=" "/>',c[c.length]='<a:font script="Hans" typeface=""/>',c[c.length]='<a:font script="Hant" typeface=""/>',c[c.length]='<a:font script="Arab" typeface="Times New Roman"/>',c[c.length]='<a:font script="Hebr" typeface="Times New Roman"/>',c[c.length]='<a:font script="Thai" typeface="Tahoma"/>',c[c.length]='<a:font script="Ethi" typeface="Nyala"/>',c[c.length]='<a:font script="Beng" typeface="Vrinda"/>',c[c.length]='<a:font script="Gujr" typeface="Shruti"/>',c[c.length]='<a:font script="Khmr" typeface="MoolBoran"/>',c[c.length]='<a:font script="Knda" typeface="Tunga"/>',c[c.length]='<a:font script="Guru" typeface="Raavi"/>',c[c.length]='<a:font script="Cans" typeface="Euphemia"/>',c[c.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',c[c.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',c[c.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',c[c.length]='<a:font script="Thaa" typeface="MV Boli"/>',c[c.length]='<a:font script="Deva" typeface="Mangal"/>',c[c.length]='<a:font script="Telu" typeface="Gautami"/>',c[c.length]='<a:font script="Taml" typeface="Latha"/>',c[c.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',c[c.length]='<a:font script="Orya" typeface="Kalinga"/>',c[c.length]='<a:font script="Mlym" typeface="Kartika"/>',c[c.length]='<a:font script="Laoo" typeface="DokChampa"/>',c[c.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',c[c.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',c[c.length]='<a:font script="Viet" typeface="Times New Roman"/>',c[c.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',c[c.length]='<a:font script="Geor" typeface="Sylfaen"/>',c[c.length]="</a:majorFont>",c[c.length]="<a:minorFont>",c[c.length]='<a:latin typeface="Calibri"/>',c[c.length]='<a:ea typeface=""/>',c[c.length]='<a:cs typeface=""/>',c[c.length]='<a:font script="Jpan" typeface=" "/>',c[c.length]='<a:font script="Hang" typeface=" "/>',c[c.length]='<a:font script="Hans" typeface=""/>',c[c.length]='<a:font script="Hant" typeface=""/>',c[c.length]='<a:font script="Arab" typeface="Arial"/>',c[c.length]='<a:font script="Hebr" typeface="Arial"/>',c[c.length]='<a:font script="Thai" typeface="Tahoma"/>',c[c.length]='<a:font script="Ethi" typeface="Nyala"/>',c[c.length]='<a:font script="Beng" typeface="Vrinda"/>',c[c.length]='<a:font script="Gujr" typeface="Shruti"/>',c[c.length]='<a:font script="Khmr" typeface="DaunPenh"/>',c[c.length]='<a:font script="Knda" typeface="Tunga"/>',c[c.length]='<a:font script="Guru" typeface="Raavi"/>',c[c.length]='<a:font script="Cans" typeface="Euphemia"/>',c[c.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',c[c.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',c[c.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',c[c.length]='<a:font script="Thaa" typeface="MV Boli"/>',c[c.length]='<a:font script="Deva" typeface="Mangal"/>',c[c.length]='<a:font script="Telu" typeface="Gautami"/>',c[c.length]='<a:font script="Taml" typeface="Latha"/>',c[c.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',c[c.length]='<a:font script="Orya" typeface="Kalinga"/>',c[c.length]='<a:font script="Mlym" typeface="Kartika"/>',c[c.length]='<a:font script="Laoo" typeface="DokChampa"/>',c[c.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',c[c.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',c[c.length]='<a:font script="Viet" typeface="Arial"/>',c[c.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',c[c.length]='<a:font script="Geor" typeface="Sylfaen"/>',c[c.length]="</a:minorFont>",c[c.length]="</a:fontScheme>",c[c.length]='<a:fmtScheme name="Office">',c[c.length]="<a:fillStyleLst>",c[c.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',c[c.length]='<a:gradFill rotWithShape="1">',c[c.length]="<a:gsLst>",c[c.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',c[c.length]="</a:gsLst>",c[c.length]='<a:lin ang="16200000" scaled="1"/>',c[c.length]="</a:gradFill>",c[c.length]='<a:gradFill rotWithShape="1">',c[c.length]="<a:gsLst>",c[c.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',c[c.length]="</a:gsLst>",c[c.length]='<a:lin ang="16200000" scaled="0"/>',c[c.length]="</a:gradFill>",c[c.length]="</a:fillStyleLst>",c[c.length]="<a:lnStyleLst>",c[c.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',c[c.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',c[c.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',c[c.length]="</a:lnStyleLst>",c[c.length]="<a:effectStyleLst>",c[c.length]="<a:effectStyle>",c[c.length]="<a:effectLst>",c[c.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',c[c.length]="</a:effectLst>",c[c.length]="</a:effectStyle>",c[c.length]="<a:effectStyle>",c[c.length]="<a:effectLst>",c[c.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',c[c.length]="</a:effectLst>",c[c.length]="</a:effectStyle>",c[c.length]="<a:effectStyle>",c[c.length]="<a:effectLst>",c[c.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',c[c.length]="</a:effectLst>",c[c.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',c[c.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',c[c.length]="</a:effectStyle>",c[c.length]="</a:effectStyleLst>",c[c.length]="<a:bgFillStyleLst>",c[c.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',c[c.length]='<a:gradFill rotWithShape="1">',c[c.length]="<a:gsLst>",c[c.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',c[c.length]="</a:gsLst>",c[c.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',c[c.length]="</a:gradFill>",c[c.length]='<a:gradFill rotWithShape="1">',c[c.length]="<a:gsLst>",c[c.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',c[c.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',c[c.length]="</a:gsLst>",c[c.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',c[c.length]="</a:gradFill>",c[c.length]="</a:bgFillStyleLst>",c[c.length]="</a:fmtScheme>",c[c.length]="</a:themeElements>",c[c.length]="<a:objectDefaults>",c[c.length]="<a:spDef>",c[c.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',c[c.length]="</a:spDef>",c[c.length]="<a:lnDef>",c[c.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',c[c.length]="</a:lnDef>",c[c.length]="</a:objectDefaults>",c[c.length]="<a:extraClrSchemeLst/>",c[c.length]="</a:theme>",c.join("")}function lp(){var a=[hn];return a.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),a.join("")}var lq=1024;function lr(a,b){for(var c=[21600,21600],d=["m0,0l0",c[1],c[0],c[1],c[0],"0xe"].join(","),e=[hV("xml",null,{"xmlns:v":h_.v,"xmlns:o":h_.o,"xmlns:x":h_.x,"xmlns:mv":h_.mv}).replace(/\/>/,">"),hV("o:shapelayout",hV("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),hV("v:shapetype",[hV("v:stroke",null,{joinstyle:"miter"}),hV("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:c.join(","),path:d})];lq<1e3*a;)lq+=1e3;return b.forEach(function(a){var b=iM(a[0]),c={color2:"#BEFF82",type:"gradient"};"gradient"==c.type&&(c.angle="-180");var d="gradient"==c.type?hV("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=hV("v:fill",d,c);++lq,e=e.concat(["<v:shape"+hU({id:"_x0000_s"+lq,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,hV("v:shadow",null,{on:"t",obscured:"t"}),hV("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",hT("x:Anchor",[b.c+1,0,b.r+1,0,b.c+3,20,b.r+5,20].join(",")),hT("x:AutoFill","False"),hT("x:Row",String(b.r)),hT("x:Column",String(b.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),e.push("</xml>"),e.join("")}function ls(a,b,c,d){var e,f=Array.isArray(a);b.forEach(function(b){var g=iM(b.ref);if(f?(a[g.r]||(a[g.r]=[]),e=a[g.r][g.c]):e=a[b.ref],!e){e={t:"z"},f?a[g.r][g.c]=e:a[b.ref]=e;var h=iQ(a["!ref"]||"BDWGO1000001:A1");h.s.r>g.r&&(h.s.r=g.r),h.e.r<g.r&&(h.e.r=g.r),h.s.c>g.c&&(h.s.c=g.c),h.e.c<g.c&&(h.e.c=g.c);var i=iP(h);i!==a["!ref"]&&(a["!ref"]=i)}e.c||(e.c=[]);var j={a:b.author,t:b.t,r:b.r,T:c};b.h&&(j.h=b.h);for(var k=e.c.length-1;k>=0;--k){if(!c&&e.c[k].T)return;c&&!e.c[k].T&&e.c.splice(k,1)}if(c&&d){for(k=0;k<d.length;++k)if(j.a==d[k].id){j.a=d[k].name||j.a;break}}e.c.push(j)})}function lt(a){var b=[hn,hV("comments",null,{xmlns:h$[0]})],c=[];return b.push("<authors>"),a.forEach(function(a){a[1].forEach(function(a){var d=hA(a.a);-1==c.indexOf(d)&&(c.push(d),b.push("<author>"+d+"</author>")),a.T&&a.ID&&-1==c.indexOf("tc="+a.ID)&&(c.push("tc="+a.ID),b.push("<author>tc="+a.ID+"</author>"))})}),0==c.length&&(c.push("SheetJ5"),b.push("<author>SheetJ5</author>")),b.push("</authors>"),b.push("<commentList>"),a.forEach(function(a){var d=0,e=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?d=c.indexOf("tc="+a[1][0].ID):a[1].forEach(function(a){a.a&&(d=c.indexOf(hA(a.a))),e.push(a.t||"")}),b.push('<comment ref="'+a[0]+'" authorId="'+d+'"><text>'),e.length<=1)b.push(hT("t",hA(e[0]||"")));else{for(var f="Comment:\n    "+e[0]+"\n",g=1;g<e.length;++g)f+="Reply:\n    "+e[g]+"\n";b.push(hT("t",hA(f)))}b.push("</text></comment>")}),b.push("</commentList>"),b.length>2&&(b[b.length]="</comments>",b[1]=b[1].replace("/>",">")),b.join("")}var lu=["xlsb","xlsm","xlam","biff8","xla"],lv=function(){var a=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,b={r:0,c:0};function c(a,c,d,e){var f=!1,g=!1;0==d.length?g=!0:"["==d.charAt(0)&&(g=!0,d=d.slice(1,-1)),0==e.length?f=!0:"["==e.charAt(0)&&(f=!0,e=e.slice(1,-1));var h=d.length>0?0|parseInt(d,10):0,i=e.length>0?0|parseInt(e,10):0;return f?i+=b.c:--i,g?h+=b.r:--h,c+(f?"":"$")+iL(i)+(g?"":"$")+iJ(h)}return function(d,e){return b=e,d.replace(a,c)}}(),lw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lx=function(a,b){return a.replace(lw,function(a,c,d,e,f,g){var h=iK(e)-(d?0:b.c),i=iI(g)-(f?0:b.r);return c+"R"+(0==i?"":f?i+1:"["+i+"]")+"C"+(0==h?"":d?h+1:"["+h+"]")})};function ly(a,b){return a.replace(lw,function(a,c,d,e,f,g){return c+("$"==d?d+e:iL(iK(e)+b.c))+("$"==f?f+g:iJ(iI(g)+b.r))})}function lz(a){return a.replace(/_xlfn\./g,"")}function lA(a){a.l+=1}function lB(a,b){var c=a.read_shift(1==b?1:2);return[16383&c,c>>14&1,c>>15&1]}function lC(a,b,c){var d=2;if(c)if(c.biff>=2&&c.biff<=5)return lD(a,b,c);else 12==c.biff&&(d=4);var e=a.read_shift(d),f=a.read_shift(d),g=lB(a,2),h=lB(a,2);return{s:{r:e,c:g[0],cRel:g[1],rRel:g[2]},e:{r:f,c:h[0],cRel:h[1],rRel:h[2]}}}function lD(a){var b=lB(a,2),c=lB(a,2),d=a.read_shift(1),e=a.read_shift(1);return{s:{r:b[0],c:d,cRel:b[1],rRel:b[2]},e:{r:c[0],c:e,cRel:c[1],rRel:c[2]}}}function lE(a,b,c){if(c&&c.biff>=2&&c.biff<=5){var d,e,f;return e=lB(d=a,2),f=d.read_shift(1),{r:e[0],c:f,cRel:e[1],rRel:e[2]}}var g=a.read_shift(c&&12==c.biff?4:2),h=lB(a,2);return{r:g,c:h[0],cRel:h[1],rRel:h[2]}}function lF(a){var b=1&a[a.l+1];return a.l+=4,[b,1]}function lG(a){return[a.read_shift(1),a.read_shift(1)]}function lH(a,b,c){var d;return a.l+=2,[{r:a.read_shift(2),c:255&(d=a.read_shift(2)),fQuoted:!!(16384&d),cRel:d>>15,rRel:d>>15}]}function lI(a){return a.l+=6,[]}function lJ(a){return a.l+=2,[jX(a),1&a.read_shift(2)]}var lK=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],lL={1:{n:"PtgExp",f:function(a,b,c){return(a.l++,c&&12==c.biff)?[a.read_shift(4,"i"),0]:[a.read_shift(2),a.read_shift(c&&2==c.biff?1:2)]}},2:{n:"PtgTbl",f:iz},3:{n:"PtgAdd",f:lA},4:{n:"PtgSub",f:lA},5:{n:"PtgMul",f:lA},6:{n:"PtgDiv",f:lA},7:{n:"PtgPower",f:lA},8:{n:"PtgConcat",f:lA},9:{n:"PtgLt",f:lA},10:{n:"PtgLe",f:lA},11:{n:"PtgEq",f:lA},12:{n:"PtgGe",f:lA},13:{n:"PtgGt",f:lA},14:{n:"PtgNe",f:lA},15:{n:"PtgIsect",f:lA},16:{n:"PtgUnion",f:lA},17:{n:"PtgRange",f:lA},18:{n:"PtgUplus",f:lA},19:{n:"PtgUminus",f:lA},20:{n:"PtgPercent",f:lA},21:{n:"PtgParen",f:lA},22:{n:"PtgMissArg",f:lA},23:{n:"PtgStr",f:function(a,b,c){return a.l++,j_(a,b-1,c)}},26:{n:"PtgSheet",f:function(a,b,c){return a.l+=5,a.l+=2,a.l+=2==c.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(a,b,c){return a.l+=2==c.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(a){return a.l++,jh[a.read_shift(1)]}},29:{n:"PtgBool",f:function(a){return a.l++,0!==a.read_shift(1)}},30:{n:"PtgInt",f:function(a){return a.l++,a.read_shift(2)}},31:{n:"PtgNum",f:function(a){return a.l++,i7(a,8)}},32:{n:"PtgArray",f:function(a,b,c){var d=(96&a[a.l++])>>5;return a.l+=2==c.biff?6:12==c.biff?14:7,[d]}},33:{n:"PtgFunc",f:function(a,b,c){var d=(96&a[a.l])>>5;a.l+=1;var e=a.read_shift(c&&c.biff<=3?1:2);return[lZ[e],lY[e],d]}},34:{n:"PtgFuncVar",f:function(a,b,c){var d,e=a[a.l++],f=a.read_shift(1),g=c&&c.biff<=3?[88==e?-1:0,a.read_shift(1)]:[(d=a)[d.l+1]>>7,32767&d.read_shift(2)];return[f,(0===g[0]?lY:lX)[g[1]]]}},35:{n:"PtgName",f:function(a,b,c){var d=a.read_shift(1)>>>5&3,e=!c||c.biff>=8?4:2,f=a.read_shift(e);switch(c.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12}return[d,0,f]}},36:{n:"PtgRef",f:function(a,b,c){var d=(96&a[a.l])>>5;return a.l+=1,[d,lE(a,0,c)]}},37:{n:"PtgArea",f:function(a,b,c){return[(96&a[a.l++])>>5,lC(a,c.biff>=2&&c.biff<=5?6:8,c)]}},38:{n:"PtgMemArea",f:function(a,b,c){var d=a.read_shift(1)>>>5&3;return a.l+=c&&2==c.biff?3:4,[d,a.read_shift(c&&2==c.biff?1:2)]}},39:{n:"PtgMemErr",f:iz},40:{n:"PtgMemNoMem",f:iz},41:{n:"PtgMemFunc",f:function(a,b,c){return[a.read_shift(1)>>>5&3,a.read_shift(c&&2==c.biff?1:2)]}},42:{n:"PtgRefErr",f:function(a,b,c){var d=a.read_shift(1)>>>5&3;return a.l+=4,c.biff<8&&a.l--,12==c.biff&&(a.l+=2),[d]}},43:{n:"PtgAreaErr",f:function(a,b,c){var d=(96&a[a.l++])>>5;return a.l+=c&&c.biff>8?12:c.biff<8?6:8,[d]}},44:{n:"PtgRefN",f:function(a,b,c){var d=(96&a[a.l])>>5;return a.l+=1,[d,function(a,b,c){var d,e,f,g,h,i=c&&c.biff?c.biff:8;if(i>=2&&i<=5){return e=(d=a).read_shift(2),f=d.read_shift(1),g=(32768&e)>>15,h=(16384&e)>>14,e&=16383,1==g&&e>=8192&&(e-=16384),1==h&&f>=128&&(f-=256),{r:e,c:f,cRel:h,rRel:g}}var j=a.read_shift(i>=12?4:2),k=a.read_shift(2),l=(16384&k)>>14,m=(32768&k)>>15;if(k&=16383,1==m)for(;j>524287;)j-=1048576;if(1==l)for(;k>8191;)k-=16384;return{r:j,c:k,cRel:l,rRel:m}}(a,0,c)]}},45:{n:"PtgAreaN",f:function(a,b,c){return[(96&a[a.l++])>>5,function(a,b,c){if(c.biff<8)return lD(a,b,c);var d=a.read_shift(12==c.biff?4:2),e=a.read_shift(12==c.biff?4:2),f=lB(a,2),g=lB(a,2);return{s:{r:d,c:f[0],cRel:f[1],rRel:f[2]},e:{r:e,c:g[0],cRel:g[1],rRel:g[2]}}}(a,b-1,c)]}},46:{n:"PtgMemAreaN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},57:{n:"PtgNameX",f:function(a,b,c){var d,e,f,g;return 5==c.biff?(e=(d=a).read_shift(1)>>>5&3,f=d.read_shift(2,"i"),d.l+=8,g=d.read_shift(2),d.l+=12,[e,f,g]):[a.read_shift(1)>>>5&3,a.read_shift(2),a.read_shift(4)]}},58:{n:"PtgRef3d",f:function(a,b,c){var d=(96&a[a.l])>>5;a.l+=1;var e=a.read_shift(2);return c&&5==c.biff&&(a.l+=12),[d,e,lE(a,0,c)]}},59:{n:"PtgArea3d",f:function(a,b,c){var d=(96&a[a.l++])>>5,e=a.read_shift(2,"i"),f=8;if(c)switch(c.biff){case 5:a.l+=12,f=6;break;case 12:f=12}return[d,e,lC(a,f,c)]}},60:{n:"PtgRefErr3d",f:function(a,b,c){var d=(96&a[a.l++])>>5,e=a.read_shift(2),f=4;if(c)switch(c.biff){case 5:f=15;break;case 12:f=6}return a.l+=f,[d,e]}},61:{n:"PtgAreaErr3d",f:function(a,b,c){var d=(96&a[a.l++])>>5,e=a.read_shift(2),f=8;if(c)switch(c.biff){case 5:a.l+=12,f=6;break;case 12:f=12}return a.l+=f,[d,e]}},255:{}},lM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lN={1:{n:"PtgElfLel",f:lJ},2:{n:"PtgElfRw",f:lH},3:{n:"PtgElfCol",f:lH},6:{n:"PtgElfRwV",f:lH},7:{n:"PtgElfColV",f:lH},10:{n:"PtgElfRadical",f:lH},11:{n:"PtgElfRadicalS",f:lI},13:{n:"PtgElfColS",f:lI},15:{n:"PtgElfColSV",f:lI},16:{n:"PtgElfRadicalLel",f:lJ},25:{n:"PtgList",f:function(a){a.l+=2;var b=a.read_shift(2),c=a.read_shift(2),d=a.read_shift(4),e=a.read_shift(2),f=a.read_shift(2),g=lK[c>>2&31];return{ixti:b,coltype:3&c,rt:g,idx:d,c:e,C:f}}},29:{n:"PtgSxName",f:function(a){return a.l+=2,[a.read_shift(4)]}},255:{}},lO={0:{n:"PtgAttrNoop",f:function(a){return a.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(a,b,c){var d=255&a[a.l+1]?1:0;return a.l+=c&&2==c.biff?3:4,[d]}},2:{n:"PtgAttrIf",f:function(a,b,c){var d=255&a[a.l+1]?1:0;return a.l+=2,[d,a.read_shift(c&&2==c.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(a,b,c){a.l+=2;for(var d=a.read_shift(c&&2==c.biff?1:2),e=[],f=0;f<=d;++f)e.push(a.read_shift(c&&2==c.biff?1:2));return e}},8:{n:"PtgAttrGoto",f:function(a,b,c){var d=255&a[a.l+1]?1:0;return a.l+=2,[d,a.read_shift(c&&2==c.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(a,b,c){a.l+=c&&2==c.biff?3:4}},32:{n:"PtgAttrBaxcel",f:lF},33:{n:"PtgAttrBaxcel",f:lF},64:{n:"PtgAttrSpace",f:function(a){return a.read_shift(2),lG(a,2)}},65:{n:"PtgAttrSpaceSemi",f:function(a){return a.read_shift(2),lG(a,2)}},128:{n:"PtgAttrIfError",f:function(a){var b=255&a[a.l+1]?1:0;return a.l+=2,[b,a.read_shift(2)]}},255:{}};function lP(a,b,c,d){if(d.biff<8)return e=b,void(a.l+=e);for(var e,f,g=a.l+b,h=[],i=0;i!==c.length;++i)switch(c[i][0]){case"PtgArray":c[i][1]=function(a,b,c){var d=0,e=0;12==c.biff?(d=a.read_shift(4),e=a.read_shift(4)):(e=1+a.read_shift(1),d=1+a.read_shift(2)),c.biff>=2&&c.biff<8&&(--d,0==--e&&(e=256));for(var f=0,g=[];f!=d&&(g[f]=[]);++f)for(var h=0;h!=e;++h)g[f][h]=function(a,b){var c=[a.read_shift(1)];if(12==b)switch(c[0]){case 2:c[0]=4;break;case 4:c[0]=16;break;case 0:c[0]=1;break;case 1:c[0]=2}switch(c[0]){case 4:c[1]=jV(a,1)?"TRUE":"FALSE",12!=b&&(a.l+=7);break;case 37:case 16:c[1]=jh[a[a.l]],a.l+=12==b?4:8;break;case 0:a.l+=8;break;case 1:c[1]=i7(a,8);break;case 2:c[1]=j2(a,0,{biff:b>0&&b<8?2:b});break;default:throw Error("Bad SerAr: "+c[0])}return c}(a,c.biff);return g}(a,0,d),h.push(c[i][1]);break;case"PtgMemArea":c[i][2]=function(a,b,c){for(var d=a.read_shift(12==c.biff?4:2),e=[],f=0;f!=d;++f)e.push((12==c.biff?i5:kb)(a,8));return e}(a,c[i][1],d),h.push(c[i][2]);break;case"PtgExp":d&&12==d.biff&&(c[i][1][1]=a.read_shift(4),h.push(c[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+c[i][0]}return 0!=(b=g-a.l)&&h.push((f=b,void(a.l+=f))),h}function lQ(a,b,c){for(var d,e,f,g=a.l+b,h=[];g!=a.l;)(b=g-a.l,e=lL[f=a[a.l]]||lL[lM[f]],(24===f||25===f)&&(e=(24===f?lN:lO)[a[a.l+1]]),e&&e.f)?h.push([e.n,e.f(a,b,c)]):(d=b,a.l+=d);return h}var lR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lS(a,b,c){if(!a)return"SH33TJSERR0";if(c.biff>8&&(!a.XTI||!a.XTI[b]))return a.SheetNames[b];if(!a.XTI)return"SH33TJSERR6";var d=a.XTI[b];if(c.biff<8)return b>1e4&&(b-=65536),b<0&&(b=-b),0==b?"":a.XTI[b-1];if(!d)return"SH33TJSERR1";var e="";if(c.biff>8)switch(a[d[0]][0]){case 357:return e=-1==d[1]?"#REF":a.SheetNames[d[1]],d[1]==d[2]?e:e+":"+a.SheetNames[d[2]];case 358:if(null!=c.SID)return a.SheetNames[c.SID];return"SH33TJSSAME"+a[d[0]][0];default:return"SH33TJSSRC"+a[d[0]][0]}switch(a[d[0]][0][0]){case 1025:return e=-1==d[1]?"#REF":a.SheetNames[d[1]]||"SH33TJSERR3",d[1]==d[2]?e:e+":"+a.SheetNames[d[2]];case 14849:return a[d[0]].slice(1).map(function(a){return a.Name}).join(";;");default:if(!a[d[0]][0][3])return"SH33TJSERR2";return e=-1==d[1]?"#REF":a[d[0]][0][3][d[1]]||"SH33TJSERR4",d[1]==d[2]?e:e+":"+a[d[0]][0][3][d[2]]}}function lT(a,b,c){var d=lS(a,b,c);return"#REF"==d?d:function(a,b){if(!a&&!(b&&b.biff<=5&&b.biff>=2))throw Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(a)?"'"+a+"'":a}(d,c)}function lU(a,b,c,d,e){var f,g,h,i,j=e&&e.biff||8,k={s:{c:0,r:0},e:{c:0,r:0}},l=[],m=0,n=0,o="";if(!a[0]||!a[0][0])return"";for(var p=-1,q="",r=0,s=a[0].length;r<s;++r){var t=a[0][r];switch(t[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=l.pop(),g=l.pop(),p>=0){switch(a[0][p][1][0]){case 0:q=g7(" ",a[0][p][1][1]);break;case 1:q=g7("\r",a[0][p][1][1]);break;default:if(q="",e.WTF)throw Error("Unexpected PtgAttrSpaceType "+a[0][p][1][0])}g+=q,p=-1}l.push(g+lR[t[0]]+f);break;case"PtgIsect":f=l.pop(),g=l.pop(),l.push(g+" "+f);break;case"PtgUnion":f=l.pop(),g=l.pop(),l.push(g+","+f);break;case"PtgRange":f=l.pop(),g=l.pop(),l.push(g+":"+f);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":h=iE(t[1][1],k,e),l.push(iG(h,j));break;case"PtgRefN":h=c?iE(t[1][1],c,e):t[1][1],l.push(iG(h,j));break;case"PtgRef3d":m=t[1][1],h=iE(t[1][2],k,e),o=lT(d,m,e),l.push(o+"!"+iG(h,j));break;case"PtgFunc":case"PtgFuncVar":var u=t[1][0],v=t[1][1];u||(u=0);var w=0==(u&=127)?[]:l.slice(-u);l.length-=u,"User"===v&&(v=w.shift()),l.push(v+"("+w.join(",")+")");break;case"PtgBool":l.push(t[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":l.push(t[1]);break;case"PtgNum":l.push(String(t[1]));break;case"PtgStr":l.push('"'+t[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":i=iF(t[1][1],c?{s:c}:k,e),l.push(iH(i,e));break;case"PtgArea":i=iF(t[1][1],k,e),l.push(iH(i,e));break;case"PtgArea3d":m=t[1][1],i=t[1][2],o=lT(d,m,e),l.push(o+"!"+iH(i,e));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgName":n=t[1][2];var x=(d.names||[])[n-1]||(d[0]||[])[n],y=x?x.Name:"SH33TJSNAME"+String(n);y&&"_xlfn."==y.slice(0,6)&&!e.xlfn&&(y=y.slice(6)),l.push(y);break;case"PtgNameX":var z,A=t[1][1];if(n=t[1][2],e.biff<=5)A<0&&(A=-A),d[A]&&(z=d[A][n]);else{var B="";if(14849==((d[A]||[])[0]||[])[0]||(1025==((d[A]||[])[0]||[])[0]?d[A][n]&&d[A][n].itab>0&&(B=d.SheetNames[d[A][n].itab-1]+"!"):B=d.SheetNames[n-1]+"!"),d[A]&&d[A][n])B+=d[A][n].Name;else if(d[0]&&d[0][n])B+=d[0][n].Name;else{var C=(lS(d,A,e)||"").split(";;");C[n-1]?B=C[n-1]:B+="SH33TJSERRX"}l.push(B);break}z||(z={Name:"SH33TJSERRY"}),l.push(z.Name);break;case"PtgParen":var D="(",E=")";if(p>=0){switch(q="",a[0][p][1][0]){case 2:D=g7(" ",a[0][p][1][1])+D;break;case 3:D=g7("\r",a[0][p][1][1])+D;break;case 4:E=g7(" ",a[0][p][1][1])+E;break;case 5:E=g7("\r",a[0][p][1][1])+E;break;default:if(e.WTF)throw Error("Unexpected PtgAttrSpaceType "+a[0][p][1][0])}p=-1}l.push(D+l.pop()+E);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":l.push("#REF!");break;case"PtgExp":h={c:t[1][1],r:t[1][0]};var F={c:c.c,r:c.r};if(d.sharedf[iN(h)]){var G=d.sharedf[iN(h)];l.push(lU(G,k,F,d,e))}else{var H=!1;for(f=0;f!=d.arrayf.length;++f)if((g=d.arrayf[f],!(h.c<g[0].s.c)&&!(h.c>g[0].e.c))&&!(h.r<g[0].s.r)&&!(h.r>g[0].e.r)){l.push(lU(g[1],k,F,d,e)),H=!0;break}H||l.push(t[1])}break;case"PtgArray":l.push("{"+function(a){for(var b=[],c=0;c<a.length;++c){for(var d=a[c],e=[],f=0;f<d.length;++f){var g=d[f];g?2===g[0]?e.push('"'+g[1].replace(/"/g,'""')+'"'):e.push(g[1]):e.push("")}b.push(e.join(","))}return b.join(";")}(t[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=r;break;case"PtgMissArg":l.push("");break;case"PtgList":l.push("Table"+t[1].idx+"[#"+t[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw Error("Unsupported ELFs");default:throw Error("Unrecognized Formula Token: "+String(t))}var I=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=e.biff&&p>=0&&-1==I.indexOf(a[0][r][0])){t=a[0][p];var J=!0;switch(t[1][0]){case 4:J=!1;case 0:q=g7(" ",t[1][1]);break;case 5:J=!1;case 1:q=g7("\r",t[1][1]);break;default:if(q="",e.WTF)throw Error("Unexpected PtgAttrSpaceType "+t[1][0])}l.push((J?q:"")+l.pop()+(J?"":q)),p=-1}}if(l.length>1&&e.WTF)throw Error("bad formula stack");return l[0]}function lV(a,b,c){var d=a.l+b,e=j8(a,6);2==c.biff&&++a.l;var f=function(a){var b;if(65535!==io(a,a.l+6))return[i7(a),"n"];switch(a[a.l]){case 0:return a.l+=8,["String","s"];case 1:return b=1===a[a.l+2],a.l+=8,[b,"b"];case 2:return b=a[a.l+2],a.l+=8,[b,"e"];case 3:return a.l+=8,["","s"]}return[]}(a,8),g=a.read_shift(1);2!=c.biff&&(a.read_shift(1),c.biff>=5&&a.read_shift(4));var h=function(a,b,c){var d,e,f=a.l+b,g=2==c.biff?1:2,h=a.read_shift(g);if(65535==h)return[[],(d=b-2,void(a.l+=d))];var i=lQ(a,h,c);return b!==h+g&&(e=lP(a,b-h-g,i,c)),a.l=f,[i,e]}(a,d-a.l,c);return{cell:e,val:f[0],formula:h,shared:g>>3&1,tt:f[1]}}function lW(a,b,c){var d=a.read_shift(4),e=lQ(a,d,c),f=a.read_shift(4),g=f>0?lP(a,f,e,c):null;return[e,g]}var lX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lY={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lZ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function l$(a){return"of:"==a.slice(0,3)&&(a=a.slice(3)),61==a.charCodeAt(0)&&61==(a=a.slice(1)).charCodeAt(0)&&(a=a.slice(1)),(a=(a=(a=a.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,b){return b.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function l_(a){var b=a.split(":");return[b[0].split(".")[0],b[0].split(".")[1]+(b.length>1?":"+(b[1].split(".")[1]||b[1].split(".")[0]):"")]}var l0={},l1={},l2="undefined"!=typeof Map;function l3(a,b,c){var d=0,e=a.length;if(c){if(l2?c.has(b):Object.prototype.hasOwnProperty.call(c,b)){for(var f=l2?c.get(b):c[b];d<f.length;++d)if(a[f[d]].t===b)return a.Count++,f[d]}}else for(;d<e;++d)if(a[d].t===b)return a.Count++,d;return a[e]={t:b},a.Count++,a.Unique++,c&&(l2?(c.has(b)||c.set(b,[]),c.get(b).push(e)):(Object.prototype.hasOwnProperty.call(c,b)||(c[b]=[]),c[b].push(e))),e}function l4(a,b){var c={min:a+1,max:a+1},d=-1;return b.MDW&&(kZ=b.MDW),null!=b.width?c.customWidth=1:null!=b.wpx?d=k_(b.wpx):null!=b.wch&&(d=b.wch),d>-1?(c.width=k0(d),c.customWidth=1):null!=b.width&&(c.width=b.width),b.hidden&&(c.hidden=!0),null!=b.level&&(c.outlineLevel=c.level=b.level),c}function l5(a,b){if(a){var c=[.7,.7,.75,.75,.3,.3];"xlml"==b&&(c=[1,1,1,1,.5,.5]),null==a.left&&(a.left=c[0]),null==a.right&&(a.right=c[1]),null==a.top&&(a.top=c[2]),null==a.bottom&&(a.bottom=c[3]),null==a.header&&(a.header=c[4]),null==a.footer&&(a.footer=c[5])}}function l6(a,b,c){var d=c.revssf[null!=b.z?b.z:"General"],e=60,f=a.length;if(null==d&&c.ssf){for(;e<392;++e)if(null==c.ssf[e]){gL(b.z,e),c.ssf[e]=b.z,c.revssf[b.z]=d=e;break}}for(e=0;e!=f;++e)if(a[e].numFmtId===d)return e;return a[f]={numFmtId:d,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function l7(a,b,c,d,e,f){try{d.cellNF&&(a.z=gk[b])}catch(a){if(d.WTF)throw a}if("z"!==a.t||d.cellStyles){if("d"===a.t&&"string"==typeof a.v&&(a.v=g4(a.v)),(!d||!1!==d.cellText)&&"z"!==a.t)try{if(null==gk[b]&&gL(gO[b]||"General",b),"e"===a.t)a.w=a.w||jh[a.v];else if(0===b)if("n"===a.t)(0|a.v)===a.v?a.w=a.v.toString(10):a.w=gu(a.v);else if("d"===a.t){var g=gY(a.v);(0|g)===g?a.w=g.toString(10):a.w=gu(g)}else{if(void 0===a.v)return"";a.w=gv(a.v,l1)}else"d"===a.t?a.w=gK(b,gY(a.v),l1):a.w=gK(b,a.v,l1)}catch(a){if(d.WTF)throw a}if(d.cellStyles&&null!=c)try{a.s=f.Fills[c],a.s.fgColor&&a.s.fgColor.theme&&!a.s.fgColor.rgb&&(a.s.fgColor.rgb=kY(e.themeElements.clrScheme[a.s.fgColor.theme].rgb,a.s.fgColor.tint||0),d.WTF&&(a.s.fgColor.raw_rgb=e.themeElements.clrScheme[a.s.fgColor.theme].rgb)),a.s.bgColor&&a.s.bgColor.theme&&(a.s.bgColor.rgb=kY(e.themeElements.clrScheme[a.s.bgColor.theme].rgb,a.s.bgColor.tint||0),d.WTF&&(a.s.bgColor.raw_rgb=e.themeElements.clrScheme[a.s.bgColor.theme].rgb))}catch(a){if(d.WTF&&f.Fills)throw a}}}var l8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,l9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ma=/<(?:\w:)?hyperlink [^>]*>/mg,mb=/"(\w*:\w*)"/,mc=/<(?:\w:)?col\b[^>]*[\/]?>/g,md=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,me=/<(?:\w:)?pageMargins[^>]*\/>/g,mf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,mg=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mh=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function mi(a,b,c,d){var e=ht(a);c.Sheets[d]||(c.Sheets[d]={}),e.codeName&&(c.Sheets[d].CodeName=hx(hK(e.codeName)))}var mj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mk=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],ml=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,mm=function(){var a=/<(?:\w+:)?c[ \/>]/,b=/<\/(?:\w+:)?row>/,c=/r=["']([^"']*)["']/,d=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,e=/ref=["']([^"']*)["']/,f=hM("v"),g=hM("f");return function(h,i,j,k,l,m){for(var n,o,p,q,r,s=0,t="",u=[],v=[],w=0,x=0,y=0,z="",A=0,B=0,C=0,D=0,E=Array.isArray(m.CellXf),F=[],G=[],H=Array.isArray(i),I=[],J={},K=!1,L=!!j.sheetStubs,M=h.split(b),N=0,O=M.length;N!=O;++N){var P=(t=M[N].trim()).length;if(0!==P){var Q=0;c:for(s=0;s<P;++s)switch(t[s]){case">":if("/"!=t[s-1]){++s;break c}if(j&&j.cellStyles){if(A=null!=(o=ht(t.slice(Q,s),!0)).r?parseInt(o.r,10):A+1,B=-1,j.sheetRows&&j.sheetRows<A)continue;J={},K=!1,o.ht&&(K=!0,J.hpt=parseFloat(o.ht),J.hpx=k5(J.hpt)),"1"==o.hidden&&(K=!0,J.hidden=!0),null!=o.outlineLevel&&(K=!0,J.level=+o.outlineLevel),K&&(I[A-1]=J)}break;case"<":Q=s}if(Q>=s)break;if(A=null!=(o=ht(t.slice(Q,s),!0)).r?parseInt(o.r,10):A+1,B=-1,!j.sheetRows||!(j.sheetRows<A)){k.s.r>A-1&&(k.s.r=A-1),k.e.r<A-1&&(k.e.r=A-1),j&&j.cellStyles&&(J={},K=!1,o.ht&&(K=!0,J.hpt=parseFloat(o.ht),J.hpx=k5(J.hpt)),"1"==o.hidden&&(K=!0,J.hidden=!0),null!=o.outlineLevel&&(K=!0,J.level=+o.outlineLevel),K&&(I[A-1]=J)),u=t.slice(s).split(a);for(var R=0;R!=u.length&&"<"==u[R].trim().charAt(0);++R);for(s=0,u=u.slice(R);s!=u.length;++s)if(0!==(t=u[s].trim()).length){if(v=t.match(c),w=s,x=0,y=0,t="<c "+("<"==t.slice(0,1)?">":"")+t,null!=v&&2===v.length){for(x=0,w=0,z=v[1];x!=z.length&&!((y=z.charCodeAt(x)-64)<1)&&!(y>26);++x)w=26*w+y;B=--w}else++B;for(x=0;x!=t.length&&62!==t.charCodeAt(x);++x);if(++x,(o=ht(t.slice(0,x),!0)).r||(o.r=iN({r:A-1,c:B})),z=t.slice(x),n={t:""},null!=(v=z.match(f))&&""!==v[1]&&(n.v=hx(v[1])),j.cellFormula){if(null!=(v=z.match(g))&&""!==v[1]){if(n.f=hx(hK(v[1])).replace(/\r\n/g,"\n"),j.xlfn||(n.f=lz(n.f)),v[0].indexOf('t="array"')>-1)n.F=(z.match(e)||[])[1],n.F.indexOf(":")>-1&&F.push([iQ(n.F),n.F]);else if(v[0].indexOf('t="shared"')>-1){q=ht(v[0]);var S=hx(hK(v[1]));j.xlfn||(S=lz(S)),G[parseInt(q.si,10)]=[q,S,o.r]}}else(v=z.match(/<f[^>]*\/>/))&&G[(q=ht(v[0])).si]&&(n.f=function(a,b,c){var d=iO(b).s,e=iM(c);return ly(a,{r:e.r-d.r,c:e.c-d.c})}(G[q.si][1],G[q.si][2],o.r));var T=iM(o.r);for(x=0;x<F.length;++x)T.r>=F[x][0].s.r&&T.r<=F[x][0].e.r&&T.c>=F[x][0].s.c&&T.c<=F[x][0].e.c&&(n.F=F[x][1])}if(null==o.t&&void 0===n.v)if(n.f||n.F)n.v=0,n.t="n";else{if(!L)continue;n.t="z"}else n.t=o.t||"n";switch(k.s.c>B&&(k.s.c=B),k.e.c<B&&(k.e.c=B),n.t){case"n":if(""==n.v||null==n.v){if(!L)continue;n.t="z"}else n.v=parseFloat(n.v);break;case"s":if(void 0===n.v){if(!L)continue;n.t="z"}else p=l0[parseInt(n.v,10)],n.v=p.t,n.r=p.r,j.cellHTML&&(n.h=p.h);break;case"str":n.t="s",n.v=null!=n.v?hK(n.v):"",j.cellHTML&&(n.h=hD(n.v));break;case"inlineStr":v=z.match(d),n.t="s",null!=v&&(p=kH(v[1]))?(n.v=p.t,j.cellHTML&&(n.h=p.h)):n.v="";break;case"b":n.v=hF(n.v);break;case"d":j.cellDates?n.v=g4(n.v,1):(n.v=gY(g4(n.v,1)),n.t="n");break;case"e":j&&!1===j.cellText||(n.w=n.v),n.v=ji[n.v]}if(C=D=0,r=null,E&&void 0!==o.s&&null!=(r=m.CellXf[o.s])&&(null!=r.numFmtId&&(C=r.numFmtId),j.cellStyles&&null!=r.fillId&&(D=r.fillId)),l7(n,C,D,j,l,m),j.cellDates&&E&&"n"==n.t&&gH(gk[C])&&(n.t="d",n.v=g0(n.v)),o.cm&&j.xlmeta){var U=(j.xlmeta.Cell||[])[o.cm-1];U&&"XLDAPR"==U.type&&(n.D=!0)}if(H){var V=iM(o.r);i[V.r]||(i[V.r]=[]),i[V.r][V.c]=n}else i[o.r]=n}}}}I.length>0&&(i["!rows"]=I)}}();function mn(a,b,c,d){var e,f=[hn,hV("worksheet",null,{xmlns:h$[0],"xmlns:r":hZ.r})],g=c.SheetNames[a],h=0,i="",j=c.Sheets[g];null==j&&(j={});var k=j["!ref"]||"A1",l=iQ(k);if(l.e.c>16383||l.e.r>1048575){if(b.WTF)throw Error("Range "+k+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575),k=iP(l)}d||(d={}),j["!comments"]=[];var m=[];!function(a,b,c,d,e){var f=!1,g={},h=null;if("xlsx"!==d.bookType&&b.vbaraw){var i=b.SheetNames[c];try{b.Workbook&&(i=b.Workbook.Sheets[c].CodeName||i)}catch(a){}f=!0,g.codeName=hL(hA(i))}if(a&&a["!outline"]){var j={summaryBelow:1,summaryRight:1};a["!outline"].above&&(j.summaryBelow=0),a["!outline"].left&&(j.summaryRight=0),h=(h||"")+hV("outlinePr",null,j)}(f||h)&&(e[e.length]=hV("sheetPr",h,g))}(j,c,a,b,f),f[f.length]=hV("dimension",null,{ref:k}),f[f.length]=(n={workbookViewId:"0"},(((c||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=c.Workbook.Views[0].RTL?"1":"0"),hV("sheetViews",hV("sheetView",null,n),{})),b.sheetFormat&&(f[f.length]=hV("sheetFormatPr",null,{defaultRowHeight:b.sheetFormat.defaultRowHeight||"16",baseColWidth:b.sheetFormat.baseColWidth||"10",outlineLevelRow:b.sheetFormat.outlineLevelRow||"7"})),null!=j["!cols"]&&j["!cols"].length>0&&(f[f.length]=function(a,b){for(var c,d=["<cols>"],e=0;e!=b.length;++e)(c=b[e])&&(d[d.length]=hV("col",null,l4(e,c)));return d[d.length]="</cols>",d.join("")}(0,j["!cols"])),f[h=f.length]="<sheetData/>",j["!links"]=[],null!=j["!ref"]&&(i=function(a,b,c,d){var e,f,g=[],h=[],i=iQ(a["!ref"]),j="",k="",l=[],m=0,n=0,o=a["!rows"],p=Array.isArray(a),q={r:k},r=-1;for(n=i.s.c;n<=i.e.c;++n)l[n]=iL(n);for(m=i.s.r;m<=i.e.r;++m){for(h=[],k=iJ(m),n=i.s.c;n<=i.e.c;++n){e=l[n]+k;var s=p?(a[m]||[])[n]:a[e];void 0!==s&&null!=(j=function(a,b,c,d){if(a.c&&c["!comments"].push([b,a.c]),void 0===a.v&&"string"!=typeof a.f||"z"===a.t&&!a.f)return"";var e="",f=a.t,g=a.v;if("z"!==a.t)switch(a.t){case"b":e=a.v?"1":"0";break;case"n":e=""+a.v;break;case"e":e=jh[a.v];break;case"d":d&&d.cellDates?e=g4(a.v,-1).toISOString():((a=g6(a)).t="n",e=""+(a.v=gY(g4(a.v)))),void 0===a.z&&(a.z=gk[14]);break;default:e=a.v}var h=hT("v",hA(e)),i={r:b},j=l6(d.cellXfs,a,d);switch(0!==j&&(i.s=j),a.t){case"n":case"z":break;case"d":i.t="d";break;case"b":i.t="b";break;case"e":i.t="e";break;default:if(null==a.v){delete a.t;break}if(a.v.length>32767)throw Error("Text length must not exceed 32767 characters");if(d&&d.bookSST){h=hT("v",""+l3(d.Strings,a.v,d.revStrings)),i.t="s";break}i.t="str"}if(a.t!=f&&(a.t=f,a.v=g),"string"==typeof a.f&&a.f){var k=a.F&&a.F.slice(0,b.length)==b?{t:"array",ref:a.F}:null;h=hV("f",hA(a.f),k)+(null!=a.v?h:"")}return a.l&&c["!links"].push([b,a.l]),a.D&&(i.cm=1),hV("c",h,i)}(s,e,a,b,c,d))&&h.push(j)}(h.length>0||o&&o[m])&&(q={r:k},o&&o[m]&&((f=o[m]).hidden&&(q.hidden=1),r=-1,f.hpx?r=k4(f.hpx):f.hpt&&(r=f.hpt),r>-1&&(q.ht=r,q.customHeight=1),f.level&&(q.outlineLevel=f.level)),g[g.length]=hV("row",h.join(""),q))}if(o)for(;m<o.length;++m)o&&o[m]&&(q={r:m+1},(f=o[m]).hidden&&(q.hidden=1),r=-1,f.hpx?r=k4(f.hpx):f.hpt&&(r=f.hpt),r>-1&&(q.ht=r,q.customHeight=1),f.level&&(q.outlineLevel=f.level),g[g.length]=hV("row","",q));return g.join("")}(j,b,a,c,d)).length>0&&(f[f.length]=i),f.length>h+1&&(f[f.length]="</sheetData>",f[h]=f[h].replace("/>",">")),j["!protect"]&&(f[f.length]=(o=j["!protect"],p={sheet:1},mj.forEach(function(a){null!=o[a]&&o[a]&&(p[a]="1")}),mk.forEach(function(a){null==o[a]||o[a]||(p[a]="0")}),o.password&&(p.password=kS(o.password).toString(16).toUpperCase()),hV("sheetProtection",null,p))),null!=j["!autofilter"]&&(f[f.length]=function(a,b,c,d){var e="string"==typeof a.ref?a.ref:iP(a.ref);c.Workbook||(c.Workbook={Sheets:[]}),c.Workbook.Names||(c.Workbook.Names=[]);var f=c.Workbook.Names,g=iO(e);g.s.r==g.e.r&&(g.e.r=iO(b["!ref"]).e.r,e=iP(g));for(var h=0;h<f.length;++h){var i=f[h];if("_xlnm._FilterDatabase"==i.Name&&i.Sheet==d){i.Ref="'"+c.SheetNames[d]+"'!"+e;break}}return h==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:d,Ref:"'"+c.SheetNames[d]+"'!"+e}),hV("autoFilter",null,{ref:e})}(j["!autofilter"],j,c,a)),null!=j["!merges"]&&j["!merges"].length>0&&(f[f.length]=function(a){if(0===a.length)return"";for(var b='<mergeCells count="'+a.length+'">',c=0;c!=a.length;++c)b+='<mergeCell ref="'+iP(a[c])+'"/>';return b+"</mergeCells>"}(j["!merges"]));var n,o,p,q,r=-1,s=-1;return j["!links"].length>0&&(f[f.length]="<hyperlinks>",j["!links"].forEach(function(a){a[1].Target&&(q={ref:a[0]},"#"!=a[1].Target.charAt(0)&&(s=jr(d,-1,hA(a[1].Target).replace(/#.*$/,""),jn.HLINK),q["r:id"]="rId"+s),(r=a[1].Target.indexOf("#"))>-1&&(q.location=hA(a[1].Target.slice(r+1))),a[1].Tooltip&&(q.tooltip=hA(a[1].Tooltip)),f[f.length]=hV("hyperlink",null,q))}),f[f.length]="</hyperlinks>"),delete j["!links"],null!=j["!margins"]&&(f[f.length]=(l5(e=j["!margins"]),hV("pageMargins",null,e))),(!b||b.ignoreEC||void 0==b.ignoreEC)&&(f[f.length]=hT("ignoredErrors",hV("ignoredError",null,{numberStoredAsText:1,sqref:k}))),m.length>0&&(s=jr(d,-1,"../drawings/drawing"+(a+1)+".xml",jn.DRAW),f[f.length]=hV("drawing",null,{"r:id":"rId"+s}),j["!drawing"]=m),j["!comments"].length>0&&(s=jr(d,-1,"../drawings/vmlDrawing"+(a+1)+".vml",jn.VML),f[f.length]=hV("legacyDrawing",null,{"r:id":"rId"+s}),j["!legacy"]=s),f.length>1&&(f[f.length]="</worksheet>",f[1]=f[1].replace("/>",">")),f.join("")}function mo(a){return[i_(a),i7(a),"n"]}var mp=["left","right","top","bottom","header","footer"],mq=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mr=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ms=[],mt=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function mu(a,b){for(var c=0;c!=a.length;++c)for(var d=a[c],e=0;e!=b.length;++e){var f=b[e];if(null==d[f[0]])d[f[0]]=f[1];else switch(f[2]){case"bool":"string"==typeof d[f[0]]&&(d[f[0]]=hF(d[f[0]]));break;case"int":"string"==typeof d[f[0]]&&(d[f[0]]=parseInt(d[f[0]],10))}}}function mv(a,b){for(var c=0;c!=b.length;++c){var d=b[c];if(null==a[d[0]])a[d[0]]=d[1];else switch(d[2]){case"bool":"string"==typeof a[d[0]]&&(a[d[0]]=hF(a[d[0]]));break;case"int":"string"==typeof a[d[0]]&&(a[d[0]]=parseInt(a[d[0]],10))}}}function mw(a){mv(a.WBProps,mq),mv(a.CalcPr,mt),mu(a.WBView,mr),mu(a.Sheets,ms),l1.date1904=hF(a.WBProps.date1904)}var mx="][*?/\\".split("");function my(a,b){if(a.length>31){if(b)return!1;throw Error("Sheet names cannot exceed 31 chars")}var c=!0;return mx.forEach(function(d){if(-1!=a.indexOf(d)){if(!b)throw Error("Sheet name cannot contain : \\ / ? * [ ]");c=!1}}),c}var mz=/<\w+:workbook/;function mA(a){var b=[hn];b[b.length]=hV("workbook",null,{xmlns:h$[0],"xmlns:r":hZ.r});var c=a.Workbook&&(a.Workbook.Names||[]).length>0,d={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(mq.forEach(function(b){null!=a.Workbook.WBProps[b[0]]&&a.Workbook.WBProps[b[0]]!=b[1]&&(d[b[0]]=a.Workbook.WBProps[b[0]])}),a.Workbook.WBProps.CodeName&&(d.codeName=a.Workbook.WBProps.CodeName,delete d.CodeName)),b[b.length]=hV("workbookPr",null,d);var e=a.Workbook&&a.Workbook.Sheets||[],f=0;if(e&&e[0]&&e[0].Hidden){for(f=0,b[b.length]="<bookViews>";f!=a.SheetNames.length&&e[f]&&e[f].Hidden;++f);f==a.SheetNames.length&&(f=0),b[b.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',b[b.length]="</bookViews>"}for(f=0,b[b.length]="<sheets>";f!=a.SheetNames.length;++f){var g={name:hA(a.SheetNames[f].slice(0,31))};if(g.sheetId=""+(f+1),g["r:id"]="rId"+(f+1),e[f])switch(e[f].Hidden){case 1:g.state="hidden";break;case 2:g.state="veryHidden"}b[b.length]=hV("sheet",null,g)}return b[b.length]="</sheets>",c&&(b[b.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(a){var c={name:a.Name};a.Comment&&(c.comment=a.Comment),null!=a.Sheet&&(c.localSheetId=""+a.Sheet),a.Hidden&&(c.hidden="1"),a.Ref&&(b[b.length]=hV("definedName",hA(a.Ref),c))}),b[b.length]="</definedNames>"),b.length>2&&(b[b.length]="</workbook>",b[1]=b[1].replace("/>",">")),b.join("")}function mB(a,b){var c={};return a.read_shift(4),c.ArchID=a.read_shift(4),a.l+=b-8,c}var mC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,mD=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mE(a,b){var c=a.split(/\s+/),d=[];if(b||(d[0]=c[0]),1===c.length)return d;var e,f,g,h=a.match(mC);if(h)for(g=0;g!=h.length;++g)-1===(f=(e=h[g].match(mD))[1].indexOf(":"))?d[e[1]]=e[2].slice(1,e[2].length-1):d["xmlns:"===e[1].slice(0,6)?"xmlns"+e[1].slice(6):e[1].slice(f+1)]=e[2].slice(1,e[2].length-1);return d}function mF(a,b){var c,d,e,f=b||{};gN();var g=fX(hX(a));("binary"==f.type||"array"==f.type||"base64"==f.type)&&(g=void 0!==h?h.utils.decode(65001,fV(g)):hK(g));var j=g.slice(0,1024).toLowerCase(),l=!1;if((1023&(j=j.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&j.indexOf(","),1023&j.indexOf(";"))){var m=g6(f);return m.type="string",kA.to_workbook(g,m)}if(-1==j.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(a){j.indexOf("<"+a)>=0&&(l=!0)}),l){var n=g,o=f,p=n.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!p||0==p.length)throw Error("Invalid HTML: could not find <table>");if(1==p.length)return iT(mS(p[0],o),o);var q=nt();return p.forEach(function(a,b){nu(q,mS(a,o),"Sheet"+(b+1))}),q}k={"General Number":"General","General Date":gk[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":gk[15],"Short Date":gk[14],"Long Time":gk[19],"Medium Time":gk[18],"Short Time":gk[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:gk[2],Standard:gk[4],Percent:gk[10],Scientific:gk[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var r,s,t,u=[],v={},w=[],x=f.dense?[]:{},y="",z={},A={},B=mE('<Data ss:Type="String">'),C=0,D=0,E=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},H={},I="",J=0,K=[],L={},M={},N=0,O=[],P=[],Q={},R=[],S=!1,T=[],U=[],V={},W=0,X=0,Y={Sheets:[],WBProps:{date1904:!1}},Z={};hY.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/mg,"");for(var _="";r=hY.exec(g);)switch(r[3]=(_=r[3]).toLowerCase()){case"data":if("data"==_){if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&u.push([r[3],!0]);break}if(u[u.length-1][1])break;"/"===r[1]?function(a,b,c,d,e,f,g,h,i,j){var l="General",m=d.StyleID,n={};j=j||{};var o=[],p=0;for(void 0===m&&h&&(m=h.StyleID),void 0===m&&g&&(m=g.StyleID);void 0!==f[m]&&(f[m].nf&&(l=f[m].nf),f[m].Interior&&o.push(f[m].Interior),f[m].Parent);)m=f[m].Parent;switch(c.Type){case"Boolean":d.t="b",d.v=hF(a);break;case"String":d.t="s",d.r=hE(hx(a)),d.v=a.indexOf("<")>-1?hx(b||a).replace(/<.*?>/g,""):d.r;break;case"DateTime":"Z"!=a.slice(-1)&&(a+="Z"),d.v=(g4(a)-new Date(Date.UTC(1899,11,30)))/864e5,d.v!=d.v?d.v=hx(a):d.v<60&&(d.v=d.v-1),l&&"General"!=l||(l="yyyy-mm-dd");case"Number":void 0===d.v&&(d.v=+a),d.t||(d.t="n");break;case"Error":d.t="e",d.v=ji[a],!1!==j.cellText&&(d.w=a);break;default:""==a&&""==b?d.t="z":(d.t="s",d.v=hE(b||a))}if(!function(a,b,c){if("z"!==a.t){if(!c||!1!==c.cellText)try{if("e"===a.t)a.w=a.w||jh[a.v];else if("General"===b)"n"===a.t?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=gu(a.v):a.w=gv(a.v);else{var d,e,f;d=b||"General",e=a.v,f=k[d]||hx(d),a.w="General"===f?gv(e):gK(f,e)}}catch(a){if(c.WTF)throw a}try{var g=k[b]||b||"General";if(c.cellNF&&(a.z=g),c.cellDates&&"n"==a.t&&gH(g)){var h=go(a.v);h&&(a.t="d",a.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}catch(a){if(c.WTF)throw a}}}(d,l,j),!1!==j.cellFormula)if(d.Formula){var q=hx(d.Formula);61==q.charCodeAt(0)&&(q=q.slice(1)),d.f=lv(q,e),delete d.Formula,"RC"==d.ArrayRange?d.F=lv("RC:RC",e):d.ArrayRange&&(d.F=lv(d.ArrayRange,e),i.push([iQ(d.F),d.F]))}else for(p=0;p<i.length;++p)e.r>=i[p][0].s.r&&e.r<=i[p][0].e.r&&e.c>=i[p][0].s.c&&e.c<=i[p][0].e.c&&(d.F=i[p][1]);j.cellStyles&&(o.forEach(function(a){!n.patternType&&a.patternType&&(n.patternType=a.patternType)}),d.s=n),void 0!==d.StyleID&&(d.ixfe=d.StyleID)}(g.slice(C,r.index),I,B,"comment"==u[u.length-1][0]?Q:z,{c:D,r:E},G,R[D],A,T,f):(I="",B=mE(r[0]),C=r.index+r[0].length);break;case"cell":if("/"===r[1])if(P.length>0&&(z.c=P),(!f.sheetRows||f.sheetRows>E)&&void 0!==z.v&&(f.dense?(x[E]||(x[E]=[]),x[E][D]=z):x[iL(D)+iJ(E)]=z),z.HRef&&(z.l={Target:hx(z.HRef)},z.HRefScreenTip&&(z.l.Tooltip=z.HRefScreenTip),delete z.HRef,delete z.HRefScreenTip),(z.MergeAcross||z.MergeDown)&&(W=D+(0|parseInt(z.MergeAcross,10)),X=E+(0|parseInt(z.MergeDown,10)),K.push({s:{c:D,r:E},e:{c:W,r:X}})),f.sheetStubs)if(z.MergeAcross||z.MergeDown){for(var aa=D;aa<=W;++aa)for(var ab=E;ab<=X;++ab)(aa>D||ab>E)&&(f.dense?(x[ab]||(x[ab]=[]),x[ab][aa]={t:"z"}):x[iL(aa)+iJ(ab)]={t:"z"});D=W+1}else++D;else z.MergeAcross?D=W+1:++D;else(z=function(a){var b=a.split(/\s+/),c={};if(1===b.length)return c;var d,e,f,g=a.match(mC);if(g)for(f=0;f!=g.length;++f)-1===(e=(d=g[f].match(mD))[1].indexOf(":"))?c[d[1]]=d[2].slice(1,d[2].length-1):c["xmlns:"===d[1].slice(0,6)?"xmlns"+d[1].slice(6):d[1].slice(e+1)]=d[2].slice(1,d[2].length-1);return c}(r[0])).Index&&(D=z.Index-1),D<F.s.c&&(F.s.c=D),D>F.e.c&&(F.e.c=D),"/>"===r[0].slice(-2)&&++D,P=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(E<F.s.r&&(F.s.r=E),E>F.e.r&&(F.e.r=E),"/>"===r[0].slice(-2)&&(A=mE(r[0])).Index&&(E=A.Index-1),D=0,++E):((A=mE(r[0])).Index&&(E=A.Index-1),V={},("0"==A.AutoFitHeight||A.Height)&&(V.hpx=parseInt(A.Height,10),V.hpt=k4(V.hpx),U[E]=V),"1"==A.Hidden&&(V.hidden=!0,U[E]=V));break;case"worksheet":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"));w.push(y),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(x["!ref"]=iP(F),f.sheetRows&&f.sheetRows<=F.e.r&&(x["!fullref"]=x["!ref"],F.e.r=f.sheetRows-1,x["!ref"]=iP(F))),K.length&&(x["!merges"]=K),R.length>0&&(x["!cols"]=R),U.length>0&&(x["!rows"]=U),v[y]=x}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=D=0,u.push([r[3],!1]),y=hx((s=mE(r[0])).Name),x=f.dense?[]:{},K=[],T=[],U=[],Z={name:y,Hidden:0},Y.Sheets.push(Z);break;case"table":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"))}else"/>"==r[0].slice(-2)||(u.push([r[3],!1]),R=[],S=!1);break;case"style":"/"===r[1]?function(a,b,c){if(c.cellStyles&&b.Interior){var d=b.Interior;d.Pattern&&(d.patternType=k6[d.Pattern]||d.Pattern)}a[b.ID]=b}(G,H,f):H=mE(r[0]);break;case"numberformat":H.nf=hx(mE(r[0]).Format||"General"),k[H.nf]&&(H.nf=k[H.nf]);for(var ac=0;392!=ac&&gk[ac]!=H.nf;++ac);if(392==ac){for(ac=57;392!=ac;++ac)if(null==gk[ac]){gL(H.nf,ac);break}}break;case"column":if("table"!==u[u.length-1][0])break;if((t=mE(r[0])).Hidden&&(t.hidden=!0,delete t.Hidden),t.Width&&(t.wpx=parseInt(t.Width,10)),!S&&t.wpx>10){S=!0,kZ=6;for(var ad=0;ad<R.length;++ad)R[ad]&&k3(R[ad])}S&&k3(t),R[t.Index-1||R.length]=t;for(var ae=0;ae<+t.Span;++ae)R[R.length]=g6(t);break;case"namedrange":if("/"===r[1])break;Y.Names||(Y.Names=[]);var af=ht(r[0]),ag={Name:af.Name,Ref:lv(af.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(ag.Sheet=Y.Sheets.length-1),Y.Names.push(ag);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":"/>"===r[0].slice(-2)||("/"===r[1]?I+=g.slice(J,r.index):J=r.index+r[0].length);break;case"interior":if(!f.cellStyles)break;H.Interior=mE(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":"/>"===r[0].slice(-2)||("/"===r[1]?(c=_,d=g.slice(N,r.index),i||(i=gV(jF)),L[c=i[c]||c]=d):N=r.index+r[0].length);break;case"styles":case"workbook":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"))}else u.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"));(e=Q).t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0,P.push(Q)}else u.push([r[3],!1]),Q={a:(s=mE(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var ah=mE(r[0]);x["!autofilter"]={ref:lv(ah.Range).replace(/\$/g,"")},u.push([r[3],!0])}break;case"datavalidation":case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((s=u.pop())[0]!==r[3])throw Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&u.push([r[3],!0]);break;default:if(0==u.length&&"document"==r[3]||0==u.length&&"uof"==r[3])return mU(g,f);var ai=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:ai=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:ai=!1}break;case"excelworkbook":switch(r[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:ai=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:ai=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(g.slice(N,r.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2}else N=r.index+r[0].length;break;case"header":x["!margins"]||l5(x["!margins"]={},"xlml"),isNaN(+ht(r[0]).Margin)||(x["!margins"].header=+ht(r[0]).Margin);break;case"footer":x["!margins"]||l5(x["!margins"]={},"xlml"),isNaN(+ht(r[0]).Margin)||(x["!margins"].footer=+ht(r[0]).Margin);break;case"pagemargins":var aj=ht(r[0]);x["!margins"]||l5(x["!margins"]={},"xlml"),isNaN(+aj.Top)||(x["!margins"].top=+aj.Top),isNaN(+aj.Left)||(x["!margins"].left=+aj.Left),isNaN(+aj.Right)||(x["!margins"].right=+aj.Right),isNaN(+aj.Bottom)||(x["!margins"].bottom=+aj.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;default:ai=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:ai=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:ai=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:ai=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:ai=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:ai=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:ai=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:ai=!1}break;case"smarttags":break;default:ai=!1}if(ai||r[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+u.join("|");if("customdocumentproperties"===u[u.length-1][0]){"/>"===r[0].slice(-2)||("/"===r[1]?function(a,b,c,d){var e=d;switch((c[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":e=hF(d);break;case"i2":case"int":e=parseInt(d,10);break;case"r4":case"float":e=parseFloat(d);break;case"date":case"dateTime.tz":e=g4(d);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw Error("bad custprop:"+c[0])}a[hx(b)]=e}(M,_,O,g.slice(N,r.index)):(O=r,N=r.index+r[0].length));break}if(f.WTF)throw"Unrecognized tag: "+r[3]+"|"+u.join("|")}var ak={};return f.bookSheets||f.bookProps||(ak.Sheets=v),ak.SheetNames=w,ak.Workbook=Y,ak.SSF=g6(gk),ak.Props=L,ak.Custprops=M,ak}function mG(a,b){switch(ng(b=b||{}),b.type||"base64"){case"base64":return mF(f0(a),b);case"binary":case"buffer":case"file":return mF(a,b);case"array":return mF(f7(a),b)}}function mH(a){return hV("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+lx(a.Ref,{r:0,c:0})})}var mI=[60,1084,2066,2165,2175];function mJ(a,b,c){if("z"!==a.t&&a.XF){var d=0;try{d=a.z||a.XF.numFmtId||0,b.cellNF&&(a.z=gk[d])}catch(a){if(b.WTF)throw a}if(!b||!1!==b.cellText)try{"e"===a.t?a.w=a.w||jh[a.v]:0===d||"General"==d?"n"===a.t?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=gu(a.v):a.w=gv(a.v):a.w=gK(d,a.v,{date1904:!!c,dateNF:b&&b.dateNF})}catch(a){if(b.WTF)throw a}if(b.cellDates&&d&&"n"==a.t&&gH(gk[d]||String(d))){var e=go(a.v);e&&(a.t="d",a.v=new Date(e.y,e.m-1,e.d,e.H,e.M,e.S,e.u))}}}function mK(a,b,c){return{v:a,ixfe:b,t:c}}var mL={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mM(a,b){if(b||(b={}),ng(b),fU(),b.codepage&&fS(b.codepage),a.FullPaths){if(gR.find(a,"/encryption"))throw Error("File is password-protected");e=gR.find(a,"!CompObj"),f=gR.find(a,"/Workbook")||gR.find(a,"/Book")}else{switch(b.type){case"base64":a=f5(f0(a));break;case"binary":a=f5(a);break;case"buffer":break;case"array":Array.isArray(a)||(a=Array.prototype.slice.call(a))}iy(a,0),f={content:a}}if(e&&function(a){var b={},c=a.content;if(c.l=28,b.AnsiUserType=c.read_shift(0,"lpstr-ansi"),b.AnsiClipboardFormat=ja(c,1),c.length-c.l<=4)return;var d=c.read_shift(4);if(0!=d&&!(d>40)&&(c.l-=4,b.Reserved1=c.read_shift(0,"lpstr-ansi"),!(c.length-c.l<=4)&&0x71b239f4===(d=c.read_shift(4)))&&(b.UnicodeClipboardFormat=ja(c,2),0!=(d=c.read_shift(4))&&!(d>40)))c.l-=4,b.Reserved2=c.read_shift(0,"lpwstr")}(e),b.bookProps&&!b.bookSheets)g={};else{var c,d,e,f,g,h,i=f1?"buffer":"array";if(f&&f.content)g=function(a,b){var c,d,e,f,g={opts:{}},h={},i,j,k,l,m,n=b.dense?[]:{},o={},p={},q=null,r=[],s="",t={},u="",v={},w=[],x=[],y=[],z={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},B=function(a){return a<8?jg[a]:a<64&&y[a-8]||jg[a]},C=function(a,b,c){var d,e=b.XF.data;e&&e.patternType&&c&&c.cellStyles&&(b.s={},b.s.patternType=e.patternType,(d=kX(B(e.icvFore)))&&(b.s.fgColor={rgb:d}),(d=kX(B(e.icvBack)))&&(b.s.bgColor={rgb:d}))},D=function(a,b,c){if(!(M>1)&&(!c.sheetRows||!(a.r>=c.sheetRows))){if(c.cellStyles&&b.XF&&b.XF.data&&C(a,b,c),delete b.ixfe,delete b.XF,i=a,u=iN(a),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),a.r<p.s.r&&(p.s.r=a.r),a.c<p.s.c&&(p.s.c=a.c),a.r+1>p.e.r&&(p.e.r=a.r+1),a.c+1>p.e.c&&(p.e.c=a.c+1),c.cellFormula&&b.f){for(var d=0;d<w.length;++d)if(!(w[d][0].s.c>a.c)&&!(w[d][0].s.r>a.r)&&!(w[d][0].e.c<a.c)&&!(w[d][0].e.r<a.r)){b.F=iP(w[d][0]),(w[d][0].s.c!=a.c||w[d][0].s.r!=a.r)&&delete b.f,b.f&&(b.f=""+lU(w[d][1],p,a,K,E));break}}c.dense?(n[a.r]||(n[a.r]=[]),n[a.r][a.c]=b):n[u]=b}},E={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!b&&!!b.cellStyles,WTF:!!b&&!!b.wtf};b.password&&(E.password=b.password);var F=[],G=[],H=[],I=[],J=!1,K=[];K.SheetNames=E.snames,K.sharedf=E.sharedf,K.arrayf=E.arrayf,K.names=[],K.XTI=[];var L=0,M=0,N=0,O=[],P=[];E.codepage=1200,fT(1200);for(var Q=!1;a.l<a.length-1;){var R=a.l,S=a.read_shift(2);if(0===S&&10===L)break;var T=a.l===a.length?0:a.read_shift(2),U=mO[S];if(U&&U.f){if(b.bookSheets&&133===L&&133!==S)break;if(L=S,2===U.r||12==U.r){var V=a.read_shift(2);if(T-=2,!E.enc&&V!==S&&((255&V)<<8|V>>8)!==S)throw Error("rt mismatch: "+V+"!="+S);12==U.r&&(a.l+=10,T-=10)}var W={};if(W=10===S?U.f(a,T,E):function(a,b,c,d,e){var f=d,g=[],h=c.slice(c.l,c.l+f);if(e&&e.enc&&e.enc.insitu&&h.length>0)switch(a){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:e.enc.insitu(h)}g.push(h),c.l+=f;for(var i=io(c,c.l),j=mO[i],k=0;null!=j&&mI.indexOf(i)>-1;)f=io(c,c.l+2),k=c.l+4,2066==i?k+=4:(2165==i||2175==i)&&(k+=12),h=c.slice(k,c.l+4+f),g.push(h),c.l+=4+f,j=mO[i=io(c,c.l)];var l=f9(g);iy(l,0);var m=0;l.lens=[];for(var n=0;n<g.length;++n)l.lens.push(m),m+=g[n].length;if(l.length<d)throw"XLS Record 0x"+a.toString(16)+" Truncated: "+l.length+" < "+d;return b.f(l,l.length,e)}(S,U,a,T,E),0==M&&-1===[9,521,1033,2057].indexOf(L))continue;switch(S){case 34:g.opts.Date1904=z.WBProps.date1904=W;break;case 134:g.opts.WriteProtect=!0;break;case 47:if(E.enc||(a.l=0),E.enc=W,!b.password)throw Error("File is password-protected");if(null==W.valid)throw Error("Encryption scheme unsupported");if(!W.valid)throw Error("Password is incorrect");break;case 92:E.lastuser=W;break;case 66:var X=Number(W);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}fT(E.codepage=X),Q=!0;break;case 317:E.rrtabid=W;break;case 25:E.winlocked=W;break;case 439:g.opts.RefreshAll=W;break;case 12:g.opts.CalcCount=W;break;case 16:g.opts.CalcDelta=W;break;case 17:g.opts.CalcIter=W;break;case 13:g.opts.CalcMode=W;break;case 14:g.opts.CalcPrecision=W;break;case 95:g.opts.CalcSaveRecalc=W;break;case 15:E.CalcRefMode=W;break;case 2211:g.opts.FullCalc=W;break;case 129:W.fDialog&&(n["!type"]="dialog"),W.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),W.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:x.push(W);break;case 430:K.push([W]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(W);break;case 24:case 536:f={Name:W.Name,Ref:lU(W.rgce,p,null,K,E)},W.itab>0&&(f.Sheet=W.itab-1),K.names.push(f),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(W),"_xlnm._FilterDatabase"==W.Name&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&"PtgArea3d"==W.rgce[0][0][0]&&(P[W.itab-1]={ref:iP(W.rgce[0][0][1][2])});break;case 22:E.ExternCount=W;break;case 23:0==K.length&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(W),K.XTI=K.XTI.concat(W);break;case 2196:if(E.biff<8)break;null!=f&&(f.Comment=W[1]);break;case 18:n["!protect"]=W;break;case 19:0!==W&&E.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,E.snames.push(W.name);break;case 10:if(--M)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,n["!ref"]=iP(p),b.sheetRows&&b.sheetRows<=p.e.r){var Y=p.e.r;p.e.r=b.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=iP(p),p.e.r=Y}p.e.r++,p.e.c++}F.length>0&&(n["!merges"]=F),G.length>0&&(n["!objects"]=G),H.length>0&&(n["!cols"]=H),I.length>0&&(n["!rows"]=I),z.Sheets.push(A)}""===s?t=n:h[s]=n,n=b.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===E.biff&&(E.biff=({9:2,521:3,1033:4})[S]||({512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2})[W.BIFFVer]||8),E.biffguess=0==W.BIFFVer,0==W.BIFFVer&&4096==W.dt&&(E.biff=5,Q=!0,fT(E.codepage=28591)),8==E.biff&&0==W.BIFFVer&&16==W.dt&&(E.biff=2),M++)break;if(n=b.dense?[]:{},E.biff<8&&!Q&&(Q=!0,fT(E.codepage=b.codepage||1252)),E.biff<5||0==W.BIFFVer&&4096==W.dt){""===s&&(s="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Z={pos:a.l-T,name:s};o[Z.pos]=Z,E.snames.push(s)}else s=(o[R]||{name:""}).name;32==W.dt&&(n["!type"]="chart"),64==W.dt&&(n["!type"]="macro"),F=[],G=[],E.arrayf=w=[],H=[],I=[],J=!1,A={Hidden:(o[R]||{hs:0}).hs,name:s};break;case 515:case 3:case 2:"chart"==n["!type"]&&(b.dense?(n[W.r]||[])[W.c]:n[iN({c:W.c,r:W.r})])&&++W.c,c={ixfe:W.ixfe,XF:x[W.ixfe]||{},v:W.val,t:"n"},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b);break;case 5:case 517:c={ixfe:W.ixfe,XF:x[W.ixfe],v:W.val,t:W.t},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b);break;case 638:c={ixfe:W.ixfe,XF:x[W.ixfe],v:W.rknum,t:"n"},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b);break;case 189:for(var _=W.c;_<=W.C;++_){var aa=W.rkrec[_-W.c][0];c={ixfe:aa,XF:x[aa],v:W.rkrec[_-W.c][1],t:"n"},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:_,r:W.r},c,b)}break;case 6:case 518:case 1030:if("String"==W.val){q=W;break}if((c=mK(W.val,W.cell.ixfe,W.tt)).XF=x[c.ixfe],b.cellFormula){var ab=W.formula;if(ab&&ab[0]&&ab[0][0]&&"PtgExp"==ab[0][0][0]){var ac=ab[0][0][1][0],ad=ab[0][0][1][1],ae=iN({r:ac,c:ad});v[ae]?c.f=""+lU(W.formula,p,W.cell,K,E):c.F=((b.dense?(n[ac]||[])[ad]:n[ae])||{}).F}else c.f=""+lU(W.formula,p,W.cell,K,E)}N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D(W.cell,c,b),q=W;break;case 7:case 519:if(q)q.val=W,(c=mK(W,q.cell.ixfe,"s")).XF=x[c.ixfe],b.cellFormula&&(c.f=""+lU(q.formula,p,q.cell,K,E)),N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D(q.cell,c,b),q=null;else throw Error("String record expects Formula");break;case 33:case 545:w.push(W);var af=iN(W[0].s);if(j=b.dense?(n[W[0].s.r]||[])[W[0].s.c]:n[af],b.cellFormula&&j){if(!q||!af||!j)break;j.f=""+lU(W[1],p,W[0],K,E),j.F=iP(W[0])}break;case 1212:if(!b.cellFormula)break;if(u){if(!q)break;v[iN(q.cell)]=W[0],((j=b.dense?(n[q.cell.r]||[])[q.cell.c]:n[iN(q.cell)])||{}).f=""+lU(W[0],p,i,K,E)}break;case 253:c=mK(r[W.isst].t,W.ixfe,"s"),r[W.isst].h&&(c.h=r[W.isst].h),c.XF=x[c.ixfe],N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b);break;case 513:b.sheetStubs&&(c={ixfe:W.ixfe,XF:x[W.ixfe],t:"z"},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b));break;case 190:if(b.sheetStubs)for(var ag=W.c;ag<=W.C;++ag){var ah=W.ixfe[ag-W.c];c={ixfe:ah,XF:x[ah],t:"z"},N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:ag,r:W.r},c,b)}break;case 214:case 516:case 4:(c=mK(W.val,W.ixfe,"s")).XF=x[c.ixfe],N>0&&(c.z=O[c.ixfe>>8&63]),mJ(c,b,g.opts.Date1904),D({c:W.c,r:W.r},c,b);break;case 0:case 512:1===M&&(p=W);break;case 252:r=W;break;case 1054:if(4==E.biff){O[N++]=W[1];for(var ai=0;ai<N+163&&gk[ai]!=W[1];++ai);ai>=163&&gL(W[1],N+163)}else gL(W[1],W[0]);break;case 30:O[N++]=W;for(var aj=0;aj<N+163&&gk[aj]!=W;++aj);aj>=163&&gL(W,N+163);break;case 229:F=F.concat(W);break;case 93:G[W.cmo[0]]=E.lastobj=W;break;case 438:E.lastobj.TxO=W;break;case 127:E.lastobj.ImData=W;break;case 440:for(m=W[0].s.r;m<=W[0].e.r;++m)for(l=W[0].s.c;l<=W[0].e.c;++l)(j=b.dense?(n[m]||[])[l]:n[iN({c:l,r:m})])&&(j.l=W[1]);break;case 2048:for(m=W[0].s.r;m<=W[0].e.r;++m)for(l=W[0].s.c;l<=W[0].e.c;++l)(j=b.dense?(n[m]||[])[l]:n[iN({c:l,r:m})])&&j.l&&(j.l.Tooltip=W[1]);break;case 28:if(E.biff<=5&&E.biff>=2)break;j=b.dense?(n[W[0].r]||[])[W[0].c]:n[iN(W[0])];var ak=G[W[2]];j||(b.dense?(n[W[0].r]||(n[W[0].r]=[]),j=n[W[0].r][W[0].c]={t:"z"}):j=n[iN(W[0])]={t:"z"},p.e.r=Math.max(p.e.r,W[0].r),p.s.r=Math.min(p.s.r,W[0].r),p.e.c=Math.max(p.e.c,W[0].c),p.s.c=Math.min(p.s.c,W[0].c)),j.c||(j.c=[]),k={a:W[1],t:ak.TxO.t},j.c.push(k);break;case 2173:x[W.ixfe],W.ext.forEach(function(a){a[0]});break;case 125:if(!E.cellStyles)break;for(;W.e>=W.s;)H[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(1&W.flags)},J||(J=!0,k2(W.w/256)),k3(H[W.e+1]);break;case 520:var al={};null!=W.level&&(I[W.r]=al,al.level=W.level),W.hidden&&(I[W.r]=al,al.hidden=!0),W.hpt&&(I[W.r]=al,al.hpt=W.hpt,al.hpx=k5(W.hpt));break;case 38:case 39:case 40:case 41:n["!margins"]||l5(n["!margins"]={}),n["!margins"][({38:"left",39:"right",40:"top",41:"bottom"})[S]]=W;break;case 161:n["!margins"]||l5(n["!margins"]={}),n["!margins"].header=W.header,n["!margins"].footer=W.footer;break;case 574:W.RTL&&(z.Views[0].RTL=!0);break;case 146:y=W;break;case 2198:e=W;break;case 140:d=W;break;case 442:s?A.CodeName=W||A.name:z.WBProps.CodeName=W||"ThisWorkbook"}}else U||console.error("Missing Info for XLS Record 0x"+S.toString(16)),a.l+=T}return g.SheetNames=gT(o).sort(function(a,b){return Number(a)-Number(b)}).map(function(a){return o[a].name}),b.bookSheets||(g.Sheets=h),!g.SheetNames.length&&t["!ref"]?(g.SheetNames.push("Sheet1"),g.Sheets&&(g.Sheets.Sheet1=t)):g.Preamble=t,g.Sheets&&P.forEach(function(a,b){g.Sheets[g.SheetNames[b]]["!autofilter"]=a}),g.Strings=r,g.SSF=g6(gk),E.enc&&(g.Encryption=E.enc),e&&(g.Themes=e),g.Metadata={},void 0!==d&&(g.Metadata.Country=d),K.names.length>0&&(z.Names=K.names),g.Workbook=z,g}(f.content,b);else if((h=gR.find(a,"PerfectOffice_MAIN"))&&h.content)g=kB.to_workbook(h.content,(b.type=i,b));else if((h=gR.find(a,"NativeContent_MAIN"))&&h.content)g=kB.to_workbook(h.content,(b.type=i,b));else if((h=gR.find(a,"MN0"))&&h.content)throw Error("Unsupported Works 4 for Mac file");else throw Error("Cannot find Workbook stream");b.bookVBA&&a.FullPaths&&gR.find(a,"/_VBA_PROJECT_CUR/VBA/dir")&&(g.vbaraw=(c=a,d=gR.utils.cfb_new({root:"R"}),c.FullPaths.forEach(function(a,b){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var e=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gR.utils.cfb_add(d,e,c.FileIndex[b].content)}}),gR.write(d)))}var j={};return a.FullPaths&&function(a,b,c){var d=gR.find(a,"/!DocumentSummaryInformation");if(d&&d.size>0)try{var e=jS(d,jc,mL.DSI);for(var f in e)b[f]=e[f]}catch(a){if(c.WTF)throw a}var g=gR.find(a,"/!SummaryInformation");if(g&&g.size>0)try{var h=jS(g,jd,mL.SI);for(var i in h)null==b[i]&&(b[i]=h[i])}catch(a){if(c.WTF)throw a}b.HeadingPairs&&b.TitlesOfParts&&(jB(b.HeadingPairs,b.TitlesOfParts,b,c),delete b.HeadingPairs,delete b.TitlesOfParts)}(a,j,b),g.Props=g.Custprops=j,b.bookFiles&&(g.cfb=a),g}var mN={0:{f:function(a,b){var c={},d=a.l+b;c.r=a.read_shift(4),a.l+=4;var e=a.read_shift(2);a.l+=1;var f=a.read_shift(1);return a.l=d,7&f&&(c.level=7&f),16&f&&(c.hidden=!0),32&f&&(c.hpt=e/20),c}},1:{f:function(a){return[iZ(a)]}},2:{f:function(a){return[iZ(a),i3(a),"n"]}},3:{f:function(a){return[iZ(a),a.read_shift(1),"e"]}},4:{f:function(a){return[iZ(a),a.read_shift(1),"b"]}},5:{f:function(a){return[iZ(a),i7(a),"n"]}},6:{f:function(a){return[iZ(a),iW(a),"str"]}},7:{f:function(a){return[iZ(a),a.read_shift(4),"s"]}},8:{f:function(a,b,c){var d=a.l+b,e=iZ(a);e.r=c["!row"];var f=[e,iW(a),"str"];if(c.cellFormula){a.l+=2;var g=lW(a,d-a.l,c);f[3]=lU(g,null,e,c.supbooks,c)}else a.l=d;return f}},9:{f:function(a,b,c){var d=a.l+b,e=iZ(a);e.r=c["!row"];var f=[e,i7(a),"n"];if(c.cellFormula){a.l+=2;var g=lW(a,d-a.l,c);f[3]=lU(g,null,e,c.supbooks,c)}else a.l=d;return f}},10:{f:function(a,b,c){var d=a.l+b,e=iZ(a);e.r=c["!row"];var f=[e,a.read_shift(1),"b"];if(c.cellFormula){a.l+=2;var g=lW(a,d-a.l,c);f[3]=lU(g,null,e,c.supbooks,c)}else a.l=d;return f}},11:{f:function(a,b,c){var d=a.l+b,e=iZ(a);e.r=c["!row"];var f=[e,a.read_shift(1),"e"];if(c.cellFormula){a.l+=2;var g=lW(a,d-a.l,c);f[3]=lU(g,null,e,c.supbooks,c)}else a.l=d;return f}},12:{f:function(a){return[i_(a)]}},13:{f:function(a){return[i_(a),i3(a),"n"]}},14:{f:function(a){return[i_(a),a.read_shift(1),"e"]}},15:{f:function(a){return[i_(a),a.read_shift(1),"b"]}},16:{f:mo},17:{f:function(a){return[i_(a),iW(a),"str"]}},18:{f:function(a){return[i_(a),a.read_shift(4),"s"]}},19:{f:iY},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(a,b,c){var d=a.l+b;a.l+=4,a.l+=1;var e=a.read_shift(4),f=iW(a),g=lW(a,0,c),h=i1(a);a.l=d;var i={Name:f,Ptg:g};return e<0xfffffff&&(i.Sheet=e),h&&(i.Comment=h),i}},40:{},42:{},43:{f:function(a,b,c){var d,e={};e.sz=a.read_shift(2)/20;var f=(d=a.read_shift(1),a.l++,{fBold:1&d,fItalic:2&d,fUnderline:4&d,fStrikeout:8&d,fOutline:16&d,fShadow:32&d,fCondense:64&d,fExtend:128&d});switch(f.fItalic&&(e.italic=1),f.fCondense&&(e.condense=1),f.fExtend&&(e.extend=1),f.fShadow&&(e.shadow=1),f.fOutline&&(e.outline=1),f.fStrikeout&&(e.strike=1),700===a.read_shift(2)&&(e.bold=1),a.read_shift(2)){case 1:e.vertAlign="superscript";break;case 2:e.vertAlign="subscript"}var g=a.read_shift(1);0!=g&&(e.underline=g);var h=a.read_shift(1);h>0&&(e.family=h);var i=a.read_shift(1);switch(i>0&&(e.charset=i),a.l++,e.color=function(a){var b={},c=a.read_shift(1),d=a.read_shift(1),e=a.read_shift(2,"i"),f=a.read_shift(1),g=a.read_shift(1),h=a.read_shift(1);switch(a.l++,c>>>1){case 0:b.auto=1;break;case 1:b.index=d;var i=jg[d];i&&(b.rgb=kX(i));break;case 2:b.rgb=kX([f,g,h]);break;case 3:b.theme=d}return 0!=e&&(b.tint=e>0?e/32767:e/32768),b}(a,8),a.read_shift(1)){case 1:e.scheme="major";break;case 2:e.scheme="minor"}return e.name=iW(a,b-21),e}},44:{f:function(a,b){return[a.read_shift(2),iW(a,b-2)]}},45:{f:iz},46:{f:iz},47:{f:function(a,b){var c=a.l+b,d=a.read_shift(2),e=a.read_shift(2);return a.l=c,{ixfe:d,numFmtId:e}}},48:{},49:{f:function(a){return a.read_shift(4,"i")}},50:{},51:{f:function(a){for(var b=[],c=a.read_shift(4);c-- >0;)b.push([a.read_shift(4),a.read_shift(4)]);return b}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ku},62:{f:function(a){return[iZ(a),iY(a),"is"]}},63:{f:function(a){var b={};b.i=a.read_shift(4);var c={};c.r=a.read_shift(4),c.c=a.read_shift(4),b.r=iN(c);var d=a.read_shift(1);return 2&d&&(b.l="1"),8&d&&(b.a="1"),b}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:iz,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(a){var b=a.read_shift(2);return a.l+=28,{RTL:32&b}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(a,b){var c={},d=a[a.l];return++a.l,c.above=!(64&d),c.left=!(128&d),a.l+=18,c.name=iW(a,b-19),c}},148:{f:i5,p:16},151:{f:function(){}},152:{},153:{f:function(a,b){var c={},d=a.read_shift(4);c.defaultThemeVersion=a.read_shift(4);var e=b>8?iW(a):"";return e.length>0&&(c.CodeName=e),c.autoCompressPictures=!!(65536&d),c.backupFile=!!(64&d),c.checkCompatibility=!!(4096&d),c.date1904=!!(1&d),c.filterPrivacy=!!(8&d),c.hidePivotFieldList=!!(1024&d),c.promptedSolutions=!!(16&d),c.publishItems=!!(2048&d),c.refreshAllConnections=!!(262144&d),c.saveExternalLinkValues=!!(128&d),c.showBorderUnselectedTables=!!(4&d),c.showInkAnnotation=!!(32&d),c.showObjects=["all","placeholders","none"][d>>13&3],c.showPivotChartFilter=!!(32768&d),c.updateLinks=["userSet","never","always"][d>>8&3],c}},154:{},155:{},156:{f:function(a,b){var c={};return c.Hidden=a.read_shift(4),c.iTabID=a.read_shift(4),c.strRelID=i1(a,b-8),c.name=iW(a),c}},157:{},158:{},159:{T:1,f:function(a){return[a.read_shift(4),a.read_shift(4)]}},160:{T:-1},161:{T:1,f:i5},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:i5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(a,b){return{flags:a.read_shift(4),version:a.read_shift(4),name:iW(a,b-8)}}},336:{T:-1},337:{f:function(a){return a.l+=4,0!=a.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:i1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kr},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(a,b,c){var d=a.l+b,e=i5(a,16),f=a.read_shift(1),g=[e];if(g[2]=f,c.cellFormula){var h=lW(a,d-a.l,c);g[1]=h}else a.l=d;return g}},427:{f:function(a,b,c){var d=a.l+b,e=[i5(a,16)];if(c.cellFormula){var f=lW(a,d-a.l,c);e[1]=f,a.l=d}else a.l=d;return e}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(a){var b={};return mp.forEach(function(c){b[c]=i7(a,8)}),b}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(a,b){var c=a.l+b,d=i5(a,16),e=i1(a),f=iW(a),g=iW(a),h=iW(a);a.l=c;var i={rfx:d,relId:e,loc:f,display:h};return g&&(i.Tooltip=g),i}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:i1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iW},633:{T:1},634:{T:-1},635:{T:1,f:function(a){var b={};b.iauthor=a.read_shift(4);var c=i5(a,16);return b.rfx=c.s,b.ref=iN(c.s),a.l+=16,b}},636:{T:-1},637:{f:iY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(a,b){return a.l+=10,{name:iW(a,b-10)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},mO={6:{f:lV},10:{f:jU},12:{f:jX},13:{f:jX},14:{f:jV},15:{f:jV},16:{f:i7},17:{f:jV},18:{f:jV},19:{f:jX},20:{f:kn},21:{f:kn},23:{f:kr},24:{f:kq},25:{f:jV},26:{},27:{},28:{f:function(a,b,c){return function(a,b,c){if(!(c.biff<8)){var d=a.read_shift(2),e=a.read_shift(2),f=a.read_shift(2),g=a.read_shift(2),h=j2(a,0,c);return c.biff<8&&a.read_shift(1),[{r:d,c:e},h,g,f]}}(a,0,c)}},29:{},34:{f:jV},35:{f:ko},38:{f:i7},39:{f:i7},40:{f:i7},41:{f:i7},42:{f:jV},43:{f:jV},47:{f:function(a,b,c){var d,e,f,g={Type:c.biff>=8?a.read_shift(2):0};return g.Type?(d=b-2,(e=g||{}).Info=a.read_shift(2),a.l-=2,1===e.Info?e.Data=function(a){var b={},c=b.EncryptionVersionInfo=kP(a,4);if(1!=c.Major||1!=c.Minor)throw"unrecognized version code "+c.Major+" : "+c.Minor;return b.Salt=a.read_shift(16),b.EncryptedVerifier=a.read_shift(16),b.EncryptedVerifierHash=a.read_shift(16),b}(a,d):e.Data=function(a,b){var c={},d=c.EncryptionVersionInfo=kP(a,4);if(b-=4,2!=d.Minor)throw Error("unrecognized minor version code: "+d.Minor);if(d.Major>4||d.Major<2)throw Error("unrecognized major version code: "+d.Major);c.Flags=a.read_shift(4),b-=4;var e=a.read_shift(4);return b-=4,c.EncryptionHeader=kQ(a,e),c.EncryptionVerifier=kR(a,b-=e),c}(a,d)):(c.biff,f={key:jX(a),verificationBytes:jX(a)},c.password&&(f.verifier=kS(c.password)),g.valid=f.verificationBytes===f.verifier,g.valid&&(g.insitu=kV(c.password))),g}},49:{f:function(a,b,c){var d={dyHeight:a.read_shift(2),fl:a.read_shift(2)};switch(c&&c.biff||8){case 2:break;case 3:case 4:a.l+=2;break;default:a.l+=10}return d.name=j_(a,0,c),d}},51:{f:jX},60:{},61:{f:function(a){return{Pos:[a.read_shift(2),a.read_shift(2)],Dim:[a.read_shift(2),a.read_shift(2)],Flags:a.read_shift(2),CurTab:a.read_shift(2),FirstTab:a.read_shift(2),Selected:a.read_shift(2),TabRatio:a.read_shift(2)}}},64:{f:jV},65:{f:function(){}},66:{f:jX},77:{},80:{},81:{},82:{},85:{f:jX},89:{},90:{},91:{},92:{f:function(a,b,c){if(c.enc)return a.l+=b,"";var d=a.l,e=j2(a,0,c);return a.read_shift(b+d-a.l),e}},93:{f:function(a,b,c){if(c&&c.biff<8){var d,e,f,g,h,i,j;return d=a,e=b,f=c,d.l+=4,g=d.read_shift(2),h=d.read_shift(2),i=d.read_shift(2),d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=2,d.l+=6,e-=36,(j=[]).push((kt[g]||iz)(d,e,f)),{cmo:[h,g,i],ft:j}}var k=ke(a,22),l=function(a,b){for(var c=a.l+b,d=[];a.l<c;){var e=a.read_shift(2);a.l-=2;try{d.push(kg[e](a,c-a.l))}catch(b){return a.l=c,d}}return a.l!=c&&(a.l=c),d}(a,b-22,k[1]);return{cmo:k,ft:l}}},94:{},95:{f:jV},96:{},97:{},99:{f:jV},125:{f:ku},128:{f:function(a){a.l+=4;var b=[a.read_shift(2),a.read_shift(2)];if(0!==b[0]&&b[0]--,0!==b[1]&&b[1]--,b[0]>7||b[1]>7)throw Error("Bad Gutters: "+b.join("|"));return b}},129:{f:function(a,b,c){var d=c&&8==c.biff||2==b?a.read_shift(2):(a.l+=b,0);return{fDialog:16&d,fBelow:64&d,fRight:128&d}}},130:{f:jX},131:{f:jV},132:{f:jV},133:{f:function(a,b,c){var d=a.read_shift(4),e=3&a.read_shift(1),f=a.read_shift(1);switch(f){case 0:f="Worksheet";break;case 1:f="Macrosheet";break;case 2:f="Chartsheet";break;case 6:f="VBAModule"}var g=j_(a,0,c);return 0===g.length&&(g="Sheet1"),{pos:d,hs:e,dt:f,name:g}}},134:{},140:{f:function(a){var b,c=[0,0];return b=a.read_shift(2),c[0]=je[b]||b,b=a.read_shift(2),c[1]=je[b]||b,c}},141:{f:jX},144:{},146:{f:function(a){for(var b=a.read_shift(2),c=[];b-- >0;)c.push(j7(a,8));return c}},151:{},152:{},153:{},154:{},155:{},156:{f:jX},157:{},158:{},160:{f:jZ},161:{f:function(a,b){var c={};return b<32||(a.l+=16,c.header=i7(a,8),c.footer=i7(a,8),a.l+=2),c}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(a,b){for(var c=a.l+b-2,d=a.read_shift(2),e=a.read_shift(2),f=[];a.l<c;)f.push(ka(a));if(a.l!==c)throw Error("MulRK read error");var g=a.read_shift(2);if(f.length!=g-e+1)throw Error("MulRK length mismatch");return{r:d,c:e,C:g,rkrec:f}}},190:{f:function(a,b){for(var c=a.l+b-2,d=a.read_shift(2),e=a.read_shift(2),f=[];a.l<c;)f.push(a.read_shift(2));if(a.l!==c)throw Error("MulBlank read error");var g=a.read_shift(2);if(f.length!=g-e+1)throw Error("MulBlank length mismatch");return{r:d,c:e,C:g,ixfe:f}}},193:{f:jU},197:{},198:{},199:{},200:{},201:{},202:{f:jV},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jX},220:{},221:{f:jV},222:{},224:{f:function(a,b,c){var d,e,f,g,h,i={};return i.ifnt=a.read_shift(2),i.numFmtId=a.read_shift(2),i.flags=a.read_shift(2),i.fStyle=i.flags>>2&1,b-=6,i.fStyle,d={},e=a.read_shift(4),f=a.read_shift(4),g=a.read_shift(4),h=a.read_shift(2),d.patternType=jf[g>>26],c.cellStyles&&(d.alc=7&e,d.fWrap=e>>3&1,d.alcV=e>>4&7,d.fJustLast=e>>7&1,d.trot=e>>8&255,d.cIndent=e>>16&15,d.fShrinkToFit=e>>20&1,d.iReadOrder=e>>22&2,d.fAtrNum=e>>26&1,d.fAtrFnt=e>>27&1,d.fAtrAlc=e>>28&1,d.fAtrBdr=e>>29&1,d.fAtrPat=e>>30&1,d.fAtrProt=e>>31&1,d.dgLeft=15&f,d.dgRight=f>>4&15,d.dgTop=f>>8&15,d.dgBottom=f>>12&15,d.icvLeft=f>>16&127,d.icvRight=f>>23&127,d.grbitDiag=f>>30&3,d.icvTop=127&g,d.icvBottom=g>>7&127,d.icvDiag=g>>14&127,d.dgDiag=g>>21&15,d.icvFore=127&h,d.icvBack=h>>7&127,d.fsxButton=h>>14&1),i.data=d,i}},225:{f:function(a,b){return 0===b||a.read_shift(2),1200}},226:{f:jU},227:{},229:{f:function(a,b){for(var c=[],d=a.read_shift(2);d--;)c.push(kb(a,b));return c}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(a,b){for(var c=a.l+b,d=a.read_shift(4),e=a.read_shift(4),f=[],g=0;g!=e&&a.l<c;++g)f.push(function(a){var b=fO;fO=1200;var c,d=a.read_shift(2),e=a.read_shift(1),f=4&e,g=8&e,h=0,i={};g&&(h=a.read_shift(2)),f&&(c=a.read_shift(4));var j=0===d?"":a.read_shift(d,2==1+(1&e)?"dbcs-cont":"sbcs-cont");return g&&(a.l+=4*h),f&&(a.l+=c),i.t=j,g||(i.raw="<t>"+i.t+"</t>",i.r=i.t),fO=b,i}(a));return f.Count=d,f.Unique=e,f}},253:{f:function(a){var b=j8(a);return b.isst=a.read_shift(4),b}},255:{f:function(a,b){var c={};return c.dsst=a.read_shift(2),a.l+=b-2,c}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jZ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jV},353:{f:jU},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(a,b,c){var d=a.l+b,e=a.read_shift(2),f=a.read_shift(2);if(c.sbcch=f,1025==f||14849==f)return[f,e];if(f<1||f>255)throw Error("Unexpected SupBook type: "+f);for(var g=j0(a,f),h=[];d>a.l;)h.push(j1(a));return[f,e,g,h]}},431:{f:jV},432:{},433:{},434:{},437:{},438:{f:function(a,b,c){var d=a.l,e="";try{a.l+=4;var f=(c.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(f)?a.l+=6:(a.read_shift(1),a.l++,a.read_shift(2),a.l+=2);var g=a.read_shift(2);a.read_shift(2),jX(a,2);var h=a.read_shift(2);a.l+=h;for(var i=1;i<a.lens.length-1;++i){if(a.l-d!=a.lens[i])throw Error("TxO: bad continue record");var j=a[a.l],k=j0(a,a.lens[i+1]-a.lens[i]-1);if((e+=k).length>=(j?g:2*g))break}if(e.length!==g&&e.length!==2*g)throw Error("cchText: "+g+" != "+e.length);return a.l=d+b,{t:e}}catch(c){return a.l=d+b,{t:e}}}},439:{f:jV},440:{f:function(a,b){var c=kb(a,8);return a.l+=16,[c,function(a,b){var c=a.l+b,d=a.read_shift(4);if(2!==d)throw Error("Unrecognized streamVersion: "+d);var e=a.read_shift(2);a.l+=2;var f,g,h,i,j,k,l="";16&e&&(f=j4(a,c-a.l)),128&e&&(g=j4(a,c-a.l)),(257&e)==257&&(h=j4(a,c-a.l)),(257&e)==1&&(i=function(a,b){var c,d,e,f,g=a.read_shift(16);switch(b-=16,g){case"e0c9ea79f9bace118c8200aa004ba90b":return c=a.read_shift(4),d=a.l,e=!1,c>24&&(a.l+=c-24,"795881f43b1d7f48af2c825dc4852763"===a.read_shift(16)&&(e=!0),a.l=d),f=a.read_shift((e?c-24:c)>>1,"utf16le").replace(ga,""),e&&(a.l+=24),f;case"0303000000000000c000000000000046":for(var h=a.read_shift(2),i="";h-- >0;)i+="../";var j=a.read_shift(0,"lpstr-ansi");if(a.l+=2,57005!=a.read_shift(2))throw Error("Bad FileMoniker");if(0===a.read_shift(4))return i+j.replace(/\\/g,"/");var k=a.read_shift(4);if(3!=a.read_shift(2))throw Error("Bad FileMoniker");return i+a.read_shift(k>>1,"utf16le").replace(ga,"");default:throw Error("Unsupported Moniker "+g)}}(a,c-a.l)),8&e&&(l=j4(a,c-a.l)),32&e&&(j=a.read_shift(16)),64&e&&(k=jG(a)),a.l=c;var m=g||h||i||"";m&&l&&(m+="#"+l),m||(m="#"+l),2&e&&"/"==m.charAt(0)&&"/"!=m.charAt(1)&&(m="file://"+m);var n={Target:m};return j&&(n.guid=j),k&&(n.time=k),f&&(n.Tooltip=f),n}(a,b-24)]}},441:{},442:{f:j1},443:{},444:{f:jX},445:{},446:{},448:{f:jU},449:{f:function(a){return a.read_shift(2),a.read_shift(4)},r:2},450:{f:jU},512:{f:kk},513:{f:j8},515:{f:function(a,b,c){c.biffguess&&2==c.biff&&(c.biff=5);var d=j8(a,6);return d.val=i7(a,8),d}},516:{f:function(a,b,c){c.biffguess&&2==c.biff&&(c.biff=5);var d=a.l+b,e=j8(a,6);return 2==c.biff&&a.l++,e.val=j1(a,d-a.l,c),e}},517:{f:km},519:{f:j1},520:{f:function(a){var b={};b.r=a.read_shift(2),b.c=a.read_shift(2),b.cnt=a.read_shift(2)-b.c;var c=a.read_shift(2);a.l+=4;var d=a.read_shift(1);return a.l+=3,7&d&&(b.level=7&d),32&d&&(b.hidden=!0),64&d&&(b.hpt=c/20),b}},523:{},545:{f:ks},549:{f:kj},566:{},574:{f:function(a,b,c){return c&&c.biff>=2&&c.biff<5?{}:{RTL:64&a.read_shift(2)}}},638:{f:function(a){var b=a.read_shift(2),c=a.read_shift(2),d=ka(a);return{r:b,c:c,ixfe:d[0],rknum:d[1]}}},659:{},1048:{},1054:{f:function(a,b,c){return[a.read_shift(2),j2(a,0,c)]}},1084:{},1212:{f:function(a,b,c){var d=kd(a,6);a.l++;var e=a.read_shift(1);return[function(a,b,c){var d,e,f=a.l+b,g=a.read_shift(2),h=lQ(a,g,c);return 65535==g?[[],(d=b-2,void(a.l+=d))]:(b!==g+2&&(e=lP(a,f-g-2,h,c)),[h,e])}(a,b-=8,c),e,d]}},2048:{f:function(a,b){a.read_shift(2);var c=kb(a,8),d=a.read_shift((b-10)/2,"dbcs-cont");return[c,d=d.replace(ga,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:jU},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(a){a.l+=2;var b={cxfs:0,crc:0};return b.cxfs=a.read_shift(2),b.crc=a.read_shift(4),b},r:12},2173:{f:function(a,b){var c=a.l+b;a.l+=2;var d=a.read_shift(2);a.l+=2;for(var e=a.read_shift(2),f=[];e-- >0;)f.push(function(a){var b=a.read_shift(2),c=a.read_shift(2)-4,d=[b];switch(b){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:d[1]=function(a){var b={};switch(b.xclrType=a.read_shift(2),b.nTintShade=a.read_shift(2),b.xclrType){case 0:case 4:a.l+=4;break;case 1:b.xclrValue=function(a,b){a.l+=b}(a,4);break;case 2:b.xclrValue=j6(a,4);break;case 3:b.xclrValue=a.read_shift(4)}return a.l+=8,b}(a,c);break;case 6:d[1]=void(a.l+=c);break;case 14:case 15:d[1]=a.read_shift(1===c?1:2);break;default:throw Error("Unrecognized ExtProp type: "+b+" "+c)}return d}(a,c-a.l));return{ixfe:d,ext:f}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jV,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(a,b,c){if(c.biff<8){a.l+=b;return}var d=a.read_shift(2),e=a.read_shift(2);return[j0(a,d,c),j0(a,e,c)]},r:12},2197:{},2198:{f:function(a,b,c){var d,e=a.l+b;if(124226!==a.read_shift(4)){if(!c.cellStyles){a.l=e;return}var f=a.slice(a.l);a.l=e;try{d=hl(f,{type:"array"})}catch(a){return}var g=hh(d,"theme/theme/theme1.xml",!0);if(g)return ln(g,c)}},r:12},2199:{},2200:{},2201:{},2202:{f:function(a){return[0!==a.read_shift(4),0!==a.read_shift(4),a.read_shift(4)]},r:12},2203:{f:jU},2204:{},2205:{},2206:{},2207:{},2211:{f:function(a){var b,c,d=(b=a.read_shift(2),c=a.read_shift(2),a.l+=8,{type:b,flags:c});if(2211!=d.type)throw Error("Invalid Future Record "+d.type);return 0!==a.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jX},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(a,b,c){var d={area:!1};if(5!=c.biff)return a.l+=b,d;var e=a.read_shift(1);return a.l+=3,16&e&&(d.area=!0),d}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(a){for(var b=a.read_shift(2),c=[];b-- >0;)c.push(j7(a,8));return c}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:kk},1:{},2:{f:function(a){var b=j8(a,6);++a.l;var c=a.read_shift(2);return b.t="n",b.val=c,b}},3:{f:function(a){var b=j8(a,6);++a.l;var c=i7(a,8);return b.t="n",b.val=c,b}},4:{f:function(a,b,c){c.biffguess&&5==c.biff&&(c.biff=2);var d=j8(a,6);++a.l;var e=j2(a,b-7,c);return d.t="str",d.val=e,d}},5:{f:km},7:{f:function(a){var b=a.read_shift(1);return 0===b?(a.l++,""):a.read_shift(b,"sbcs-cont")}},8:{},9:{f:kh},11:{},22:{f:jX},30:{f:j2},31:{},32:{},33:{f:ks},36:{},37:{f:kj},50:{f:function(a,b){a.l+=6,a.l+=2,a.l+=1,a.l+=3,a.l+=1,a.l+=b-13}},62:{},52:{},67:{},68:{f:jX},69:{},86:{},126:{},127:{f:function(a){var b=a.read_shift(2),c=a.read_shift(2),d=a.read_shift(4),e={fmt:b,env:c,len:d,data:a.slice(a.l,a.l+d)};return a.l+=d,e}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(a,b,c){var d=a.l+b,e=j8(a,6),f=a.read_shift(2),g=j0(a,f,c);return a.l=d,e.t="str",e.val=g,e}},223:{},234:{},354:{},421:{},518:{f:lV},521:{f:kh},536:{f:kq},547:{f:ko},561:{},579:{},1030:{f:lV},1033:{f:kh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function mP(a,b,c,d){if(!isNaN(b)){var e=d||(c||[]).length||0,f=a.next(4);f.write_shift(2,b),f.write_shift(2,e),e>0&&il(c)&&a.push(c)}}function mQ(a,b,c){return a||(a=iA(7)),a.write_shift(2,b),a.write_shift(2,c),a.write_shift(2,0),a.write_shift(1,0),a}function mR(a,b){for(var c=0;c<=a.SheetNames.length;++c){var d=a.Sheets[a.SheetNames[c]];d&&d["!ref"]&&iO(d["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+a.SheetNames[c]+"' extends beyond column IV (255).  Data may be lost.")}var e=b||{};switch(e.biff||2){case 8:case 5:var f=b||{},g=[];a&&!a.SSF&&(a.SSF=g6(gk)),a&&a.SSF&&(gN(),gM(a.SSF),f.revssf=gW(a.SSF),f.revssf[a.SSF[65535]]=0,f.ssf=a.SSF),f.Strings=[],f.Strings.Count=0,f.Strings.Unique=0,nh(f),f.cellXfs=[],l6(f.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={});for(var h=0;h<a.SheetNames.length;++h)g[g.length]=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=iC(),n=c.SheetNames[a],o=c.Sheets[n]||{},p=(c||{}).Workbook||{},q=(p.Sheets||[])[a]||{},r=Array.isArray(o),s=8==b.biff,t="",u=[],v=iQ(o["!ref"]||"A1"),w=s?65536:16384;if(v.e.c>255||v.e.r>=w){if(b.WTF)throw Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,w-1)}mP(m,2057,ki(c,16,b)),mP(m,13,jY(1)),mP(m,12,jY(100)),mP(m,15,jW(!0)),mP(m,17,jW(!1)),mP(m,16,i8(.001)),mP(m,95,jW(!0)),mP(m,42,jW(!1)),mP(m,43,jW(!1)),mP(m,130,jY(1)),mP(m,128,(d=[0,0],(e=iA(8)).write_shift(4,0),e.write_shift(2,d[0]?d[0]+1:0),e.write_shift(2,d[1]?d[1]+1:0),e)),mP(m,131,jW(!1)),mP(m,132,jW(!1)),s&&function(a,b){if(b){var c=0;b.forEach(function(b,d){var e,f,g;++c<=256&&b&&mP(a,125,(e=l4(d,b),(f=iA(12)).write_shift(2,d),f.write_shift(2,d),f.write_shift(2,256*e.width),f.write_shift(2,0),g=0,e.hidden&&(g|=1),f.write_shift(1,g),g=e.level||0,f.write_shift(1,g),f.write_shift(2,0),f))})}}(m,o["!cols"]),mP(m,512,((g=iA(2*(f=8!=b.biff&&b.biff?2:4)+6)).write_shift(f,v.s.r),g.write_shift(f,v.e.r+1),g.write_shift(2,v.s.c),g.write_shift(2,v.e.c+1),g.write_shift(2,0),g)),s&&(o["!links"]=[]);for(var x=v.s.r;x<=v.e.r;++x){t=iJ(x);for(var y=v.s.c;y<=v.e.c;++y){x===v.s.r&&(u[y]=iL(y)),l=u[y]+t;var z=r?(o[x]||[])[y]:o[l];z&&(!function(a,b,c,d,e){var f=16+l6(e.cellXfs,b,e);if(null==b.v&&!b.bf)return mP(a,513,j9(c,d,f));if(b.bf)mP(a,6,function(a,b,c,d,e){var f=j9(b,c,e),g=function(a){if(null==a){var b=iA(8);return b.write_shift(1,3),b.write_shift(1,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,65535),b}return"number"==typeof a?i8(a):i8(0)}(a.v),h=iA(6);h.write_shift(2,33),h.write_shift(4,0);for(var i=iA(a.bf.length),j=0;j<a.bf.length;++j)i[j]=a.bf[j];return f9([f,g,h,i])}(b,c,d,0,f));else switch(b.t){case"d":case"n":var g,h="d"==b.t?gY(g4(b.v)):b.v;mP(a,515,(j9(c,d,f,g=iA(14)),i8(h,g),g));break;case"b":case"e":mP(a,517,(i=b.v,j=b.t,j9(c,d,f,k=iA(8)),j$(i,j,k),k));break;case"s":case"str":if(e.bookSST){var i,j,k,l,m,n,o,p=l3(e.Strings,b.v,e.revStrings);mP(a,253,(j9(c,d,f,o=iA(10)),o.write_shift(4,p),o))}else mP(a,516,(l=(b.v||"").slice(0,255),j9(c,d,f,n=iA(8+ +(m=!e||8==e.biff)+(1+m)*l.length)),n.write_shift(2,l.length),m&&n.write_shift(1,1),n.write_shift((1+m)*l.length,l,m?"utf16le":"sbcs"),n));break;default:mP(a,513,j9(c,d,f))}}(m,z,x,y,b),s&&z.l&&o["!links"].push([l,z.l]))}}var A=q.CodeName||q.name||n;return s&&mP(m,574,(h=(p.Views||[])[0],i=iA(18),j=1718,h&&h.RTL&&(j|=64),i.write_shift(2,j),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i)),s&&(o["!merges"]||[]).length&&mP(m,229,function(a){var b=iA(2+8*a.length);b.write_shift(2,a.length);for(var c=0;c<a.length;++c)kc(a[c],b);return b}(o["!merges"])),s&&function(a,b){for(var c=0;c<b["!links"].length;++c){var d=b["!links"][c];mP(a,440,function(a){var b=iA(24),c=iM(a[0]);b.write_shift(2,c.r),b.write_shift(2,c.r),b.write_shift(2,c.c),b.write_shift(2,c.c);for(var d="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<16;++e)b.write_shift(1,parseInt(d[e],16));return f9([b,function(a){var b=iA(512),c=0,d=a.Target;"file://"==d.slice(0,7)&&(d=d.slice(7));var e=d.indexOf("#"),f=e>-1?31:23;switch(d.charAt(0)){case"#":f=28;break;case".":f&=-3}b.write_shift(4,2),b.write_shift(4,f);var g=[8,6815827,6619237,4849780,83];for(c=0;c<g.length;++c)b.write_shift(4,g[c]);if(28==f)j5(d=d.slice(1),b);else if(2&f){for(c=0,g="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");c<g.length;++c)b.write_shift(1,parseInt(g[c],16));var h=e>-1?d.slice(0,e):d;for(b.write_shift(4,2*(h.length+1)),c=0;c<h.length;++c)b.write_shift(2,h.charCodeAt(c));b.write_shift(2,0),8&f&&j5(e>-1?d.slice(e+1):"",b)}else{for(c=0,g="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" ");c<g.length;++c)b.write_shift(1,parseInt(g[c],16));for(var i=0;"../"==d.slice(3*i,3*i+3)||"..\\"==d.slice(3*i,3*i+3);)++i;for(b.write_shift(2,i),b.write_shift(4,d.length-3*i+1),c=0;c<d.length-3*i;++c)b.write_shift(1,255&d.charCodeAt(c+3*i));for(b.write_shift(1,0),b.write_shift(2,65535),b.write_shift(2,57005),c=0;c<6;++c)b.write_shift(4,0)}return b.slice(0,b.l)}(a[1])])}(d)),d[1].Tooltip&&mP(a,2048,function(a){var b=a[1].Tooltip,c=iA(10+2*(b.length+1));c.write_shift(2,2048);var d=iM(a[0]);c.write_shift(2,d.r),c.write_shift(2,d.r),c.write_shift(2,d.c),c.write_shift(2,d.c);for(var e=0;e<b.length;++e)c.write_shift(2,b.charCodeAt(e));return c.write_shift(2,0),c}(d))}delete b["!links"]}(m,o),mP(m,442,j3(A,b)),s&&((k=iA(19)).write_shift(4,2151),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(2,3),k.write_shift(1,1),k.write_shift(4,0),mP(m,2151,k),(k=iA(39)).write_shift(4,2152),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(2,3),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(2,1),k.write_shift(4,4),k.write_shift(2,0),kc(iQ(o["!ref"]||"A1"),k),k.write_shift(4,4),mP(m,2152,k)),mP(m,10),m.end()}(h,f,a);return g.unshift(function(a,b,c){var d,e,f,g,h,i,j,k=iC(),l=(a||{}).Workbook||{},m=l.Sheets||[],n=l.WBProps||{},o=8==c.biff,p=5==c.biff;mP(k,2057,ki(a,5,c)),"xla"==c.bookType&&mP(k,135),mP(k,225,o?jY(1200):null),mP(k,193,function(a,b){b||(b=iA(2));for(var c=0;c<2;++c)b.write_shift(1,0);return b}(2)),p&&mP(k,191),p&&mP(k,192),mP(k,226),mP(k,92,function(a,b){var c=!b||8==b.biff,d=iA(c?112:54);for(d.write_shift(8==b.biff?2:1,7),c&&d.write_shift(1,0),d.write_shift(4,0x33336853),d.write_shift(4,5458548|0x20000000*!c);d.l<d.length;)d.write_shift(1,32*!c);return d}(0,c)),mP(k,66,jY(o?1200:1252)),o&&mP(k,353,jY(0)),o&&mP(k,448),mP(k,317,function(a){for(var b=iA(2*a),c=0;c<a;++c)b.write_shift(2,c+1);return b}(a.SheetNames.length)),o&&a.vbaraw&&mP(k,211),o&&a.vbaraw&&mP(k,442,j3(n.CodeName||"ThisWorkbook",c)),mP(k,156,jY(17)),mP(k,25,jW(!1)),mP(k,18,jW(!1)),mP(k,19,jY(0)),o&&mP(k,431,jW(!1)),o&&mP(k,444,jY(0)),mP(k,61,((d=iA(18)).write_shift(2,0),d.write_shift(2,0),d.write_shift(2,29280),d.write_shift(2,17600),d.write_shift(2,56),d.write_shift(2,0),d.write_shift(2,0),d.write_shift(2,1),d.write_shift(2,500),d)),mP(k,64,jW(!1)),mP(k,141,jY(0)),mP(k,34,jW("true"==(a.Workbook&&a.Workbook.WBProps&&hF(a.Workbook.WBProps.date1904)?"true":"false"))),mP(k,14,jW(!0)),o&&mP(k,439,jW(!1)),mP(k,218,jY(0)),mP(k,49,(f=(e={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(h=iA((g=c&&5==c.biff)?15+f.length:16+2*f.length)).write_shift(2,20*(e.sz||12)),h.write_shift(4,0),h.write_shift(2,400),h.write_shift(4,0),h.write_shift(2,0),h.write_shift(1,f.length),g||h.write_shift(1,1),h.write_shift((g?1:2)*f.length,f,g?"sbcs":"utf16le"),h)),i=a.SSF,i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var b=a[0];b<=a[1];++b)null!=i[b]&&mP(k,1054,function(a,b,c,d){var e=c&&5==c.biff;d||(d=iA(e?3+b.length:5+2*b.length)),d.write_shift(2,a),d.write_shift(e?1:2,b.length),e||d.write_shift(1,1),d.write_shift((e?1:2)*b.length,b,e?"sbcs":"utf16le");var f=d.length>d.l?d.slice(0,d.l):d;return null==f.l&&(f.l=f.length),f}(b,i[b],c))});for(var q=0;q<16;++q)mP(k,224,kl({numFmtId:0,style:!0},0,c));c.cellXfs.forEach(function(a){mP(k,224,kl(a,0,c))}),o&&mP(k,352,jW(!1));var r=k.end(),s=iC();o&&mP(s,140,(j||(j=iA(4)),j.write_shift(2,1),j.write_shift(2,1),j)),o&&c.Strings&&function(a,b,c,d){var e=(c||[]).length||0;if(e<=8224)return mP(a,252,c,e);if(!isNaN(252)){for(var f=c.parts||[],g=0,h=0,i=0;i+(f[g]||8224)<=8224;)i+=f[g]||8224,g++;var j=a.next(4);for(j.write_shift(2,b),j.write_shift(2,i),a.push(c.slice(h,h+i)),h+=i;h<e;){for((j=a.next(4)).write_shift(2,60),i=0;i+(f[g]||8224)<=8224;)i+=f[g]||8224,g++;j.write_shift(2,i),a.push(c.slice(h,h+i)),h+=i}}}(s,252,function(a,b){var c=iA(8);c.write_shift(4,a.Count),c.write_shift(4,a.Unique);for(var d=[],e=0;e<a.length;++e)d[e]=function(a){var b=a.t||"",c=iA(3);c.write_shift(2,b.length),c.write_shift(1,1);var d=iA(2*b.length);return d.write_shift(2*b.length,b,"utf16le"),f9([c,d])}(a[e],b);var f=f9([c].concat(d));return f.parts=[c.length].concat(d.map(function(a){return a.length})),f}(c.Strings,c)),mP(s,10);var t=s.end(),u=iC(),v=0,w=0;for(w=0;w<a.SheetNames.length;++w)v+=(o?12:11)+(o?2:1)*a.SheetNames[w].length;var x=r.length+v+t.length;for(w=0;w<a.SheetNames.length;++w)mP(u,133,function(a,b){var c=!b||b.biff>=8?2:1,d=iA(8+c*a.name.length);d.write_shift(4,a.pos),d.write_shift(1,a.hs||0),d.write_shift(1,a.dt),d.write_shift(1,a.name.length),b.biff>=8&&d.write_shift(1,1),d.write_shift(c*a.name.length,a.name,b.biff<8?"sbcs":"utf16le");var e=d.slice(0,d.l);return e.l=d.l,e}({pos:x,hs:(m[w]||{}).Hidden||0,dt:0,name:a.SheetNames[w]},c)),x+=b[w].length;var y=u.end();if(v!=y.length)throw Error("BS8 "+v+" != "+y.length);var z=[];return r.length&&z.push(r),y.length&&z.push(y),t.length&&z.push(t),f9(z)}(a,g,f)),f9(g);case 4:case 3:case 2:for(var i=b||{},j=iC(),k=0,l=0;l<a.SheetNames.length;++l)a.SheetNames[l]==i.sheet&&(k=l);if(0==k&&i.sheet&&a.SheetNames[0]!=i.sheet)throw Error("Sheet not found: "+i.sheet);return mP(j,4==i.biff?1033:3==i.biff?521:9,ki(a,16,i)),!function(a,b,c,d){var e,f=Array.isArray(b),g=iQ(b["!ref"]||"A1"),h="",i=[];if(g.e.c>255||g.e.r>16383){if(d.WTF)throw Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,16383),e=iP(g)}for(var j=g.s.r;j<=g.e.r;++j){h=iJ(j);for(var k=g.s.c;k<=g.e.c;++k){j===g.s.r&&(i[k]=iL(k)),e=i[k]+h;var l=f?(b[j]||[])[k]:b[e];l&&function(a,b,c,d){if(null!=b.v)switch(b.t){case"d":case"n":var e,f,g,h,i,j,k,l="d"==b.t?gY(g4(b.v)):b.v;l==(0|l)&&l>=0&&l<65536?mP(a,2,(mQ(j=iA(9),c,d),j.write_shift(2,l),j)):mP(a,3,(mQ(k=iA(15),c,d),k.write_shift(8,l,"f"),k));return;case"b":case"e":mP(a,5,(e=b.v,f=b.t,mQ(g=iA(9),c,d),j$(e,f||"b",g),g));return;case"s":case"str":mP(a,4,(mQ(i=iA(8+2*(h=(b.v||"").slice(0,255)).length),c,d),i.write_shift(1,h.length),i.write_shift(h.length,h,"sbcs"),i.l<i.length?i.slice(0,i.l):i));return}mP(a,1,mQ(null,c,d))}(a,l,j,k,d)}}}(j,a.Sheets[a.SheetNames[k]],0,i,a),mP(j,10),j.end()}throw Error("invalid type "+e.bookType+" for BIFF")}function mS(a,b){var c=b||{},d=c.dense?[]:{},e=(a=a.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!e)throw Error("Invalid HTML: could not find <table>");var f=a.match(/<\/table/i),g=e.index,h=f&&f.index||a.length,i=hb(a.slice(g,h),/(:?<tr[^>]*>)/i,"<tr>"),j=-1,k=0,l=0,m=0,n={s:{r:1e7,c:1e7},e:{r:0,c:0}},o=[];for(g=0;g<i.length;++g){var p=i[g].trim(),q=p.slice(0,3).toLowerCase();if("<tr"==q){if(++j,c.sheetRows&&c.sheetRows<=j){--j;break}k=0;continue}if("<td"==q||"<th"==q){var r=p.split(/<\/t[dh]>/i);for(h=0;h<r.length;++h){var s=r[h].trim();if(s.match(/<t[dh]/i)){for(var t=s,u=0;"<"==t.charAt(0)&&(u=t.indexOf(">"))>-1;)t=t.slice(u+1);for(var v=0;v<o.length;++v){var w=o[v];w.s.c==k&&w.s.r<j&&j<=w.e.r&&(k=w.e.c+1,v=-1)}var x=ht(s.slice(0,s.indexOf(">")));m=x.colspan?+x.colspan:1,((l=+x.rowspan)>1||m>1)&&o.push({s:{r:j,c:k},e:{r:j+(l||1)-1,c:k+m-1}});var y=x.t||x["data-t"]||"";if(!t.length||(t=hN(t),n.s.r>j&&(n.s.r=j),n.e.r<j&&(n.e.r=j),n.s.c>k&&(n.s.c=k),n.e.c<k&&(n.e.c=k),!t.length)){k+=m;continue}var z={t:"s",v:t};c.raw||!t.trim().length||"s"==y||("TRUE"===t?z={t:"b",v:!0}:"FALSE"===t?z={t:"b",v:!1}:isNaN(g8(t))?isNaN(ha(t).getDate())||(z={t:"d",v:g4(t)},c.cellDates||(z={t:"n",v:gY(z.v)}),z.z=c.dateNF||gk[14]):z={t:"n",v:g8(t)}),c.dense?(d[j]||(d[j]=[]),d[j][k]=z):d[iN({r:j,c:k})]=z,k+=m}}}}return d["!ref"]=iP(n),o.length&&(d["!merges"]=o),d}var mT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mU(a,b){var c=b||{},d,e,f,g,h,i,j=hX(a),k=[],l={name:""},m="",n=0,o={},p=[],q=c.dense?[]:{},r={value:""},s="",t=0,u=[],v=-1,w=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},y=0,z={},A=[],B={},C=0,D=[],E=1,F=1,G=[],H={Names:[]},I={},J=["",""],K=[],L={},M="",N=0,O=!1,P=!1,Q=0;for(hY.lastIndex=0,j=j.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=hY.exec(j);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"":"/"===h[1]?(x.e.c>=x.s.c&&x.e.r>=x.s.r?q["!ref"]=iP(x):q["!ref"]="A1:A1",c.sheetRows>0&&c.sheetRows<=x.e.r&&(q["!fullref"]=q["!ref"],x.e.r=c.sheetRows-1,q["!ref"]=iP(x)),A.length&&(q["!merges"]=A),D.length&&(q["!rows"]=D),f.name=f[""]||f.name,"undefined"!=typeof JSON&&JSON.stringify(f),p.push(f.name),o[f.name]=q,P=!1):"/"!==h[0].charAt(h[0].length-2)&&(f=ht(h[0],!1),v=w=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,q=c.dense?[]:{},A=[],D=[],P=!0);break;case"table-row-group":"/"===h[1]?--y:++y;break;case"table-row":case"":if("/"===h[1]){v+=E,E=1;break}if((g=ht(h[0],!1))[""]?v=g[""]-1:-1==v&&(v=0),(E=+g["number-rows-repeated"]||1)<10)for(Q=0;Q<E;++Q)y>0&&(D[v+Q]={level:y});w=-1;break;case"covered-table-cell":"/"!==h[1]&&++w,c.sheetStubs&&(c.dense?(q[v]||(q[v]=[]),q[v][w]={t:"z"}):q[iN({r:v,c:w})]={t:"z"}),s="",u=[];break;case"table-cell":case"":if("/"===h[0].charAt(h[0].length-2))++w,F=parseInt((r=ht(h[0],!1))["number-columns-repeated"]||"1",10),i={t:"z",v:null},r.formula&&!1!=c.cellFormula&&(i.f=l$(hx(r.formula))),"string"==(r[""]||r["value-type"])&&(i.t="s",i.v=hx(r["string-value"]||""),c.dense?(q[v]||(q[v]=[]),q[v][w]=i):q[iN({r:v,c:w})]=i),w+=F-1;else if("/"!==h[1]){s="",t=0,u=[],F=1;var R=E?v+E-1:v;if(++w>x.e.c&&(x.e.c=w),w<x.s.c&&(x.s.c=w),v<x.s.r&&(x.s.r=v),R>x.e.r&&(x.e.r=R),r=ht(h[0],!1),K=[],L={},i={t:r[""]||r["value-type"],v:null},c.cellFormula)if(r.formula&&(r.formula=hx(r.formula)),r["number-matrix-columns-spanned"]&&r["number-matrix-rows-spanned"]&&(B={s:{r:v,c:w},e:{r:v+(C=parseInt(r["number-matrix-rows-spanned"],10)||0)-1,c:w+(parseInt(r["number-matrix-columns-spanned"],10)||0)-1}},i.F=iP(B),G.push([B,i.F])),r.formula)i.f=l$(r.formula);else for(Q=0;Q<G.length;++Q)v>=G[Q][0].s.r&&v<=G[Q][0].e.r&&w>=G[Q][0].s.c&&w<=G[Q][0].e.c&&(i.F=G[Q][1]);switch((r["number-columns-spanned"]||r["number-rows-spanned"])&&(B={s:{r:v,c:w},e:{r:v+(C=parseInt(r["number-rows-spanned"],10)||0)-1,c:w+(parseInt(r["number-columns-spanned"],10)||0)-1}},A.push(B)),r["number-columns-repeated"]&&(F=parseInt(r["number-columns-repeated"],10)),i.t){case"boolean":i.t="b",i.v=hF(r["boolean-value"]);break;case"float":case"percentage":case"currency":i.t="n",i.v=parseFloat(r.value);break;case"date":i.t="d",i.v=g4(r["date-value"]),c.cellDates||(i.t="n",i.v=gY(i.v)),i.z="m/d/yy";break;case"time":i.t="n",i.v=function(a){var b=0,c=0,d=!1,e=a.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!e)throw Error("|"+a+"| is not an ISO8601 Duration");for(var f=1;f!=e.length;++f)if(e[f]){switch(c=1,f>3&&(d=!0),e[f].slice(e[f].length-1)){case"Y":throw Error("Unsupported ISO Duration Field: "+e[f].slice(e[f].length-1));case"D":c*=24;case"H":c*=60;case"M":if(d)c*=60;else throw Error("Unsupported ISO Duration Field: M")}b+=c*parseInt(e[f],10)}return b}(r["time-value"])/86400,c.cellDates&&(i.t="d",i.v=g0(i.v)),i.z="HH:MM:SS";break;case"number":i.t="n",i.v=parseFloat(r[""]);break;default:if("string"!==i.t&&"text"!==i.t&&i.t)throw Error("Unsupported value type "+i.t);i.t="s",null!=r["string-value"]&&(s=hx(r["string-value"]),u=[])}}else{if(O=!1,"s"===i.t&&(i.v=s||"",u.length&&(i.R=u),O=0==t),I.Target&&(i.l=I),K.length>0&&(i.c=K,K=[]),s&&!1!==c.cellText&&(i.w=s),O&&(i.t="z",delete i.v),(!O||c.sheetStubs)&&!(c.sheetRows&&c.sheetRows<=v))for(var S=0;S<E;++S){if(F=parseInt(r["number-columns-repeated"]||"1",10),c.dense)for(q[v+S]||(q[v+S]=[]),q[v+S][w]=0==S?i:g6(i);--F>0;)q[v+S][w+F]=g6(i);else for(q[iN({r:v+S,c:w})]=i;--F>0;)q[iN({r:v+S,c:w+F})]=g6(i);x.e.c<=w&&(x.e.c=w)}w+=(F=parseInt(r["number-columns-repeated"]||"1",10))-1,F=0,i={},s="",u=[]}I={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===h[1]){if((d=k.pop())[0]!==h[3])throw"Bad state: "+d}else"/"!==h[0].charAt(h[0].length-2)&&k.push([h[3],!0]);break;case"annotation":if("/"===h[1]){if((d=k.pop())[0]!==h[3])throw"Bad state: "+d;L.t=s,u.length&&(L.R=u),L.a=M,K.push(L)}else"/"!==h[0].charAt(h[0].length-2)&&k.push([h[3],!1]);M="",N=0,s="",t=0,u=[];break;case"creator":"/"===h[1]?M=j.slice(N,h.index):N=h.index+h[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===h[1]){if((d=k.pop())[0]!==h[3])throw"Bad state: "+d}else"/"!==h[0].charAt(h[0].length-2)&&k.push([h[3],!1]);s="",t=0,u=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===h[1]){if(z[l.name]=m,(d=k.pop())[0]!==h[3])throw"Bad state: "+d}else"/"!==h[0].charAt(h[0].length-2)&&(m="",l=ht(h[0],!1),k.push([h[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(k[k.length-1][0]){case"time-style":case"date-style":e=ht(h[0],!1),m+=mT[h[3]][+("long"===e.style)]}break;case"text":if("/>"===h[0].slice(-2));else if("/"===h[1])switch(k[k.length-1][0]){case"number-style":case"date-style":case"time-style":m+=j.slice(n,h.index)}else n=h.index+h[0].length;break;case"named-range":J=l_((e=ht(h[0],!1))["cell-range-address"]);var T={Name:e.name,Ref:J[0]+"!"+J[1]};P&&(T.Sheet=p.length),H.Names.push(T);break;case"p":case"":if(["master-styles"].indexOf(k[k.length-1][0])>-1)break;if("/"!==h[1]||r&&r["string-value"])ht(h[0],!1),t=h.index+h[0].length;else{var U=[hx(j.slice(t,h.index).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,b){return Array(parseInt(b,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,"\n").replace(/<[^>]*>/g,""))];s=(s.length>0?s+"\n":"")+U[0]}break;case"database-range":if("/"===h[1])break;try{o[(J=l_(ht(h[0])["target-range-address"]))[0]]["!autofilter"]={ref:J[1]}}catch(a){}break;case"a":if("/"!==h[1]){if(!(I=ht(h[0],!1)).href)break;I.Target=hx(I.href),delete I.href,"#"==I.Target.charAt(0)&&I.Target.indexOf(".")>-1?(J=l_(I.Target.slice(1)),I.Target="#"+J[0]+"!"+J[1]):I.Target.match(/^\.\.[\\\/]/)&&(I.Target=I.Target.slice(3))}break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(c.WTF)throw Error(h)}}var V={Sheets:o,SheetNames:p,Workbook:H};return c.bookSheets&&delete V.Sheets,V}var mV=function(){var a="<office:document-styles "+hU({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+'><office:master-styles><style:master-page style:name="mp1" style:page-layout-name="mp1"><style:header/><style:header-left style:display="false"/><style:footer/><style:footer-left style:display="false"/></style:master-page></office:master-styles></office:document-styles>';return function(){return hn+a}}(),mW=function(){var a="          <table:table-cell />\n",b=function(b,c,d){var e=[];e.push('      <table:table table:name="'+hA(c.SheetNames[d])+'" table:style-name="ta1">\n');var f=0,g=0,h=iO(b["!ref"]||"A1"),i=b["!merges"]||[],j=0,k=Array.isArray(b);if(b["!cols"])for(g=0;g<=h.e.c;++g)e.push("        <table:table-column"+(b["!cols"][g]?' table:style-name="co'+b["!cols"][g].ods+'"':"")+"></table:table-column>\n");var l="",m=b["!rows"]||[];for(f=0;f<h.s.r;++f)l=m[f]?' table:style-name="ro'+m[f].ods+'"':"",e.push("        <table:table-row"+l+"></table:table-row>\n");for(;f<=h.e.r;++f){for(l=m[f]?' table:style-name="ro'+m[f].ods+'"':"",e.push("        <table:table-row"+l+">\n"),g=0;g<h.s.c;++g)e.push(a);for(;g<=h.e.c;++g){var n=!1,o={},p="";for(j=0;j!=i.length;++j)if(!(i[j].s.c>g)&&!(i[j].s.r>f)&&!(i[j].e.c<g)&&!(i[j].e.r<f)){(i[j].s.c!=g||i[j].s.r!=f)&&(n=!0),o["table:number-columns-spanned"]=i[j].e.c-i[j].s.c+1,o["table:number-rows-spanned"]=i[j].e.r-i[j].s.r+1;break}if(n){e.push("          <table:covered-table-cell/>\n");continue}var q=iN({r:f,c:g}),r=k?(b[f]||[])[g]:b[q];if(r&&r.f&&(o["table:formula"]=hA(("of:="+r.f.replace(lw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),r.F&&r.F.slice(0,q.length)==q)){var s=iO(r.F);o["table:number-matrix-columns-spanned"]=s.e.c-s.s.c+1,o["table:number-matrix-rows-spanned"]=s.e.r-s.s.r+1}if(!r){e.push(a);continue}switch(r.t){case"b":p=r.v?"TRUE":"FALSE",o["office:value-type"]="boolean",o["office:boolean-value"]=r.v?"true":"false";break;case"n":p=r.w||String(r.v||0),o["office:value-type"]="float",o["office:value"]=r.v||0;break;case"s":case"str":p=null==r.v?"":r.v,o["office:value-type"]="string";break;case"d":p=r.w||g4(r.v).toISOString(),o["office:value-type"]="date",o["office:date-value"]=g4(r.v).toISOString(),o["table:style-name"]="ce1";break;default:e.push(a);continue}var t=hA(p).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(r.l&&r.l.Target){var u=r.l.Target;"#"==(u="#"==u.charAt(0)?"#"+u.slice(1).replace(/\./,"!"):u).charAt(0)||u.match(/^\w+:/)||(u="../"+u),t=hV("text:a",t,{"xlink:href":u.replace(/&/g,"&amp;")})}e.push("          "+hV("table:table-cell",hV("text:p",t,{}),o)+"\n")}e.push("        </table:table-row>\n")}return e.push("      </table:table>\n"),e.join("")},c=function(a,b){a.push(" <office:automatic-styles>\n"),a.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),a.push('   <number:month number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push('   <number:day number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push("   <number:year/>\n"),a.push("  </number:date-style>\n");var c=0;b.SheetNames.map(function(a){return b.Sheets[a]}).forEach(function(b){if(b&&b["!cols"]){for(var d=0;d<b["!cols"].length;++d)if(b["!cols"][d]){var e=b["!cols"][d];if(null==e.width&&null==e.wpx&&null==e.wch)continue;k3(e),e.ods=c;var f=b["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+c+'" style:family="table-column">\n'),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+'"/>\n'),a.push("  </style:style>\n"),++c}}});var d=0;b.SheetNames.map(function(a){return b.Sheets[a]}).forEach(function(b){if(b&&b["!rows"]){for(var c=0;c<b["!rows"].length;++c)if(b["!rows"][c]){b["!rows"][c].ods=d;var e=b["!rows"][c].hpx+"px";a.push('  <style:style style:name="ro'+d+'" style:family="table-row">\n'),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+e+'"/>\n'),a.push("  </style:style>\n"),++d}}}),a.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),a.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),a.push("  </style:style>\n"),a.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),a.push(" </office:automatic-styles>\n")};return function(a,d){var e=[hn],f=hU({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=hU({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==d.bookType?(e.push("<office:document"+f+g+">\n"),e.push(jt().replace(/office:document-meta/g,"office:meta"))):e.push("<office:document-content"+f+">\n"),c(e,a),e.push("  <office:body>\n"),e.push("    <office:spreadsheet>\n");for(var h=0;h!=a.SheetNames.length;++h)e.push(b(a.Sheets[a.SheetNames[h]],a,h,d));return e.push("    </office:spreadsheet>\n"),e.push("  </office:body>\n"),"fods"==d.bookType?e.push("</office:document>"):e.push("</office:document-content>"),e.join("")}}();function mX(a,b){if("fods"==b.bookType)return mW(a,b);var c=hk(),d="",e=[],f=[];return hj(c,d="mimetype","application/vnd.oasis.opendocument.spreadsheet"),hj(c,d="content.xml",mW(a,b)),e.push([d,"text/xml"]),f.push([d,"ContentFile"]),hj(c,d="styles.xml",mV(a,b)),e.push([d,"text/xml"]),f.push([d,"StylesFile"]),hj(c,d="meta.xml",hn+jt()),e.push([d,"text/xml"]),f.push([d,"MetadataFile"]),hj(c,d="manifest.rdf",function(a){var b=[hn];b.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var c=0;c!=a.length;++c)b.push(js(a[c][0],a[c][1])),b.push('  <rdf:Description rdf:about="">\n    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a[c][0]+'"/>\n  </rdf:Description>\n');return b.push(js("","Document","pkg")),b.push("</rdf:RDF>"),b.join("")}(f)),e.push([d,"application/rdf+xml"]),hj(c,d="META-INF/manifest.xml",function(a){var b=[hn];b.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),b.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var c=0;c<a.length;++c)b.push('  <manifest:file-entry manifest:full-path="'+a[c][0]+'" manifest:media-type="'+a[c][1]+'"/>\n');return b.push("</manifest:manifest>"),b.join("")}(e)),c}function mY(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function mZ(a){return"undefined"!=typeof TextDecoder?new TextDecoder().decode(a):hK(f7(a))}function m$(a){var b=new Uint8Array(a.reduce(function(a,b){return a+b.length},0)),c=0;return a.forEach(function(a){b.set(a,c),c+=a.length}),b}function m_(a){return a-=a>>1&0x55555555,((a=(0x33333333&a)+(a>>2&0x33333333))+(a>>4)&0xf0f0f0f)*0x1010101>>>24}function m0(a,b){var c=b?b[0]:0,d=127&a[c];d:if(a[c++]>=128&&(d|=(127&a[c])<<7,a[c++]<128||(d|=(127&a[c])<<14,a[c++]<128)||(d|=(127&a[c])<<21,a[c++]<128)||(d+=(127&a[c])*0x10000000,++c,a[c++]<128)||(d+=(127&a[c])*0x800000000,++c,a[c++]<128)||(d+=(127&a[c])*0x40000000000,++c,a[c++]<128)))break d;return b&&(b[0]=c),d}function m1(a){var b=new Uint8Array(7);b[0]=127&a;var c=1;e:if(a>127){if(b[c-1]|=128,b[c]=a>>7&127,++c,a<=16383||(b[c-1]|=128,b[c]=a>>14&127,++c,a<=2097151)||(b[c-1]|=128,b[c]=a>>21&127,++c,a<=0xfffffff)||(b[c-1]|=128,b[c]=a/256>>>21&127,++c,a<=0x7ffffffff)||(b[c-1]|=128,b[c]=a/65536>>>21&127,++c,a<=0x3ffffffffff))break e;b[c-1]|=128,b[c]=a/0x1000000>>>21&127,++c}return b.slice(0,c)}function m2(a){var b=0,c=127&a[0];d:if(a[b++]>=128){if(c|=(127&a[b])<<7,a[b++]<128||(c|=(127&a[b])<<14,a[b++]<128)||(c|=(127&a[b])<<21,a[b++]<128))break d;c|=(127&a[b])<<28}return c}function m3(a){for(var b=[],c=[0];c[0]<a.length;){var d,e=c[0],f=m0(a,c),g=7&f,h=0;if(0==(f=Math.floor(f/8)))break;switch(g){case 0:for(var i=c[0];a[c[0]++]>=128;);d=a.slice(i,c[0]);break;case 5:h=4,d=a.slice(c[0],c[0]+h),c[0]+=h;break;case 1:h=8,d=a.slice(c[0],c[0]+h),c[0]+=h;break;case 2:h=m0(a,c),d=a.slice(c[0],c[0]+h),c[0]+=h;break;default:throw Error("PB Type ".concat(g," for Field ").concat(f," at offset ").concat(e))}var j={data:d,type:g};null==b[f]?b[f]=[j]:b[f].push(j)}return b}function m4(a){var b=[];return a.forEach(function(a,c){a.forEach(function(a){a.data&&(b.push(m1(8*c+a.type)),2==a.type&&b.push(m1(a.data.length)),b.push(a.data))})}),m$(b)}function m5(a,b){return(null==a?void 0:a.map(function(a){return b(a.data)}))||[]}function m6(a){for(var b,c=[],d=[0];d[0]<a.length;){var e=m0(a,d),f=m3(a.slice(d[0],d[0]+e));d[0]+=e;var g={id:m2(f[1][0].data),messages:[]};f[2].forEach(function(b){var c=m3(b.data),e=m2(c[3][0].data);g.messages.push({meta:c,data:a.slice(d[0],d[0]+e)}),d[0]+=e}),(null==(b=f[3])?void 0:b[0])&&(g.merge=m2(f[3][0].data)>>>0>0),c.push(g)}return c}function m7(a){var b=[];return a.forEach(function(a){var c=[];c[1]=[{data:m1(a.id),type:0}],c[2]=[],null!=a.merge&&(c[3]=[{data:m1(+!!a.merge),type:0}]);var d=[];a.messages.forEach(function(a){d.push(a.data),a.meta[3]=[{type:0,data:m1(a.data.length)}],c[2].push({data:m4(a.meta),type:2})});var e=m4(c);b.push(m1(e.length)),b.push(e),d.forEach(function(a){return b.push(a)})}),m$(b)}function m8(a){for(var b=[],c=0;c<a.length;){var d=a[c++],e=a[c]|a[c+1]<<8|a[c+2]<<16;c+=3,b.push(function(a,b){if(0!=a)throw Error("Unexpected Snappy chunk type ".concat(a));for(var c=[0],d=m0(b,c),e=[];c[0]<b.length;){var f=3&b[c[0]];if(0==f){var g=b[c[0]++]>>2;if(g<60)++g;else{var h=g-59;g=b[c[0]],h>1&&(g|=b[c[0]+1]<<8),h>2&&(g|=b[c[0]+2]<<16),h>3&&(g|=b[c[0]+3]<<24),g>>>=0,g++,c[0]+=h}e.push(b.slice(c[0],c[0]+g)),c[0]+=g;continue}var i=0,j=0;if(1==f?(j=(b[c[0]]>>2&7)+4,i=(224&b[c[0]++])<<3|b[c[0]++]):(j=(b[c[0]++]>>2)+1,2==f?(i=b[c[0]]|b[c[0]+1]<<8,c[0]+=2):(i=(b[c[0]]|b[c[0]+1]<<8|b[c[0]+2]<<16|b[c[0]+3]<<24)>>>0,c[0]+=4)),e=[m$(e)],0==i)throw Error("Invalid offset 0");if(i>e[0].length)throw Error("Invalid offset beyond length");if(j>=i)for(e.push(e[0].slice(-i)),j-=i;j>=e[e.length-1].length;)e.push(e[e.length-1]),j-=e[e.length-1].length;e.push(e[0].slice(-i,-i+j))}var k=m$(e);if(k.length!=d)throw Error("Unexpected length: ".concat(k.length," != ").concat(d));return k}(d,a.slice(c,c+e))),c+=e}if(c!==a.length)throw Error("data is not a valid framed stream!");return m$(b)}function m9(a){for(var b=[],c=0;c<a.length;){var d=Math.min(a.length-c,0xfffffff),e=new Uint8Array(4);b.push(e);var f=m1(d),g=f.length;b.push(f),d<=60?(g++,b.push(new Uint8Array([d-1<<2]))):d<=256?(g+=2,b.push(new Uint8Array([240,d-1&255]))):d<=65536?(g+=3,b.push(new Uint8Array([244,d-1&255,d-1>>8&255]))):d<=0x1000000?(g+=4,b.push(new Uint8Array([248,d-1&255,d-1>>8&255,d-1>>16&255]))):d<=0x100000000&&(g+=5,b.push(new Uint8Array([252,d-1&255,d-1>>8&255,d-1>>16&255,d-1>>>24&255]))),b.push(a.slice(c,c+d)),g+=d,e[0]=0,e[1]=255&g,e[2]=g>>8&255,e[3]=g>>16&255,c+=d}return m$(b)}function na(a,b){var c=new Uint8Array(32),d=mY(c),e=12,f=0;switch(c[0]=5,a.t){case"n":c[1]=2,function(a,b,c){var d=Math.floor(0==c?0:Math.LOG10E*Math.log(Math.abs(c)))+6176-20,e=c/Math.pow(10,d-6176);a[b+15]|=d>>7,a[b+14]|=(127&d)<<1;for(var f=0;e>=1;++f,e/=256)a[b+f]=255&e;a[b+15]|=c>=0?0:128}(c,e,a.v),f|=1,e+=16;break;case"b":c[1]=6,d.setFloat64(e,+!!a.v,!0),f|=2,e+=8;break;case"s":if(-1==b.indexOf(a.v))throw Error("Value ".concat(a.v," missing from SST!"));c[1]=3,d.setUint32(e,b.indexOf(a.v),!0),f|=8,e+=4;break;default:throw"unsupported cell type "+a.t}return d.setUint32(8,f,!0),c.slice(0,e)}function nb(a,b){var c=new Uint8Array(32),d=mY(c),e=12,f=0;switch(c[0]=3,a.t){case"n":c[2]=2,d.setFloat64(e,a.v,!0),f|=32,e+=8;break;case"b":c[2]=6,d.setFloat64(e,+!!a.v,!0),f|=32,e+=8;break;case"s":if(-1==b.indexOf(a.v))throw Error("Value ".concat(a.v," missing from SST!"));c[2]=3,d.setUint32(e,b.indexOf(a.v),!0),f|=16,e+=4;break;default:throw"unsupported cell type "+a.t}return d.setUint32(4,f,!0),c.slice(0,e)}function nc(a){return m0(m3(a)[1][0].data)}function nd(a,b){var c=m3(b.data),d=m2(c[1][0].data),e=c[3],f=[];return(e||[]).forEach(function(b){var c=m3(b.data),e=m2(c[1][0].data)>>>0;switch(d){case 1:f[e]=mZ(c[3][0].data);break;case 8:var g=m3(a[nc(c[9][0].data)][0].data),h=a[nc(g[1][0].data)][0],i=m2(h.meta[1][0].data);if(2001!=i)throw Error("2000 unexpected reference to ".concat(i));var j=m3(h.data);f[e]=j[3].map(function(a){return mZ(a.data)}).join("")}}),f}function ne(a){var b,c,d,e,f={},g=[];if(a.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw Error("Unsupported password protection")}),a.FileIndex.forEach(function(a){var b,c;if(a.name.match(/\.iwa$/)){try{b=m8(a.content)}catch(b){return console.log("?? "+a.content.length+" "+(b.message||b))}try{c=m6(b)}catch(a){return console.log("## "+(a.message||a))}c.forEach(function(a){f[a.id]=a.messages,g.push(a.id)})}}),!g.length)throw Error("File has no messages");var h=(null==(e=null==(d=null==(c=null==(b=null==f?void 0:f[1])?void 0:b[0])?void 0:c.meta)?void 0:d[1])?void 0:e[0].data)&&1==m2(f[1][0].meta[1][0].data)&&f[1][0];if(h||g.forEach(function(a){f[a].forEach(function(a){if(1==m2(a.meta[1][0].data)>>>0)if(h)throw Error("Document has multiple roots");else h=a})}),!h)throw Error("Cannot find Document root");var i=h,j=nt();if(m5(m3(i.data)[1],nc).forEach(function(a){f[a].forEach(function(a){if(2==m2(a.meta[1][0].data)){var b,c,d,e=(d={name:(null==(b=(c=m3(a.data))[1])?void 0:b[0])?mZ(c[1][0].data):"",sheets:[]},m5(c[2],nc).forEach(function(a){f[a].forEach(function(a){6e3==m2(a.meta[1][0].data)&&d.sheets.push(function(a,b){var c=m3(b.data),d={"!ref":"A1"},e=a[nc(c[2][0].data)],f=m2(e[0].meta[1][0].data);if(6001!=f)throw Error("6000 unexpected reference to ".concat(f));return!function(a,b,c){var d,e=m3(b.data),f={s:{r:0,c:0},e:{r:0,c:0}};if(f.e.r=(m2(e[6][0].data)>>>0)-1,f.e.r<0)throw Error("Invalid row varint ".concat(e[6][0].data));if(f.e.c=(m2(e[7][0].data)>>>0)-1,f.e.c<0)throw Error("Invalid col varint ".concat(e[7][0].data));c["!ref"]=iP(f);var g=m3(e[4][0].data),h=nd(a,a[nc(g[4][0].data)][0]),i=(null==(d=g[17])?void 0:d[0])?nd(a,a[nc(g[17][0].data)][0]):[],j=m3(g[3][0].data),k=0;j[1].forEach(function(b){var d,e,f,g,j=a[nc(m3(b.data)[2][0].data)][0],l=m2(j.meta[1][0].data);if(6002!=l)throw Error("6001 unexpected reference to ".concat(l));var m=(f=(null==(d=null==(e=m3(j.data))?void 0:e[7])?void 0:d[0])?+(m2(e[7][0].data)>>>0>0):-1,g=m5(e[5],function(a){return function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=m3(a),t=m2(s[1][0].data)>>>0,u=m2(s[2][0].data)>>>0,v=(null==(d=null==(c=s[8])?void 0:c[0])?void 0:d.data)&&m2(s[8][0].data)>0||!1;if((null==(f=null==(e=s[7])?void 0:e[0])?void 0:f.data)&&0!=b)q=null==(h=null==(g=s[7])?void 0:g[0])?void 0:h.data,r=null==(j=null==(i=s[6])?void 0:i[0])?void 0:j.data;else if((null==(l=null==(k=s[4])?void 0:k[0])?void 0:l.data)&&1!=b)q=null==(n=null==(m=s[4])?void 0:m[0])?void 0:n.data,r=null==(p=null==(o=s[3])?void 0:o[0])?void 0:p.data;else throw"NUMBERS Tile missing ".concat(b," cell storage");for(var w=v?4:1,x=mY(q),y=[],z=0;z<q.length/2;++z){var A=x.getUint16(2*z,!0);A<65535&&y.push([z,A])}if(y.length!=u)throw"Expected ".concat(u," cells, found ").concat(y.length);var B=[];for(z=0;z<y.length-1;++z)B[y[z][0]]=r.subarray(y[z][1]*w,y[z+1][1]*w);return y.length>=1&&(B[y[y.length-1][0]]=r.subarray(y[y.length-1][1]*w)),{R:t,cells:B}}(a,f)}),{nrows:m2(e[4][0].data)>>>0,data:g.reduce(function(a,b){return a[b.R]||(a[b.R]=[]),b.cells.forEach(function(c,d){if(a[b.R][d])throw Error("Duplicate cell r=".concat(b.R," c=").concat(d));a[b.R][d]=c}),a},[])});m.data.forEach(function(a,b){a.forEach(function(a,d){var e=iN({r:k+b,c:d}),f=function(a,b,c){switch(a[0]){case 0:case 1:case 2:case 3:return function(a,b,c,d){var e,f=mY(a),g=f.getUint32(4,!0),h=(d>1?12:8)+4*m_(g&(d>1?3470:398)),i=-1,j=-1,k=NaN,l=new Date(2001,0,1);switch(512&g&&(i=f.getUint32(h,!0),h+=4),h+=4*m_(g&(d>1?12288:4096)),16&g&&(j=f.getUint32(h,!0),h+=4),32&g&&(k=f.getFloat64(h,!0),h+=8),64&g&&(l.setTime(l.getTime()+1e3*f.getFloat64(h,!0)),h+=8),a[2]){case 0:break;case 2:e={t:"n",v:k};break;case 3:e={t:"s",v:b[j]};break;case 5:e={t:"d",v:l};break;case 6:e={t:"b",v:k>0};break;case 7:e={t:"n",v:k/86400};break;case 8:e={t:"e",v:0};break;case 9:if(i>-1)e={t:"s",v:c[i]};else if(j>-1)e={t:"s",v:b[j]};else if(isNaN(k))throw Error("Unsupported cell type ".concat(a.slice(0,4)));else e={t:"n",v:k};break;default:throw Error("Unsupported cell type ".concat(a.slice(0,4)))}return e}(a,b,c,a[0]);case 5:return function(a,b,c){var d,e=mY(a),f=e.getUint32(8,!0),g=12,h=-1,i=-1,j=NaN,k=NaN,l=new Date(2001,0,1);switch(1&f&&(j=function(a,b){for(var c=(127&a[b+15])<<7|a[b+14]>>1,d=1&a[b+14],e=b+13;e>=b;--e)d=256*d+a[e];return(128&a[b+15]?-d:d)*Math.pow(10,c-6176)}(a,g),g+=16),2&f&&(k=e.getFloat64(g,!0),g+=8),4&f&&(l.setTime(l.getTime()+1e3*e.getFloat64(g,!0)),g+=8),8&f&&(i=e.getUint32(g,!0),g+=4),16&f&&(h=e.getUint32(g,!0),g+=4),a[1]){case 0:break;case 2:case 10:d={t:"n",v:j};break;case 3:d={t:"s",v:b[i]};break;case 5:d={t:"d",v:l};break;case 6:d={t:"b",v:k>0};break;case 7:d={t:"n",v:k/86400};break;case 8:d={t:"e",v:0};break;case 9:if(h>-1)d={t:"s",v:c[h]};else throw Error("Unsupported cell type ".concat(a[1]," : ").concat(31&f," : ").concat(a.slice(0,4)));break;default:throw Error("Unsupported cell type ".concat(a[1]," : ").concat(31&f," : ").concat(a.slice(0,4)))}return d}(a,b,c);default:throw Error("Unsupported payload version ".concat(a[0]))}}(a,h,i);f&&(c[e]=f)})}),k+=m.nrows})}(a,e[0],d),d}(f,a))})}),d);e.sheets.forEach(function(a,b){nu(j,a,0==b?e.name:e.name+"_"+b,!0)})}})}),0==j.SheetNames.length)throw Error("Empty NUMBERS file");return j}function nf(a){return function(b){for(var c=0;c!=a.length;++c){var d=a[c];void 0===b[d[0]]&&(b[d[0]]=d[1]),"n"===d[2]&&(b[d[0]]=Number(b[d[0]]))}}}function ng(a){nf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(a)}function nh(a){nf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function ni(a){return"/"==a.charAt(0)?a.slice(1):a}function nj(a,b){var c="";switch((b||{}).type||"base64"){case"buffer":case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":c=f0(a.slice(0,12));break;case"binary":c=a;break;default:throw Error("Unrecognized type "+(b&&b.type||"undefined"))}return[c.charCodeAt(0),c.charCodeAt(1),c.charCodeAt(2),c.charCodeAt(3),c.charCodeAt(4),c.charCodeAt(5),c.charCodeAt(6),c.charCodeAt(7)]}function nk(a,b){var c=0;f:for(;c<a.length;)switch(a.charCodeAt(c)){case 10:case 13:case 32:++c;break;case 60:return mG(a.slice(c),b);default:break f}return kA.to_workbook(a,b)}function nl(a,b,c,d){return d?(c.type="string",kA.to_workbook(a,c)):kA.to_workbook(b,c)}function nm(a,b){fU();var c,e,f,g,i,j,k,l=b||{};if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)return nm(new Uint8Array(a),((l=g6(l)).type="array",l));"undefined"!=typeof Uint8Array&&a instanceof Uint8Array&&!l.type&&(l.type="undefined"!=typeof Deno?"buffer":"array");var m=a,n=[0,0,0,0],o=!1;if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),l1={},l.dateNF&&(l1.dateNF=l.dateNF),l.type||(l.type=f1&&Buffer.isBuffer(a)?"buffer":"base64"),"file"==l.type&&(l.type=f1?"buffer":"binary",m=function(a){if(void 0!==d)return d.readFileSync(a);if("undefined"!=typeof Deno)return Deno.readFileSync(a);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var b=File(a);b.open("r"),b.encoding="binary";var c=b.read();return b.close(),c}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw Error("Cannot access file "+a)}(a),"undefined"==typeof Uint8Array||f1||(l.type="array")),"string"==l.type&&(o=!0,l.type="binary",l.codepage=65001,m=a.match(/[^\x00-\x7F]/)?hL(a):a),"array"==l.type&&"undefined"!=typeof Uint8Array&&a instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var p=new Uint8Array(new ArrayBuffer(3));if(p.foo="bar",!p.foo)return(l=g6(l)).type="array",nm(f8(m),l)}switch((n=nj(m,l))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return f=gR.read(m,l),g=l,gR.find(f,"EncryptedPackage")?function(a,b){var c=b||{},d="Workbook",e=gR.find(a,d);try{if(d="/!DataSpaces/Version",!(e=gR.find(a,d))||!e.content||(f=e.content,(g={}).id=f.read_shift(0,"lpp4"),g.R=kP(f,4),g.U=kP(f,4),g.W=kP(f,4),d="/!DataSpaces/DataSpaceMap",!(e=gR.find(a,d))||!e.content))throw Error("ECMA-376 Encrypted file missing "+d);var f,g,h=function(a){var b=[];a.l+=4;for(var c=a.read_shift(4);c-- >0;)b.push(function(a){for(var b=a.read_shift(4),c=a.l+b-4,d={},e=a.read_shift(4),f=[];e-- >0;)f.push({t:a.read_shift(4),v:a.read_shift(0,"lpp4")});if(d.name=a.read_shift(0,"lpp4"),d.comps=f,a.l!=c)throw Error("Bad DataSpaceMapEntry: "+a.l+" != "+c);return d}(a));return b}(e.content);if(1!==h.length||1!==h[0].comps.length||0!==h[0].comps[0].t||"StrongEncryptionDataSpace"!==h[0].name||"EncryptedPackage"!==h[0].comps[0].v)throw Error("ECMA-376 Encrypted file bad "+d);if(d="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(e=gR.find(a,d))||!e.content)throw Error("ECMA-376 Encrypted file missing "+d);var i=function(a){var b=[];a.l+=4;for(var c=a.read_shift(4);c-- >0;)b.push(a.read_shift(0,"lpp4"));return b}(e.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw Error("ECMA-376 Encrypted file bad "+d);if(d="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(e=gR.find(a,d))||!e.content)throw Error("ECMA-376 Encrypted file missing "+d);!function(a){var b,c=(b={},a.read_shift(4),a.l+=4,b.id=a.read_shift(0,"lpp4"),b.name=a.read_shift(0,"lpp4"),b.R=kP(a,4),b.U=kP(a,4),b.W=kP(a,4),b);if(c.ename=a.read_shift(0,"8lpp4"),c.blksz=a.read_shift(4),c.cmode=a.read_shift(4),4!=a.read_shift(4))throw Error("Bad !Primary record")}(e.content)}catch(a){}if(d="/EncryptionInfo",!(e=gR.find(a,d))||!e.content)throw Error("ECMA-376 Encrypted file missing "+d);var j=function(a){var b,c,d,e,f=kP(a);switch(f.Minor){case 2:return[f.Minor,function(a){if((63&a.read_shift(4))!=36)throw Error("EncryptionInfo mismatch");var b=a.read_shift(4);return{t:"Std",h:kQ(a,b),v:kR(a,a.length-a.l)}}(a,f)];case 3:return[f.Minor,function(){throw Error("File is password-protected: ECMA-376 Extensible")}(a,f)];case 4:return[f.Minor,(b=a,c=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"],b.l+=4,d=b.read_shift(b.length-b.l,"utf8"),e={},d.replace(hq,function(a){var b=ht(a);switch(hu(b[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":c.forEach(function(a){e[a]=b[a]});break;case"<dataIntegrity":e.encryptedHmacKey=b.encryptedHmacKey,e.encryptedHmacValue=b.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":e.encs=[];break;case"<keyEncryptor":e.uri=b.uri;break;case"<encryptedKey":e.encs.push(b);break;default:throw b[0]}}),e)]}throw Error("ECMA-376 Encrypted file unrecognized Version: "+f.Minor)}(e.content);if(d="/EncryptedPackage",!(e=gR.find(a,d))||!e.content)throw Error("ECMA-376 Encrypted file missing "+d);if(4==j[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(j[1],e.content,c.password||"",c);if(2==j[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(j[1],e.content,c.password||"",c);throw Error("File is password-protected")}(f,g):mM(f,g);break;case 9:if(n[1]<=8)return mM(m,l);break;case 60:return mG(m,l);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw Error("TIFF Image File is not a spreadsheet");if(68===n[1]){var q=m,r=l,s=r||{},t=!!s.WTF;s.WTF=!0;try{var u=kx.to_workbook(q,s);return s.WTF=t,u}catch(a){if(s.WTF=t,!a.message.match(/SYLK bad record ID/)&&t)throw a;return kA.to_workbook(q,r)}}break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return ky.to_workbook(m,l);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?(c=m,(e=l||{}).type||(e.type=f1&&Buffer.isBuffer(c)?"buffer":"base64"),function(a,b){if(gN(),ng(b=b||{}),he(a,"META-INF/manifest.xml")||he(a,"objectdata.xml")){var c=a,d=b;d=d||{},he(c,"META-INF/manifest.xml")&&function(a,b){for(var c,d,e=hX(a);c=hY.exec(e);)switch(c[3]){case"manifest":break;case"file-entry":if("/"==(d=ht(c[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==d.type)throw Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw Error("Unsupported ODS Encryption");default:if(b&&b.WTF)throw c}}(hg(c,"META-INF/manifest.xml"),d);var e=hh(c,"content.xml");if(!e)throw Error("Missing content.xml in ODS / UOF file");var f=mU(hK(e),d);return he(c,"meta.xml")&&(f.Props=jw(hg(c,"meta.xml"))),f}if(he(a,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw Error("NUMBERS file parsing requires Uint8Array support");if(a.FileIndex)return ne(a);var g,h,i,j,k,l,m,n,o,p,q,r,s,t=gR.utils.cfb_new();return hi(a).forEach(function(b){hj(t,b,function a(b,c,d){if(!d)return hd(hf(b,c));if(!c)return null;try{return a(b,c)}catch(a){return null}}(a,b))}),ne(t)}if(!he(a,"[Content_Types].xml")){if(he(a,"index.xml.gz"))throw Error("Unsupported NUMBERS 08 file");if(he(a,"index.xml"))throw Error("Unsupported NUMBERS 09 file");throw Error("Unsupported ZIP file")}var u=hi(a),v=function(a){var b=jl();if(!a||!a.match)return b;var c={};if((a.match(hq)||[]).forEach(function(a){var d=ht(a);switch(d[0].replace(hr,"<")){case"<?xml":break;case"<Types":b.xmlns=d["xmlns"+(d[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":c[d.Extension]=d.ContentType;break;case"<Override":void 0!==b[jj[d.ContentType]]&&b[jj[d.ContentType]].push(d.PartName)}}),b.xmlns!==hZ.CT)throw Error("Unknown Namespace: "+b.xmlns);return b.calcchain=b.calcchains.length>0?b.calcchains[0]:"",b.sst=b.strs.length>0?b.strs[0]:"",b.style=b.styles.length>0?b.styles[0]:"",b.defaults=c,delete b.calcchains,b}(hh(a,"[Content_Types].xml")),w=!1;if(0===v.workbooks.length&&hg(a,q="xl/workbook.xml",!0)&&v.workbooks.push(q),0===v.workbooks.length){if(!hg(a,q="xl/workbook.bin",!0))throw Error("Could not find workbook");v.workbooks.push(q),w=!0}"bin"==v.workbooks[0].slice(-3)&&(w=!0);var x={},y={};if(!b.bookSheets&&!b.bookProps){if(l0=[],v.sst)try{l0=function(a,b,c){if(".bin"===b.slice(-4)){var d,e;return d=[],e=!1,iB(a,function(a,b,f){switch(f){case 159:d.Count=a[0],d.Unique=a[1];break;case 19:d.push(a);break;case 160:return!0;case 35:e=!0;break;case 36:e=!1;break;default:if(b.T,!e||c.WTF)throw Error("Unexpected record 0x"+f.toString(16))}}),d}return function(a,b){var c=[],d="";if(!a)return c;var e=a.match(kI);if(e){d=e[2].replace(kJ,"").split(kK);for(var f=0;f!=d.length;++f){var g=kH(d[f].trim(),b);null!=g&&(c[c.length]=g)}c.Count=(e=ht(e[1])).count,c.Unique=e.uniqueCount}return c}(a,c)}(hg(a,ni(v.sst)),v.sst,b)}catch(a){if(b.WTF)throw a}b.cellStyles&&v.themes.length&&(g=hh(a,v.themes[0].replace(/^\//,""),!0)||"",v.themes[0],x=ln(g,b)),v.style&&(y=function(a,b,c,d){if(".bin"===b.slice(-4)){var e={};for(var f in e.NumberFmt=[],gk)e.NumberFmt[f]=gk[f];e.CellXf=[],e.Fonts=[];var g=[],h=!1;return iB(a,function(a,b,f){switch(f){case 44:e.NumberFmt[a[0]]=a[1],gL(a[1],a[0]);break;case 43:e.Fonts.push(a),null!=a.color.theme&&c&&c.themeElements&&c.themeElements.clrScheme&&(a.color.rgb=kY(c.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==g[g.length-1]&&e.CellXf.push(a);break;case 35:h=!0;break;case 36:h=!1;break;case 37:g.push(f),h=!0;break;case 38:g.pop(),h=!1;break;default:if(b.T>0)g.push(f);else if(b.T<0)g.pop();else if(!h||d.WTF&&37!=g[g.length-1])throw Error("Unexpected record 0x"+f.toString(16))}}),e}return k9(a,c,d)}(hg(a,ni(v.style)),v.style,x,b))}v.links.map(function(c){try{jp(hh(a,jo(ni(c))),c);var d=hg(a,ni(c)),e=c,f=b;if(".bin"===e.slice(-4)){if(!d)return d;var g=f||{},h=!1;return void iB(d,function(a,b,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:h=!0;break;case 36:h=!1;break;default:if(b.T);else if(!h||g.WTF)throw Error("Unexpected record 0x"+c.toString(16))}},g)}return}catch(a){}});var z=function(a,b,c){if(".bin"===b.slice(-4)){var d,e,f,g,h,i;return e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},f=[],g=!1,(d=c)||(d={}),d.biff=12,h=[],(i=[[]]).SheetNames=[],i.XTI=[],mN[16]={n:"BrtFRTArchID$",f:mB},iB(a,function(a,b,c){switch(c){case 156:i.SheetNames.push(a.name),e.Sheets.push(a);break;case 153:e.WBProps=a;break;case 39:null!=a.Sheet&&(d.SID=a.Sheet),a.Ref=lU(a.Ptg,null,null,i,d),delete d.SID,delete a.Ptg,h.push(a);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([c,a]):i[0]=[c,a],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(a),i.XTI=i.XTI.concat(a);break;case 35:case 37:f.push(c),g=!0;break;case 36:case 38:f.pop(),g=!1;break;default:if(b.T);else if(!g||d.WTF&&37!=f[f.length-1]&&35!=f[f.length-1])throw Error("Unexpected record 0x"+c.toString(16))}},d),mw(e),e.Names=h,e.supbooks=i,e}return function(a,b){if(!a)throw Error("Could not find file");var c={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},d=!1,e="xmlns",f={},g=0;if(a.replace(hq,function(h,i){var j=ht(h);switch(hu(j[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":h.match(mz)&&(e="xmlns"+h.match(/<(\w+):/)[1]),c.xmlns=j[e];break;case"<fileVersion":delete j[0],c.AppVersion=j;break;case"<workbookPr":case"<workbookPr/>":mq.forEach(function(a){if(null!=j[a[0]])switch(a[2]){case"bool":c.WBProps[a[0]]=hF(j[a[0]]);break;case"int":c.WBProps[a[0]]=parseInt(j[a[0]],10);break;default:c.WBProps[a[0]]=j[a[0]]}}),j.codeName&&(c.WBProps.CodeName=hK(j.codeName));break;case"<workbookView":case"<workbookView/>":delete j[0],c.WBView.push(j);break;case"<sheet":switch(j.state){case"hidden":j.Hidden=1;break;case"veryHidden":j.Hidden=2;break;default:j.Hidden=0}delete j.state,j.name=hx(hK(j.name)),delete j[0],c.Sheets.push(j);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":d=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":d=!1;break;case"<definedName":(f={}).Name=hK(j.name),j.comment&&(f.Comment=j.comment),j.localSheetId&&(f.Sheet=+j.localSheetId),hF(j.hidden||"0")&&(f.Hidden=!0),g=i+h.length;break;case"</definedName>":f.Ref=hx(hK(a.slice(g,i))),c.Names.push(f);break;case"<calcPr":case"<calcPr/>":delete j[0],c.CalcPr=j;break;default:if(!d&&b.WTF)throw Error("unrecognized "+j[0]+" in workbook")}return h}),-1===h$.indexOf(c.xmlns))throw Error("Unknown Namespace: "+c.xmlns);return mw(c),c}(a,c)}(hg(a,ni(v.workbooks[0])),v.workbooks[0],b),A={},B="";v.coreprops.length&&((B=hg(a,ni(v.coreprops[0]),!0))&&(A=jw(B)),0!==v.extprops.length)&&(B=hg(a,ni(v.extprops[0]),!0))&&(h=B,i=A,j=b,k={},i||(i={}),h=hK(h),jz.forEach(function(a){var b=(h.match(hM(a[0]))||[])[1];switch(a[2]){case"string":b&&(i[a[1]]=hx(b));break;case"bool":i[a[1]]="true"===b;break;case"raw":var c=h.match(RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(k[a[1]]=c[1])}}),k.HeadingPairs&&k.TitlesOfParts&&jB(k.HeadingPairs,k.TitlesOfParts,i,j));var C={};(!b.bookSheets||b.bookProps)&&0!==v.custprops.length&&(B=hh(a,ni(v.custprops[0]),!0))&&(C=function(a,b){var c={},d="",e=a.match(jD);if(e)for(var f=0;f!=e.length;++f){var g=e[f],h=ht(g);switch(h[0]){case"<?xml":case"<Properties":break;case"<property":d=hx(h.name);break;case"</property>":d=null;break;default:if(0===g.indexOf("<vt:")){var i=g.split(">"),j=i[0].slice(4),k=i[1];switch(j){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":c[d]=hx(k);break;case"bool":c[d]=hF(k);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":c[d]=parseInt(k,10);break;case"r4":case"r8":case"decimal":c[d]=parseFloat(k);break;case"filetime":case"date":c[d]=g4(k);break;default:if("/"==j.slice(-1))break;b.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",g,j,i)}}else if("</"===g.slice(0,2));else if(b.WTF)throw Error(g)}}return c}(B,b));var D={};if((b.bookSheets||b.bookProps)&&(z.Sheets?p=z.Sheets.map(function(a){return a.name}):A.Worksheets&&A.SheetNames.length>0&&(p=A.SheetNames),b.bookProps&&(D.Props=A,D.Custprops=C),b.bookSheets&&void 0!==p&&(D.SheetNames=p),b.bookSheets?D.SheetNames:b.bookProps))return D;p={};var E={};b.bookDeps&&v.calcchain&&(E=function(a,b,c){if(".bin"===b.slice(-4)){var d;return d=[],iB(a,function(a,b,c){if(63===c)d.push(a);else if(b.T);else if(1)throw Error("Unexpected record 0x"+c.toString(16))}),d}var e=[];if(!a)return e;var f=1;return(a.match(hq)||[]).forEach(function(a){var b=ht(a);switch(b[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete b[0],b.i?f=b.i:b.i=f,e.push(b)}}),e}(hg(a,ni(v.calcchain)),v.calcchain,b));var F=0,G={},H=z.Sheets;A.Worksheets=H.length,A.SheetNames=[];for(var I=0;I!=H.length;++I)A.SheetNames[I]=H[I].name;var J=w?"bin":"xml",K=v.workbooks[0].lastIndexOf("/"),L=(v.workbooks[0].slice(0,K+1)+"_rels/"+v.workbooks[0].slice(K+1)+".rels").replace(/^\//,"");he(a,L)||(L="xl/_rels/workbook."+J+".rels");var M=jp(hh(a,L,!0),L.replace(/_rels.*/,"s5s"));(v.metadata||[]).length>=1&&(b.xlmeta=function(a,b,c){if(".bin"===b.slice(-4)){var d,e,f,g,h;return d={Types:[],Cell:[],Value:[]},e=c||{},f=[],g=!1,h=2,iB(a,function(a,b,c){switch(c){case 335:d.Types.push({name:a.name});break;case 51:a.forEach(function(a){1==h?d.Cell.push({type:d.Types[a[0]-1].name,index:a[1]}):0==h&&d.Value.push({type:d.Types[a[0]-1].name,index:a[1]})});break;case 337:h=+!!a;break;case 338:h=2;break;case 35:f.push(c),g=!0;break;case 36:f.pop(),g=!1;break;default:if(b.T);else if(!g||e.WTF&&35!=f[f.length-1])throw Error("Unexpected record 0x"+c.toString(16))}}),d}var i,j={Types:[],Cell:[],Value:[]};if(!a)return j;var k=!1,l=2;return a.replace(hq,function(a){var b=ht(a);switch(hu(b[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":j.Types.push({name:b.name});break;case"<futureMetadata":for(var d=0;d<j.Types.length;++d)j.Types[d].name==b.name&&(i=j.Types[d]);break;case"<rc":1==l?j.Cell.push({type:j.Types[b.t-1].name,index:+b.v}):0==l&&j.Value.push({type:j.Types[b.t-1].name,index:+b.v});break;case"<cellMetadata":l=1;break;case"</cellMetadata>":case"</valueMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"<ext":k=!0;break;case"</ext>":k=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+b.i);break;default:if(!k&&c.WTF)throw Error("unrecognized "+b[0]+" in metadata")}return a}),j}(hg(a,ni(v.metadata[0])),v.metadata[0],b)),(v.people||[]).length>=1&&(b.people=(l=hg(a,ni(v.people[0])),m=b,n=[],o=!1,l.replace(hq,function(a){var b=ht(a);switch(hu(b[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:b.displayname,id:b.id});break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(!o&&m.WTF)throw Error("unrecognized "+b[0]+" in threaded comments")}return a}),n)),M&&(M=function(a,b){if(!a)return 0;try{a=b.map(function(b){var c;return b.id||(b.id=b.strRelID),[b.name,a["!id"][b.id].Target,(c=a["!id"][b.id].Type,jn.WS.indexOf(c)>-1?"sheet":jn.CS&&c==jn.CS?"chart":jn.DS&&c==jn.DS?"dialog":jn.MS&&c==jn.MS?"macro":c&&c.length?c:"sheet")]})}catch(a){return null}return a&&0!==a.length?a:null}(M,z.Sheets));var N=+!!hg(a,"xl/worksheets/sheet.xml",!0);for(F=0;F!=A.Worksheets;++F){var O="sheet";if(M&&M[F]?(he(a,r="xl/"+M[F][1].replace(/[\/]?xl\//,""))||(r=M[F][1]),he(a,r)||(r=L.replace(/_rels\/.*$/,"")+M[F][1]),O=M[F][2]):r=(r="xl/worksheets/sheet"+(F+1-N)+"."+J).replace(/sheet0\./,"sheet."),s=r.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),b&&null!=b.sheets)switch(typeof b.sheets){case"number":if(F!=b.sheets)continue;break;case"string":if(A.SheetNames[F].toLowerCase()!=b.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(b.sheets)){for(var P=!1,Q=0;Q!=b.sheets.length;++Q)"number"==typeof b.sheets[Q]&&b.sheets[Q]==F&&(P=1),"string"==typeof b.sheets[Q]&&b.sheets[Q].toLowerCase()==A.SheetNames[F].toLowerCase()&&(P=1);if(!P)continue}}!function(a,b,c,d,e,f,g,h,i,j,k,l){try{f[d]=jp(hh(a,c,!0),b);var m,n,o=hg(a,b);switch(h){case"sheet":m=f[d],n=".bin"===b.slice(-4)?function(a,b,c,d,e,f,g){if(!a)return a;var h,i,j,k,l,m,n,o,p,q,r,s,t=b||{};d||(d={"!id":{}});var u=t.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],x=!1,y=!1,z=[];t.biff=12,t["!row"]=0;var A=0,B=!1,C=[],D={},E=t.supbooks||e.supbooks||[[]];if(E.sharedf=D,E.arrayf=C,E.SheetNames=e.SheetNames||e.Sheets.map(function(a){return a.name}),!t.supbooks&&(t.supbooks=E,e.Names))for(var F=0;F<e.Names.length;++F)E[0][F+1]=e.Names[F];var G=[],H=[],I=!1;if(mN[16]={n:"BrtShortReal",f:mo},iB(a,function(a,b,F){if(!y)switch(F){case 148:h=a;break;case 0:i=a,t.sheetRows&&t.sheetRows<=i.r&&(y=!0),p=iJ(l=i.r),t["!row"]=i.r,(a.hidden||a.hpt||null!=a.level)&&(a.hpt&&(a.hpx=k5(a.hpt)),H[a.r]=a);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(j={t:a[2]},a[2]){case"n":j.v=a[1];break;case"s":o=l0[a[1]],j.v=o.t,j.r=o.r;break;case"b":j.v=!!a[1];break;case"e":j.v=a[1],!1!==t.cellText&&(j.w=jh[j.v]);break;case"str":j.t="s",j.v=a[1];break;case"is":j.t="s",j.v=a[1].t}if((k=g.CellXf[a[0].iStyleRef])&&l7(j,k.numFmtId,null,t,f,g),m=-1==a[0].c?m+1:a[0].c,t.dense?(u[l]||(u[l]=[]),u[l][m]=j):u[iL(m)+p]=j,t.cellFormula){for(A=0,B=!1;A<C.length;++A){var J=C[A];i.r>=J[0].s.r&&i.r<=J[0].e.r&&m>=J[0].s.c&&m<=J[0].e.c&&(j.F=iP(J[0]),B=!0)}!B&&a.length>3&&(j.f=a[3])}if(v.s.r>i.r&&(v.s.r=i.r),v.s.c>m&&(v.s.c=m),v.e.r<i.r&&(v.e.r=i.r),v.e.c<m&&(v.e.c=m),t.cellDates&&k&&"n"==j.t&&gH(gk[k.numFmtId])){var K=go(j.v);K&&(j.t="d",j.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}r&&("XLDAPR"==r.type&&(j.D=!0),r=void 0),s&&(s=void 0);break;case 1:case 12:if(!t.sheetStubs||x)break;j={t:"z",v:void 0},m=-1==a[0].c?m+1:a[0].c,t.dense?(u[l]||(u[l]=[]),u[l][m]=j):u[iL(m)+p]=j,v.s.r>i.r&&(v.s.r=i.r),v.s.c>m&&(v.s.c=m),v.e.r<i.r&&(v.e.r=i.r),v.e.c<m&&(v.e.c=m),r&&("XLDAPR"==r.type&&(j.D=!0),r=void 0),s&&(s=void 0);break;case 176:z.push(a);break;case 49:r=((t.xlmeta||{}).Cell||[])[a-1];break;case 494:var L=d["!id"][a.relId];for(L?(a.Target=L.Target,a.loc&&(a.Target+="#"+a.loc),a.Rel=L):""==a.relId&&(a.Target="#"+a.loc),l=a.rfx.s.r;l<=a.rfx.e.r;++l)for(m=a.rfx.s.c;m<=a.rfx.e.c;++m)t.dense?(u[l]||(u[l]=[]),u[l][m]||(u[l][m]={t:"z",v:void 0}),u[l][m].l=a):(u[n=iN({c:m,r:l})]||(u[n]={t:"z",v:void 0}),u[n].l=a);break;case 426:if(!t.cellFormula)break;C.push(a),(q=t.dense?u[l][m]:u[iL(m)+p]).f=lU(a[1],v,{r:i.r,c:m},E,t),q.F=iP(a[0]);break;case 427:if(!t.cellFormula)break;D[iN(a[0].s)]=a[1],(q=t.dense?u[l][m]:u[iL(m)+p]).f=lU(a[1],v,{r:i.r,c:m},E,t);break;case 60:if(!t.cellStyles)break;for(;a.e>=a.s;)G[a.e--]={width:a.w/256,hidden:!!(1&a.flags),level:a.level},I||(I=!0,k2(a.w/256)),k3(G[a.e+1]);break;case 161:u["!autofilter"]={ref:iP(a)};break;case 476:u["!margins"]=a;break;case 147:e.Sheets[c]||(e.Sheets[c]={}),a.name&&(e.Sheets[c].CodeName=a.name),(a.above||a.left)&&(u["!outline"]={above:a.above,left:a.left});break;case 137:e.Views||(e.Views=[{}]),e.Views[0]||(e.Views[0]={}),a.RTL&&(e.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:w.push(F),x=!0;break;case 38:w.pop(),x=!1;break;default:if(b.T);else if(!x||t.WTF)throw Error("Unexpected record 0x"+F.toString(16))}},t),delete t.supbooks,delete t["!row"],!u["!ref"]&&(v.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=iP(h||v)),t.sheetRows&&u["!ref"]){var J=iQ(u["!ref"]);t.sheetRows<=+J.e.r&&(J.e.r=t.sheetRows-1,J.e.r>v.e.r&&(J.e.r=v.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>v.e.c&&(J.e.c=v.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),u["!fullref"]=u["!ref"],u["!ref"]=iP(J))}return z.length>0&&(u["!merges"]=z),G.length>0&&(u["!cols"]=G),H.length>0&&(u["!rows"]=H),u}(o,i,e,m,j,k,l):function(a,b,c,d,e,f,g){if(!a)return a;d||(d={"!id":{}});var h=b.dense?[]:{},i={s:{r:2e6,c:2e6},e:{r:0,c:0}},j="",k="",l=a.match(l9);l?(j=a.slice(0,l.index),k=a.slice(l.index+l[0].length)):j=k=a;var m=j.match(mf);m?mi(m[0],h,e,c):(m=j.match(mg))&&(o=m[0],p=m[1],q=h,r=e,s=c,mi(o.slice(0,o.indexOf(">")),q,r,s));var n=(j.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(n>0){var o,p,q,r,s,t,u=j.slice(n,n+50).match(mb);u&&(t=iQ(u[1])).s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(h["!ref"]=iP(t))}var v=j.match(mh);v&&v[1]&&function(a,b){b.Views||(b.Views=[{}]),(a.match(ml)||[]).forEach(function(a,c){var d=ht(a);b.Views[c]||(b.Views[c]={}),+d.zoomScale&&(b.Views[c].zoom=+d.zoomScale),hF(d.rightToLeft)&&(b.Views[c].RTL=!0)})}(v[1],e);var w=[];if(b.cellStyles){var x=j.match(mc);x&&function(a,b){for(var c=!1,d=0;d!=b.length;++d){var e=ht(b[d],!0);e.hidden&&(e.hidden=hF(e.hidden));var f=parseInt(e.min,10)-1,g=parseInt(e.max,10)-1;for(e.outlineLevel&&(e.level=+e.outlineLevel||0),delete e.min,delete e.max,e.width=+e.width,!c&&e.width&&(c=!0,k2(e.width)),k3(e);f<=g;)a[f++]=g6(e)}}(w,x)}l&&mm(l[1],h,b,i,f,g);var y=k.match(md);y&&(h["!autofilter"]={ref:(y[0].match(/ref="([^"]*)"/)||[])[1]});var z=[],A=k.match(l8);if(A)for(n=0;n!=A.length;++n)z[n]=iQ(A[n].slice(A[n].indexOf('"')+1));var B=k.match(ma);B&&function(a,b,c){for(var d=Array.isArray(a),e=0;e!=b.length;++e){var f=ht(hK(b[e]),!0);if(!f.ref)return;var g=((c||{})["!id"]||[])[f.id];g?(f.Target=g.Target,f.location&&(f.Target+="#"+hx(f.location))):(f.Target="#"+hx(f.location),g={Target:f.Target,TargetMode:"Internal"}),f.Rel=g,f.tooltip&&(f.Tooltip=f.tooltip,delete f.tooltip);for(var h=iQ(f.ref),i=h.s.r;i<=h.e.r;++i)for(var j=h.s.c;j<=h.e.c;++j){var k=iN({c:j,r:i});d?(a[i]||(a[i]=[]),a[i][j]||(a[i][j]={t:"z",v:void 0}),a[i][j].l=f):(a[k]||(a[k]={t:"z",v:void 0}),a[k].l=f)}}}(h,B,d);var C=k.match(me);if(C&&(h["!margins"]=function(a){var b={};return["left","right","top","bottom","header","footer"].forEach(function(c){a[c]&&(b[c]=parseFloat(a[c]))}),b}(ht(C[0]))),!h["!ref"]&&i.e.c>=i.s.c&&i.e.r>=i.s.r&&(h["!ref"]=iP(i)),b.sheetRows>0&&h["!ref"]){var D=iQ(h["!ref"]);b.sheetRows<=+D.e.r&&(D.e.r=b.sheetRows-1,D.e.r>i.e.r&&(D.e.r=i.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>i.e.c&&(D.e.c=i.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),h["!fullref"]=h["!ref"],h["!ref"]=iP(D))}return w.length>0&&(h["!cols"]=w),z.length>0&&(h["!merges"]=z),h}(o,i,e,m,j,k,l);break;case"chart":if(!(n=function(a,b,c,d,e,f,g,h){if(".bin"===b.slice(-4)){var i=e;if(!a)return a;i||(i={"!id":{}});var j={"!type":"chart","!drawel":null,"!rel":""},k=[],l=!1;return iB(a,function(a,b,e){switch(e){case 550:j["!rel"]=a;break;case 651:f.Sheets[c]||(f.Sheets[c]={}),a.name&&(f.Sheets[c].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:k.push(e);break;case 38:k.pop();break;default:if(b.T>0)k.push(e);else if(b.T<0)k.pop();else if(!l||d.WTF)throw Error("Unexpected record 0x"+e.toString(16))}},d),i["!id"][j["!rel"]]&&(j["!drawel"]=i["!id"][j["!rel"]]),j}var m=e;if(!a)return a;m||(m={"!id":{}});var n,o={"!type":"chart","!drawel":null,"!rel":""},p=a.match(mf);return p&&mi(p[0],o,f,c),(n=a.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=n[1]),m["!id"][o["!rel"]]&&(o["!drawel"]=m["!id"][o["!rel"]]),o}(o,b,e,i,f[d],j,0,0))||!n["!drawel"])break;var p=hm(n["!drawel"].Target,b),q=jo(p),r=function(a,b){if(!a)return"??";var c=(a.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return b["!id"][c].Target}(hh(a,p,!0),jp(hh(a,q,!0),p)),s=hm(r,p),t=jo(s);n=function(a,b,c,d,e,f){var g=f||{"!type":"chart"};if(!a)return f;var h=0,i=0,j="A",k={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(a.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(a){var b,c,d,e,f=(c=[],d=a.match(/^<c:numCache>/),(a.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var b=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);b&&(c[+b[1]]=d?+b[2]:b[2])}),e=hx((a.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]),(a.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){b=a.replace(/<.*?>/g,"")}),[c,e,b]);k.s.r=k.s.c=0,k.e.c=h,j=iL(h),f[0].forEach(function(a,b){g[j+iJ(b)]={t:"n",v:a,z:f[1]},i=b}),k.e.r<i&&(k.e.r=i),++h}),h>0&&(g["!ref"]=iP(k)),g}(hh(a,s,!0),0,0,jp(hh(a,t,!0),s),0,n);break;case"macro":f[d],b.slice(-4),n={"!type":"macro"};break;case"dialog":f[d],b.slice(-4),n={"!type":"dialog"};break;default:throw Error("Unrecognized sheet type "+h)}g[d]=n;var u=[];f&&f[d]&&gT(f[d]).forEach(function(c){var e,g,h,j,k,l="";if(f[d][c].Type==jn.CMNT){l=hm(f[d][c].Target,b);var m=function(a,b,c){if(".bin"===b.slice(-4)){var d,e,f,g;return d=[],e=[],f={},g=!1,iB(a,function(a,b,h){switch(h){case 632:e.push(a);break;case 635:f=a;break;case 637:f.t=a.t,f.h=a.h,f.r=a.r;break;case 636:if(f.author=e[f.iauthor],delete f.iauthor,c.sheetRows&&f.rfx&&c.sheetRows<=f.rfx.r)break;f.t||(f.t=""),delete f.rfx,d.push(f);break;case 3072:case 37:case 38:break;case 35:g=!0;break;case 36:g=!1;break;default:if(b.T);else if(!g||c.WTF)throw Error("Unexpected record 0x"+h.toString(16))}}),d}if(a.match(/<(?:\w+:)?comments *\/>/))return[];var h=[],i=[],j=a.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);j&&j[1]&&j[1].split(/<\/\w*:?author>/).forEach(function(a){if(""!==a&&""!==a.trim()){var b=a.match(/<(?:\w+:)?author[^>]*>(.*)/);b&&h.push(b[1])}});var k=a.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return k&&k[1]&&k[1].split(/<\/\w*:?comment>/).forEach(function(a){if(""!==a&&""!==a.trim()){var b=a.match(/<(?:\w+:)?comment[^>]*>/);if(b){var d=ht(b[0]),e={author:d.authorId&&h[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},f=iM(d.ref);if(!c.sheetRows||!(c.sheetRows<=f.r)){var g=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),j=!!g&&!!g[1]&&kH(g[1])||{r:"",t:"",h:""};e.r=j.r,"<t></t>"==j.r&&(j.t=j.h=""),e.t=(j.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),c.cellHTML&&(e.h=j.h),i.push(e)}}}}),i}(hg(a,l,!0),l,i);if(!m||!m.length)return;ls(n,m,!1)}f[d][c].Type==jn.TCMNT&&(l=hm(f[d][c].Target,b),u=u.concat((e=hg(a,l,!0),g=[],h=!1,j={},k=0,e.replace(hq,function(a,b){var c=ht(a);switch(hu(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":j={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=j.t&&g.push(j);break;case"<text>":case"<text":k=b+a.length;break;case"</text>":j.t=e.slice(k,b).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":h=!0;break;case"</mentions>":case"</ext>":h=!1;break;default:if(!h&&i.WTF)throw Error("unrecognized "+c[0]+" in threaded comments")}return a}),g)))}),u&&u.length&&ls(n,u,!0,i.people||[])}catch(a){if(i.WTF)throw a}}(a,r,s,A.SheetNames[F],F,G,p,O,b,z,x,y)}return D={Directory:v,Workbook:z,Props:A,Custprops:C,Deps:E,Sheets:p,SheetNames:A.SheetNames,Strings:l0,Styles:y,Themes:x,SSF:g6(gk)},b&&b.bookFiles&&(a.files?(D.keys=u,D.files=a.files):(D.keys=[],D.files={},a.FullPaths.forEach(function(b,c){b=b.replace(/^Root Entry[\/]/,""),D.keys.push(b),D.files[b]=a.FileIndex[c]}))),b&&b.bookVBA&&(v.vba.length>0?D.vbaraw=hg(a,ni(v.vba[0]),!0):v.defaults&&"application/vnd.ms-office.vbaProject"===v.defaults.bin&&(D.vbaraw=hg(a,"xl/vbaProject.bin",!0))),D}(hl(c,e),e)):nl(a,m,l,o);case 239:return 60===n[3]?mG(m,l):nl(a,m,l,o);case 255:if(254===n[1])return i=m,j=l,k=i,"base64"==j.type&&(k=f0(k)),k=h.utils.decode(1200,k.slice(2),"str"),j.type="binary",nk(k,j);if(0===n[1]&&2===n[2]&&0===n[3])return kB.to_workbook(m,l);break;case 0:if(0===n[1]&&(n[2]>=2&&0===n[3]||0===n[2]&&(8===n[3]||9===n[3])))return kB.to_workbook(m,l);break;case 3:case 131:case 139:case 140:return kw.to_workbook(m,l);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return kW.to_workbook(m,l);break;case 10:case 13:case 32:var v=m,w=l,x="",y=nj(v,w);switch(w.type){case"base64":x=f0(v);break;case"binary":x=v;break;case"buffer":x=v.toString("binary");break;case"array":x=g5(v);break;default:throw Error("Unrecognized type "+w.type)}return 239==y[0]&&187==y[1]&&191==y[2]&&(x=hK(x)),w.type="binary",nk(x,w);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw Error("PNG Image File is not a spreadsheet")}return kv.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?kw.to_workbook(m,l):nl(a,m,l,o)}function nn(a,b){switch(b.type){case"base64":case"binary":break;case"buffer":case"array":b.type="";break;case"file":return gS(b.file,gR.write(a,{type:f1?"buffer":""}));case"string":throw Error("'string' output type invalid for '"+b.bookType+"' files");default:throw Error("Unrecognized type "+b.type)}return gR.write(a,b)}function no(a,b,c){c||(c="");var d=c+a;switch(b.type){case"base64":return f_(hL(d));case"binary":return hL(d);case"string":return a;case"file":return gS(b.file,d,"utf8");case"buffer":if(f1)return f2(d,"utf8");if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(d);return no(d,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw Error("Unrecognized type "+b.type)}function np(a,b){switch(b.type){case"string":case"base64":case"binary":for(var c="",d=0;d<a.length;++d)c+=String.fromCharCode(a[d]);return"base64"==b.type?f_(c):"string"==b.type?hK(c):c;case"file":return gS(b.file,a);case"buffer":return a;default:throw Error("Unrecognized type "+b.type)}}function nq(a,b){if(null==a||null==a["!ref"])return[];var c={t:"n",v:0},d=0,e=1,f=[],g=0,h="",i={s:{r:0,c:0},e:{r:0,c:0}},j=b||{},k=null!=j.range?j.range:a["!ref"];switch(1===j.header?d=1:"A"===j.header?d=2:Array.isArray(j.header)?d=3:null==j.header&&(d=0),typeof k){case"string":i=iQ(k);break;case"number":(i=iQ(a["!ref"])).s.r=k;break;default:i=k}d>0&&(e=0);var l=iJ(i.s.r),m=[],n=[],o=0,p=0,q=Array.isArray(a),r=i.s.r,s=0,t={};q&&!a[r]&&(a[r]=[]);var u=j.skipHidden&&a["!cols"]||[],v=j.skipHidden&&a["!rows"]||[];for(s=i.s.c;s<=i.e.c;++s)if(!(u[s]||{}).hidden)switch(m[s]=iL(s),c=q?a[r][s]:a[m[s]+l],d){case 1:f[s]=s-i.s.c;break;case 2:f[s]=m[s];break;case 3:f[s]=j.header[s-i.s.c];break;default:if(null==c&&(c={w:"__EMPTY",t:"s"}),h=g=iS(c,null,j),p=t[g]||0){do h=g+"_"+p++;while(t[h]);t[g]=p,t[h]=1}else t[g]=1;f[s]=h}for(r=i.s.r+e;r<=i.e.r;++r)if(!(v[r]||{}).hidden){var w=function(a,b,c,d,e,f,g,h){var i=iJ(c),j=h.defval,k=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),l=!0,m=1===e?[]:{};if(1!==e)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:c,enumerable:!1})}catch(a){m.__rowNum__=c}else m.__rowNum__=c;if(!g||a[c])for(var n=b.s.c;n<=b.e.c;++n){var o=g?a[c][n]:a[d[n]+i];if(void 0===o||void 0===o.t){if(void 0===j)continue;null!=f[n]&&(m[f[n]]=j);continue}var p=o.v;switch(o.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw Error("unrecognized type "+o.t)}if(null!=f[n]){if(null==p)if("e"==o.t&&null===p)m[f[n]]=null;else if(void 0!==j)m[f[n]]=j;else{if(!k||null!==p)continue;m[f[n]]=null}else m[f[n]]=k&&("n"!==o.t||"n"===o.t&&!1!==h.rawNumbers)?p:iS(o,p,h);null!=p&&(l=!1)}}return{row:m,isempty:l}}(a,i,r,m,d,f,q,j);(!1===w.isempty||(1===d?!1!==j.blankrows:j.blankrows))&&(n[o++]=w.row)}return n.length=o,n}var nr=/"/g;function ns(a,b){var c=[],d=null==b?{}:b;if(null==a||null==a["!ref"])return"";var e=iQ(a["!ref"]),f=void 0!==d.FS?d.FS:",",g=f.charCodeAt(0),h=void 0!==d.RS?d.RS:"\n",i=h.charCodeAt(0),j=RegExp(("|"==f?"\\|":f)+"+$"),k="",l=[];d.dense=Array.isArray(a);for(var m=d.skipHidden&&a["!cols"]||[],n=d.skipHidden&&a["!rows"]||[],o=e.s.c;o<=e.e.c;++o)(m[o]||{}).hidden||(l[o]=iL(o));for(var p=0,q=e.s.r;q<=e.e.r;++q)!(n[q]||{}).hidden&&null!=(k=function(a,b,c,d,e,f,g,h){for(var i=!0,j=[],k="",l=iJ(c),m=b.s.c;m<=b.e.c;++m)if(d[m]){var n=h.dense?(a[c]||[])[m]:a[d[m]+l];if(null==n)k="";else if(null!=n.v){i=!1,k=""+(h.rawNumbers&&"n"==n.t?n.v:iS(n,null,h));for(var o=0,p=0;o!==k.length;++o)if((p=k.charCodeAt(o))===e||p===f||34===p||h.forceQuotes){k='"'+k.replace(nr,'""')+'"';break}"ID"==k&&(k='"ID"')}else null==n.f||n.F?k="":(i=!1,(k="="+n.f).indexOf(",")>=0&&(k='"'+k.replace(nr,'""')+'"'));j.push(k)}return!1===h.blankrows&&i?null:j.join(g)}(a,e,q,l,g,i,f,d))&&(d.strip&&(k=k.replace(j,"")),(k||!1!==d.blankrows)&&c.push((p++?h:"")+k));return delete d.dense,c.join("")}function nt(){return{SheetNames:[],Sheets:{}}}function nu(a,b,c,d){var e=1;if(!c)for(;e<=65535&&-1!=a.SheetNames.indexOf(c="Sheet"+e);++e,c=void 0);if(!c||a.SheetNames.length>=65535)throw Error("Too many worksheets");if(d&&a.SheetNames.indexOf(c)>=0){var f=c.match(/(^.*?)(\d+)$/);e=f&&+f[2]||0;var g=f&&f[1]||c;for(++e;e<=65535&&-1!=a.SheetNames.indexOf(c=g+e);++e);}if(my(c),a.SheetNames.indexOf(c)>=0)throw Error("Worksheet with name |"+c+"| already exists!");return a.SheetNames.push(c),a.Sheets[c]=b,c}var nv={encode_cell:iN,encode_range:iP,decode_range:iO,sheet_to_json:nq};function nw(){let{projectData:a,setProjectData:b,setMapping:c}=D(),[d,e]=(0,w.useState)(!1),[f,g]=(0,w.useState)(null);return(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold",children:"\xc9tape 2 : D\xe9finition du Contexte"}),(0,v.jsx)("p",{className:"text-slate-600",children:"Chargez un fichier Excel (.xlsx) et d\xe9finissez les colonnes de travail."}),(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsx)(aU,{children:"Chargement du Fichier"})}),(0,v.jsx)(aV,{children:a?(0,v.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-100 rounded-md",children:[(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)(fM,{className:"w-6 h-6 text-slate-700"}),(0,v.jsx)("p",{className:"ml-4 font-medium",children:a.fileName})]}),(0,v.jsx)(aR,{variant:"link",size:"sm",onClick:()=>b(null),children:"Changer"})]}):(0,v.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-slate-50",children:[d?(0,v.jsx)(fy.A,{className:"w-8 h-8 text-slate-500 animate-spin"}):(0,v.jsx)(fL,{className:"w-8 h-8 text-slate-500"}),(0,v.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:d?"Analyse du fichier...":"Cliquez ou glissez-d\xe9posez un fichier .xlsx"}),(0,v.jsx)("input",{type:"file",className:"hidden",accept:".xlsx",onChange:a=>{let c=a.target.files?.[0];if(!c)return;e(!0);let d=new FileReader;d.onload=a=>{try{let d=a.target?.result,e=nm(d,{type:"binary"}),f=e.SheetNames.map(a=>{let b=e.Sheets[a],c=nv.sheet_to_json(b,{header:1}),d=c.length>0?c[0].map(String):[],f=nv.sheet_to_json(b);return{name:a,columns:d,rows:f,questionColumn:null,answerColumn:null}});if(0===f.length||f.every(a=>0===a.columns.length))return void fD.oR.error("Le fichier semble vide ou ne contient pas d'en-t\xeates.");let h={fileName:c.name,workbookBinary:d,sheets:f};b(h),g(f[0].name)}catch(a){console.error("Erreur lors de la lecture du fichier Excel :",a),fD.oR.error("Le format du fichier est invalide.",{description:"Veuillez v\xe9rifier qu'il s'agit d'un fichier .xlsx valide."})}finally{e(!1)}},d.readAsBinaryString(c)},disabled:d})]})})]}),a&&(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsx)(aU,{children:"Mapping des Colonnes"})}),(0,v.jsxs)(aV,{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Onglet"}),(0,v.jsxs)(eI,{value:f??void 0,onValueChange:g,children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{placeholder:"Choisir un onglet"})}),(0,v.jsx)(eL,{children:a.sheets.map(a=>(0,v.jsx)(eM,{value:a.name,children:a.name},a.name))})]})]}),f&&(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(()=>{let b=a.sheets.find(a=>a.name===f);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Colonne des Questions"}),(0,v.jsxs)(eI,{onValueChange:a=>c(b.name,"question",a),value:b.questionColumn||void 0,children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{placeholder:"Choisir une colonne..."})}),(0,v.jsx)(eL,{children:b.columns.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"text-sm font-medium",children:"Colonne des R\xe9ponses (R\xe9f\xe9rence)"}),(0,v.jsxs)(eI,{onValueChange:a=>c(b.name,"answer",a),value:b.answerColumn||void 0,children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{placeholder:"Choisir une colonne..."})}),(0,v.jsx)(eL,{children:b.columns.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]})]})})()}),(0,v.jsxs)("div",{className:"bg-slate-50 border rounded-md p-3 text-sm space-y-2",children:[(0,v.jsx)("p",{className:"font-medium text-slate-700",children:"Statut des onglets"}),(0,v.jsx)("ul",{className:"space-y-1 list-disc ml-5",children:a.sheets.map(a=>(0,v.jsxs)("li",{children:[(0,v.jsx)("span",{className:"font-semibold",children:a.name}),"  Q: ",a.questionColumn??"Non d\xe9fini"," / R: ",a.answerColumn??"Non d\xe9fini"]},a.name))})]})]})]})]})}fN.version;var nx=w.forwardRef((a,b)=>(0,v.jsx)(a5.label,{...a,ref:b,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));function ny({className:a,...b}){return(0,v.jsx)(nx,{"data-slot":"label",className:aP("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...b})}function nz({className:a,...b}){return(0,v.jsx)("textarea",{"data-slot":"textarea",className:aP("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}nx.displayName="Label";var nA="Progress",[nB,nC]=a$(nA),[nD,nE]=nB(nA),nF=w.forwardRef((a,b)=>{var c,d;let{__scopeProgress:e,value:f=null,max:g,getValueLabel:h=nI,...i}=a;(g||0===g)&&!nL(g)&&console.error((c=`${g}`,`Invalid prop \`max\` of value \`${c}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let j=nL(g)?g:100;null===f||nM(f,j)||console.error((d=`${f}`,`Invalid prop \`value\` of value \`${d}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let k=nM(f,j)?f:null,l=nK(k)?h(k,j):void 0;return(0,v.jsx)(nD,{scope:e,value:k,max:j,children:(0,v.jsx)(a5.div,{"aria-valuemax":j,"aria-valuemin":0,"aria-valuenow":nK(k)?k:void 0,"aria-valuetext":l,role:"progressbar","data-state":nJ(k,j),"data-value":k??void 0,"data-max":j,...i,ref:b})})});nF.displayName=nA;var nG="ProgressIndicator",nH=w.forwardRef((a,b)=>{let{__scopeProgress:c,...d}=a,e=nE(nG,c);return(0,v.jsx)(a5.div,{"data-state":nJ(e.value,e.max),"data-value":e.value??void 0,"data-max":e.max,...d,ref:b})});function nI(a,b){return`${Math.round(a/b*100)}%`}function nJ(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function nK(a){return"number"==typeof a}function nL(a){return nK(a)&&!isNaN(a)&&a>0}function nM(a,b){return nK(a)&&!isNaN(a)&&a<=b&&a>=0}function nN({className:a,value:b,...c}){return(0,v.jsx)(nF,{"data-slot":"progress",className:aP("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a),...c,children:(0,v.jsx)(nH,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(b||0)}%)`}})})}nH.displayName=nG;var nO="rovingFocusGroup.onEntryFocus",nP={bubbles:!1,cancelable:!0},nQ="RovingFocusGroup",[nR,nS,nT]=a_(nQ),[nU,nV]=a$(nQ,[nT]),[nW,nX]=nU(nQ),nY=w.forwardRef((a,b)=>(0,v.jsx)(nR.Provider,{scope:a.__scopeRovingFocusGroup,children:(0,v.jsx)(nR.Slot,{scope:a.__scopeRovingFocusGroup,children:(0,v.jsx)(nZ,{...a,ref:b})})}));nY.displayName=nQ;var nZ=w.forwardRef((a,b)=>{let{__scopeRovingFocusGroup:c,orientation:d,loop:e=!1,dir:f,currentTabStopId:g,defaultCurrentTabStopId:h,onCurrentTabStopIdChange:i,onEntryFocus:j,preventScrollOnEntryFocus:k=!1,...l}=a,m=w.useRef(null),n=I(b,m),o=a4(f),[p,q]=c_({prop:g,defaultProp:h??null,onChange:i,caller:nQ}),[r,s]=w.useState(!1),t=a6(j),u=nS(c),x=w.useRef(!1),[y,z]=w.useState(0);return w.useEffect(()=>{let a=m.current;if(a)return a.addEventListener(nO,t),()=>a.removeEventListener(nO,t)},[t]),(0,v.jsx)(nW,{scope:c,orientation:d,dir:o,loop:e,currentTabStopId:p,onItemFocus:w.useCallback(a=>q(a),[q]),onItemShiftTab:w.useCallback(()=>s(!0),[]),onFocusableItemAdd:w.useCallback(()=>z(a=>a+1),[]),onFocusableItemRemove:w.useCallback(()=>z(a=>a-1),[]),children:(0,v.jsx)(a5.div,{tabIndex:r||0===y?-1:0,"data-orientation":d,...l,ref:n,style:{outline:"none",...a.style},onMouseDown:aZ(a.onMouseDown,()=>{x.current=!0}),onFocus:aZ(a.onFocus,a=>{let b=!x.current;if(a.target===a.currentTarget&&b&&!r){let b=new CustomEvent(nO,nP);if(a.currentTarget.dispatchEvent(b),!b.defaultPrevented){let a=u().filter(a=>a.focusable);n1([a.find(a=>a.active),a.find(a=>a.id===p),...a].filter(Boolean).map(a=>a.ref.current),k)}}x.current=!1}),onBlur:aZ(a.onBlur,()=>s(!1))})})}),n$="RovingFocusGroupItem",n_=w.forwardRef((a,b)=>{let{__scopeRovingFocusGroup:c,focusable:d=!0,active:e=!1,tabStopId:f,children:g,...h}=a,i=br(),j=f||i,k=nX(n$,c),l=k.currentTabStopId===j,m=nS(c),{onFocusableItemAdd:n,onFocusableItemRemove:o,currentTabStopId:p}=k;return w.useEffect(()=>{if(d)return n(),()=>o()},[d,n,o]),(0,v.jsx)(nR.ItemSlot,{scope:c,id:j,focusable:d,active:e,children:(0,v.jsx)(a5.span,{tabIndex:l?0:-1,"data-orientation":k.orientation,...h,ref:b,onMouseDown:aZ(a.onMouseDown,a=>{d?k.onItemFocus(j):a.preventDefault()}),onFocus:aZ(a.onFocus,()=>k.onItemFocus(j)),onKeyDown:aZ(a.onKeyDown,a=>{if("Tab"===a.key&&a.shiftKey)return void k.onItemShiftTab();if(a.target!==a.currentTarget)return;let b=function(a,b,c){var d;let e=(d=a.key,"rtl"!==c?d:"ArrowLeft"===d?"ArrowRight":"ArrowRight"===d?"ArrowLeft":d);if(!("vertical"===b&&["ArrowLeft","ArrowRight"].includes(e))&&!("horizontal"===b&&["ArrowUp","ArrowDown"].includes(e)))return n0[e]}(a,k.orientation,k.dir);if(void 0!==b){if(a.metaKey||a.ctrlKey||a.altKey||a.shiftKey)return;a.preventDefault();let c=m().filter(a=>a.focusable).map(a=>a.ref.current);if("last"===b)c.reverse();else if("prev"===b||"next"===b){"prev"===b&&c.reverse();let d=c.indexOf(a.currentTarget);c=k.loop?function(a,b){return a.map((c,d)=>a[(b+d)%a.length])}(c,d+1):c.slice(d+1)}setTimeout(()=>n1(c))}}),children:"function"==typeof g?g({isCurrentTabStop:l,hasTabStop:null!=p}):g})})});n_.displayName=n$;var n0={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function n1(a,b=!1){let c=document.activeElement;for(let d of a)if(d===c||(d.focus({preventScroll:b}),document.activeElement!==c))return}var n2="Radio",[n3,n4]=a$(n2),[n5,n6]=n3(n2),n7=w.forwardRef((a,b)=>{let{__scopeRadio:c,name:d,checked:e=!1,required:f,disabled:g,value:h="on",onCheck:i,form:j,...k}=a,[l,m]=w.useState(null),n=I(b,a=>m(a)),o=w.useRef(!1),p=!l||j||!!l.closest("form");return(0,v.jsxs)(n5,{scope:c,checked:e,disabled:g,children:[(0,v.jsx)(a5.button,{type:"button",role:"radio","aria-checked":e,"data-state":ob(e),"data-disabled":g?"":void 0,disabled:g,value:h,...k,ref:n,onClick:aZ(a.onClick,a=>{e||i?.(),p&&(o.current=a.isPropagationStopped(),o.current||a.stopPropagation())})}),p&&(0,v.jsx)(oa,{control:l,bubbles:!o.current,name:d,value:h,checked:e,required:f,disabled:g,form:j,style:{transform:"translateX(-100%)"}})]})});n7.displayName=n2;var n8="RadioIndicator",n9=w.forwardRef((a,b)=>{let{__scopeRadio:c,forceMount:d,...e}=a,f=n6(n8,c);return(0,v.jsx)(eP,{present:d||f.checked,children:(0,v.jsx)(a5.span,{"data-state":ob(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:b})})});n9.displayName=n8;var oa=w.forwardRef(({__scopeRadio:a,control:b,checked:c,bubbles:d=!0,...e},f)=>{let g=w.useRef(null),h=I(g,f),i=c0(c),j=cG(b);return w.useEffect(()=>{let a=g.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(i!==c&&b){let e=new Event("click",{bubbles:d});b.call(a,c),a.dispatchEvent(e)}},[i,c,d]),(0,v.jsx)(a5.input,{type:"radio","aria-hidden":!0,defaultChecked:c,...e,tabIndex:-1,ref:h,style:{...e.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function ob(a){return a?"checked":"unchecked"}oa.displayName="RadioBubbleInput";var oc=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],od="RadioGroup",[oe,of]=a$(od,[nV,n4]),og=nV(),oh=n4(),[oi,oj]=oe(od),ok=w.forwardRef((a,b)=>{let{__scopeRadioGroup:c,name:d,defaultValue:e,value:f,required:g=!1,disabled:h=!1,orientation:i,dir:j,loop:k=!0,onValueChange:l,...m}=a,n=og(c),o=a4(j),[p,q]=c_({prop:f,defaultProp:e??null,onChange:l,caller:od});return(0,v.jsx)(oi,{scope:c,name:d,required:g,disabled:h,value:p,onValueChange:q,children:(0,v.jsx)(nY,{asChild:!0,...n,orientation:i,dir:o,loop:k,children:(0,v.jsx)(a5.div,{role:"radiogroup","aria-required":g,"aria-orientation":i,"data-disabled":h?"":void 0,dir:o,...m,ref:b})})})});ok.displayName=od;var ol="RadioGroupItem",om=w.forwardRef((a,b)=>{let{__scopeRadioGroup:c,disabled:d,...e}=a,f=oj(ol,c),g=f.disabled||d,h=og(c),i=oh(c),j=w.useRef(null),k=I(b,j),l=f.value===e.value,m=w.useRef(!1);return w.useEffect(()=>{let a=a=>{oc.includes(a.key)&&(m.current=!0)},b=()=>m.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,v.jsx)(n_,{asChild:!0,...h,focusable:!g,active:l,children:(0,v.jsx)(n7,{disabled:g,required:f.required,checked:l,...i,...e,name:f.name,ref:k,onCheck:()=>f.onValueChange(e.value),onKeyDown:aZ(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:aZ(e.onFocus,()=>{m.current&&j.current?.click()})})})});om.displayName=ol;var on=w.forwardRef((a,b)=>{let{__scopeRadioGroup:c,...d}=a,e=oh(c);return(0,v.jsx)(n9,{...e,...d,ref:b})});on.displayName="RadioGroupIndicator";let oo=(0,eE.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function op({className:a,...b}){return(0,v.jsx)(ok,{"data-slot":"radio-group",className:aP("grid gap-3",a),...b})}function oq({className:a,...b}){return(0,v.jsx)(om,{"data-slot":"radio-group-item",className:aP("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...b,children:(0,v.jsx)(on,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,v.jsx)(oo,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}let or=(0,fE.createServerReference)("700cf13863712079344a0b4e555b504e56b9b8a4aa",fE.callServer,void 0,fE.findSourceMapURL,"generateSingleLLMResponse"),os=["Expert Dynamics 365 Sales","Expert Dynamics 365 Customer Insights","Expert Dynamics 365 Customer Service","Expert Dynamics 365 Contact Center","Expert Power Platform","Architecte d'Int\xe9gration","Expert S\xe9curit\xe9 Azure","Expert Conformit\xe9 et RGPD"];function ot(){let{projectData:a,llmConfigs:b,setResults:c,generationParams:d,setGenerationParams:e,setCurrentStep:f,generationProgress:g,setGenerationProgress:h,generationLogs:i,addMultipleGenerationLogs:j,clearGenerationLogs:k}=D(),[l,m]=(0,w.useState)(!1),[n,o]=(0,w.useState)(!1),p=(0,w.useRef)(null),q=async e=>{if(!a)return void fD.oR.error("Veuillez charger un fichier \xe0 l'\xe9tape 2.");let g=a.sheets.filter(a=>a.questionColumn);if(0===g.length)return void fD.oR.error("Aucun onglet n'est mapp\xe9.");m(!0),c([]),k(),e&&o(!0);let i=g.flatMap(a=>a.rows.map((b,c)=>({sheetName:a.name,rowIndex:c,question:b[a.questionColumn]})).filter(a=>!!a.question)),l=i.length;h({current:0,total:l});let n=[];for(let a=0;a<l;a++){let{question:c,sheetName:e,rowIndex:f}=i[a];j([`--- D\xe9but Question ${a+1}/${l}: "${c.substring(0,40)}..." ---`]);try{let{result:a,logs:g}=await or(c,b,d),h=b.find(a=>a.isValidated)?.provider,i=h&&a[h]?h:"";n.push({...a,sheetName:e,rowIndex:f,selectedAnswer:i}),j(g)}catch(g){fD.oR.error(`Erreur sur la question ${a+1}`,{description:g.message});let d={question:c,sheetName:e,rowIndex:f,status:"Refus\xe9e",...b.reduce((a,b)=>({...a,[b.provider]:`ERREUR FATALE: ${g.message}`}),{})};n.push(d),j([` ERREUR FATALE: ${g.message}`])}j([`--- Fin Question ${a+1}/${l} ---
`]),h({current:a+1,total:l})}c(n),m(!1),fD.oR.success("G\xe9n\xe9ration termin\xe9e !"),e?(j([" TRAITEMENT TERMIN\xc9 !"]),setTimeout(()=>{o(!1),f(4)},3e3)):f(4)};return(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold",children:"\xc9tape 3 : Playground de G\xe9n\xe9ration"}),(0,v.jsx)("p",{className:"text-slate-600",children:"D\xe9finissez les param\xe8tres et lancez la g\xe9n\xe9ration des r\xe9ponses."}),(0,v.jsxs)(aS,{children:[(0,v.jsxs)(aT,{children:[(0,v.jsx)(aU,{children:"Param\xe8tres de G\xe9n\xe9ration"}),(0,v.jsxs)("p",{className:"text-sm text-muted-foreground pt-1",children:[(0,v.jsx)("span",{className:"font-bold",children:a?a.sheets.reduce((a,b)=>a+b.rows.length,0):0})," lignes charg\xe9es (toutes feuilles)."]})]}),(0,v.jsxs)(aV,{className:"space-y-6",children:[l?(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Progression"}),(0,v.jsx)(nN,{value:g.current/g.total*100}),(0,v.jsxs)("p",{className:"text-sm text-center text-slate-600",children:[g.current," / ",g.total," questions trait\xe9es"]})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,v.jsxs)("div",{className:"space-y-3",children:[(0,v.jsx)(ny,{children:"Langue de la r\xe9ponse"}),(0,v.jsxs)(op,{value:d.language,onValueChange:a=>e({language:a}),className:"flex space-x-4",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Fran\xe7ais",id:"lang-fr"}),(0,v.jsx)(ny,{htmlFor:"lang-fr",children:"Fran\xe7ais"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Anglais",id:"lang-en"}),(0,v.jsx)(ny,{htmlFor:"lang-en",children:"Anglais"})]})]})]}),(0,v.jsxs)("div",{className:"space-y-3",children:[(0,v.jsx)(ny,{children:"Taille de la r\xe9ponse"}),(0,v.jsxs)(op,{value:d.responseLength,onValueChange:a=>e({responseLength:a}),className:"flex space-x-4",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Courte",id:"len-s"}),(0,v.jsx)(ny,{htmlFor:"len-s",children:"Courte"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Moyenne",id:"len-m"}),(0,v.jsx)(ny,{htmlFor:"len-m",children:"Moyenne"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Longue",id:"len-l"}),(0,v.jsx)(ny,{htmlFor:"len-l",children:"Longue"})]})]})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Persona"}),(0,v.jsxs)(eI,{value:d.persona,onValueChange:a=>e({persona:a}),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{})}),(0,v.jsx)(eL,{children:os.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Instructions Suppl\xe9mentaires"}),(0,v.jsx)(nz,{placeholder:"Ex: Adopter un ton professionnel...",value:d.instructions,onChange:a=>e({instructions:a.target.value})})]})]}),(0,v.jsxs)("div",{className:"flex flex-col space-y-2 pt-4",children:[(0,v.jsxs)(aR,{onClick:()=>q(!1),disabled:l,className:"w-full",children:[l?(0,v.jsx)(fy.A,{className:"mr-2 h-4 w-4 animate-spin"}):"\uD83D\uDE80",l?"G\xe9n\xe9ration en cours...":"Lancer la G\xe9n\xe9ration"]}),(0,v.jsxs)(aR,{variant:"outline",onClick:()=>q(!0),disabled:l,className:"w-full",children:[(0,v.jsx)(fM,{className:"mr-2 h-4 w-4"}),"G\xe9n\xe9rer avec Log"]})]})]})]}),(0,v.jsx)(fm,{open:n,onOpenChange:o,children:(0,v.jsxs)(fr,{className:"max-w-4xl h-[80vh] flex flex-col",children:[(0,v.jsx)(fs,{children:(0,v.jsx)(fu,{children:"Log de G\xe9n\xe9ration en Temps R\xe9el"})}),(0,v.jsx)("div",{ref:p,className:"flex-1 h-full overflow-y-auto bg-slate-900 text-white font-mono text-xs p-4 rounded-md",children:i.map((a,b)=>(0,v.jsx)("p",{className:`${a.includes("ERREUR")?"text-red-400":""} ${a.includes("")?"text-green-400":""}`,children:a},b))})]})})]})}function ou({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,v.jsx)("table",{"data-slot":"table",className:aP("w-full caption-bottom text-sm",a),...b})})}function ov({className:a,...b}){return(0,v.jsx)("thead",{"data-slot":"table-header",className:aP("[&_tr]:border-b",a),...b})}function ow({className:a,...b}){return(0,v.jsx)("tbody",{"data-slot":"table-body",className:aP("[&_tr:last-child]:border-0",a),...b})}function ox({className:a,...b}){return(0,v.jsx)("tr",{"data-slot":"table-row",className:aP("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...b})}function oy({className:a,...b}){return(0,v.jsx)("th",{"data-slot":"table-head",className:aP("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}function oz({className:a,...b}){return(0,v.jsx)("td",{"data-slot":"table-cell",className:aP("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}let oA=P("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function oB({className:a,variant:b,asChild:c=!1,...d}){return(0,v.jsx)(c?K:"span",{"data-slot":"badge",className:aP(oA({variant:b}),a),...d})}function oC({...a}){return(0,v.jsx)(eW,{"data-slot":"sheet",...a})}function oD({...a}){return(0,v.jsx)(e0,{"data-slot":"sheet-portal",...a})}function oE({className:a,...b}){return(0,v.jsx)(e2,{"data-slot":"sheet-overlay",className:aP("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function oF({className:a,children:b,side:c="right",...d}){return(0,v.jsxs)(oD,{children:[(0,v.jsx)(oE,{}),(0,v.jsxs)(e6,{"data-slot":"sheet-content",className:aP("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===c&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===c&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===c&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===c&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a),...d,children:[b,(0,v.jsxs)(fe,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,v.jsx)(fl,{className:"size-4"}),(0,v.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function oG({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"sheet-header",className:aP("flex flex-col gap-1.5 p-4",a),...b})}function oH({className:a,...b}){return(0,v.jsx)("div",{"data-slot":"sheet-footer",className:aP("mt-auto flex flex-col gap-2 p-4",a),...b})}function oI({className:a,...b}){return(0,v.jsx)(fb,{"data-slot":"sheet-title",className:aP("text-foreground font-semibold",a),...b})}let oJ=(0,eE.A)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),oK=(0,eE.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);function oL(a,b){return"function"==typeof a?a(b):a}function oM(a,b){return c=>{b.setState(b=>({...b,[a]:oL(c,b[a])}))}}function oN(a){return a instanceof Function}function oO(a,b,c){let d,e=[];return f=>{let g,h;c.key&&c.debug&&(g=Date.now());let i=a(f);if(!(i.length!==e.length||i.some((a,b)=>e[b]!==a)))return d;if(e=i,c.key&&c.debug&&(h=Date.now()),d=b(...i),null==c||null==c.onChange||c.onChange(d),c.key&&c.debug&&null!=c&&c.debug()){let a=Math.round((Date.now()-g)*100)/100,b=Math.round((Date.now()-h)*100)/100,d=b/16,e=(a,b)=>{for(a=String(a);a.length<b;)a=" "+a;return a};console.info(`%c ${e(b,5)} /${e(a,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*d,120))}deg 100% 31%);`,null==c?void 0:c.key)}return d}}function oP(a,b,c,d){return{debug:()=>{var c;return null!=(c=null==a?void 0:a.debugAll)?c:a[b]},key:!1,onChange:d}}let oQ="debugHeaders";function oR(a,b,c){var d;let e={id:null!=(d=c.id)?d:b.id,column:b,index:c.index,isPlaceholder:!!c.isPlaceholder,placeholderId:c.placeholderId,depth:c.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{let a=[],b=c=>{c.subHeaders&&c.subHeaders.length&&c.subHeaders.map(b),a.push(c)};return b(e),a},getContext:()=>({table:a,header:e,column:b})};return a._features.forEach(b=>{null==b.createHeader||b.createHeader(e,a)}),e}function oS(a,b,c,d){var e,f;let g=0,h=function(a,b){void 0===b&&(b=1),g=Math.max(g,b),a.filter(a=>a.getIsVisible()).forEach(a=>{var c;null!=(c=a.columns)&&c.length&&h(a.columns,b+1)},0)};h(a);let i=[],j=(a,b)=>{let e={depth:b,id:[d,`${b}`].filter(Boolean).join("_"),headers:[]},f=[];a.forEach(a=>{let g,h=[...f].reverse()[0],i=a.column.depth===e.depth,j=!1;if(i&&a.column.parent?g=a.column.parent:(g=a.column,j=!0),h&&(null==h?void 0:h.column)===g)h.subHeaders.push(a);else{let e=oR(c,g,{id:[d,b,g.id,null==a?void 0:a.id].filter(Boolean).join("_"),isPlaceholder:j,placeholderId:j?`${f.filter(a=>a.column===g).length}`:void 0,depth:b,index:f.length});e.subHeaders.push(a),f.push(e)}e.headers.push(a),a.headerGroup=e}),i.push(e),b>0&&j(f,b-1)};j(b.map((a,b)=>oR(c,a,{depth:g,index:b})),g-1),i.reverse();let k=a=>a.filter(a=>a.column.getIsVisible()).map(a=>{let b=0,c=0,d=[0];return a.subHeaders&&a.subHeaders.length?(d=[],k(a.subHeaders).forEach(a=>{let{colSpan:c,rowSpan:e}=a;b+=c,d.push(e)})):b=1,c+=Math.min(...d),a.colSpan=b,a.rowSpan=c,{colSpan:b,rowSpan:c}});return k(null!=(e=null==(f=i[0])?void 0:f.headers)?e:[]),i}let oT=(a,b,c,d,e,f,g)=>{let h={id:b,index:d,original:c,depth:e,parentId:g,_valuesCache:{},_uniqueValuesCache:{},getValue:b=>{if(h._valuesCache.hasOwnProperty(b))return h._valuesCache[b];let c=a.getColumn(b);if(null!=c&&c.accessorFn)return h._valuesCache[b]=c.accessorFn(h.original,d),h._valuesCache[b]},getUniqueValues:b=>{if(h._uniqueValuesCache.hasOwnProperty(b))return h._uniqueValuesCache[b];let c=a.getColumn(b);if(null!=c&&c.accessorFn)return c.columnDef.getUniqueValues?h._uniqueValuesCache[b]=c.columnDef.getUniqueValues(h.original,d):h._uniqueValuesCache[b]=[h.getValue(b)],h._uniqueValuesCache[b]},renderValue:b=>{var c;return null!=(c=h.getValue(b))?c:a.options.renderFallbackValue},subRows:null!=f?f:[],getLeafRows:()=>(function(a,b){let c=[],d=a=>{a.forEach(a=>{c.push(a);let e=b(a);null!=e&&e.length&&d(e)})};return d(a),c})(h.subRows,a=>a.subRows),getParentRow:()=>h.parentId?a.getRow(h.parentId,!0):void 0,getParentRows:()=>{let a=[],b=h;for(;;){let c=b.getParentRow();if(!c)break;a.push(c),b=c}return a.reverse()},getAllCells:oO(()=>[a.getAllLeafColumns()],b=>b.map(b=>(function(a,b,c,d){let e={id:`${b.id}_${c.id}`,row:b,column:c,getValue:()=>b.getValue(d),renderValue:()=>{var b;return null!=(b=e.getValue())?b:a.options.renderFallbackValue},getContext:oO(()=>[a,c,b,e],(a,b,c,d)=>({table:a,column:b,row:c,cell:d,getValue:d.getValue,renderValue:d.renderValue}),oP(a.options,"debugCells","cell.getContext"))};return a._features.forEach(d=>{null==d.createCell||d.createCell(e,c,b,a)},{}),e})(a,h,b,b.id)),oP(a.options,"debugRows","getAllCells")),_getAllCellsByColumnId:oO(()=>[h.getAllCells()],a=>a.reduce((a,b)=>(a[b.column.id]=b,a),{}),oP(a.options,"debugRows","getAllCellsByColumnId"))};for(let b=0;b<a._features.length;b++){let c=a._features[b];null==c||null==c.createRow||c.createRow(h,a)}return h},oU=(a,b,c)=>{var d,e;let f=null==c||null==(d=c.toString())?void 0:d.toLowerCase();return!!(null==(e=a.getValue(b))||null==(e=e.toString())||null==(e=e.toLowerCase())?void 0:e.includes(f))};oU.autoRemove=a=>o2(a);let oV=(a,b,c)=>{var d;return!!(null==(d=a.getValue(b))||null==(d=d.toString())?void 0:d.includes(c))};oV.autoRemove=a=>o2(a);let oW=(a,b,c)=>{var d;return(null==(d=a.getValue(b))||null==(d=d.toString())?void 0:d.toLowerCase())===(null==c?void 0:c.toLowerCase())};oW.autoRemove=a=>o2(a);let oX=(a,b,c)=>{var d;return null==(d=a.getValue(b))?void 0:d.includes(c)};oX.autoRemove=a=>o2(a);let oY=(a,b,c)=>!c.some(c=>{var d;return!(null!=(d=a.getValue(b))&&d.includes(c))});oY.autoRemove=a=>o2(a)||!(null!=a&&a.length);let oZ=(a,b,c)=>c.some(c=>{var d;return null==(d=a.getValue(b))?void 0:d.includes(c)});oZ.autoRemove=a=>o2(a)||!(null!=a&&a.length);let o$=(a,b,c)=>a.getValue(b)===c;o$.autoRemove=a=>o2(a);let o_=(a,b,c)=>a.getValue(b)==c;o_.autoRemove=a=>o2(a);let o0=(a,b,c)=>{let[d,e]=c,f=a.getValue(b);return f>=d&&f<=e};o0.resolveFilterValue=a=>{let[b,c]=a,d="number"!=typeof b?parseFloat(b):b,e="number"!=typeof c?parseFloat(c):c,f=null===b||Number.isNaN(d)?-1/0:d,g=null===c||Number.isNaN(e)?1/0:e;if(f>g){let a=f;f=g,g=a}return[f,g]},o0.autoRemove=a=>o2(a)||o2(a[0])&&o2(a[1]);let o1={includesString:oU,includesStringSensitive:oV,equalsString:oW,arrIncludes:oX,arrIncludesAll:oY,arrIncludesSome:oZ,equals:o$,weakEquals:o_,inNumberRange:o0};function o2(a){return null==a||""===a}function o3(a,b,c){return!!a&&!!a.autoRemove&&a.autoRemove(b,c)||void 0===b||"string"==typeof b&&!b}let o4={sum:(a,b,c)=>c.reduce((b,c)=>{let d=c.getValue(a);return b+("number"==typeof d?d:0)},0),min:(a,b,c)=>{let d;return c.forEach(b=>{let c=b.getValue(a);null!=c&&(d>c||void 0===d&&c>=c)&&(d=c)}),d},max:(a,b,c)=>{let d;return c.forEach(b=>{let c=b.getValue(a);null!=c&&(d<c||void 0===d&&c>=c)&&(d=c)}),d},extent:(a,b,c)=>{let d,e;return c.forEach(b=>{let c=b.getValue(a);null!=c&&(void 0===d?c>=c&&(d=e=c):(d>c&&(d=c),e<c&&(e=c)))}),[d,e]},mean:(a,b)=>{let c=0,d=0;if(b.forEach(b=>{let e=b.getValue(a);null!=e&&(e*=1)>=e&&(++c,d+=e)}),c)return d/c},median:(a,b)=>{if(!b.length)return;let c=b.map(b=>b.getValue(a));if(!function(a){return Array.isArray(a)&&a.every(a=>"number"==typeof a)}(c))return;if(1===c.length)return c[0];let d=Math.floor(c.length/2),e=c.sort((a,b)=>a-b);return c.length%2!=0?e[d]:(e[d-1]+e[d])/2},unique:(a,b)=>Array.from(new Set(b.map(b=>b.getValue(a))).values()),uniqueCount:(a,b)=>new Set(b.map(b=>b.getValue(a))).size,count:(a,b)=>b.length},o5=()=>({left:[],right:[]}),o6={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},o7=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),o8=null;function o9(a){return"touchstart"===a.type}function pa(a,b){return b?"center"===b?a.getCenterVisibleLeafColumns():"left"===b?a.getLeftVisibleLeafColumns():a.getRightVisibleLeafColumns():a.getVisibleLeafColumns()}let pb=()=>({pageIndex:0,pageSize:10}),pc=()=>({top:[],bottom:[]}),pd=(a,b,c,d,e)=>{var f;let g=e.getRow(b,!0);c?(g.getCanMultiSelect()||Object.keys(a).forEach(b=>delete a[b]),g.getCanSelect()&&(a[b]=!0)):delete a[b],d&&null!=(f=g.subRows)&&f.length&&g.getCanSelectSubRows()&&g.subRows.forEach(b=>pd(a,b.id,c,d,e))};function pe(a,b){let c=a.getState().rowSelection,d=[],e={},f=function(a,b){return a.map(a=>{var b;let g=pf(a,c);if(g&&(d.push(a),e[a.id]=a),null!=(b=a.subRows)&&b.length&&(a={...a,subRows:f(a.subRows)}),g)return a}).filter(Boolean)};return{rows:f(b.rows),flatRows:d,rowsById:e}}function pf(a,b){var c;return null!=(c=b[a.id])&&c}function pg(a,b,c){var d;if(!(null!=(d=a.subRows)&&d.length))return!1;let e=!0,f=!1;return a.subRows.forEach(a=>{if((!f||e)&&(a.getCanSelect()&&(pf(a,b)?f=!0:e=!1),a.subRows&&a.subRows.length)){let c=pg(a,b);"all"===c?f=!0:("some"===c&&(f=!0),e=!1)}}),e?"all":!!f&&"some"}let ph=/([0-9]+)/gm;function pi(a,b){return a===b?0:a>b?1:-1}function pj(a){return"number"==typeof a?isNaN(a)||a===1/0||a===-1/0?"":String(a):"string"==typeof a?a:""}function pk(a,b){let c=a.split(ph).filter(Boolean),d=b.split(ph).filter(Boolean);for(;c.length&&d.length;){let a=c.shift(),b=d.shift(),e=parseInt(a,10),f=parseInt(b,10),g=[e,f].sort();if(isNaN(g[0])){if(a>b)return 1;if(b>a)return -1;continue}if(isNaN(g[1]))return isNaN(e)?-1:1;if(e>f)return 1;if(f>e)return -1}return c.length-d.length}let pl={alphanumeric:(a,b,c)=>pk(pj(a.getValue(c)).toLowerCase(),pj(b.getValue(c)).toLowerCase()),alphanumericCaseSensitive:(a,b,c)=>pk(pj(a.getValue(c)),pj(b.getValue(c))),text:(a,b,c)=>pi(pj(a.getValue(c)).toLowerCase(),pj(b.getValue(c)).toLowerCase()),textCaseSensitive:(a,b,c)=>pi(pj(a.getValue(c)),pj(b.getValue(c))),datetime:(a,b,c)=>{let d=a.getValue(c),e=b.getValue(c);return d>e?1:d<e?-1:0},basic:(a,b,c)=>pi(a.getValue(c),b.getValue(c))},pm=[{createTable:a=>{a.getHeaderGroups=oO(()=>[a.getAllColumns(),a.getVisibleLeafColumns(),a.getState().columnPinning.left,a.getState().columnPinning.right],(b,c,d,e)=>{var f,g;let h=null!=(f=null==d?void 0:d.map(a=>c.find(b=>b.id===a)).filter(Boolean))?f:[],i=null!=(g=null==e?void 0:e.map(a=>c.find(b=>b.id===a)).filter(Boolean))?g:[];return oS(b,[...h,...c.filter(a=>!(null!=d&&d.includes(a.id))&&!(null!=e&&e.includes(a.id))),...i],a)},oP(a.options,oQ,"getHeaderGroups")),a.getCenterHeaderGroups=oO(()=>[a.getAllColumns(),a.getVisibleLeafColumns(),a.getState().columnPinning.left,a.getState().columnPinning.right],(b,c,d,e)=>oS(b,c=c.filter(a=>!(null!=d&&d.includes(a.id))&&!(null!=e&&e.includes(a.id))),a,"center"),oP(a.options,oQ,"getCenterHeaderGroups")),a.getLeftHeaderGroups=oO(()=>[a.getAllColumns(),a.getVisibleLeafColumns(),a.getState().columnPinning.left],(b,c,d)=>{var e;return oS(b,null!=(e=null==d?void 0:d.map(a=>c.find(b=>b.id===a)).filter(Boolean))?e:[],a,"left")},oP(a.options,oQ,"getLeftHeaderGroups")),a.getRightHeaderGroups=oO(()=>[a.getAllColumns(),a.getVisibleLeafColumns(),a.getState().columnPinning.right],(b,c,d)=>{var e;return oS(b,null!=(e=null==d?void 0:d.map(a=>c.find(b=>b.id===a)).filter(Boolean))?e:[],a,"right")},oP(a.options,oQ,"getRightHeaderGroups")),a.getFooterGroups=oO(()=>[a.getHeaderGroups()],a=>[...a].reverse(),oP(a.options,oQ,"getFooterGroups")),a.getLeftFooterGroups=oO(()=>[a.getLeftHeaderGroups()],a=>[...a].reverse(),oP(a.options,oQ,"getLeftFooterGroups")),a.getCenterFooterGroups=oO(()=>[a.getCenterHeaderGroups()],a=>[...a].reverse(),oP(a.options,oQ,"getCenterFooterGroups")),a.getRightFooterGroups=oO(()=>[a.getRightHeaderGroups()],a=>[...a].reverse(),oP(a.options,oQ,"getRightFooterGroups")),a.getFlatHeaders=oO(()=>[a.getHeaderGroups()],a=>a.map(a=>a.headers).flat(),oP(a.options,oQ,"getFlatHeaders")),a.getLeftFlatHeaders=oO(()=>[a.getLeftHeaderGroups()],a=>a.map(a=>a.headers).flat(),oP(a.options,oQ,"getLeftFlatHeaders")),a.getCenterFlatHeaders=oO(()=>[a.getCenterHeaderGroups()],a=>a.map(a=>a.headers).flat(),oP(a.options,oQ,"getCenterFlatHeaders")),a.getRightFlatHeaders=oO(()=>[a.getRightHeaderGroups()],a=>a.map(a=>a.headers).flat(),oP(a.options,oQ,"getRightFlatHeaders")),a.getCenterLeafHeaders=oO(()=>[a.getCenterFlatHeaders()],a=>a.filter(a=>{var b;return!(null!=(b=a.subHeaders)&&b.length)}),oP(a.options,oQ,"getCenterLeafHeaders")),a.getLeftLeafHeaders=oO(()=>[a.getLeftFlatHeaders()],a=>a.filter(a=>{var b;return!(null!=(b=a.subHeaders)&&b.length)}),oP(a.options,oQ,"getLeftLeafHeaders")),a.getRightLeafHeaders=oO(()=>[a.getRightFlatHeaders()],a=>a.filter(a=>{var b;return!(null!=(b=a.subHeaders)&&b.length)}),oP(a.options,oQ,"getRightLeafHeaders")),a.getLeafHeaders=oO(()=>[a.getLeftHeaderGroups(),a.getCenterHeaderGroups(),a.getRightHeaderGroups()],(a,b,c)=>{var d,e,f,g,h,i;return[...null!=(d=null==(e=a[0])?void 0:e.headers)?d:[],...null!=(f=null==(g=b[0])?void 0:g.headers)?f:[],...null!=(h=null==(i=c[0])?void 0:i.headers)?h:[]].map(a=>a.getLeafHeaders()).flat()},oP(a.options,oQ,"getLeafHeaders"))}},{getInitialState:a=>({columnVisibility:{},...a}),getDefaultOptions:a=>({onColumnVisibilityChange:oM("columnVisibility",a)}),createColumn:(a,b)=>{a.toggleVisibility=c=>{a.getCanHide()&&b.setColumnVisibility(b=>({...b,[a.id]:null!=c?c:!a.getIsVisible()}))},a.getIsVisible=()=>{var c,d;let e=a.columns;return null==(c=e.length?e.some(a=>a.getIsVisible()):null==(d=b.getState().columnVisibility)?void 0:d[a.id])||c},a.getCanHide=()=>{var c,d;return(null==(c=a.columnDef.enableHiding)||c)&&(null==(d=b.options.enableHiding)||d)},a.getToggleVisibilityHandler=()=>b=>{null==a.toggleVisibility||a.toggleVisibility(b.target.checked)}},createRow:(a,b)=>{a._getAllVisibleCells=oO(()=>[a.getAllCells(),b.getState().columnVisibility],a=>a.filter(a=>a.column.getIsVisible()),oP(b.options,"debugRows","_getAllVisibleCells")),a.getVisibleCells=oO(()=>[a.getLeftVisibleCells(),a.getCenterVisibleCells(),a.getRightVisibleCells()],(a,b,c)=>[...a,...b,...c],oP(b.options,"debugRows","getVisibleCells"))},createTable:a=>{let b=(b,c)=>oO(()=>[c(),c().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(a=>null==a.getIsVisible?void 0:a.getIsVisible()),oP(a.options,"debugColumns",b));a.getVisibleFlatColumns=b("getVisibleFlatColumns",()=>a.getAllFlatColumns()),a.getVisibleLeafColumns=b("getVisibleLeafColumns",()=>a.getAllLeafColumns()),a.getLeftVisibleLeafColumns=b("getLeftVisibleLeafColumns",()=>a.getLeftLeafColumns()),a.getRightVisibleLeafColumns=b("getRightVisibleLeafColumns",()=>a.getRightLeafColumns()),a.getCenterVisibleLeafColumns=b("getCenterVisibleLeafColumns",()=>a.getCenterLeafColumns()),a.setColumnVisibility=b=>null==a.options.onColumnVisibilityChange?void 0:a.options.onColumnVisibilityChange(b),a.resetColumnVisibility=b=>{var c;a.setColumnVisibility(b?{}:null!=(c=a.initialState.columnVisibility)?c:{})},a.toggleAllColumnsVisible=b=>{var c;b=null!=(c=b)?c:!a.getIsAllColumnsVisible(),a.setColumnVisibility(a.getAllLeafColumns().reduce((a,c)=>({...a,[c.id]:b||!(null!=c.getCanHide&&c.getCanHide())}),{}))},a.getIsAllColumnsVisible=()=>!a.getAllLeafColumns().some(a=>!(null!=a.getIsVisible&&a.getIsVisible())),a.getIsSomeColumnsVisible=()=>a.getAllLeafColumns().some(a=>null==a.getIsVisible?void 0:a.getIsVisible()),a.getToggleAllColumnsVisibilityHandler=()=>b=>{var c;a.toggleAllColumnsVisible(null==(c=b.target)?void 0:c.checked)}}},{getInitialState:a=>({columnOrder:[],...a}),getDefaultOptions:a=>({onColumnOrderChange:oM("columnOrder",a)}),createColumn:(a,b)=>{a.getIndex=oO(a=>[pa(b,a)],b=>b.findIndex(b=>b.id===a.id),oP(b.options,"debugColumns","getIndex")),a.getIsFirstColumn=c=>{var d;return(null==(d=pa(b,c)[0])?void 0:d.id)===a.id},a.getIsLastColumn=c=>{var d;let e=pa(b,c);return(null==(d=e[e.length-1])?void 0:d.id)===a.id}},createTable:a=>{a.setColumnOrder=b=>null==a.options.onColumnOrderChange?void 0:a.options.onColumnOrderChange(b),a.resetColumnOrder=b=>{var c;a.setColumnOrder(b?[]:null!=(c=a.initialState.columnOrder)?c:[])},a._getOrderColumnsFn=oO(()=>[a.getState().columnOrder,a.getState().grouping,a.options.groupedColumnMode],(a,b,c)=>d=>{let e=[];if(null!=a&&a.length){let b=[...a],c=[...d];for(;c.length&&b.length;){let a=b.shift(),d=c.findIndex(b=>b.id===a);d>-1&&e.push(c.splice(d,1)[0])}e=[...e,...c]}else e=d;return function(a,b,c){if(!(null!=b&&b.length)||!c)return a;let d=a.filter(a=>!b.includes(a.id));return"remove"===c?d:[...b.map(b=>a.find(a=>a.id===b)).filter(Boolean),...d]}(e,b,c)},oP(a.options,"debugTable","_getOrderColumnsFn"))}},{getInitialState:a=>({columnPinning:o5(),...a}),getDefaultOptions:a=>({onColumnPinningChange:oM("columnPinning",a)}),createColumn:(a,b)=>{a.pin=c=>{let d=a.getLeafColumns().map(a=>a.id).filter(Boolean);b.setColumnPinning(a=>{var b,e,f,g,h,i;return"right"===c?{left:(null!=(f=null==a?void 0:a.left)?f:[]).filter(a=>!(null!=d&&d.includes(a))),right:[...(null!=(g=null==a?void 0:a.right)?g:[]).filter(a=>!(null!=d&&d.includes(a))),...d]}:"left"===c?{left:[...(null!=(h=null==a?void 0:a.left)?h:[]).filter(a=>!(null!=d&&d.includes(a))),...d],right:(null!=(i=null==a?void 0:a.right)?i:[]).filter(a=>!(null!=d&&d.includes(a)))}:{left:(null!=(b=null==a?void 0:a.left)?b:[]).filter(a=>!(null!=d&&d.includes(a))),right:(null!=(e=null==a?void 0:a.right)?e:[]).filter(a=>!(null!=d&&d.includes(a)))}})},a.getCanPin=()=>a.getLeafColumns().some(a=>{var c,d,e;return(null==(c=a.columnDef.enablePinning)||c)&&(null==(d=null!=(e=b.options.enableColumnPinning)?e:b.options.enablePinning)||d)}),a.getIsPinned=()=>{let c=a.getLeafColumns().map(a=>a.id),{left:d,right:e}=b.getState().columnPinning,f=c.some(a=>null==d?void 0:d.includes(a)),g=c.some(a=>null==e?void 0:e.includes(a));return f?"left":!!g&&"right"},a.getPinnedIndex=()=>{var c,d;let e=a.getIsPinned();return e?null!=(c=null==(d=b.getState().columnPinning)||null==(d=d[e])?void 0:d.indexOf(a.id))?c:-1:0}},createRow:(a,b)=>{a.getCenterVisibleCells=oO(()=>[a._getAllVisibleCells(),b.getState().columnPinning.left,b.getState().columnPinning.right],(a,b,c)=>{let d=[...null!=b?b:[],...null!=c?c:[]];return a.filter(a=>!d.includes(a.column.id))},oP(b.options,"debugRows","getCenterVisibleCells")),a.getLeftVisibleCells=oO(()=>[a._getAllVisibleCells(),b.getState().columnPinning.left],(a,b)=>(null!=b?b:[]).map(b=>a.find(a=>a.column.id===b)).filter(Boolean).map(a=>({...a,position:"left"})),oP(b.options,"debugRows","getLeftVisibleCells")),a.getRightVisibleCells=oO(()=>[a._getAllVisibleCells(),b.getState().columnPinning.right],(a,b)=>(null!=b?b:[]).map(b=>a.find(a=>a.column.id===b)).filter(Boolean).map(a=>({...a,position:"right"})),oP(b.options,"debugRows","getRightVisibleCells"))},createTable:a=>{a.setColumnPinning=b=>null==a.options.onColumnPinningChange?void 0:a.options.onColumnPinningChange(b),a.resetColumnPinning=b=>{var c,d;return a.setColumnPinning(b?o5():null!=(c=null==(d=a.initialState)?void 0:d.columnPinning)?c:o5())},a.getIsSomeColumnsPinned=b=>{var c,d,e;let f=a.getState().columnPinning;return b?!!(null==(c=f[b])?void 0:c.length):!!((null==(d=f.left)?void 0:d.length)||(null==(e=f.right)?void 0:e.length))},a.getLeftLeafColumns=oO(()=>[a.getAllLeafColumns(),a.getState().columnPinning.left],(a,b)=>(null!=b?b:[]).map(b=>a.find(a=>a.id===b)).filter(Boolean),oP(a.options,"debugColumns","getLeftLeafColumns")),a.getRightLeafColumns=oO(()=>[a.getAllLeafColumns(),a.getState().columnPinning.right],(a,b)=>(null!=b?b:[]).map(b=>a.find(a=>a.id===b)).filter(Boolean),oP(a.options,"debugColumns","getRightLeafColumns")),a.getCenterLeafColumns=oO(()=>[a.getAllLeafColumns(),a.getState().columnPinning.left,a.getState().columnPinning.right],(a,b,c)=>{let d=[...null!=b?b:[],...null!=c?c:[]];return a.filter(a=>!d.includes(a.id))},oP(a.options,"debugColumns","getCenterLeafColumns"))}},{createColumn:(a,b)=>{a._getFacetedRowModel=b.options.getFacetedRowModel&&b.options.getFacetedRowModel(b,a.id),a.getFacetedRowModel=()=>a._getFacetedRowModel?a._getFacetedRowModel():b.getPreFilteredRowModel(),a._getFacetedUniqueValues=b.options.getFacetedUniqueValues&&b.options.getFacetedUniqueValues(b,a.id),a.getFacetedUniqueValues=()=>a._getFacetedUniqueValues?a._getFacetedUniqueValues():new Map,a._getFacetedMinMaxValues=b.options.getFacetedMinMaxValues&&b.options.getFacetedMinMaxValues(b,a.id),a.getFacetedMinMaxValues=()=>{if(a._getFacetedMinMaxValues)return a._getFacetedMinMaxValues()}}},{getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:a=>({columnFilters:[],...a}),getDefaultOptions:a=>({onColumnFiltersChange:oM("columnFilters",a),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(a,b)=>{a.getAutoFilterFn=()=>{let c=b.getCoreRowModel().flatRows[0],d=null==c?void 0:c.getValue(a.id);return"string"==typeof d?o1.includesString:"number"==typeof d?o1.inNumberRange:"boolean"==typeof d||null!==d&&"object"==typeof d?o1.equals:Array.isArray(d)?o1.arrIncludes:o1.weakEquals},a.getFilterFn=()=>{var c,d;return oN(a.columnDef.filterFn)?a.columnDef.filterFn:"auto"===a.columnDef.filterFn?a.getAutoFilterFn():null!=(c=null==(d=b.options.filterFns)?void 0:d[a.columnDef.filterFn])?c:o1[a.columnDef.filterFn]},a.getCanFilter=()=>{var c,d,e;return(null==(c=a.columnDef.enableColumnFilter)||c)&&(null==(d=b.options.enableColumnFilters)||d)&&(null==(e=b.options.enableFilters)||e)&&!!a.accessorFn},a.getIsFiltered=()=>a.getFilterIndex()>-1,a.getFilterValue=()=>{var c;return null==(c=b.getState().columnFilters)||null==(c=c.find(b=>b.id===a.id))?void 0:c.value},a.getFilterIndex=()=>{var c,d;return null!=(c=null==(d=b.getState().columnFilters)?void 0:d.findIndex(b=>b.id===a.id))?c:-1},a.setFilterValue=c=>{b.setColumnFilters(b=>{var d,e;let f=a.getFilterFn(),g=null==b?void 0:b.find(b=>b.id===a.id),h=oL(c,g?g.value:void 0);if(o3(f,h,a))return null!=(d=null==b?void 0:b.filter(b=>b.id!==a.id))?d:[];let i={id:a.id,value:h};return g?null!=(e=null==b?void 0:b.map(b=>b.id===a.id?i:b))?e:[]:null!=b&&b.length?[...b,i]:[i]})}},createRow:(a,b)=>{a.columnFilters={},a.columnFiltersMeta={}},createTable:a=>{a.setColumnFilters=b=>{let c=a.getAllLeafColumns();null==a.options.onColumnFiltersChange||a.options.onColumnFiltersChange(a=>{var d;return null==(d=oL(b,a))?void 0:d.filter(a=>{let b=c.find(b=>b.id===a.id);return!(b&&o3(b.getFilterFn(),a.value,b))&&!0})})},a.resetColumnFilters=b=>{var c,d;a.setColumnFilters(b?[]:null!=(c=null==(d=a.initialState)?void 0:d.columnFilters)?c:[])},a.getPreFilteredRowModel=()=>a.getCoreRowModel(),a.getFilteredRowModel=()=>(!a._getFilteredRowModel&&a.options.getFilteredRowModel&&(a._getFilteredRowModel=a.options.getFilteredRowModel(a)),a.options.manualFiltering||!a._getFilteredRowModel)?a.getPreFilteredRowModel():a._getFilteredRowModel()}},{createTable:a=>{a._getGlobalFacetedRowModel=a.options.getFacetedRowModel&&a.options.getFacetedRowModel(a,"__global__"),a.getGlobalFacetedRowModel=()=>a.options.manualFiltering||!a._getGlobalFacetedRowModel?a.getPreFilteredRowModel():a._getGlobalFacetedRowModel(),a._getGlobalFacetedUniqueValues=a.options.getFacetedUniqueValues&&a.options.getFacetedUniqueValues(a,"__global__"),a.getGlobalFacetedUniqueValues=()=>a._getGlobalFacetedUniqueValues?a._getGlobalFacetedUniqueValues():new Map,a._getGlobalFacetedMinMaxValues=a.options.getFacetedMinMaxValues&&a.options.getFacetedMinMaxValues(a,"__global__"),a.getGlobalFacetedMinMaxValues=()=>{if(a._getGlobalFacetedMinMaxValues)return a._getGlobalFacetedMinMaxValues()}}},{getInitialState:a=>({globalFilter:void 0,...a}),getDefaultOptions:a=>({onGlobalFilterChange:oM("globalFilter",a),globalFilterFn:"auto",getColumnCanGlobalFilter:b=>{var c;let d=null==(c=a.getCoreRowModel().flatRows[0])||null==(c=c._getAllCellsByColumnId()[b.id])?void 0:c.getValue();return"string"==typeof d||"number"==typeof d}}),createColumn:(a,b)=>{a.getCanGlobalFilter=()=>{var c,d,e,f;return(null==(c=a.columnDef.enableGlobalFilter)||c)&&(null==(d=b.options.enableGlobalFilter)||d)&&(null==(e=b.options.enableFilters)||e)&&(null==(f=null==b.options.getColumnCanGlobalFilter?void 0:b.options.getColumnCanGlobalFilter(a))||f)&&!!a.accessorFn}},createTable:a=>{a.getGlobalAutoFilterFn=()=>o1.includesString,a.getGlobalFilterFn=()=>{var b,c;let{globalFilterFn:d}=a.options;return oN(d)?d:"auto"===d?a.getGlobalAutoFilterFn():null!=(b=null==(c=a.options.filterFns)?void 0:c[d])?b:o1[d]},a.setGlobalFilter=b=>{null==a.options.onGlobalFilterChange||a.options.onGlobalFilterChange(b)},a.resetGlobalFilter=b=>{a.setGlobalFilter(b?void 0:a.initialState.globalFilter)}}},{getInitialState:a=>({sorting:[],...a}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:a=>({onSortingChange:oM("sorting",a),isMultiSortEvent:a=>a.shiftKey}),createColumn:(a,b)=>{a.getAutoSortingFn=()=>{let c=b.getFilteredRowModel().flatRows.slice(10),d=!1;for(let b of c){let c=null==b?void 0:b.getValue(a.id);if("[object Date]"===Object.prototype.toString.call(c))return pl.datetime;if("string"==typeof c&&(d=!0,c.split(ph).length>1))return pl.alphanumeric}return d?pl.text:pl.basic},a.getAutoSortDir=()=>{let c=b.getFilteredRowModel().flatRows[0];return"string"==typeof(null==c?void 0:c.getValue(a.id))?"asc":"desc"},a.getSortingFn=()=>{var c,d;if(!a)throw Error();return oN(a.columnDef.sortingFn)?a.columnDef.sortingFn:"auto"===a.columnDef.sortingFn?a.getAutoSortingFn():null!=(c=null==(d=b.options.sortingFns)?void 0:d[a.columnDef.sortingFn])?c:pl[a.columnDef.sortingFn]},a.toggleSorting=(c,d)=>{let e=a.getNextSortingOrder(),f=null!=c;b.setSorting(g=>{let h,i=null==g?void 0:g.find(b=>b.id===a.id),j=null==g?void 0:g.findIndex(b=>b.id===a.id),k=[],l=f?c:"desc"===e;if("toggle"!=(h=null!=g&&g.length&&a.getCanMultiSort()&&d?i?"toggle":"add":null!=g&&g.length&&j!==g.length-1?"replace":i?"toggle":"replace")||f||e||(h="remove"),"add"===h){var m;(k=[...g,{id:a.id,desc:l}]).splice(0,k.length-(null!=(m=b.options.maxMultiSortColCount)?m:Number.MAX_SAFE_INTEGER))}else k="toggle"===h?g.map(b=>b.id===a.id?{...b,desc:l}:b):"remove"===h?g.filter(b=>b.id!==a.id):[{id:a.id,desc:l}];return k})},a.getFirstSortDir=()=>{var c,d;return(null!=(c=null!=(d=a.columnDef.sortDescFirst)?d:b.options.sortDescFirst)?c:"desc"===a.getAutoSortDir())?"desc":"asc"},a.getNextSortingOrder=c=>{var d,e;let f=a.getFirstSortDir(),g=a.getIsSorted();return g?(g===f||null!=(d=b.options.enableSortingRemoval)&&!d||!!c&&null!=(e=b.options.enableMultiRemove)&&!e)&&("desc"===g?"asc":"desc"):f},a.getCanSort=()=>{var c,d;return(null==(c=a.columnDef.enableSorting)||c)&&(null==(d=b.options.enableSorting)||d)&&!!a.accessorFn},a.getCanMultiSort=()=>{var c,d;return null!=(c=null!=(d=a.columnDef.enableMultiSort)?d:b.options.enableMultiSort)?c:!!a.accessorFn},a.getIsSorted=()=>{var c;let d=null==(c=b.getState().sorting)?void 0:c.find(b=>b.id===a.id);return!!d&&(d.desc?"desc":"asc")},a.getSortIndex=()=>{var c,d;return null!=(c=null==(d=b.getState().sorting)?void 0:d.findIndex(b=>b.id===a.id))?c:-1},a.clearSorting=()=>{b.setSorting(b=>null!=b&&b.length?b.filter(b=>b.id!==a.id):[])},a.getToggleSortingHandler=()=>{let c=a.getCanSort();return d=>{c&&(null==d.persist||d.persist(),null==a.toggleSorting||a.toggleSorting(void 0,!!a.getCanMultiSort()&&(null==b.options.isMultiSortEvent?void 0:b.options.isMultiSortEvent(d))))}}},createTable:a=>{a.setSorting=b=>null==a.options.onSortingChange?void 0:a.options.onSortingChange(b),a.resetSorting=b=>{var c,d;a.setSorting(b?[]:null!=(c=null==(d=a.initialState)?void 0:d.sorting)?c:[])},a.getPreSortedRowModel=()=>a.getGroupedRowModel(),a.getSortedRowModel=()=>(!a._getSortedRowModel&&a.options.getSortedRowModel&&(a._getSortedRowModel=a.options.getSortedRowModel(a)),a.options.manualSorting||!a._getSortedRowModel)?a.getPreSortedRowModel():a._getSortedRowModel()}},{getDefaultColumnDef:()=>({aggregatedCell:a=>{var b,c;return null!=(b=null==(c=a.getValue())||null==c.toString?void 0:c.toString())?b:null},aggregationFn:"auto"}),getInitialState:a=>({grouping:[],...a}),getDefaultOptions:a=>({onGroupingChange:oM("grouping",a),groupedColumnMode:"reorder"}),createColumn:(a,b)=>{a.toggleGrouping=()=>{b.setGrouping(b=>null!=b&&b.includes(a.id)?b.filter(b=>b!==a.id):[...null!=b?b:[],a.id])},a.getCanGroup=()=>{var c,d;return(null==(c=a.columnDef.enableGrouping)||c)&&(null==(d=b.options.enableGrouping)||d)&&(!!a.accessorFn||!!a.columnDef.getGroupingValue)},a.getIsGrouped=()=>{var c;return null==(c=b.getState().grouping)?void 0:c.includes(a.id)},a.getGroupedIndex=()=>{var c;return null==(c=b.getState().grouping)?void 0:c.indexOf(a.id)},a.getToggleGroupingHandler=()=>{let b=a.getCanGroup();return()=>{b&&a.toggleGrouping()}},a.getAutoAggregationFn=()=>{let c=b.getCoreRowModel().flatRows[0],d=null==c?void 0:c.getValue(a.id);return"number"==typeof d?o4.sum:"[object Date]"===Object.prototype.toString.call(d)?o4.extent:void 0},a.getAggregationFn=()=>{var c,d;if(!a)throw Error();return oN(a.columnDef.aggregationFn)?a.columnDef.aggregationFn:"auto"===a.columnDef.aggregationFn?a.getAutoAggregationFn():null!=(c=null==(d=b.options.aggregationFns)?void 0:d[a.columnDef.aggregationFn])?c:o4[a.columnDef.aggregationFn]}},createTable:a=>{a.setGrouping=b=>null==a.options.onGroupingChange?void 0:a.options.onGroupingChange(b),a.resetGrouping=b=>{var c,d;a.setGrouping(b?[]:null!=(c=null==(d=a.initialState)?void 0:d.grouping)?c:[])},a.getPreGroupedRowModel=()=>a.getFilteredRowModel(),a.getGroupedRowModel=()=>(!a._getGroupedRowModel&&a.options.getGroupedRowModel&&(a._getGroupedRowModel=a.options.getGroupedRowModel(a)),a.options.manualGrouping||!a._getGroupedRowModel)?a.getPreGroupedRowModel():a._getGroupedRowModel()},createRow:(a,b)=>{a.getIsGrouped=()=>!!a.groupingColumnId,a.getGroupingValue=c=>{if(a._groupingValuesCache.hasOwnProperty(c))return a._groupingValuesCache[c];let d=b.getColumn(c);return null!=d&&d.columnDef.getGroupingValue?(a._groupingValuesCache[c]=d.columnDef.getGroupingValue(a.original),a._groupingValuesCache[c]):a.getValue(c)},a._groupingValuesCache={}},createCell:(a,b,c,d)=>{a.getIsGrouped=()=>b.getIsGrouped()&&b.id===c.groupingColumnId,a.getIsPlaceholder=()=>!a.getIsGrouped()&&b.getIsGrouped(),a.getIsAggregated=()=>{var b;return!a.getIsGrouped()&&!a.getIsPlaceholder()&&!!(null!=(b=c.subRows)&&b.length)}}},{getInitialState:a=>({expanded:{},...a}),getDefaultOptions:a=>({onExpandedChange:oM("expanded",a),paginateExpandedRows:!0}),createTable:a=>{let b=!1,c=!1;a._autoResetExpanded=()=>{var d,e;if(!b)return void a._queue(()=>{b=!0});if(null!=(d=null!=(e=a.options.autoResetAll)?e:a.options.autoResetExpanded)?d:!a.options.manualExpanding){if(c)return;c=!0,a._queue(()=>{a.resetExpanded(),c=!1})}},a.setExpanded=b=>null==a.options.onExpandedChange?void 0:a.options.onExpandedChange(b),a.toggleAllRowsExpanded=b=>{(null!=b?b:!a.getIsAllRowsExpanded())?a.setExpanded(!0):a.setExpanded({})},a.resetExpanded=b=>{var c,d;a.setExpanded(b?{}:null!=(c=null==(d=a.initialState)?void 0:d.expanded)?c:{})},a.getCanSomeRowsExpand=()=>a.getPrePaginationRowModel().flatRows.some(a=>a.getCanExpand()),a.getToggleAllRowsExpandedHandler=()=>b=>{null==b.persist||b.persist(),a.toggleAllRowsExpanded()},a.getIsSomeRowsExpanded=()=>{let b=a.getState().expanded;return!0===b||Object.values(b).some(Boolean)},a.getIsAllRowsExpanded=()=>{let b=a.getState().expanded;return"boolean"==typeof b?!0===b:!(!Object.keys(b).length||a.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},a.getExpandedDepth=()=>{let b=0;return(!0===a.getState().expanded?Object.keys(a.getRowModel().rowsById):Object.keys(a.getState().expanded)).forEach(a=>{let c=a.split(".");b=Math.max(b,c.length)}),b},a.getPreExpandedRowModel=()=>a.getSortedRowModel(),a.getExpandedRowModel=()=>(!a._getExpandedRowModel&&a.options.getExpandedRowModel&&(a._getExpandedRowModel=a.options.getExpandedRowModel(a)),a.options.manualExpanding||!a._getExpandedRowModel)?a.getPreExpandedRowModel():a._getExpandedRowModel()},createRow:(a,b)=>{a.toggleExpanded=c=>{b.setExpanded(d=>{var e;let f=!0===d||!!(null!=d&&d[a.id]),g={};if(!0===d?Object.keys(b.getRowModel().rowsById).forEach(a=>{g[a]=!0}):g=d,c=null!=(e=c)?e:!f,!f&&c)return{...g,[a.id]:!0};if(f&&!c){let{[a.id]:b,...c}=g;return c}return d})},a.getIsExpanded=()=>{var c;let d=b.getState().expanded;return!!(null!=(c=null==b.options.getIsRowExpanded?void 0:b.options.getIsRowExpanded(a))?c:!0===d||(null==d?void 0:d[a.id]))},a.getCanExpand=()=>{var c,d,e;return null!=(c=null==b.options.getRowCanExpand?void 0:b.options.getRowCanExpand(a))?c:(null==(d=b.options.enableExpanding)||d)&&!!(null!=(e=a.subRows)&&e.length)},a.getIsAllParentsExpanded=()=>{let c=!0,d=a;for(;c&&d.parentId;)c=(d=b.getRow(d.parentId,!0)).getIsExpanded();return c},a.getToggleExpandedHandler=()=>{let b=a.getCanExpand();return()=>{b&&a.toggleExpanded()}}}},{getInitialState:a=>({...a,pagination:{...pb(),...null==a?void 0:a.pagination}}),getDefaultOptions:a=>({onPaginationChange:oM("pagination",a)}),createTable:a=>{let b=!1,c=!1;a._autoResetPageIndex=()=>{var d,e;if(!b)return void a._queue(()=>{b=!0});if(null!=(d=null!=(e=a.options.autoResetAll)?e:a.options.autoResetPageIndex)?d:!a.options.manualPagination){if(c)return;c=!0,a._queue(()=>{a.resetPageIndex(),c=!1})}},a.setPagination=b=>null==a.options.onPaginationChange?void 0:a.options.onPaginationChange(a=>oL(b,a)),a.resetPagination=b=>{var c;a.setPagination(b?pb():null!=(c=a.initialState.pagination)?c:pb())},a.setPageIndex=b=>{a.setPagination(c=>{let d=oL(b,c.pageIndex);return d=Math.max(0,Math.min(d,void 0===a.options.pageCount||-1===a.options.pageCount?Number.MAX_SAFE_INTEGER:a.options.pageCount-1)),{...c,pageIndex:d}})},a.resetPageIndex=b=>{var c,d;a.setPageIndex(b?0:null!=(c=null==(d=a.initialState)||null==(d=d.pagination)?void 0:d.pageIndex)?c:0)},a.resetPageSize=b=>{var c,d;a.setPageSize(b?10:null!=(c=null==(d=a.initialState)||null==(d=d.pagination)?void 0:d.pageSize)?c:10)},a.setPageSize=b=>{a.setPagination(a=>{let c=Math.max(1,oL(b,a.pageSize)),d=Math.floor(a.pageSize*a.pageIndex/c);return{...a,pageIndex:d,pageSize:c}})},a.setPageCount=b=>a.setPagination(c=>{var d;let e=oL(b,null!=(d=a.options.pageCount)?d:-1);return"number"==typeof e&&(e=Math.max(-1,e)),{...c,pageCount:e}}),a.getPageOptions=oO(()=>[a.getPageCount()],a=>{let b=[];return a&&a>0&&(b=[...Array(a)].fill(null).map((a,b)=>b)),b},oP(a.options,"debugTable","getPageOptions")),a.getCanPreviousPage=()=>a.getState().pagination.pageIndex>0,a.getCanNextPage=()=>{let{pageIndex:b}=a.getState().pagination,c=a.getPageCount();return -1===c||0!==c&&b<c-1},a.previousPage=()=>a.setPageIndex(a=>a-1),a.nextPage=()=>a.setPageIndex(a=>a+1),a.firstPage=()=>a.setPageIndex(0),a.lastPage=()=>a.setPageIndex(a.getPageCount()-1),a.getPrePaginationRowModel=()=>a.getExpandedRowModel(),a.getPaginationRowModel=()=>(!a._getPaginationRowModel&&a.options.getPaginationRowModel&&(a._getPaginationRowModel=a.options.getPaginationRowModel(a)),a.options.manualPagination||!a._getPaginationRowModel)?a.getPrePaginationRowModel():a._getPaginationRowModel(),a.getPageCount=()=>{var b;return null!=(b=a.options.pageCount)?b:Math.ceil(a.getRowCount()/a.getState().pagination.pageSize)},a.getRowCount=()=>{var b;return null!=(b=a.options.rowCount)?b:a.getPrePaginationRowModel().rows.length}}},{getInitialState:a=>({rowPinning:pc(),...a}),getDefaultOptions:a=>({onRowPinningChange:oM("rowPinning",a)}),createRow:(a,b)=>{a.pin=(c,d,e)=>{let f=d?a.getLeafRows().map(a=>{let{id:b}=a;return b}):[],g=new Set([...e?a.getParentRows().map(a=>{let{id:b}=a;return b}):[],a.id,...f]);b.setRowPinning(a=>{var b,d,e,f,h,i;return"bottom"===c?{top:(null!=(e=null==a?void 0:a.top)?e:[]).filter(a=>!(null!=g&&g.has(a))),bottom:[...(null!=(f=null==a?void 0:a.bottom)?f:[]).filter(a=>!(null!=g&&g.has(a))),...Array.from(g)]}:"top"===c?{top:[...(null!=(h=null==a?void 0:a.top)?h:[]).filter(a=>!(null!=g&&g.has(a))),...Array.from(g)],bottom:(null!=(i=null==a?void 0:a.bottom)?i:[]).filter(a=>!(null!=g&&g.has(a)))}:{top:(null!=(b=null==a?void 0:a.top)?b:[]).filter(a=>!(null!=g&&g.has(a))),bottom:(null!=(d=null==a?void 0:a.bottom)?d:[]).filter(a=>!(null!=g&&g.has(a)))}})},a.getCanPin=()=>{var c;let{enableRowPinning:d,enablePinning:e}=b.options;return"function"==typeof d?d(a):null==(c=null!=d?d:e)||c},a.getIsPinned=()=>{let c=[a.id],{top:d,bottom:e}=b.getState().rowPinning,f=c.some(a=>null==d?void 0:d.includes(a)),g=c.some(a=>null==e?void 0:e.includes(a));return f?"top":!!g&&"bottom"},a.getPinnedIndex=()=>{var c,d;let e=a.getIsPinned();if(!e)return -1;let f=null==(c="top"===e?b.getTopRows():b.getBottomRows())?void 0:c.map(a=>{let{id:b}=a;return b});return null!=(d=null==f?void 0:f.indexOf(a.id))?d:-1}},createTable:a=>{a.setRowPinning=b=>null==a.options.onRowPinningChange?void 0:a.options.onRowPinningChange(b),a.resetRowPinning=b=>{var c,d;return a.setRowPinning(b?pc():null!=(c=null==(d=a.initialState)?void 0:d.rowPinning)?c:pc())},a.getIsSomeRowsPinned=b=>{var c,d,e;let f=a.getState().rowPinning;return b?!!(null==(c=f[b])?void 0:c.length):!!((null==(d=f.top)?void 0:d.length)||(null==(e=f.bottom)?void 0:e.length))},a._getPinnedRows=(b,c,d)=>{var e;return(null==(e=a.options.keepPinnedRows)||e?(null!=c?c:[]).map(b=>{let c=a.getRow(b,!0);return c.getIsAllParentsExpanded()?c:null}):(null!=c?c:[]).map(a=>b.find(b=>b.id===a))).filter(Boolean).map(a=>({...a,position:d}))},a.getTopRows=oO(()=>[a.getRowModel().rows,a.getState().rowPinning.top],(b,c)=>a._getPinnedRows(b,c,"top"),oP(a.options,"debugRows","getTopRows")),a.getBottomRows=oO(()=>[a.getRowModel().rows,a.getState().rowPinning.bottom],(b,c)=>a._getPinnedRows(b,c,"bottom"),oP(a.options,"debugRows","getBottomRows")),a.getCenterRows=oO(()=>[a.getRowModel().rows,a.getState().rowPinning.top,a.getState().rowPinning.bottom],(a,b,c)=>{let d=new Set([...null!=b?b:[],...null!=c?c:[]]);return a.filter(a=>!d.has(a.id))},oP(a.options,"debugRows","getCenterRows"))}},{getInitialState:a=>({rowSelection:{},...a}),getDefaultOptions:a=>({onRowSelectionChange:oM("rowSelection",a),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:a=>{a.setRowSelection=b=>null==a.options.onRowSelectionChange?void 0:a.options.onRowSelectionChange(b),a.resetRowSelection=b=>{var c;return a.setRowSelection(b?{}:null!=(c=a.initialState.rowSelection)?c:{})},a.toggleAllRowsSelected=b=>{a.setRowSelection(c=>{b=void 0!==b?b:!a.getIsAllRowsSelected();let d={...c},e=a.getPreGroupedRowModel().flatRows;return b?e.forEach(a=>{a.getCanSelect()&&(d[a.id]=!0)}):e.forEach(a=>{delete d[a.id]}),d})},a.toggleAllPageRowsSelected=b=>a.setRowSelection(c=>{let d=void 0!==b?b:!a.getIsAllPageRowsSelected(),e={...c};return a.getRowModel().rows.forEach(b=>{pd(e,b.id,d,!0,a)}),e}),a.getPreSelectedRowModel=()=>a.getCoreRowModel(),a.getSelectedRowModel=oO(()=>[a.getState().rowSelection,a.getCoreRowModel()],(b,c)=>Object.keys(b).length?pe(a,c):{rows:[],flatRows:[],rowsById:{}},oP(a.options,"debugTable","getSelectedRowModel")),a.getFilteredSelectedRowModel=oO(()=>[a.getState().rowSelection,a.getFilteredRowModel()],(b,c)=>Object.keys(b).length?pe(a,c):{rows:[],flatRows:[],rowsById:{}},oP(a.options,"debugTable","getFilteredSelectedRowModel")),a.getGroupedSelectedRowModel=oO(()=>[a.getState().rowSelection,a.getSortedRowModel()],(b,c)=>Object.keys(b).length?pe(a,c):{rows:[],flatRows:[],rowsById:{}},oP(a.options,"debugTable","getGroupedSelectedRowModel")),a.getIsAllRowsSelected=()=>{let b=a.getFilteredRowModel().flatRows,{rowSelection:c}=a.getState(),d=!!(b.length&&Object.keys(c).length);return d&&b.some(a=>a.getCanSelect()&&!c[a.id])&&(d=!1),d},a.getIsAllPageRowsSelected=()=>{let b=a.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:c}=a.getState(),d=!!b.length;return d&&b.some(a=>!c[a.id])&&(d=!1),d},a.getIsSomeRowsSelected=()=>{var b;let c=Object.keys(null!=(b=a.getState().rowSelection)?b:{}).length;return c>0&&c<a.getFilteredRowModel().flatRows.length},a.getIsSomePageRowsSelected=()=>{let b=a.getPaginationRowModel().flatRows;return!a.getIsAllPageRowsSelected()&&b.filter(a=>a.getCanSelect()).some(a=>a.getIsSelected()||a.getIsSomeSelected())},a.getToggleAllRowsSelectedHandler=()=>b=>{a.toggleAllRowsSelected(b.target.checked)},a.getToggleAllPageRowsSelectedHandler=()=>b=>{a.toggleAllPageRowsSelected(b.target.checked)}},createRow:(a,b)=>{a.toggleSelected=(c,d)=>{let e=a.getIsSelected();b.setRowSelection(f=>{var g;if(c=void 0!==c?c:!e,a.getCanSelect()&&e===c)return f;let h={...f};return pd(h,a.id,c,null==(g=null==d?void 0:d.selectChildren)||g,b),h})},a.getIsSelected=()=>{let{rowSelection:c}=b.getState();return pf(a,c)},a.getIsSomeSelected=()=>{let{rowSelection:c}=b.getState();return"some"===pg(a,c)},a.getIsAllSubRowsSelected=()=>{let{rowSelection:c}=b.getState();return"all"===pg(a,c)},a.getCanSelect=()=>{var c;return"function"==typeof b.options.enableRowSelection?b.options.enableRowSelection(a):null==(c=b.options.enableRowSelection)||c},a.getCanSelectSubRows=()=>{var c;return"function"==typeof b.options.enableSubRowSelection?b.options.enableSubRowSelection(a):null==(c=b.options.enableSubRowSelection)||c},a.getCanMultiSelect=()=>{var c;return"function"==typeof b.options.enableMultiRowSelection?b.options.enableMultiRowSelection(a):null==(c=b.options.enableMultiRowSelection)||c},a.getToggleSelectedHandler=()=>{let b=a.getCanSelect();return c=>{var d;b&&a.toggleSelected(null==(d=c.target)?void 0:d.checked)}}}},{getDefaultColumnDef:()=>o6,getInitialState:a=>({columnSizing:{},columnSizingInfo:o7(),...a}),getDefaultOptions:a=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:oM("columnSizing",a),onColumnSizingInfoChange:oM("columnSizingInfo",a)}),createColumn:(a,b)=>{a.getSize=()=>{var c,d,e;let f=b.getState().columnSizing[a.id];return Math.min(Math.max(null!=(c=a.columnDef.minSize)?c:o6.minSize,null!=(d=null!=f?f:a.columnDef.size)?d:o6.size),null!=(e=a.columnDef.maxSize)?e:o6.maxSize)},a.getStart=oO(a=>[a,pa(b,a),b.getState().columnSizing],(b,c)=>c.slice(0,a.getIndex(b)).reduce((a,b)=>a+b.getSize(),0),oP(b.options,"debugColumns","getStart")),a.getAfter=oO(a=>[a,pa(b,a),b.getState().columnSizing],(b,c)=>c.slice(a.getIndex(b)+1).reduce((a,b)=>a+b.getSize(),0),oP(b.options,"debugColumns","getAfter")),a.resetSize=()=>{b.setColumnSizing(b=>{let{[a.id]:c,...d}=b;return d})},a.getCanResize=()=>{var c,d;return(null==(c=a.columnDef.enableResizing)||c)&&(null==(d=b.options.enableColumnResizing)||d)},a.getIsResizing=()=>b.getState().columnSizingInfo.isResizingColumn===a.id},createHeader:(a,b)=>{a.getSize=()=>{let b=0,c=a=>{if(a.subHeaders.length)a.subHeaders.forEach(c);else{var d;b+=null!=(d=a.column.getSize())?d:0}};return c(a),b},a.getStart=()=>{if(a.index>0){let b=a.headerGroup.headers[a.index-1];return b.getStart()+b.getSize()}return 0},a.getResizeHandler=c=>{let d=b.getColumn(a.column.id),e=null==d?void 0:d.getCanResize();return f=>{if(!d||!e||(null==f.persist||f.persist(),o9(f)&&f.touches&&f.touches.length>1))return;let g=a.getSize(),h=a?a.getLeafHeaders().map(a=>[a.column.id,a.column.getSize()]):[[d.id,d.getSize()]],i=o9(f)?Math.round(f.touches[0].clientX):f.clientX,j={},k=(a,c)=>{"number"==typeof c&&(b.setColumnSizingInfo(a=>{var d,e;let f="rtl"===b.options.columnResizeDirection?-1:1,g=(c-(null!=(d=null==a?void 0:a.startOffset)?d:0))*f,h=Math.max(g/(null!=(e=null==a?void 0:a.startSize)?e:0),-.999999);return a.columnSizingStart.forEach(a=>{let[b,c]=a;j[b]=Math.round(100*Math.max(c+c*h,0))/100}),{...a,deltaOffset:g,deltaPercentage:h}}),("onChange"===b.options.columnResizeMode||"end"===a)&&b.setColumnSizing(a=>({...a,...j})))},l=a=>k("move",a),m=a=>{k("end",a),b.setColumnSizingInfo(a=>({...a,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},n=c||("undefined"!=typeof document?document:null),o={moveHandler:a=>l(a.clientX),upHandler:a=>{null==n||n.removeEventListener("mousemove",o.moveHandler),null==n||n.removeEventListener("mouseup",o.upHandler),m(a.clientX)}},p={moveHandler:a=>(a.cancelable&&(a.preventDefault(),a.stopPropagation()),l(a.touches[0].clientX),!1),upHandler:a=>{var b;null==n||n.removeEventListener("touchmove",p.moveHandler),null==n||n.removeEventListener("touchend",p.upHandler),a.cancelable&&(a.preventDefault(),a.stopPropagation()),m(null==(b=a.touches[0])?void 0:b.clientX)}},q=!!function(){if("boolean"==typeof o8)return o8;let a=!1;try{let b=()=>{};window.addEventListener("test",b,{get passive(){return a=!0,!1}}),window.removeEventListener("test",b)}catch(b){a=!1}return o8=a}()&&{passive:!1};o9(f)?(null==n||n.addEventListener("touchmove",p.moveHandler,q),null==n||n.addEventListener("touchend",p.upHandler,q)):(null==n||n.addEventListener("mousemove",o.moveHandler,q),null==n||n.addEventListener("mouseup",o.upHandler,q)),b.setColumnSizingInfo(a=>({...a,startOffset:i,startSize:g,deltaOffset:0,deltaPercentage:0,columnSizingStart:h,isResizingColumn:d.id}))}}},createTable:a=>{a.setColumnSizing=b=>null==a.options.onColumnSizingChange?void 0:a.options.onColumnSizingChange(b),a.setColumnSizingInfo=b=>null==a.options.onColumnSizingInfoChange?void 0:a.options.onColumnSizingInfoChange(b),a.resetColumnSizing=b=>{var c;a.setColumnSizing(b?{}:null!=(c=a.initialState.columnSizing)?c:{})},a.resetHeaderSizeInfo=b=>{var c;a.setColumnSizingInfo(b?o7():null!=(c=a.initialState.columnSizingInfo)?c:o7())},a.getTotalSize=()=>{var b,c;return null!=(b=null==(c=a.getHeaderGroups()[0])?void 0:c.headers.reduce((a,b)=>a+b.getSize(),0))?b:0},a.getLeftTotalSize=()=>{var b,c;return null!=(b=null==(c=a.getLeftHeaderGroups()[0])?void 0:c.headers.reduce((a,b)=>a+b.getSize(),0))?b:0},a.getCenterTotalSize=()=>{var b,c;return null!=(b=null==(c=a.getCenterHeaderGroups()[0])?void 0:c.headers.reduce((a,b)=>a+b.getSize(),0))?b:0},a.getRightTotalSize=()=>{var b,c;return null!=(b=null==(c=a.getRightHeaderGroups()[0])?void 0:c.headers.reduce((a,b)=>a+b.getSize(),0))?b:0}}}];function pn(a,b){var c,d,e;return a?"function"==typeof(d=c=a)&&(()=>{let a=Object.getPrototypeOf(d);return a.prototype&&a.prototype.isReactComponent})()||"function"==typeof c||"object"==typeof(e=c)&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)?w.createElement(a,b):a:null}let po="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function pp(a){let b=Object.prototype.toString.call(a);return"[object Window]"===b||"[object global]"===b}function pq(a){return"nodeType"in a}function pr(a){var b,c;return a?pp(a)?a:pq(a)&&null!=(b=null==(c=a.ownerDocument)?void 0:c.defaultView)?b:window:window}function ps(a){let{Document:b}=pr(a);return a instanceof b}function pt(a){return!pp(a)&&a instanceof pr(a).HTMLElement}function pu(a){return a instanceof pr(a).SVGElement}function pv(a){return a?pp(a)?a.document:pq(a)?ps(a)?a:pt(a)||pu(a)?a.ownerDocument:document:document:document}let pw=po?w.useLayoutEffect:w.useEffect;function px(a){let b=(0,w.useRef)(a);return pw(()=>{b.current=a}),(0,w.useCallback)(function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return null==b.current?void 0:b.current(...c)},[])}function py(a,b){void 0===b&&(b=[a]);let c=(0,w.useRef)(a);return pw(()=>{c.current!==a&&(c.current=a)},b),c}function pz(a,b){let c=(0,w.useRef)();return(0,w.useMemo)(()=>{let b=a(c.current);return c.current=b,b},[...b])}function pA(a){let b=px(a),c=(0,w.useRef)(null),d=(0,w.useCallback)(a=>{a!==c.current&&(null==b||b(a,c.current)),c.current=a},[]);return[c,d]}function pB(a){let b=(0,w.useRef)();return(0,w.useEffect)(()=>{b.current=a},[a]),b.current}let pC={};function pD(a,b){return(0,w.useMemo)(()=>{if(b)return b;let c=null==pC[a]?0:pC[a]+1;return pC[a]=c,a+"-"+c},[a,b])}function pE(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return d.reduce((b,c)=>{for(let[d,e]of Object.entries(c)){let c=b[d];null!=c&&(b[d]=c+a*e)}return b},{...b})}}let pF=pE(1),pG=pE(-1);function pH(a){if(!a)return!1;let{KeyboardEvent:b}=pr(a.target);return b&&a instanceof b}function pI(a){if(function(a){if(!a)return!1;let{TouchEvent:b}=pr(a.target);return b&&a instanceof b}(a)){if(a.touches&&a.touches.length){let{clientX:b,clientY:c}=a.touches[0];return{x:b,y:c}}else if(a.changedTouches&&a.changedTouches.length){let{clientX:b,clientY:c}=a.changedTouches[0];return{x:b,y:c}}}return"clientX"in a&&"clientY"in a?{x:a.clientX,y:a.clientY}:null}let pJ=Object.freeze({Translate:{toString(a){if(!a)return;let{x:b,y:c}=a;return"translate3d("+(b?Math.round(b):0)+"px, "+(c?Math.round(c):0)+"px, 0)"}},Scale:{toString(a){if(!a)return;let{scaleX:b,scaleY:c}=a;return"scaleX("+b+") scaleY("+c+")"}},Transform:{toString(a){if(a)return[pJ.Translate.toString(a),pJ.Scale.toString(a)].join(" ")}},Transition:{toString(a){let{property:b,duration:c,easing:d}=a;return b+" "+c+"ms "+d}}}),pK="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",pL={display:"none"};function pM(a){let{id:b,value:c}=a;return y().createElement("div",{id:b,style:pL},c)}function pN(a){let{id:b,announcement:c,ariaLiveType:d="assertive"}=a;return y().createElement("div",{id:b,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":d,"aria-atomic":!0},c)}let pO=(0,w.createContext)(null),pP={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},pQ={onDragStart(a){let{active:b}=a;return"Picked up draggable item "+b.id+"."},onDragOver(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was moved over droppable area "+c.id+".":"Draggable item "+b.id+" is no longer over a droppable area."},onDragEnd(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was dropped over droppable area "+c.id:"Draggable item "+b.id+" was dropped."},onDragCancel(a){let{active:b}=a;return"Dragging was cancelled. Draggable item "+b.id+" was dropped."}};function pR(a){let{announcements:b=pQ,container:c,hiddenTextDescribedById:d,screenReaderInstructions:e=pP}=a,{announce:f,announcement:g}=function(){let[a,b]=(0,w.useState)("");return{announce:(0,w.useCallback)(a=>{null!=a&&b(a)},[]),announcement:a}}(),h=pD("DndLiveRegion"),[i,j]=(0,w.useState)(!1);(0,w.useEffect)(()=>{j(!0)},[]);var k=(0,w.useMemo)(()=>({onDragStart(a){let{active:c}=a;f(b.onDragStart({active:c}))},onDragMove(a){let{active:c,over:d}=a;b.onDragMove&&f(b.onDragMove({active:c,over:d}))},onDragOver(a){let{active:c,over:d}=a;f(b.onDragOver({active:c,over:d}))},onDragEnd(a){let{active:c,over:d}=a;f(b.onDragEnd({active:c,over:d}))},onDragCancel(a){let{active:c,over:d}=a;f(b.onDragCancel({active:c,over:d}))}}),[f,b]);let l=(0,w.useContext)(pO);if((0,w.useEffect)(()=>{if(!l)throw Error("useDndMonitor must be used within a children of <DndContext>");return l(k)},[k,l]),!i)return null;let m=y().createElement(y().Fragment,null,y().createElement(pM,{id:d,value:e.draggable}),y().createElement(pN,{id:h,announcement:g}));return c?(0,aX.createPortal)(m,c):m}function pS(){}function pT(a,b){return(0,w.useMemo)(()=>({sensor:a,options:null!=b?b:{}}),[a,b])}!function(a){a.DragStart="dragStart",a.DragMove="dragMove",a.DragEnd="dragEnd",a.DragCancel="dragCancel",a.DragOver="dragOver",a.RegisterDroppable="registerDroppable",a.SetDroppableDisabled="setDroppableDisabled",a.UnregisterDroppable="unregisterDroppable"}(l||(l={}));let pU=Object.freeze({x:0,y:0});function pV(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return c-d}function pW(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return d-c}function pX(a,b,c){return void 0===b&&(b=a.left),void 0===c&&(c=a.top),{x:b+.5*a.width,y:c+.5*a.height}}let pY=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=pX(b,b.left,b.top),f=[];for(let a of d){let{id:b}=a,d=c.get(b);if(d){let c=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))}(pX(d),e);f.push({id:b,data:{droppableContainer:a,value:c}})}}return f.sort(pV)},pZ=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=[];for(let a of d){let{id:d}=a,f=c.get(d);if(f){let c=function(a,b){let c=Math.max(b.top,a.top),d=Math.max(b.left,a.left),e=Math.min(b.left+b.width,a.left+a.width),f=Math.min(b.top+b.height,a.top+a.height);if(d<e&&c<f){let g=b.width*b.height,h=a.width*a.height,i=(e-d)*(f-c);return Number((i/(g+h-i)).toFixed(4))}return 0}(f,b);c>0&&e.push({id:d,data:{droppableContainer:a,value:c}})}}return e.sort(pW)};function p$(a,b){return a&&b?{x:a.left-b.left,y:a.top-b.top}:pU}let p_=function(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return d.reduce((b,c)=>({...b,top:b.top+a*c.y,bottom:b.bottom+a*c.y,left:b.left+a*c.x,right:b.right+a*c.x}),{...b})}}(1),p0={ignoreTransform:!1};function p1(a,b){void 0===b&&(b=p0);let c=a.getBoundingClientRect();if(b.ignoreTransform){let{transform:b,transformOrigin:d}=pr(a).getComputedStyle(a);b&&(c=function(a,b,c){let d=function(a){if(a.startsWith("matrix3d(")){let b=a.slice(9,-1).split(/, /);return{x:+b[12],y:+b[13],scaleX:+b[0],scaleY:+b[5]}}if(a.startsWith("matrix(")){let b=a.slice(7,-1).split(/, /);return{x:+b[4],y:+b[5],scaleX:+b[0],scaleY:+b[3]}}return null}(b);if(!d)return a;let{scaleX:e,scaleY:f,x:g,y:h}=d,i=a.left-g-(1-e)*parseFloat(c),j=a.top-h-(1-f)*parseFloat(c.slice(c.indexOf(" ")+1)),k=e?a.width/e:a.width,l=f?a.height/f:a.height;return{width:k,height:l,top:j,right:i+k,bottom:j+l,left:i}}(c,b,d))}let{top:d,left:e,width:f,height:g,bottom:h,right:i}=c;return{top:d,left:e,width:f,height:g,bottom:h,right:i}}function p2(a){return p1(a,{ignoreTransform:!0})}function p3(a,b){let c=[];return a?function d(e){var f;if(null!=b&&c.length>=b||!e)return c;if(ps(e)&&null!=e.scrollingElement&&!c.includes(e.scrollingElement))return c.push(e.scrollingElement),c;if(!pt(e)||pu(e)||c.includes(e))return c;let g=pr(a).getComputedStyle(e);return(e!==a&&function(a,b){void 0===b&&(b=pr(a).getComputedStyle(a));let c=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{let d=b[a];return"string"==typeof d&&c.test(d)})}(e,g)&&c.push(e),void 0===(f=g)&&(f=pr(e).getComputedStyle(e)),"fixed"===f.position)?c:d(e.parentNode)}(a):c}function p4(a){let[b]=p3(a,1);return null!=b?b:null}function p5(a){return po&&a?pp(a)?a:pq(a)?ps(a)||a===pv(a).scrollingElement?window:pt(a)?a:null:null:null}function p6(a){return pp(a)?a.scrollX:a.scrollLeft}function p7(a){return pp(a)?a.scrollY:a.scrollTop}function p8(a){return{x:p6(a),y:p7(a)}}function p9(a){return!!po&&!!a&&a===document.scrollingElement}function qa(a){let b={x:0,y:0},c=p9(a)?{height:window.innerHeight,width:window.innerWidth}:{height:a.clientHeight,width:a.clientWidth},d={x:a.scrollWidth-c.width,y:a.scrollHeight-c.height},e=a.scrollTop<=b.y,f=a.scrollLeft<=b.x;return{isTop:e,isLeft:f,isBottom:a.scrollTop>=d.y,isRight:a.scrollLeft>=d.x,maxScroll:d,minScroll:b}}!function(a){a[a.Forward=1]="Forward",a[a.Backward=-1]="Backward"}(m||(m={}));let qb={x:.2,y:.2};function qc(a){return a.reduce((a,b)=>pF(a,p8(b)),pU)}let qd=[["x",["left","right"],function(a){return a.reduce((a,b)=>a+p6(b),0)}],["y",["top","bottom"],function(a){return a.reduce((a,b)=>a+p7(b),0)}]];class qe{constructor(a,b){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;let c=p3(b),d=qc(c);for(let[b,e,f]of(this.rect={...a},this.width=a.width,this.height=a.height,qd))for(let a of e)Object.defineProperty(this,a,{get:()=>{let e=f(c),g=d[b]-e;return this.rect[a]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class qf{constructor(a){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(a=>{var b;return null==(b=this.target)?void 0:b.removeEventListener(...a)})},this.target=a}add(a,b,c){var d;null==(d=this.target)||d.addEventListener(a,b,c),this.listeners.push([a,b,c])}}function qg(a,b){let c=Math.abs(a.x),d=Math.abs(a.y);return"number"==typeof b?Math.sqrt(c**2+d**2)>b:"x"in b&&"y"in b?c>b.x&&d>b.y:"x"in b?c>b.x:"y"in b&&d>b.y}function qh(a){a.preventDefault()}function qi(a){a.stopPropagation()}!function(a){a.Click="click",a.DragStart="dragstart",a.Keydown="keydown",a.ContextMenu="contextmenu",a.Resize="resize",a.SelectionChange="selectionchange",a.VisibilityChange="visibilitychange"}(n||(n={})),function(a){a.Space="Space",a.Down="ArrowDown",a.Right="ArrowRight",a.Left="ArrowLeft",a.Up="ArrowUp",a.Esc="Escape",a.Enter="Enter",a.Tab="Tab"}(o||(o={}));let qj={start:[o.Space,o.Enter],cancel:[o.Esc],end:[o.Space,o.Enter,o.Tab]},qk=(a,b)=>{let{currentCoordinates:c}=b;switch(a.code){case o.Right:return{...c,x:c.x+25};case o.Left:return{...c,x:c.x-25};case o.Down:return{...c,y:c.y+25};case o.Up:return{...c,y:c.y-25}}};class ql{constructor(a){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=a;let{event:{target:b}}=a;this.props=a,this.listeners=new qf(pv(b)),this.windowListeners=new qf(pr(b)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(n.Resize,this.handleCancel),this.windowListeners.add(n.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(n.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:a,onStart:b}=this.props,c=a.node.current;c&&function(a,b){if(void 0===b&&(b=p1),!a)return;let{top:c,left:d,bottom:e,right:f}=b(a);p4(a)&&(e<=0||f<=0||c>=window.innerHeight||d>=window.innerWidth)&&a.scrollIntoView({block:"center",inline:"center"})}(c),b(pU)}handleKeyDown(a){if(pH(a)){let{active:b,context:c,options:d}=this.props,{keyboardCodes:e=qj,coordinateGetter:f=qk,scrollBehavior:g="smooth"}=d,{code:h}=a;if(e.end.includes(h))return void this.handleEnd(a);if(e.cancel.includes(h))return void this.handleCancel(a);let{collisionRect:i}=c.current,j=i?{x:i.left,y:i.top}:pU;this.referenceCoordinates||(this.referenceCoordinates=j);let k=f(a,{active:b,context:c.current,currentCoordinates:j});if(k){let b=pG(k,j),d={x:0,y:0},{scrollableAncestors:e}=c.current;for(let c of e){let e=a.code,{isTop:f,isRight:h,isLeft:i,isBottom:j,maxScroll:l,minScroll:m}=qa(c),n=function(a){if(a===document.scrollingElement){let{innerWidth:a,innerHeight:b}=window;return{top:0,left:0,right:a,bottom:b,width:a,height:b}}let{top:b,left:c,right:d,bottom:e}=a.getBoundingClientRect();return{top:b,left:c,right:d,bottom:e,width:a.clientWidth,height:a.clientHeight}}(c),p={x:Math.min(e===o.Right?n.right-n.width/2:n.right,Math.max(e===o.Right?n.left:n.left+n.width/2,k.x)),y:Math.min(e===o.Down?n.bottom-n.height/2:n.bottom,Math.max(e===o.Down?n.top:n.top+n.height/2,k.y))},q=e===o.Right&&!h||e===o.Left&&!i,r=e===o.Down&&!j||e===o.Up&&!f;if(q&&p.x!==k.x){let a=c.scrollLeft+b.x,f=e===o.Right&&a<=l.x||e===o.Left&&a>=m.x;if(f&&!b.y)return void c.scrollTo({left:a,behavior:g});f?d.x=c.scrollLeft-a:d.x=e===o.Right?c.scrollLeft-l.x:c.scrollLeft-m.x,d.x&&c.scrollBy({left:-d.x,behavior:g});break}if(r&&p.y!==k.y){let a=c.scrollTop+b.y,f=e===o.Down&&a<=l.y||e===o.Up&&a>=m.y;if(f&&!b.x)return void c.scrollTo({top:a,behavior:g});f?d.y=c.scrollTop-a:d.y=e===o.Down?c.scrollTop-l.y:c.scrollTop-m.y,d.y&&c.scrollBy({top:-d.y,behavior:g});break}}this.handleMove(a,pF(pG(k,this.referenceCoordinates),d))}}}handleMove(a,b){let{onMove:c}=this.props;a.preventDefault(),c(b)}handleEnd(a){let{onEnd:b}=this.props;a.preventDefault(),this.detach(),b()}handleCancel(a){let{onCancel:b}=this.props;a.preventDefault(),this.detach(),b()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function qm(a){return!!(a&&"distance"in a)}function qn(a){return!!(a&&"delay"in a)}ql.activators=[{eventName:"onKeyDown",handler:(a,b,c)=>{let{keyboardCodes:d=qj,onActivation:e}=b,{active:f}=c,{code:g}=a.nativeEvent;if(d.start.includes(g)){let b=f.activatorNode.current;return(!b||a.target===b)&&(a.preventDefault(),null==e||e({event:a.nativeEvent}),!0)}return!1}}];class qo{constructor(a,b,c){var d;void 0===c&&(c=function(a){let{EventTarget:b}=pr(a);return a instanceof b?a:pv(a)}(a.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=a,this.events=b;let{event:e}=a,{target:f}=e;this.props=a,this.events=b,this.document=pv(f),this.documentListeners=new qf(this.document),this.listeners=new qf(c),this.windowListeners=new qf(pr(f)),this.initialCoordinates=null!=(d=pI(e))?d:pU,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:a,props:{options:{activationConstraint:b,bypassActivationConstraint:c}}}=this;if(this.listeners.add(a.move.name,this.handleMove,{passive:!1}),this.listeners.add(a.end.name,this.handleEnd),a.cancel&&this.listeners.add(a.cancel.name,this.handleCancel),this.windowListeners.add(n.Resize,this.handleCancel),this.windowListeners.add(n.DragStart,qh),this.windowListeners.add(n.VisibilityChange,this.handleCancel),this.windowListeners.add(n.ContextMenu,qh),this.documentListeners.add(n.Keydown,this.handleKeydown),b){if(null!=c&&c({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(qn(b)){this.timeoutId=setTimeout(this.handleStart,b.delay),this.handlePending(b);return}if(qm(b))return void this.handlePending(b)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(a,b){let{active:c,onPending:d}=this.props;d(c,a,this.initialCoordinates,b)}handleStart(){let{initialCoordinates:a}=this,{onStart:b}=this.props;a&&(this.activated=!0,this.documentListeners.add(n.Click,qi,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(n.SelectionChange,this.removeTextSelection),b(a))}handleMove(a){var b;let{activated:c,initialCoordinates:d,props:e}=this,{onMove:f,options:{activationConstraint:g}}=e;if(!d)return;let h=null!=(b=pI(a))?b:pU,i=pG(d,h);if(!c&&g){if(qm(g)){if(null!=g.tolerance&&qg(i,g.tolerance))return this.handleCancel();if(qg(i,g.distance))return this.handleStart()}return qn(g)&&qg(i,g.tolerance)?this.handleCancel():void this.handlePending(g,i)}a.cancelable&&a.preventDefault(),f(h)}handleEnd(){let{onAbort:a,onEnd:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleCancel(){let{onAbort:a,onCancel:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleKeydown(a){a.code===o.Esc&&this.handleCancel()}removeTextSelection(){var a;null==(a=this.document.getSelection())||a.removeAllRanges()}}let qp={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class qq extends qo{constructor(a){let{event:b}=a;super(a,qp,pv(b.target))}}qq.activators=[{eventName:"onPointerDown",handler:(a,b)=>{let{nativeEvent:c}=a,{onActivation:d}=b;return!!c.isPrimary&&0===c.button&&(null==d||d({event:c}),!0)}}];let qr={move:{name:"mousemove"},end:{name:"mouseup"}};!function(a){a[a.RightClick=2]="RightClick"}(p||(p={}));class qs extends qo{constructor(a){super(a,qr,pv(a.event.target))}}qs.activators=[{eventName:"onMouseDown",handler:(a,b)=>{let{nativeEvent:c}=a,{onActivation:d}=b;return c.button!==p.RightClick&&(null==d||d({event:c}),!0)}}];let qt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class qu extends qo{constructor(a){super(a,qt)}static setup(){return window.addEventListener(qt.move.name,a,{capture:!1,passive:!1}),function(){window.removeEventListener(qt.move.name,a)};function a(){}}}qu.activators=[{eventName:"onTouchStart",handler:(a,b)=>{let{nativeEvent:c}=a,{onActivation:d}=b,{touches:e}=c;return!(e.length>1)&&(null==d||d({event:c}),!0)}}],function(a){a[a.Pointer=0]="Pointer",a[a.DraggableRect=1]="DraggableRect"}(q||(q={})),function(a){a[a.TreeOrder=0]="TreeOrder",a[a.ReversedTreeOrder=1]="ReversedTreeOrder"}(r||(r={}));let qv={x:{[m.Backward]:!1,[m.Forward]:!1},y:{[m.Backward]:!1,[m.Forward]:!1}};!function(a){a[a.Always=0]="Always",a[a.BeforeDragging=1]="BeforeDragging",a[a.WhileDragging=2]="WhileDragging"}(s||(s={})),(t||(t={})).Optimized="optimized";let qw=new Map;function qx(a,b){return pz(c=>a?c||("function"==typeof b?b(a):a):null,[b,a])}function qy(a){let{callback:b,disabled:c}=a,d=px(b),e=(0,w.useMemo)(()=>{if(c||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:a}=window;return new a(d)},[c]);return(0,w.useEffect)(()=>()=>null==e?void 0:e.disconnect(),[e]),e}function qz(a){return new qe(p1(a),a)}function qA(a,b,c){void 0===b&&(b=qz);let[d,e]=(0,w.useState)(null);function f(){e(d=>{if(!a)return null;if(!1===a.isConnected){var e;return null!=(e=null!=d?d:c)?e:null}let f=b(a);return JSON.stringify(d)===JSON.stringify(f)?d:f})}let g=function(a){let{callback:b,disabled:c}=a,d=px(b),e=(0,w.useMemo)(()=>{if(c||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:a}=window;return new a(d)},[d,c]);return(0,w.useEffect)(()=>()=>null==e?void 0:e.disconnect(),[e]),e}({callback(b){if(a)for(let c of b){let{type:b,target:d}=c;if("childList"===b&&d instanceof HTMLElement&&d.contains(a)){f();break}}}}),h=qy({callback:f});return pw(()=>{f(),a?(null==h||h.observe(a),null==g||g.observe(document.body,{childList:!0,subtree:!0})):(null==h||h.disconnect(),null==g||g.disconnect())},[a]),d}let qB=[];function qC(a,b){void 0===b&&(b=[]);let c=(0,w.useRef)(null);return(0,w.useEffect)(()=>{c.current=null},b),(0,w.useEffect)(()=>{let b=a!==pU;b&&!c.current&&(c.current=a),!b&&c.current&&(c.current=null)},[a]),c.current?pG(a,c.current):pU}function qD(a){return(0,w.useMemo)(()=>a?function(a){let b=a.innerWidth,c=a.innerHeight;return{top:0,left:0,right:b,bottom:c,width:b,height:c}}(a):null,[a])}let qE=[],qF=[{sensor:qq,options:{}},{sensor:ql,options:{}}],qG={current:{}},qH={draggable:{measure:p2},droppable:{measure:p2,strategy:s.WhileDragging,frequency:t.Optimized},dragOverlay:{measure:p1}};class qI extends Map{get(a){var b;return null!=a&&null!=(b=super.get(a))?b:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(a=>{let{disabled:b}=a;return!b})}getNodeFor(a){var b,c;return null!=(b=null==(c=this.get(a))?void 0:c.node.current)?b:void 0}}let qJ={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new qI,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:pS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:qH,measureDroppableContainers:pS,windowRect:null,measuringScheduled:!1},qK={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:pS,draggableNodes:new Map,over:null,measureDroppableContainers:pS},qL=(0,w.createContext)(qK),qM=(0,w.createContext)(qJ);function qN(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new qI}}}function qO(a,b){switch(b.type){case l.DragStart:return{...a,draggable:{...a.draggable,initialCoordinates:b.initialCoordinates,active:b.active}};case l.DragMove:if(null==a.draggable.active)return a;return{...a,draggable:{...a.draggable,translate:{x:b.coordinates.x-a.draggable.initialCoordinates.x,y:b.coordinates.y-a.draggable.initialCoordinates.y}}};case l.DragEnd:case l.DragCancel:return{...a,draggable:{...a.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case l.RegisterDroppable:{let{element:c}=b,{id:d}=c,e=new qI(a.droppable.containers);return e.set(d,c),{...a,droppable:{...a.droppable,containers:e}}}case l.SetDroppableDisabled:{let{id:c,key:d,disabled:e}=b,f=a.droppable.containers.get(c);if(!f||d!==f.key)return a;let g=new qI(a.droppable.containers);return g.set(c,{...f,disabled:e}),{...a,droppable:{...a.droppable,containers:g}}}case l.UnregisterDroppable:{let{id:c,key:d}=b,e=a.droppable.containers.get(c);if(!e||d!==e.key)return a;let f=new qI(a.droppable.containers);return f.delete(c),{...a,droppable:{...a.droppable,containers:f}}}default:return a}}function qP(a){let{disabled:b}=a,{active:c,activatorEvent:d,draggableNodes:e}=(0,w.useContext)(qL),f=pB(d),g=pB(null==c?void 0:c.id);return(0,w.useEffect)(()=>{if(!b&&!d&&f&&null!=g){if(!pH(f)||document.activeElement===f.target)return;let a=e.get(g);if(!a)return;let{activatorNode:b,node:c}=a;(b.current||c.current)&&requestAnimationFrame(()=>{for(let a of[b.current,c.current]){if(!a)continue;let b=a.matches(pK)?a:a.querySelector(pK);if(b){b.focus();break}}})}},[d,b,e,g,f]),null}let qQ=(0,w.createContext)({...pU,scaleX:1,scaleY:1});!function(a){a[a.Uninitialized=0]="Uninitialized",a[a.Initializing=1]="Initializing",a[a.Initialized=2]="Initialized"}(u||(u={}));let qR=(0,w.memo)(function(a){var b,c,d,e,f,g;let{id:h,accessibility:i,autoScroll:j=!0,children:k,sensors:n=qF,collisionDetection:o=pZ,measuring:p,modifiers:t,...v}=a,[x,z]=(0,w.useReducer)(qO,void 0,qN),[A,B]=function(){let[a]=(0,w.useState)(()=>new Set),b=(0,w.useCallback)(b=>(a.add(b),()=>a.delete(b)),[a]);return[(0,w.useCallback)(b=>{let{type:c,event:d}=b;a.forEach(a=>{var b;return null==(b=a[c])?void 0:b.call(a,d)})},[a]),b]}(),[C,D]=(0,w.useState)(u.Uninitialized),E=C===u.Initialized,{draggable:{active:F,nodes:G,translate:H},droppable:{containers:I}}=x,J=null!=F?G.get(F):null,K=(0,w.useRef)({initial:null,translated:null}),L=(0,w.useMemo)(()=>{var a;return null!=F?{id:F,data:null!=(a=null==J?void 0:J.data)?a:qG,rect:K}:null},[F,J]),M=(0,w.useRef)(null),[N,O]=(0,w.useState)(null),[P,Q]=(0,w.useState)(null),R=py(v,Object.values(v)),S=pD("DndDescribedBy",h),T=(0,w.useMemo)(()=>I.getEnabled(),[I]),U=(0,w.useMemo)(()=>({draggable:{...qH.draggable,...null==p?void 0:p.draggable},droppable:{...qH.droppable,...null==p?void 0:p.droppable},dragOverlay:{...qH.dragOverlay,...null==p?void 0:p.dragOverlay}}),[null==p?void 0:p.draggable,null==p?void 0:p.droppable,null==p?void 0:p.dragOverlay]),{droppableRects:V,measureDroppableContainers:W,measuringScheduled:X}=function(a,b){let{dragging:c,dependencies:d,config:e}=b,[f,g]=(0,w.useState)(null),{frequency:h,measure:i,strategy:j}=e,k=(0,w.useRef)(a),l=function(){switch(j){case s.Always:return!1;case s.BeforeDragging:return c;default:return!c}}(),m=py(l),n=(0,w.useCallback)(function(a){void 0===a&&(a=[]),m.current||g(b=>null===b?a:b.concat(a.filter(a=>!b.includes(a))))},[m]),o=(0,w.useRef)(null),p=pz(b=>{if(l&&!c)return qw;if(!b||b===qw||k.current!==a||null!=f){let b=new Map;for(let c of a){if(!c)continue;if(f&&f.length>0&&!f.includes(c.id)&&c.rect.current){b.set(c.id,c.rect.current);continue}let a=c.node.current,d=a?new qe(i(a),a):null;c.rect.current=d,d&&b.set(c.id,d)}return b}return b},[a,f,c,l,i]);return(0,w.useEffect)(()=>{k.current=a},[a]),(0,w.useEffect)(()=>{l||n()},[c,l]),(0,w.useEffect)(()=>{f&&f.length>0&&g(null)},[JSON.stringify(f)]),(0,w.useEffect)(()=>{l||"number"!=typeof h||null!==o.current||(o.current=setTimeout(()=>{n(),o.current=null},h))},[h,l,n,...d]),{droppableRects:p,measureDroppableContainers:n,measuringScheduled:null!=f}}(T,{dragging:E,dependencies:[H.x,H.y],config:U.droppable}),Y=function(a,b){let c=null!=b?a.get(b):void 0,d=c?c.node.current:null;return pz(a=>{var c;return null==b?null:null!=(c=null!=d?d:a)?c:null},[d,b])}(G,F),Z=(0,w.useMemo)(()=>P?pI(P):null,[P]),_=function(){let a=(null==N?void 0:N.autoScrollEnabled)===!1,b="object"==typeof j?!1===j.enabled:!1===j,c=E&&!a&&!b;return"object"==typeof j?{...j,enabled:c}:{enabled:c}}(),aa=qx(Y,U.draggable.measure);!function(a){let{activeNode:b,measure:c,initialRect:d,config:e=!0}=a,f=(0,w.useRef)(!1),{x:g,y:h}="boolean"==typeof e?{x:e,y:e}:e;pw(()=>{if(!g&&!h||!b){f.current=!1;return}if(f.current||!d)return;let a=null==b?void 0:b.node.current;if(!a||!1===a.isConnected)return;let e=p$(c(a),d);if(g||(e.x=0),h||(e.y=0),f.current=!0,Math.abs(e.x)>0||Math.abs(e.y)>0){let b=p4(a);b&&b.scrollBy({top:e.y,left:e.x})}},[b,g,h,d,c])}({activeNode:null!=F?G.get(F):null,config:_.layoutShiftCompensation,initialRect:aa,measure:U.draggable.measure});let ab=qA(Y,U.draggable.measure,aa),ac=qA(Y?Y.parentElement:null),ad=(0,w.useRef)({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:V,draggableNodes:G,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ae=I.getNodeFor(null==(b=ad.current.over)?void 0:b.id),af=function(a){let{measure:b}=a,[c,d]=(0,w.useState)(null),e=qy({callback:(0,w.useCallback)(a=>{for(let{target:c}of a)if(pt(c)){d(a=>{let d=b(c);return a?{...a,width:d.width,height:d.height}:d});break}},[b])}),[f,g]=pA((0,w.useCallback)(a=>{let c=function(a){if(!a)return null;if(a.children.length>1)return a;let b=a.children[0];return pt(b)?b:a}(a);null==e||e.disconnect(),c&&(null==e||e.observe(c)),d(c?b(c):null)},[b,e]));return(0,w.useMemo)(()=>({nodeRef:f,rect:c,setRef:g}),[c,f,g])}({measure:U.dragOverlay.measure}),ag=null!=(c=af.nodeRef.current)?c:Y,ah=E?null!=(d=af.rect)?d:ab:null,ai=!!(af.nodeRef.current&&af.rect),aj=function(a){let b=qx(a);return p$(a,b)}(ai?null:ab),ak=qD(ag?pr(ag):null),al=function(a){let b=(0,w.useRef)(a),c=pz(c=>a?c&&c!==qB&&a&&b.current&&a.parentNode===b.current.parentNode?c:p3(a):qB,[a]);return(0,w.useEffect)(()=>{b.current=a},[a]),c}(E?null!=ae?ae:Y:null),am=function(a,b){void 0===b&&(b=p1);let[c]=a,d=qD(c?pr(c):null),[e,f]=(0,w.useState)(qE);function g(){f(()=>a.length?a.map(a=>p9(a)?d:new qe(b(a),a)):qE)}let h=qy({callback:g});return pw(()=>{null==h||h.disconnect(),g(),a.forEach(a=>null==h?void 0:h.observe(a))},[a]),e}(al),an=function(a,b){let{transform:c,...d}=b;return null!=a&&a.length?a.reduce((a,b)=>b({transform:a,...d}),c):c}(t,{transform:{x:H.x-aj.x,y:H.y-aj.y,scaleX:1,scaleY:1},activatorEvent:P,active:L,activeNodeRect:ab,containerNodeRect:ac,draggingNodeRect:ah,over:ad.current.over,overlayNodeRect:af.rect,scrollableAncestors:al,scrollableAncestorRects:am,windowRect:ak}),ao=Z?pF(Z,H):null,ap=function(a){let[b,c]=(0,w.useState)(null),d=(0,w.useRef)(a),e=(0,w.useCallback)(a=>{let b=p5(a.target);b&&c(a=>a?(a.set(b,p8(b)),new Map(a)):null)},[]);return(0,w.useEffect)(()=>{let b=d.current;if(a!==b){f(b);let g=a.map(a=>{let b=p5(a);return b?(b.addEventListener("scroll",e,{passive:!0}),[b,p8(b)]):null}).filter(a=>null!=a);c(g.length?new Map(g):null),d.current=a}return()=>{f(a),f(b)};function f(a){a.forEach(a=>{let b=p5(a);null==b||b.removeEventListener("scroll",e)})}},[e,a]),(0,w.useMemo)(()=>a.length?b?Array.from(b.values()).reduce((a,b)=>pF(a,b),pU):qc(a):pU,[a,b])}(al),aq=qC(ap),ar=qC(ap,[ab]),as=pF(an,aq),at=ah?p_(ah,an):null,au=L&&at?o({active:L,collisionRect:at,droppableRects:V,droppableContainers:T,pointerCoordinates:ao}):null,av=function(a,b){if(!a||0===a.length)return null;let[c]=a;return c.id}(au,"id"),[aw,ax]=(0,w.useState)(null),ay=(f=ai?an:pF(an,ar),g=null!=(e=null==aw?void 0:aw.rect)?e:null,{...f,scaleX:g&&ab?g.width/ab.width:1,scaleY:g&&ab?g.height/ab.height:1}),az=(0,w.useRef)(null),aA=(0,w.useCallback)((a,b)=>{let{sensor:c,options:d}=b;if(null==M.current)return;let e=G.get(M.current);if(!e)return;let f=a.nativeEvent,g=new c({active:M.current,activeNode:e,event:f,options:d,context:ad,onAbort(a){if(!G.get(a))return;let{onDragAbort:b}=R.current,c={id:a};null==b||b(c),A({type:"onDragAbort",event:c})},onPending(a,b,c,d){if(!G.get(a))return;let{onDragPending:e}=R.current,f={id:a,constraint:b,initialCoordinates:c,offset:d};null==e||e(f),A({type:"onDragPending",event:f})},onStart(a){let b=M.current;if(null==b)return;let c=G.get(b);if(!c)return;let{onDragStart:d}=R.current,e={activatorEvent:f,active:{id:b,data:c.data,rect:K}};(0,aX.unstable_batchedUpdates)(()=>{null==d||d(e),D(u.Initializing),z({type:l.DragStart,initialCoordinates:a,active:b}),A({type:"onDragStart",event:e}),O(az.current),Q(f)})},onMove(a){z({type:l.DragMove,coordinates:a})},onEnd:h(l.DragEnd),onCancel:h(l.DragCancel)});function h(a){return async function(){let{active:b,collisions:c,over:d,scrollAdjustedTranslate:e}=ad.current,g=null;if(b&&e){let{cancelDrop:h}=R.current;g={activatorEvent:f,active:b,collisions:c,delta:e,over:d},a===l.DragEnd&&"function"==typeof h&&await Promise.resolve(h(g))&&(a=l.DragCancel)}M.current=null,(0,aX.unstable_batchedUpdates)(()=>{z({type:a}),D(u.Uninitialized),ax(null),O(null),Q(null),az.current=null;let b=a===l.DragEnd?"onDragEnd":"onDragCancel";if(g){let a=R.current[b];null==a||a(g),A({type:b,event:g})}})}}az.current=g},[G]),aB=(0,w.useCallback)((a,b)=>(c,d)=>{let e=c.nativeEvent,f=G.get(d);null!==M.current||!f||e.dndKit||e.defaultPrevented||!0===a(c,b.options,{active:f})&&(e.dndKit={capturedBy:b.sensor},M.current=d,aA(c,b))},[G,aA]),aC=(0,w.useMemo)(()=>n.reduce((a,b)=>{let{sensor:c}=b;return[...a,...c.activators.map(a=>({eventName:a.eventName,handler:aB(a.handler,b)}))]},[]),[n,aB]);(0,w.useEffect)(()=>{if(!po)return;let a=n.map(a=>{let{sensor:b}=a;return null==b.setup?void 0:b.setup()});return()=>{for(let b of a)null==b||b()}},n.map(a=>{let{sensor:b}=a;return b})),pw(()=>{ab&&C===u.Initializing&&D(u.Initialized)},[ab,C]),(0,w.useEffect)(()=>{let{onDragMove:a}=R.current,{active:b,activatorEvent:c,collisions:d,over:e}=ad.current;if(!b||!c)return;let f={active:b,activatorEvent:c,collisions:d,delta:{x:as.x,y:as.y},over:e};(0,aX.unstable_batchedUpdates)(()=>{null==a||a(f),A({type:"onDragMove",event:f})})},[as.x,as.y]),(0,w.useEffect)(()=>{let{active:a,activatorEvent:b,collisions:c,droppableContainers:d,scrollAdjustedTranslate:e}=ad.current;if(!a||null==M.current||!b||!e)return;let{onDragOver:f}=R.current,g=d.get(av),h=g&&g.rect.current?{id:g.id,rect:g.rect.current,data:g.data,disabled:g.disabled}:null,i={active:a,activatorEvent:b,collisions:c,delta:{x:e.x,y:e.y},over:h};(0,aX.unstable_batchedUpdates)(()=>{ax(h),null==f||f(i),A({type:"onDragOver",event:i})})},[av]),pw(()=>{ad.current={activatorEvent:P,active:L,activeNode:Y,collisionRect:at,collisions:au,droppableRects:V,draggableNodes:G,draggingNode:ag,draggingNodeRect:ah,droppableContainers:I,over:aw,scrollableAncestors:al,scrollAdjustedTranslate:as},K.current={initial:ah,translated:at}},[L,Y,au,at,G,ag,ah,V,I,aw,al,as]),function(a){let{acceleration:b,activator:c=q.Pointer,canScroll:d,draggingRect:e,enabled:f,interval:g=5,order:h=r.TreeOrder,pointerCoordinates:i,scrollableAncestors:j,scrollableAncestorRects:k,delta:l,threshold:n}=a,o=function(a){let{delta:b,disabled:c}=a,d=pB(b);return pz(a=>{if(c||!d||!a)return qv;let e={x:Math.sign(b.x-d.x),y:Math.sign(b.y-d.y)};return{x:{[m.Backward]:a.x[m.Backward]||-1===e.x,[m.Forward]:a.x[m.Forward]||1===e.x},y:{[m.Backward]:a.y[m.Backward]||-1===e.y,[m.Forward]:a.y[m.Forward]||1===e.y}}},[c,b,d])}({delta:l,disabled:!f}),[p,s]=function(){let a=(0,w.useRef)(null);return[(0,w.useCallback)((b,c)=>{a.current=setInterval(b,c)},[]),(0,w.useCallback)(()=>{null!==a.current&&(clearInterval(a.current),a.current=null)},[])]}(),t=(0,w.useRef)({x:0,y:0}),u=(0,w.useRef)({x:0,y:0}),v=(0,w.useMemo)(()=>{switch(c){case q.Pointer:return i?{top:i.y,bottom:i.y,left:i.x,right:i.x}:null;case q.DraggableRect:return e}},[c,e,i]),x=(0,w.useRef)(null),y=(0,w.useCallback)(()=>{let a=x.current;if(!a)return;let b=t.current.x*u.current.x,c=t.current.y*u.current.y;a.scrollBy(b,c)},[]),z=(0,w.useMemo)(()=>h===r.TreeOrder?[...j].reverse():j,[h,j]);(0,w.useEffect)(()=>{if(!f||!j.length||!v)return void s();for(let a of z){if((null==d?void 0:d(a))===!1)continue;let c=k[j.indexOf(a)];if(!c)continue;let{direction:e,speed:f}=function(a,b,c,d,e){let{top:f,left:g,right:h,bottom:i}=c;void 0===d&&(d=10),void 0===e&&(e=qb);let{isTop:j,isBottom:k,isLeft:l,isRight:n}=qa(a),o={x:0,y:0},p={x:0,y:0},q={height:b.height*e.y,width:b.width*e.x};return!j&&f<=b.top+q.height?(o.y=m.Backward,p.y=d*Math.abs((b.top+q.height-f)/q.height)):!k&&i>=b.bottom-q.height&&(o.y=m.Forward,p.y=d*Math.abs((b.bottom-q.height-i)/q.height)),!n&&h>=b.right-q.width?(o.x=m.Forward,p.x=d*Math.abs((b.right-q.width-h)/q.width)):!l&&g<=b.left+q.width&&(o.x=m.Backward,p.x=d*Math.abs((b.left+q.width-g)/q.width)),{direction:o,speed:p}}(a,c,v,b,n);for(let a of["x","y"])o[a][e[a]]||(f[a]=0,e[a]=0);if(f.x>0||f.y>0){s(),x.current=a,p(y,g),t.current=f,u.current=e;return}}t.current={x:0,y:0},u.current={x:0,y:0},s()},[b,y,d,s,f,g,JSON.stringify(v),JSON.stringify(o),p,j,z,k,JSON.stringify(n)])}({..._,delta:H,draggingRect:at,pointerCoordinates:ao,scrollableAncestors:al,scrollableAncestorRects:am});let aD=(0,w.useMemo)(()=>({active:L,activeNode:Y,activeNodeRect:ab,activatorEvent:P,collisions:au,containerNodeRect:ac,dragOverlay:af,draggableNodes:G,droppableContainers:I,droppableRects:V,over:aw,measureDroppableContainers:W,scrollableAncestors:al,scrollableAncestorRects:am,measuringConfiguration:U,measuringScheduled:X,windowRect:ak}),[L,Y,ab,P,au,ac,af,G,I,V,aw,W,al,am,U,X,ak]),aE=(0,w.useMemo)(()=>({activatorEvent:P,activators:aC,active:L,activeNodeRect:ab,ariaDescribedById:{draggable:S},dispatch:z,draggableNodes:G,over:aw,measureDroppableContainers:W}),[P,aC,L,ab,z,S,G,aw,W]);return y().createElement(pO.Provider,{value:B},y().createElement(qL.Provider,{value:aE},y().createElement(qM.Provider,{value:aD},y().createElement(qQ.Provider,{value:ay},k)),y().createElement(qP,{disabled:(null==i?void 0:i.restoreFocus)===!1})),y().createElement(pR,{...i,hiddenTextDescribedById:S}))}),qS=(0,w.createContext)(null),qT="button",qU={timeout:25};function qV(a,b,c){let d=a.slice();return d.splice(c<0?d.length+c:c,0,d.splice(b,1)[0]),d}function qW(a){return null!==a&&a>=0}let qX={scaleX:1,scaleY:1},qY=a=>{var b;let{rects:c,activeNodeRect:d,activeIndex:e,overIndex:f,index:g}=a,h=null!=(b=c[e])?b:d;if(!h)return null;let i=function(a,b,c){let d=a[b],e=a[b-1],f=a[b+1];return d&&(e||f)?c<b?e?d.left-(e.left+e.width):f.left-(d.left+d.width):f?f.left-(d.left+d.width):d.left-(e.left+e.width):0}(c,g,e);if(g===e){let a=c[f];return a?{x:e<f?a.left+a.width-(h.left+h.width):a.left-h.left,y:0,...qX}:null}return g>e&&g<=f?{x:-h.width-i,y:0,...qX}:g<e&&g>=f?{x:h.width+i,y:0,...qX}:{x:0,y:0,...qX}},qZ=a=>{let{rects:b,activeIndex:c,overIndex:d,index:e}=a,f=qV(b,d,c),g=b[e],h=f[e];return h&&g?{x:h.left-g.left,y:h.top-g.top,scaleX:h.width/g.width,scaleY:h.height/g.height}:null},q$="Sortable",q_=y().createContext({activeIndex:-1,containerId:q$,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:qZ,disabled:{draggable:!1,droppable:!1}});function q0(a){let{children:b,id:c,items:d,strategy:e=qZ,disabled:f=!1}=a,{active:g,dragOverlay:h,droppableRects:i,over:j,measureDroppableContainers:k}=(0,w.useContext)(qM),l=pD(q$,c),m=null!==h.rect,n=(0,w.useMemo)(()=>d.map(a=>"object"==typeof a&&"id"in a?a.id:a),[d]),o=null!=g,p=g?n.indexOf(g.id):-1,q=j?n.indexOf(j.id):-1,r=(0,w.useRef)(n),s=!function(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}(n,r.current),t=-1!==q&&-1===p||s,u="boolean"==typeof f?{draggable:f,droppable:f}:f;pw(()=>{s&&o&&k(n)},[s,n,o,k]),(0,w.useEffect)(()=>{r.current=n},[n]);let v=(0,w.useMemo)(()=>({activeIndex:p,containerId:l,disabled:u,disableTransforms:t,items:n,overIndex:q,useDragOverlay:m,sortedRects:n.reduce((a,b,c)=>{let d=i.get(b);return d&&(a[c]=d),a},Array(n.length)),strategy:e}),[p,l,u.draggable,u.droppable,t,n,q,i,m,e]);return y().createElement(q_.Provider,{value:v},b)}let q1=a=>{let{id:b,items:c,activeIndex:d,overIndex:e}=a;return qV(c,d,e).indexOf(b)},q2=a=>{let{containerId:b,isSorting:c,wasDragging:d,index:e,items:f,newIndex:g,previousItems:h,previousContainerId:i,transition:j}=a;return!!j&&!!d&&(h===f||e!==g)&&(!!c||g!==e&&b===i)},q3={duration:200,easing:"ease"},q4="transform",q5=pJ.Transition.toString({property:q4,duration:0,easing:"linear"}),q6={roleDescription:"sortable"};o.Down,o.Right,o.Up,o.Left;let q7=["Expert Dynamics 365 Sales","Expert Dynamics 365 Customer Insights","Expert Dynamics 365 Customer Service","Expert Dynamics 365 Contact Center","Expert Power Platform","Architecte d'Int\xe9gration","Expert S\xe9curit\xe9 Azure","Expert Conformit\xe9 et RGPD"];function q8(){let{selectedResultIndex:a,results:b,llmConfigs:c,setSelectedResultIndex:d,updateSingleResult:e,generationParams:f}=D(),[g,h]=(0,w.useState)(null),[i,j]=(0,w.useState)(!1),[k,l]=(0,w.useState)(f),m=(a,b)=>{g&&h({...g,[a]:b})},n=async()=>{if(g){j(!0),fD.oR.info("R\xe9g\xe9n\xe9ration en cours...");try{let{result:a}=await or(g.question,c,k),b={...g};for(let c in a)"question"!==c&&(b[c]=a[c]);let d=c.find(a=>a.isValidated)?.provider;!b.selectedAnswer&&d&&a[d]&&(b.selectedAnswer=d),h(b),fD.oR.success("R\xe9ponse r\xe9g\xe9n\xe9r\xe9e avec succ\xe8s !")}catch(a){fD.oR.error("La r\xe9g\xe9n\xe9ration a \xe9chou\xe9.",{description:a.message})}finally{j(!1)}}};return g?(0,v.jsx)(oC,{open:null!==a,onOpenChange:b=>!i&&d(b?a:null),children:(0,v.jsxs)(oF,{className:"w-full md:w-[60vw] sm:max-w-none flex flex-col",children:[(0,v.jsx)(oG,{children:(0,v.jsx)(oI,{children:"D\xe9tail et Modification"})}),i&&(0,v.jsxs)("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center z-10",children:[(0,v.jsx)(fy.A,{className:"h-8 w-8 animate-spin"}),(0,v.jsx)("p",{className:"ml-2",children:"R\xe9g\xe9n\xe9ration en cours..."})]}),(0,v.jsxs)("div",{className:"space-y-4 py-4 flex-1 overflow-y-auto",children:[(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsx)(aU,{children:"Question"})}),(0,v.jsx)(aV,{children:(0,v.jsx)("p",{className:"text-sm font-medium",children:g.question})})]}),c.filter(a=>a.isValidated).map(a=>(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsxs)(aU,{children:["R\xe9ponse de ",a.provider]})}),(0,v.jsx)(aV,{children:(0,v.jsx)(nz,{value:g[a.provider]||"",onChange:b=>m(a.provider,b.target.value),className:"h-48 whitespace-pre-wrap font-mono text-xs"})})]},a.id)),c.some(a=>a.isValidated)&&(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsx)(aU,{children:"R\xe9ponse choisie pour l'export"})}),(0,v.jsx)(aV,{children:(0,v.jsxs)(eI,{value:g.selectedAnswer||"",onValueChange:a=>m("selectedAnswer",a),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{placeholder:"Choisir un provider"})}),(0,v.jsxs)(eL,{children:[(0,v.jsx)(eM,{value:"",children:"(premi\xe8re r\xe9ponse non vide)"}),c.filter(a=>a.isValidated).map(a=>(0,v.jsx)(eM,{value:a.provider,children:a.provider},a.id))]})]})})]}),(0,v.jsxs)(aS,{children:[(0,v.jsx)(aT,{children:(0,v.jsx)(aU,{children:"Validation"})}),(0,v.jsx)(aV,{children:(0,v.jsxs)(op,{value:g.status,onValueChange:a=>m("status",a),children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Valid\xe9e",id:"s-validee"}),(0,v.jsx)(ny,{htmlFor:"s-validee",children:"Valid\xe9e"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Doute",id:"s-doute"}),(0,v.jsx)(ny,{htmlFor:"s-doute",children:"Doute"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Refus\xe9e",id:"s-refusee"}),(0,v.jsx)(ny,{htmlFor:"s-refusee",children:"Refus\xe9e"})]})]})})]})]}),(0,v.jsxs)(oH,{children:[(0,v.jsxs)(fm,{children:[(0,v.jsx)(fn,{asChild:!0,children:(0,v.jsx)(aR,{variant:"outline",children:"R\xe9g\xe9n\xe9rer"})}),(0,v.jsxs)(fr,{children:[(0,v.jsx)(fs,{children:(0,v.jsx)(fu,{children:"Param\xe8tres de R\xe9g\xe9n\xe9ration"})}),(0,v.jsxs)("div",{className:"space-y-4 py-4",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Langue"}),(0,v.jsxs)(op,{value:k.language,onValueChange:a=>l({...k,language:a}),children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Fran\xe7ais",id:"r-lang-fr"}),(0,v.jsx)(ny,{htmlFor:"r-lang-fr",children:"Fran\xe7ais"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Anglais",id:"r-lang-en"}),(0,v.jsx)(ny,{htmlFor:"r-lang-en",children:"Anglais"})]})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Taille"}),(0,v.jsxs)(op,{value:k.responseLength,onValueChange:a=>l({...k,responseLength:a}),children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Courte",id:"r-len-s"}),(0,v.jsx)(ny,{htmlFor:"r-len-s",children:"Courte"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Moyenne",id:"r-len-m"}),(0,v.jsx)(ny,{htmlFor:"r-len-m",children:"Moyenne"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Longue",id:"r-len-l"}),(0,v.jsx)(ny,{htmlFor:"r-len-l",children:"Longue"})]})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Persona"}),(0,v.jsxs)(eI,{value:k.persona,onValueChange:a=>l({...k,persona:a}),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{})}),(0,v.jsx)(eL,{children:q7.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]})]}),(0,v.jsxs)(ft,{children:[(0,v.jsx)(fp,{asChild:!0,children:(0,v.jsx)(aR,{variant:"ghost",children:"Annuler"})}),(0,v.jsx)(fp,{asChild:!0,children:(0,v.jsx)(aR,{onClick:n,children:"Lancer la R\xe9g\xe9n\xe9ration"})})]})]})]}),(0,v.jsx)(aR,{onClick:()=>{null!==a&&g&&(e(a,g),fD.oR.success("Modifications enregistr\xe9es !"),d(null))},children:"Enregistrer et Fermer"})]})]})}):null}let q9=({header:a})=>{let{attributes:b,listeners:c,setNodeRef:d,transform:e,transition:f}=function(a){var b,c,d,e;let{animateLayoutChanges:f=q2,attributes:g,disabled:h,data:i,getNewIndex:j=q1,id:k,strategy:m,resizeObserverConfig:n,transition:o=q3}=a,{items:p,containerId:q,activeIndex:r,disabled:s,disableTransforms:t,sortedRects:u,overIndex:v,useDragOverlay:x,strategy:y}=(0,w.useContext)(q_),z=(b=h,c=s,"boolean"==typeof b?{draggable:b,droppable:!1}:{draggable:null!=(d=null==b?void 0:b.draggable)?d:c.draggable,droppable:null!=(e=null==b?void 0:b.droppable)?e:c.droppable}),A=p.indexOf(k),B=(0,w.useMemo)(()=>({sortable:{containerId:q,index:A,items:p},...i}),[q,i,A,p]),C=(0,w.useMemo)(()=>p.slice(p.indexOf(k)),[p,k]),{rect:D,node:E,isOver:F,setNodeRef:G}=function(a){let{data:b,disabled:c=!1,id:d,resizeObserverConfig:e}=a,f=pD("Droppable"),{active:g,dispatch:h,over:i,measureDroppableContainers:j}=(0,w.useContext)(qL),k=(0,w.useRef)({disabled:c}),m=(0,w.useRef)(!1),n=(0,w.useRef)(null),o=(0,w.useRef)(null),{disabled:p,updateMeasurementsFor:q,timeout:r}={...qU,...e},s=py(null!=q?q:d),t=qy({callback:(0,w.useCallback)(()=>{if(!m.current){m.current=!0;return}null!=o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{j(Array.isArray(s.current)?s.current:[s.current]),o.current=null},r)},[r]),disabled:p||!g}),[u,v]=pA((0,w.useCallback)((a,b)=>{t&&(b&&(t.unobserve(b),m.current=!1),a&&t.observe(a))},[t])),x=py(b);return(0,w.useEffect)(()=>{t&&u.current&&(t.disconnect(),m.current=!1,t.observe(u.current))},[u,t]),(0,w.useEffect)(()=>(h({type:l.RegisterDroppable,element:{id:d,key:f,disabled:c,node:u,rect:n,data:x}}),()=>h({type:l.UnregisterDroppable,key:f,id:d})),[d]),(0,w.useEffect)(()=>{c!==k.current.disabled&&(h({type:l.SetDroppableDisabled,id:d,key:f,disabled:c}),k.current.disabled=c)},[d,f,c,h]),{active:g,rect:n,isOver:(null==i?void 0:i.id)===d,node:u,over:i,setNodeRef:v}}({id:k,data:B,disabled:z.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...n}}),{active:H,activatorEvent:I,activeNodeRect:J,attributes:K,setNodeRef:L,listeners:M,isDragging:N,over:O,setActivatorNodeRef:P,transform:Q}=function(a){let{id:b,data:c,disabled:d=!1,attributes:e}=a,f=pD("Draggable"),{activators:g,activatorEvent:h,active:i,activeNodeRect:j,ariaDescribedById:k,draggableNodes:l,over:m}=(0,w.useContext)(qL),{role:n=qT,roleDescription:o="draggable",tabIndex:p=0}=null!=e?e:{},q=(null==i?void 0:i.id)===b,r=(0,w.useContext)(q?qQ:qS),[s,t]=pA(),[u,v]=pA(),x=(0,w.useMemo)(()=>g.reduce((a,c)=>{let{eventName:d,handler:e}=c;return a[d]=a=>{e(a,b)},a},{}),[g,b]),y=py(c);return pw(()=>(l.set(b,{id:b,key:f,node:s,activatorNode:u,data:y}),()=>{let a=l.get(b);a&&a.key===f&&l.delete(b)}),[l,b]),{active:i,activatorEvent:h,activeNodeRect:j,attributes:(0,w.useMemo)(()=>({role:n,tabIndex:p,"aria-disabled":d,"aria-pressed":!!q&&n===qT||void 0,"aria-roledescription":o,"aria-describedby":k.draggable}),[d,n,p,q,o,k.draggable]),isDragging:q,listeners:d?void 0:x,node:s,over:m,setNodeRef:t,setActivatorNodeRef:v,transform:r}}({id:k,data:B,attributes:{...q6,...g},disabled:z.draggable}),R=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,w.useMemo)(()=>a=>{b.forEach(b=>b(a))},b)}(G,L),S=!!H,T=S&&!t&&qW(r)&&qW(v),U=!x&&N,V=U&&T?Q:null,W=T?null!=V?V:(null!=m?m:y)({rects:u,activeNodeRect:J,activeIndex:r,overIndex:v,index:A}):null,X=qW(r)&&qW(v)?j({id:k,items:p,activeIndex:r,overIndex:v}):A,Y=null==H?void 0:H.id,Z=(0,w.useRef)({activeId:Y,items:p,newIndex:X,containerId:q}),_=p!==Z.current.items,aa=f({active:H,containerId:q,isDragging:N,isSorting:S,id:k,index:A,items:p,newIndex:Z.current.newIndex,previousItems:Z.current.items,previousContainerId:Z.current.containerId,transition:o,wasDragging:null!=Z.current.activeId}),ab=function(a){let{disabled:b,index:c,node:d,rect:e}=a,[f,g]=(0,w.useState)(null),h=(0,w.useRef)(c);return pw(()=>{if(!b&&c!==h.current&&d.current){let a=e.current;if(a){let b=p1(d.current,{ignoreTransform:!0}),c={x:a.left-b.left,y:a.top-b.top,scaleX:a.width/b.width,scaleY:a.height/b.height};(c.x||c.y)&&g(c)}}c!==h.current&&(h.current=c)},[b,c,d,e]),(0,w.useEffect)(()=>{f&&g(null)},[f]),f}({disabled:!aa,index:A,node:E,rect:D});return(0,w.useEffect)(()=>{S&&Z.current.newIndex!==X&&(Z.current.newIndex=X),q!==Z.current.containerId&&(Z.current.containerId=q),p!==Z.current.items&&(Z.current.items=p)},[S,X,q,p]),(0,w.useEffect)(()=>{if(Y===Z.current.activeId)return;if(null!=Y&&null==Z.current.activeId){Z.current.activeId=Y;return}let a=setTimeout(()=>{Z.current.activeId=Y},50);return()=>clearTimeout(a)},[Y]),{active:H,activeIndex:r,attributes:K,data:B,rect:D,index:A,newIndex:X,items:p,isOver:F,isSorting:S,isDragging:N,listeners:M,node:E,overIndex:v,over:O,setNodeRef:R,setActivatorNodeRef:P,setDroppableNodeRef:G,setDraggableNodeRef:L,transform:null!=ab?ab:W,transition:ab||_&&Z.current.newIndex===A?q5:(!U||pH(I))&&o&&(S||aa)?pJ.Transition.toString({...o,property:q4}):void 0}}({id:a.column.id}),g={transform:pJ.Transform.toString(e),transition:f,width:a.getSize()};return(0,v.jsxs)(oy,{colSpan:a.colSpan,style:g,ref:d,className:"relative group bg-slate-50",children:[(0,v.jsxs)("div",{...b,...c,className:"flex items-center justify-center cursor-grab py-4 px-2",children:[(0,v.jsx)(oJ,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,v.jsxs)("div",{className:"flex-grow font-bold text-slate-700",onClick:a.column.getToggleSortingHandler(),children:[pn(a.column.columnDef.header,a.getContext()),{asc:" ",desc:" "}[a.column.getIsSorted()]??null]})]}),(0,v.jsx)("div",{onMouseDown:a.getResizeHandler(),onTouchStart:a.getResizeHandler(),className:"absolute top-0 right-0 h-full w-1 bg-primary/20 opacity-0 group-hover:opacity-100 cursor-col-resize user-select-none"})]},a.id)};function ra(){let{results:a,llmConfigs:b,setSelectedResultIndex:c,setResults:d,generationParams:e,columnOrder:f,setColumnOrder:g,projectData:i}=D(),[j,k]=(0,w.useState)([]),[l,m]=(0,w.useState)([]),[n,o]=(0,w.useState)(""),[p,q]=(0,w.useState)(!1),[r,s]=(0,w.useState)(e),[t,u]=(0,w.useState)({current:0,total:0}),[x,y]=(0,w.useState)(!1),z=b.filter(a=>a.isValidated),A=z.map(a=>a.provider),B=(0,w.useMemo)(()=>[{id:"rowNumber",header:"N\xb0",cell:a=>(0,v.jsx)("div",{className:"text-center text-muted-foreground",children:a.row.index+1}),size:60,enableResizing:!1},{accessorKey:"sheetName",header:"Onglet",cell:a=>(0,v.jsx)("div",{className:"text-sm text-muted-foreground px-2",children:a.getValue()}),size:140,minSize:100,maxSize:200},{accessorKey:"question",header:"Question",cell:a=>(0,v.jsx)("div",{className:"font-medium text-sm p-2",children:a.getValue()}),size:450,minSize:200,maxSize:800},...z.map(a=>({accessorKey:a.provider,header:a.provider,cell:a=>(0,v.jsx)("div",{className:"text-xs whitespace-pre-wrap font-mono p-2",children:a.getValue()||"N/A"}),size:400,minSize:150,maxSize:700})),{accessorKey:"selectedAnswer",header:"R\xe9ponse choisie",cell:b=>{let c=b.row.original;return(0,v.jsxs)(eI,{value:c.selectedAnswer||"",onValueChange:e=>{let f=[...a];f[b.row.index]={...c,selectedAnswer:e},d(f)},children:[(0,v.jsx)(eK,{className:"w-[180px]",children:(0,v.jsx)(eJ,{placeholder:"Choisir"})}),(0,v.jsxs)(eL,{children:[(0,v.jsx)(eM,{value:"",children:"(premi\xe8re r\xe9ponse non vide)"}),A.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))]})]})},size:220,minSize:180,maxSize:260},{accessorKey:"status",header:"Statut",cell:a=>{let b=a.getValue();return(0,v.jsx)("div",{className:"p-2 flex justify-center",children:(0,v.jsx)(oB,{variant:"Valid\xe9e"===b?"default":"Refus\xe9e"===b?"destructive":"secondary",children:b})})},size:150,enableResizing:!1}],[z]);(0,w.useMemo)(()=>B.map(a=>a.id||a.accessorKey),[B]);let C=function(a){let b={state:{},onStateChange:()=>{},renderFallbackValue:null,...a},[c]=w.useState(()=>({current:function(a){var b,c;let d=[...pm,...null!=(b=a._features)?b:[]],e={_features:d},f=e._features.reduce((a,b)=>Object.assign(a,null==b.getDefaultOptions?void 0:b.getDefaultOptions(e)),{}),g={...null!=(c=a.initialState)?c:{}};e._features.forEach(a=>{var b;g=null!=(b=null==a.getInitialState?void 0:a.getInitialState(g))?b:g});let h=[],i=!1,j={_features:d,options:{...f,...a},initialState:g,_queue:a=>{h.push(a),i||(i=!0,Promise.resolve().then(()=>{for(;h.length;)h.shift()();i=!1}).catch(a=>setTimeout(()=>{throw a})))},reset:()=>{e.setState(e.initialState)},setOptions:a=>{var b;b=oL(a,e.options),e.options=e.options.mergeOptions?e.options.mergeOptions(f,b):{...f,...b}},getState:()=>e.options.state,setState:a=>{null==e.options.onStateChange||e.options.onStateChange(a)},_getRowId:(a,b,c)=>{var d;return null!=(d=null==e.options.getRowId?void 0:e.options.getRowId(a,b,c))?d:`${c?[c.id,b].join("."):b}`},getCoreRowModel:()=>(e._getCoreRowModel||(e._getCoreRowModel=e.options.getCoreRowModel(e)),e._getCoreRowModel()),getRowModel:()=>e.getPaginationRowModel(),getRow:(a,b)=>{let c=(b?e.getPrePaginationRowModel():e.getRowModel()).rowsById[a];if(!c&&!(c=e.getCoreRowModel().rowsById[a]))throw Error();return c},_getDefaultColumnDef:oO(()=>[e.options.defaultColumn],a=>{var b;return a=null!=(b=a)?b:{},{header:a=>{let b=a.header.column.columnDef;return b.accessorKey?b.accessorKey:b.accessorFn?b.id:null},cell:a=>{var b,c;return null!=(b=null==(c=a.renderValue())||null==c.toString?void 0:c.toString())?b:null},...e._features.reduce((a,b)=>Object.assign(a,null==b.getDefaultColumnDef?void 0:b.getDefaultColumnDef()),{}),...a}},oP(a,"debugColumns","_getDefaultColumnDef")),_getColumnDefs:()=>e.options.columns,getAllColumns:oO(()=>[e._getColumnDefs()],a=>{let b=function(a,c,d){return void 0===d&&(d=0),a.map(a=>{let f=function(a,b,c,d){var e,f;let g,h={...a._getDefaultColumnDef(),...b},i=h.accessorKey,j=null!=(e=null!=(f=h.id)?f:i?"function"==typeof String.prototype.replaceAll?i.replaceAll(".","_"):i.replace(/\./g,"_"):void 0)?e:"string"==typeof h.header?h.header:void 0;if(h.accessorFn?g=h.accessorFn:i&&(g=i.includes(".")?a=>{let b=a;for(let a of i.split(".")){var c;b=null==(c=b)?void 0:c[a]}return b}:a=>a[h.accessorKey]),!j)throw Error();let k={id:`${String(j)}`,accessorFn:g,parent:d,depth:c,columnDef:h,columns:[],getFlatColumns:oO(()=>[!0],()=>{var a;return[k,...null==(a=k.columns)?void 0:a.flatMap(a=>a.getFlatColumns())]},oP(a.options,"debugColumns","column.getFlatColumns")),getLeafColumns:oO(()=>[a._getOrderColumnsFn()],a=>{var b;return null!=(b=k.columns)&&b.length?a(k.columns.flatMap(a=>a.getLeafColumns())):[k]},oP(a.options,"debugColumns","column.getLeafColumns"))};for(let b of a._features)null==b.createColumn||b.createColumn(k,a);return k}(e,a,d,c);return f.columns=a.columns?b(a.columns,f,d+1):[],f})};return b(a)},oP(a,"debugColumns","getAllColumns")),getAllFlatColumns:oO(()=>[e.getAllColumns()],a=>a.flatMap(a=>a.getFlatColumns()),oP(a,"debugColumns","getAllFlatColumns")),_getAllFlatColumnsById:oO(()=>[e.getAllFlatColumns()],a=>a.reduce((a,b)=>(a[b.id]=b,a),{}),oP(a,"debugColumns","getAllFlatColumnsById")),getAllLeafColumns:oO(()=>[e.getAllColumns(),e._getOrderColumnsFn()],(a,b)=>b(a.flatMap(a=>a.getLeafColumns())),oP(a,"debugColumns","getAllLeafColumns")),getColumn:a=>e._getAllFlatColumnsById()[a]};Object.assign(e,j);for(let a=0;a<e._features.length;a++){let b=e._features[a];null==b||null==b.createTable||b.createTable(e)}return e}(b)})),[d,e]=w.useState(()=>c.current.initialState);return c.current.setOptions(b=>({...b,...a,state:{...d,...a.state},onStateChange:b=>{e(b),null==a.onStateChange||a.onStateChange(b)}})),c.current}({data:a,columns:B,state:{sorting:j,columnFilters:l,globalFilter:n,columnOrder:f},onSortingChange:k,onColumnFiltersChange:m,onGlobalFilterChange:o,columnResizeMode:"onChange",getCoreRowModel:a=>oO(()=>[a.options.data],b=>{let c={rows:[],flatRows:[],rowsById:{}},d=function(b,e,f){void 0===e&&(e=0);let g=[];for(let i=0;i<b.length;i++){let j=oT(a,a._getRowId(b[i],i,f),b[i],i,e,void 0,null==f?void 0:f.id);if(c.flatRows.push(j),c.rowsById[j.id]=j,g.push(j),a.options.getSubRows){var h;j.originalSubRows=a.options.getSubRows(b[i],i),null!=(h=j.originalSubRows)&&h.length&&(j.subRows=d(j.originalSubRows,e+1,j))}}return g};return c.rows=d(b),c},oP(a.options,"debugTable","getRowModel",()=>a._autoResetPageIndex())),getSortedRowModel:a=>oO(()=>[a.getState().sorting,a.getPreSortedRowModel()],(b,c)=>{if(!c.rows.length||!(null!=b&&b.length))return c;let d=a.getState().sorting,e=[],f=d.filter(b=>{var c;return null==(c=a.getColumn(b.id))?void 0:c.getCanSort()}),g={};f.forEach(b=>{let c=a.getColumn(b.id);c&&(g[b.id]={sortUndefined:c.columnDef.sortUndefined,invertSorting:c.columnDef.invertSorting,sortingFn:c.getSortingFn()})});let h=a=>{let b=a.map(a=>({...a}));return b.sort((a,b)=>{for(let d=0;d<f.length;d+=1){var c;let e=f[d],h=g[e.id],i=h.sortUndefined,j=null!=(c=null==e?void 0:e.desc)&&c,k=0;if(i){let c=a.getValue(e.id),d=b.getValue(e.id),f=void 0===c,g=void 0===d;if(f||g){if("first"===i)return f?-1:1;if("last"===i)return f?1:-1;k=f&&g?0:f?i:-i}}if(0===k&&(k=h.sortingFn(a,b,e.id)),0!==k)return j&&(k*=-1),h.invertSorting&&(k*=-1),k}return a.index-b.index}),b.forEach(a=>{var b;e.push(a),null!=(b=a.subRows)&&b.length&&(a.subRows=h(a.subRows))}),b};return{rows:h(c.rows),flatRows:e,rowsById:c.rowsById}},oP(a.options,"debugTable","getSortedRowModel",()=>a._autoResetPageIndex())),getFilteredRowModel:a=>oO(()=>[a.getPreFilteredRowModel(),a.getState().columnFilters,a.getState().globalFilter],(b,c,d)=>{var e,f;let g,h;if(!b.rows.length||!(null!=c&&c.length)&&!d){for(let a=0;a<b.flatRows.length;a++)b.flatRows[a].columnFilters={},b.flatRows[a].columnFiltersMeta={};return b}let i=[],j=[];(null!=c?c:[]).forEach(b=>{var c;let d=a.getColumn(b.id);if(!d)return;let e=d.getFilterFn();e&&i.push({id:b.id,filterFn:e,resolvedValue:null!=(c=null==e.resolveFilterValue?void 0:e.resolveFilterValue(b.value))?c:b.value})});let k=(null!=c?c:[]).map(a=>a.id),l=a.getGlobalFilterFn(),m=a.getAllLeafColumns().filter(a=>a.getCanGlobalFilter());d&&l&&m.length&&(k.push("__global__"),m.forEach(a=>{var b;j.push({id:a.id,filterFn:l,resolvedValue:null!=(b=null==l.resolveFilterValue?void 0:l.resolveFilterValue(d))?b:d})}));for(let a=0;a<b.flatRows.length;a++){let c=b.flatRows[a];if(c.columnFilters={},i.length)for(let a=0;a<i.length;a++){let b=(g=i[a]).id;c.columnFilters[b]=g.filterFn(c,b,g.resolvedValue,a=>{c.columnFiltersMeta[b]=a})}if(j.length){for(let a=0;a<j.length;a++){let b=(h=j[a]).id;if(h.filterFn(c,b,h.resolvedValue,a=>{c.columnFiltersMeta[b]=a})){c.columnFilters.__global__=!0;break}}!0!==c.columnFilters.__global__&&(c.columnFilters.__global__=!1)}}return e=b.rows,f=a=>{for(let b=0;b<k.length;b++)if(!1===a.columnFilters[k[b]])return!1;return!0},a.options.filterFromLeafRows?function(a,b,c){var d;let e=[],f={},g=null!=(d=c.options.maxLeafRowFilterDepth)?d:100,h=function(a,d){void 0===d&&(d=0);let i=[];for(let k=0;k<a.length;k++){var j;let l=a[k],m=oT(c,l.id,l.original,l.index,l.depth,void 0,l.parentId);if(m.columnFilters=l.columnFilters,null!=(j=l.subRows)&&j.length&&d<g){if(m.subRows=h(l.subRows,d+1),b(l=m)&&!m.subRows.length||b(l)||m.subRows.length){i.push(l),f[l.id]=l,e.push(l);continue}}else b(l=m)&&(i.push(l),f[l.id]=l,e.push(l))}return i};return{rows:h(a),flatRows:e,rowsById:f}}(e,f,a):function(a,b,c){var d;let e=[],f={},g=null!=(d=c.options.maxLeafRowFilterDepth)?d:100,h=function(a,d){void 0===d&&(d=0);let i=[];for(let k=0;k<a.length;k++){let l=a[k];if(b(l)){var j;if(null!=(j=l.subRows)&&j.length&&d<g){let a=oT(c,l.id,l.original,l.index,l.depth,void 0,l.parentId);a.subRows=h(l.subRows,d+1),l=a}i.push(l),e.push(l),f[l.id]=l}}return i};return{rows:h(a),flatRows:e,rowsById:f}}(e,f,a)},oP(a.options,"debugTable","getFilteredRowModel",()=>a._autoResetPageIndex()))}),E=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,w.useMemo)(()=>[...b].filter(a=>null!=a),[...b])}(pT(qs),pT(qu),pT(ql)),F=async()=>{let c=a.map((a,b)=>({...a,originalIndex:b})).filter(a=>"Doute"===a.status||"Refus\xe9e"===a.status);if(0===c.length){fD.oR.info("Aucune r\xe9ponse \xe0 r\xe9g\xe9n\xe9rer."),y(!1);return}q(!0),u({current:0,total:c.length});let e=[...a];for(let a=0;a<c.length;a++){let d=c[a];try{let a=await or(d.question,b,r),c=A[0],f=c&&a[c]?c:d.selectedAnswer||"";e[d.originalIndex]={...a,sheetName:d.sheetName,rowIndex:d.rowIndex,selectedAnswer:f}}catch(a){fD.oR.error(`Erreur sur la question: "${d.question.substring(0,20)}..."`)}u({current:a+1,total:c.length})}d(e),q(!1),fD.oR.success("R\xe9g\xe9n\xe9ration en masse termin\xe9e !"),setTimeout(()=>{y(!1)},2e3)};return 0===a.length?(0,v.jsxs)("div",{className:"text-center py-12",children:[(0,v.jsx)("h2",{className:"text-xl font-bold",children:"\xc9tape 4 : R\xe9sultats"}),(0,v.jsx)("p",{className:"text-slate-600 mt-4",children:"Aucun r\xe9sultat. Lancez une g\xe9n\xe9ration \xe0 l'\xe9tape 3."})]}):(0,v.jsxs)("div",{className:"space-y-4 w-full",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold",children:"\xc9tape 4 : R\xe9sultats"}),(0,v.jsx)("p",{className:"text-slate-600",children:"Filtrez, triez, r\xe9organisez, redimensionnez et exportez vos r\xe9sultats."}),(0,v.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-slate-50 p-4 rounded-lg border",children:[(0,v.jsxs)("div",{className:"relative w-full md:w-1/3",children:[(0,v.jsx)(oK,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,v.jsx)(aW,{placeholder:"Rechercher sur toutes les colonnes...",value:n,onChange:a=>o(a.target.value),className:"pl-10"})]}),(0,v.jsxs)("div",{className:"flex gap-4 items-center w-full md:w-auto",children:[(0,v.jsxs)(eI,{value:C.getColumn("status")?.getFilterValue()??"",onValueChange:a=>C.getColumn("status")?.setFilterValue("Tous"===a?"":a),children:[(0,v.jsx)(eK,{className:"w-full md:w-[180px]",children:(0,v.jsx)(eJ,{placeholder:"Filtrer par statut..."})}),(0,v.jsxs)(eL,{children:[(0,v.jsx)(eM,{value:"Tous",children:"Tous les statuts"}),(0,v.jsx)(eM,{value:"Valid\xe9e",children:"Valid\xe9e"}),(0,v.jsx)(eM,{value:"Doute",children:"Doute"}),(0,v.jsx)(eM,{value:"Refus\xe9e",children:"Refus\xe9e"})]})]}),(0,v.jsxs)(fm,{open:x,onOpenChange:y,children:[(0,v.jsx)(fn,{asChild:!0,children:(0,v.jsx)(aR,{variant:"outline",children:"R\xe9g\xe9n\xe9rer les \xe9checs"})}),(0,v.jsxs)(fr,{onInteractOutside:a=>{p&&a.preventDefault()},children:[(0,v.jsx)(fs,{children:(0,v.jsx)(fu,{children:"R\xe9g\xe9n\xe9ration en Masse"})}),p?(0,v.jsxs)("div",{className:"py-4 space-y-4",children:[(0,v.jsx)("p",{children:"La r\xe9g\xe9n\xe9ration est en cours. Veuillez patienter."}),(0,v.jsx)(nN,{value:t.current/t.total*100}),(0,v.jsxs)("p",{className:"text-sm text-center text-muted-foreground",children:[t.current," / ",t.total," r\xe9ponses trait\xe9es"]})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"space-y-4 py-4",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Langue"}),(0,v.jsxs)(op,{value:r.language,onValueChange:a=>s({...r,language:a}),children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Fran\xe7ais",id:"br-lang-fr"}),(0,v.jsx)(ny,{htmlFor:"br-lang-fr",children:"Fran\xe7ais"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Anglais",id:"br-lang-en"}),(0,v.jsx)(ny,{htmlFor:"br-lang-en",children:"Anglais"})]})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Taille"}),(0,v.jsxs)(op,{value:r.responseLength,onValueChange:a=>s({...r,responseLength:a}),children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Courte",id:"br-len-s"}),(0,v.jsx)(ny,{htmlFor:"br-len-s",children:"Courte"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Moyenne",id:"br-len-m"}),(0,v.jsx)(ny,{htmlFor:"br-len-m",children:"Moyenne"})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)(oq,{value:"Longue",id:"br-len-l"}),(0,v.jsx)(ny,{htmlFor:"br-len-l",children:"Longue"})]})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(ny,{children:"Persona"}),(0,v.jsxs)(eI,{value:r.persona,onValueChange:a=>s({...r,persona:a}),children:[(0,v.jsx)(eK,{children:(0,v.jsx)(eJ,{})}),(0,v.jsx)(eL,{children:q7.map(a=>(0,v.jsx)(eM,{value:a,children:a},a))})]})]})]}),(0,v.jsxs)(ft,{children:[(0,v.jsx)(aR,{variant:"ghost",onClick:()=>y(!1),children:"Annuler"}),(0,v.jsx)(aR,{onClick:F,children:"Lancer la R\xe9g\xe9n\xe9ration"})]})]})]})]}),(0,v.jsx)(aR,{onClick:()=>{if(!i)return void fD.oR.error("Aucun fichier source charg\xe9.");let c=nm(i.workbookBinary,{type:"binary"}),d=new Map(i.sheets.map(a=>[a.name,a])),e=b.filter(a=>a.isValidated).map(a=>a.provider),f=(a,b)=>{let c=nv.decode_range(a["!ref"]||"A1");c.s.r=Math.min(c.s.r,b.r),c.s.c=Math.min(c.s.c,b.c),c.e.r=Math.max(c.e.r,b.r),c.e.c=Math.max(c.e.c,b.c),a["!ref"]=nv.encode_range(c)},g=a=>{if(a.selectedAnswer){let b=a[a.selectedAnswer];if("string"==typeof b)return b}for(let b of e){let c=a[b];if("string"==typeof c&&c.trim().length>0)return c}return""},j=0;for(let b of a){let a=d.get(b.sheetName),e=c.Sheets[b.sheetName];if(!a||!e){console.warn(`Feuille introuvable: ${b.sheetName}`);continue}if(!a.answerColumn)return void fD.oR.error(`Colonne r\xe9ponse non d\xe9finie pour l'onglet ${b.sheetName}.`);let h=a.columns.indexOf(a.answerColumn);if(-1===h)return void fD.oR.error(`Impossible de trouver la colonne r\xe9ponse "${a.answerColumn}" dans l'onglet ${b.sheetName}.`);let i={c:h,r:b.rowIndex+1};e[nv.encode_cell(i)]={t:"s",v:g(b)},f(e,i),j++}let k=function a(b,c){fU(),function(a){if(!a||!a.SheetNames||!a.Sheets)throw Error("Invalid Workbook");if(!a.SheetNames.length)throw Error("Workbook is empty");var b,c,d=a.Workbook&&a.Workbook.Sheets||[];b=a.SheetNames,c=!!a.vbaraw,b.forEach(function(a,e){my(a);for(var f=0;f<e;++f)if(a==b[f])throw Error("Duplicate Sheet Name: "+a);if(c){var g=d&&d[e]&&d[e].CodeName||a;if(95==g.charCodeAt(0)&&g.length>22)throw Error("Bad Code Name: Worksheet"+g)}});for(var e=0;e<a.SheetNames.length;++e)!function(a,b,c){if(a&&a["!ref"]){var d=iQ(a["!ref"]);if(d.e.c<d.s.c||d.e.r<d.s.r)throw Error("Bad range ("+c+"): "+a["!ref"])}}(a.Sheets[a.SheetNames[e]],a.SheetNames[e],e)}(b);var d,e,f=g6(c||{});if(f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),"array"==f.type){f.type="binary";var g=a(b,f);return f.type="array",f6(g)}var i=0;if(f.sheet&&(i="number"==typeof f.sheet?f.sheet:b.SheetNames.indexOf(f.sheet),!b.SheetNames[i]))throw Error("Sheet not found: "+f.sheet+" : "+typeof f.sheet);switch(f.bookType||"xlsb"){case"xml":case"xlml":return no(function(a,b){b||(b={}),a.SSF||(a.SSF=g6(gk)),a.SSF&&(gN(),gM(a.SSF),b.revssf=gW(a.SSF),b.revssf[a.SSF[65535]]=0,b.ssf=a.SSF,b.cellXfs=[],l6(b.cellXfs,{},{revssf:{General:0}}));var c,d,e,f,g,h,i,j,k,l,m=[];m.push((c=b,d=[],a.Props&&d.push((e=a.Props,f=[],gT(jF).map(function(a){for(var b=0;b<ju.length;++b)if(ju[b][1]==a)return ju[b];for(b=0;b<jz.length;++b)if(jz[b][1]==a)return jz[b];throw a}).forEach(function(a){if(null!=e[a[1]]){var b=c&&c.Props&&null!=c.Props[a[1]]?c.Props[a[1]]:e[a[1]];"date"===a[2]&&(b=new Date(b).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof b?b=String(b):!0===b||!1===b?b=b?"1":"0":b instanceof Date&&(b=new Date(b).toISOString().replace(/\.\d*Z/,"")),f.push(hT(jF[a[1]]||a[1],b))}}),hV("DocumentProperties",f.join(""),{xmlns:h_.o}))),a.Custprops&&d.push((g=a.Props,h=a.Custprops,i=["Worksheets","SheetNames"],j="CustomDocumentProperties",k=[],g&&gT(g).forEach(function(a){if(Object.prototype.hasOwnProperty.call(g,a)){for(var b=0;b<ju.length;++b)if(a==ju[b][1])return;for(b=0;b<jz.length;++b)if(a==jz[b][1])return;for(b=0;b<i.length;++b)if(a==i[b])return;var c=g[a],d="string";"number"==typeof c?(d="float",c=String(c)):!0===c||!1===c?(d="boolean",c=c?"1":"0"):c=String(c),k.push(hV(hB(a),c,{"dt:dt":d}))}}),h&&gT(h).forEach(function(a){if(Object.prototype.hasOwnProperty.call(h,a)&&!(g&&Object.prototype.hasOwnProperty.call(g,a))){var b=h[a],c="string";"number"==typeof b?(c="float",b=String(b)):!0===b||!1===b?(c="boolean",b=b?"1":"0"):b instanceof Date?(c="dateTime.tz",b=b.toISOString()):b=String(b),k.push(hV(hB(a),b,{"dt:dt":c}))}}),"<"+j+' xmlns="'+h_.o+'">'+k.join("")+"</"+j+">")),d.join(""))),m.push(""),m.push(""),m.push("");for(var n=0;n<a.SheetNames.length;++n)m.push(hV("Worksheet",function(a,b,c){var d=[],e=c.SheetNames[a],f=c.Sheets[e],g=f?function(a,b,c,d){if(!a||!((d||{}).Workbook||{}).Names)return"";for(var e=d.Workbook.Names,f=[],g=0;g<e.length;++g){var h=e[g];h.Sheet==c&&(h.Name.match(/^_xlfn\./)||f.push(mH(h)))}return f.join("")}(f,0,a,c):"";return g.length>0&&d.push("<Names>"+g+"</Names>"),(g=f?function(a,b,c,d){if(!a["!ref"])return"";var e=iQ(a["!ref"]),f=a["!merges"]||[],g=0,h=[];a["!cols"]&&a["!cols"].forEach(function(a,b){k3(a);var c=!!a.width,d=l4(b,a),e={"ss:Index":b+1};c&&(e["ss:Width"]=k$(d.width)),a.hidden&&(e["ss:Hidden"]="1"),h.push(hV("Column",null,e))});for(var i=Array.isArray(a),j=e.s.r;j<=e.e.r;++j){for(var k=[function(a,b){var c='<Row ss:Index="'+(a+1)+'"';return b&&(b.hpt&&!b.hpx&&(b.hpx=k5(b.hpt)),b.hpx&&(c+=' ss:AutoFitHeight="0" ss:Height="'+b.hpx+'"'),b.hidden&&(c+=' ss:Hidden="1"')),c+">"}(j,(a["!rows"]||[])[j])],l=e.s.c;l<=e.e.c;++l){var m=!1;for(g=0;g!=f.length;++g)if(!(f[g].s.c>l)&&!(f[g].s.r>j)&&!(f[g].e.c<l)&&!(f[g].e.r<j)){(f[g].s.c!=l||f[g].s.r!=j)&&(m=!0);break}if(!m){var n={r:j,c:l},o=iN(n),p=i?(a[j]||[])[l]:a[o];k.push(function(a,b,c,d,e,f,g){if(!a||void 0==a.v&&void 0==a.f)return"";var h={};if(a.f&&(h["ss:Formula"]="="+hA(lx(a.f,g))),a.F&&a.F.slice(0,b.length)==b){var i=iM(a.F.slice(b.length+1));h["ss:ArrayRange"]="RC:R"+(i.r==g.r?"":"["+(i.r-g.r)+"]")+"C"+(i.c==g.c?"":"["+(i.c-g.c)+"]")}if(a.l&&a.l.Target&&(h["ss:HRef"]=hA(a.l.Target),a.l.Tooltip&&(h["x:HRefScreenTip"]=hA(a.l.Tooltip))),c["!merges"])for(var j=c["!merges"],k=0;k!=j.length;++k)j[k].s.c==g.c&&j[k].s.r==g.r&&(j[k].e.c>j[k].s.c&&(h["ss:MergeAcross"]=j[k].e.c-j[k].s.c),j[k].e.r>j[k].s.r&&(h["ss:MergeDown"]=j[k].e.r-j[k].s.r));var l="",m="";switch(a.t){case"z":if(!d.sheetStubs)return"";break;case"n":l="Number",m=String(a.v);break;case"b":l="Boolean",m=a.v?"1":"0";break;case"e":l="Error",m=jh[a.v];break;case"d":l="DateTime",m=new Date(a.v).toISOString(),null==a.z&&(a.z=a.z||gk[14]);break;case"s":l="String",m=((a.v||"")+"").replace(hy,function(a){return hw[a]}).replace(hC,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var n=l6(d.cellXfs,a,d);h["ss:StyleID"]="s"+(21+n),h["ss:Index"]=g.c+1;var o=null!=a.v?m:"",p="z"==a.t?"":'<Data ss:Type="'+l+'">'+o+"</Data>";return(a.c||[]).length>0&&(p+=a.c.map(function(a){var b=hV("ss:Data",(a.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return hV("Comment",b,{"ss:Author":a.a})}).join("")),hV("Cell",p,h)}(p,o,a,b,0,0,n))}}k.push("</Row>"),k.length>2&&h.push(k.join(""))}return h.join("")}(f,b,0,0):"").length>0&&d.push("<Table>"+g+"</Table>"),d.push(function(a,b,c,d){if(!a)return"";var e=[];if(a["!margins"]&&(e.push("<PageSetup>"),a["!margins"].header&&e.push(hV("Header",null,{"x:Margin":a["!margins"].header})),a["!margins"].footer&&e.push(hV("Footer",null,{"x:Margin":a["!margins"].footer})),e.push(hV("PageMargins",null,{"x:Bottom":a["!margins"].bottom||"0.75","x:Left":a["!margins"].left||"0.7","x:Right":a["!margins"].right||"0.7","x:Top":a["!margins"].top||"0.75"})),e.push("</PageSetup>")),d&&d.Workbook&&d.Workbook.Sheets&&d.Workbook.Sheets[c])if(d.Workbook.Sheets[c].Hidden)e.push(hV("Visible",1==d.Workbook.Sheets[c].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<c&&(!d.Workbook.Sheets[f]||d.Workbook.Sheets[f].Hidden);++f);f==c&&e.push("<Selected/>")}return(((((d||{}).Workbook||{}).Views||[])[0]||{}).RTL&&e.push("<DisplayRightToLeft/>"),a["!protect"]&&(e.push(hT("ProtectContents","True")),a["!protect"].objects&&e.push(hT("ProtectObjects","True")),a["!protect"].scenarios&&e.push(hT("ProtectScenarios","True")),null==a["!protect"].selectLockedCells||a["!protect"].selectLockedCells?null==a["!protect"].selectUnlockedCells||a["!protect"].selectUnlockedCells||e.push(hT("EnableSelection","UnlockedCells")):e.push(hT("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(b){a["!protect"][b[0]]&&e.push("<"+b[1]+"/>")})),0==e.length)?"":hV("WorksheetOptions",e.join(""),{xmlns:h_.x})}(f,0,a,c)),d.join("")}(n,b,a),{"ss:Name":hA(a.SheetNames[n])}));return m[2]=(l=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],b.cellXfs.forEach(function(a,b){var c=[];c.push(hV("NumberFormat",null,{"ss:Format":hA(gk[a.numFmtId])})),l.push(hV("Style",c.join(""),{"ss:ID":"s"+(21+b)}))}),hV("Styles",l.join(""))),m[3]=function(a){if(!((a||{}).Workbook||{}).Names)return"";for(var b=a.Workbook.Names,c=[],d=0;d<b.length;++d){var e=b[d];null==e.Sheet&&(e.Name.match(/^_xlfn\./)||c.push(mH(e)))}return hV("Names",c.join(""))}(a,b),hn+hV("Workbook",m.join(""),{xmlns:h_.ss,"xmlns:o":h_.o,"xmlns:x":h_.x,"xmlns:ss":h_.ss,"xmlns:dt":h_.dt,"xmlns:html":h_.html})}(b,f),f);case"slk":case"sylk":return no(kx.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"htm":case"html":return no(function(a,b){var c=b||{},d=null!=c.header?c.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',e=null!=c.footer?c.footer:"</body></html>",f=[d],g=iO(a["!ref"]);c.dense=Array.isArray(a),f.push("<table"+(c&&c.id?' id="'+c.id+'"':"")+">");for(var h=g.s.r;h<=g.e.r;++h)f.push(function(a,b,c,d){for(var e=a["!merges"]||[],f=[],g=b.s.c;g<=b.e.c;++g){for(var h=0,i=0,j=0;j<e.length;++j)if(!(e[j].s.r>c)&&!(e[j].s.c>g)&&!(e[j].e.r<c)&&!(e[j].e.c<g)){if(e[j].s.r<c||e[j].s.c<g){h=-1;break}h=e[j].e.r-e[j].s.r+1,i=e[j].e.c-e[j].s.c+1;break}if(!(h<0)){var k=iN({r:c,c:g}),l=d.dense?(a[c]||[])[g]:a[k],m=l&&null!=l.v&&(l.h||hD(l.w||(iS(l),l.w)||""))||"",n={};h>1&&(n.rowspan=h),i>1&&(n.colspan=i),d.editable?m='<span contenteditable="true">'+m+"</span>":l&&(n["data-t"]=l&&l.t||"z",null!=l.v&&(n["data-v"]=l.v),null!=l.z&&(n["data-z"]=l.z),l.l&&"#"!=(l.l.Target||"#").charAt(0)&&(m='<a href="'+l.l.Target+'">'+m+"</a>")),n.id=(d.id||"sjs")+"-"+k,f.push(hV("td",m,n))}}return"<tr>"+f.join("")+"</tr>"}(a,g,h,c));return f.push("</table>"+e),f.join("")}(b.Sheets[b.SheetNames[i]],f),f);case"txt":var j=function(a,b){b||(b={}),b.FS="	",b.RS="\n";var c=ns(a,b);if(void 0===h||"string"==b.type)return c;var d=h.utils.encode(1200,c,"str");return String.fromCharCode(255)+String.fromCharCode(254)+d}(b.Sheets[b.SheetNames[i]],f);switch(f.type){case"base64":return f_(j);case"binary":case"string":return j;case"file":return gS(f.file,j,"binary");case"buffer":if(f1)return f2(j,"binary");return j.split("").map(function(a){return a.charCodeAt(0)})}throw Error("Unrecognized type "+f.type);case"csv":return no(ns(b.Sheets[b.SheetNames[i]],f),f,"\uFEFF");case"dif":return no(ky.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"dbf":return np(kw.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"prn":return no(kA.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"rtf":return no(kW.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"eth":return no(kz.from_sheet(b.Sheets[b.SheetNames[i]],f),f);case"fods":return no(mX(b,f),f);case"wk1":return np(kB.sheet_to_wk1(b.Sheets[b.SheetNames[i]],f),f);case"wk3":return np(kB.book_to_wk3(b,f),f);case"biff2":f.biff||(f.biff=2);case"biff3":f.biff||(f.biff=3);case"biff4":return f.biff||(f.biff=4),np(mR(b,f),f);case"biff5":f.biff||(f.biff=5);case"biff8":case"xla":case"xls":return f.biff||(f.biff=8),nn(function(a,b){var c,d=b||{},e=gR.utils.cfb_new({root:"R"}),f="/Workbook";switch(d.bookType||"xls"){case"xls":d.bookType="biff8";case"xla":d.bookType||(d.bookType="xla");case"biff8":f="/Workbook",d.biff=8;break;case"biff5":f="/Book",d.biff=5;break;default:throw Error("invalid type "+d.bookType+" for XLS CFB")}return gR.utils.cfb_add(e,f,mR(a,d)),8==d.biff&&(a.Props||a.Custprops)&&function(a,b){var c,d=[],e=[],f=[],g=0,h=gU(jc,"n"),i=gU(jd,"n");if(a.Props)for(g=0,c=gT(a.Props);g<c.length;++g)(Object.prototype.hasOwnProperty.call(h,c[g])?d:Object.prototype.hasOwnProperty.call(i,c[g])?e:f).push([c[g],a.Props[c[g]]]);if(a.Custprops)for(g=0,c=gT(a.Custprops);g<c.length;++g)Object.prototype.hasOwnProperty.call(a.Props||{},c[g])||(Object.prototype.hasOwnProperty.call(h,c[g])?d:Object.prototype.hasOwnProperty.call(i,c[g])?e:f).push([c[g],a.Custprops[c[g]]]);var j=[];for(g=0;g<f.length;++g)jQ.indexOf(f[g][0])>-1||jA.indexOf(f[g][0])>-1||null!=f[g][1]&&j.push(f[g]);e.length&&gR.utils.cfb_add(b,"/\x05SummaryInformation",jT(e,mL.SI,i,jd)),(d.length||j.length)&&gR.utils.cfb_add(b,"/\x05DocumentSummaryInformation",jT(d,mL.DSI,h,jc,j.length?j:null,mL.UDI))}(a,e),8==d.biff&&a.vbaraw&&(c=gR.read(a.vbaraw,{type:"string"==typeof a.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(a,b){if(0!=b){var d=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==d.slice(-1)&&gR.utils.cfb_add(e,d,c.FileIndex[b].content)}}),e}(b,d=f||{}),d);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(a,b){var c={},d=f1?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(b.compression&&(c.compression="DEFLATE"),b.password)c.type=d;else switch(b.type){case"base64":c.type="base64";break;case"binary":c.type="string";break;case"string":throw Error("'string' output type invalid for '"+b.bookType+"' files");case"buffer":case"file":c.type=d;break;default:throw Error("Unrecognized type "+b.type)}var e=a.FullPaths?gR.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[c.type]||c.type,compression:!!b.compression}):a.generate(c);if("undefined"!=typeof Deno&&"string"==typeof e){if("binary"==b.type||"base64"==b.type)return e;e=new Uint8Array(f6(e))}return b.password&&"undefined"!=typeof encrypt_agile?nn(encrypt_agile(e,b.password),b):"file"===b.type?gS(b.file,e):"string"==b.type?hK(e):e}("ods"==(e=g6(f||{})).bookType?mX(b,e):"numbers"==e.bookType?function(a,b){if(!b||!b.numbers)throw Error("Must pass a `numbers` option -- check the README");var c,d=a.Sheets[a.SheetNames[0]];a.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var e=iO(d["!ref"]);e.s.r=e.s.c=0;var f=!1;e.e.c>9&&(f=!0,e.e.c=9),e.e.r>49&&(f=!0,e.e.r=49),f&&console.error("The Numbers writer is currently limited to ".concat(iP(e)));var g=nq(d,{range:e,header:1}),h=["~Sh33tJ5~"];g.forEach(function(a){return a.forEach(function(a){"string"==typeof a&&h.push(a)})});var i={},j=[],k=gR.read(b.numbers,{type:"base64"});k.FileIndex.map(function(a,b){return[a,k.FullPaths[b]]}).forEach(function(a){var b=a[0],c=a[1];2==b.type&&b.name.match(/\.iwa/)&&m6(m8(b.content)).forEach(function(a){j.push(a.id),i[a.id]={deps:[],location:c,type:m2(a.messages[0].meta[1][0].data)}})}),j.sort(function(a,b){return a-b});var l=j.filter(function(a){return a>1}).map(function(a){return[a,m1(a)]});k.FileIndex.map(function(a,b){return[a,k.FullPaths[b]]}).forEach(function(a){var b=a[0];a[1],b.name.match(/\.iwa/)&&m6(m8(b.content)).forEach(function(a){a.messages.forEach(function(b){l.forEach(function(b){a.messages.some(function(a){return 11006!=m2(a.meta[1][0].data)&&function(a,b){b:for(var c=0;c<=a.length-b.length;++c){for(var d=0;d<b.length;++d)if(a[c+d]!=b[d])continue b;return!0}return!1}(a.data,b[1])})&&i[b[0]].deps.push(a.id)})})})});for(var m=gR.find(k,i[1].location),n=m6(m8(m.content)),o=0;o<n.length;++o){var p=n[o];1==p.id&&(c=p)}var q=nc(m3(c.messages[0].data)[1][0].data);for(o=0,n=m6(m8((m=gR.find(k,i[q].location)).content));o<n.length;++o)(p=n[o]).id==q&&(c=p);for(o=0,q=nc(m3(c.messages[0].data)[2][0].data),n=m6(m8((m=gR.find(k,i[q].location)).content));o<n.length;++o)(p=n[o]).id==q&&(c=p);for(o=0,q=nc(m3(c.messages[0].data)[2][0].data),n=m6(m8((m=gR.find(k,i[q].location)).content));o<n.length;++o)(p=n[o]).id==q&&(c=p);var r=m3(c.messages[0].data);r[6][0].data=m1(e.e.r+1),r[7][0].data=m1(e.e.c+1);for(var s=nc(r[46][0].data),t=gR.find(k,i[s].location),u=m6(m8(t.content)),v=0;v<u.length&&u[v].id!=s;++v);if(u[v].id!=s)throw"Bad ColumnRowUIDMapArchive";var w=m3(u[v].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var x=0;x<=e.e.c;++x){var y=[];y[1]=y[2]=[{type:0,data:m1(x+420690)}],w[1].push({type:2,data:m4(y)}),w[2].push({type:0,data:m1(x)}),w[3].push({type:0,data:m1(x)})}w[4]=[],w[5]=[],w[6]=[];for(var z=0;z<=e.e.r;++z)(y=[])[1]=y[2]=[{type:0,data:m1(z+726270)}],w[4].push({type:2,data:m4(y)}),w[5].push({type:0,data:m1(z)}),w[6].push({type:0,data:m1(z)});u[v].messages[0].data=m4(w),t.content=m9(m7(u)),t.size=t.content.length,delete r[46];var A=m3(r[4][0].data);A[7][0].data=m1(e.e.r+1);var B=nc(m3(A[1][0].data)[2][0].data);if((u=m6(m8((t=gR.find(k,i[B].location)).content)))[0].id!=B)throw"Bad HeaderStorageBucket";var C=m3(u[0].messages[0].data);for(z=0;z<g.length;++z){var D=m3(C[2][0].data);D[1][0].data=m1(z),D[4][0].data=m1(g[z].length),C[2][z]={type:C[2][0].type,data:m4(D)}}u[0].messages[0].data=m4(C),t.content=m9(m7(u)),t.size=t.content.length;var E=nc(A[2][0].data);if((u=m6(m8((t=gR.find(k,i[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";for(x=0,C=m3(u[0].messages[0].data);x<=e.e.c;++x)(D=m3(C[2][0].data))[1][0].data=m1(x),D[4][0].data=m1(e.e.r+1),C[2][x]={type:C[2][0].type,data:m4(D)};u[0].messages[0].data=m4(C),t.content=m9(m7(u)),t.size=t.content.length;var F=nc(A[4][0].data);!function(){for(var a,b=gR.find(k,i[F].location),c=m6(m8(b.content)),d=0;d<c.length;++d){var e=c[d];e.id==F&&(a=e)}var f=m3(a.messages[0].data);f[3]=[];var g=[];h.forEach(function(a,b){g[1]=[{type:0,data:m1(b)}],g[2]=[{type:0,data:m1(1)}],g[3]=[{type:2,data:"undefined"!=typeof TextEncoder?new TextEncoder().encode(a):f5(hL(a))}],f[3].push({type:2,data:m4(g)})}),a.messages[0].data=m4(f),b.content=m9(m7(c)),b.size=b.content.length}();var G=m3(A[3][0].data),H=G[1][0];delete G[2];var I=m3(H.data),J=nc(I[2][0].data);!function(){for(var a,b=gR.find(k,i[J].location),c=m6(m8(b.content)),d=0;d<c.length;++d){var f=c[d];f.id==J&&(a=f)}var j=m3(a.messages[0].data);delete j[6],delete G[7];var l=new Uint8Array(j[5][0].data);j[5]=[];for(var m=0,n=0;n<=e.e.r;++n){var o=m3(l);m+=function(a,b,c){if(!(null==(d=a[6])?void 0:d[0])||!(null==(e=a[7])?void 0:e[0]))throw"Mutation only works on post-BNC storages!";if((null==(g=null==(f=a[8])?void 0:f[0])?void 0:g.data)&&m2(a[8][0].data)>0)throw"Math only works with normal offsets";for(var d,e,f,g,h,i,j=0,k=mY(a[7][0].data),l=0,m=[],n=mY(a[4][0].data),o=0,p=[],q=0;q<b.length;++q){if(null==b[q]){k.setUint16(2*q,65535,!0),n.setUint16(2*q,65535);continue}switch(k.setUint16(2*q,l,!0),n.setUint16(2*q,o,!0),typeof b[q]){case"string":h=na({t:"s",v:b[q]},c),i=nb({t:"s",v:b[q]},c);break;case"number":h=na({t:"n",v:b[q]},c),i=nb({t:"n",v:b[q]},c);break;case"boolean":h=na({t:"b",v:b[q]},c),i=nb({t:"b",v:b[q]},c);break;default:throw Error("Unsupported value "+b[q])}m.push(h),l+=h.length,p.push(i),o+=i.length,++j}for(a[2][0].data=m1(j);q<a[7][0].data.length/2;++q)k.setUint16(2*q,65535,!0),n.setUint16(2*q,65535,!0);return a[6][0].data=m$(m),a[3][0].data=m$(p),j}(o,g[n],h),o[1][0].data=m1(n),j[5].push({data:m4(o),type:2})}j[1]=[{type:0,data:m1(e.e.c+1)}],j[2]=[{type:0,data:m1(e.e.r+1)}],j[3]=[{type:0,data:m1(m)}],j[4]=[{type:0,data:m1(e.e.r+1)}],a.messages[0].data=m4(j),b.content=m9(m7(c)),b.size=b.content.length}(),H.data=m4(I),A[3][0].data=m4(G),r[4][0].data=m4(A),c.messages[0].data=m4(r);var K=m9(m7(n));return m.content=K,m.size=m.content.length,k}(b,e):"xlsb"==e.bookType?function(a,b){lq=1024,a&&!a.SSF&&(a.SSF=g6(gk)),a&&a.SSF&&(gN(),gM(a.SSF),b.revssf=gW(a.SSF),b.revssf[a.SSF[65535]]=0,b.ssf=a.SSF),b.rels={},b.wbrels={},b.Strings=[],b.Strings.Count=0,b.Strings.Unique=0,l2?b.revStrings=new Map:(b.revStrings={},b.revStrings.foo=[],delete b.revStrings.foo);var c,d,e,f,g,h,i,j="xlsb"==b.bookType?"bin":"xml",k=lu.indexOf(b.bookType)>-1,l=jl();nh(b=b||{});var m=hk(),n="",o=0;if(b.cellXfs=[],l6(b.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),hj(m,n="docProps/core.xml",jy(a.Props,b)),l.coreprops.push(n),jr(b.rels,2,n,jn.CORE_PROPS),n="docProps/app.xml",a.Props&&a.Props.SheetNames);else if(a.Workbook&&a.Workbook.Sheets){for(var p=[],q=0;q<a.SheetNames.length;++q)2!=(a.Workbook.Sheets[q]||{}).Hidden&&p.push(a.SheetNames[q]);a.Props.SheetNames=p}else a.Props.SheetNames=a.SheetNames;for(a.Props.Worksheets=a.Props.SheetNames.length,hj(m,n,jC(a.Props,b)),l.extprops.push(n),jr(b.rels,3,n,jn.EXT_PROPS),a.Custprops!==a.Props&&gT(a.Custprops||{}).length>0&&(hj(m,n="docProps/custom.xml",jE(a.Custprops,b)),l.custprops.push(n),jr(b.rels,4,n,jn.CUST_PROPS)),o=1;o<=a.SheetNames.length;++o){var r={"!id":{}},s=a.Sheets[a.SheetNames[o-1]];if((s||{})["!type"],hj(m,n="xl/worksheets/sheet"+o+"."+j,(t=o-1,u=n,v=b,(".bin"===u.slice(-4)?function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n=iC(),o=c.SheetNames[a],p=c.Sheets[o]||{},q=o;try{c&&c.Workbook&&(q=c.Workbook.Sheets[a].CodeName||q)}catch(a){}var r=iQ(p["!ref"]||"A1");if(r.e.c>16383||r.e.r>1048575){if(b.WTF)throw Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");r.e.c=Math.min(r.e.c,16383),r.e.r=Math.min(r.e.c,1048575)}p["!links"]=[],p["!comments"]=[],iD(n,129),(c.vbaraw||p["!outline"])&&iD(n,147,function(a,b,c){null==c&&(c=iA(84+4*a.length));var d=192;b&&(b.above&&(d&=-65),b.left&&(d&=-129)),c.write_shift(1,d);for(var e=1;e<3;++e)c.write_shift(1,0);return i9({auto:1},c),c.write_shift(-4,-1),c.write_shift(-4,-1),iX(a,c),c.slice(0,c.l)}(q,p["!outline"])),iD(n,148,i6(r)),e=c.Workbook,iD(n,133),iD(n,137,(null==f&&(f=iA(30)),g=924,(((e||{}).Views||[])[0]||{}).RTL&&(g|=32),f.write_shift(2,g),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(1,0),f.write_shift(1,0),f.write_shift(2,0),f.write_shift(2,100),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(2,0),f.write_shift(4,0),f)),iD(n,138),iD(n,134),p&&p["!cols"]&&(iD(n,390),p["!cols"].forEach(function(a,b){var c,d,e;a&&iD(n,60,(null==c&&(c=iA(18)),d=l4(b,a),c.write_shift(-4,b),c.write_shift(-4,b),c.write_shift(4,256*(d.width||10)),c.write_shift(4,0),e=0,a.hidden&&(e|=1),"number"==typeof d.width&&(e|=2),a.level&&(e|=a.level<<8),c.write_shift(2,e),c))}),iD(n,391)),function(a,b,c,d){var e,f=iQ(b["!ref"]||"A1"),g="",h=[];iD(a,145);var i=Array.isArray(b),j=f.e.r;b["!rows"]&&(j=Math.max(f.e.r,b["!rows"].length-1));for(var k=f.s.r;k<=j;++k){g=iJ(k),function(a,b,c,d){var e=function(a,b,c){var d=iA(145),e=(c["!rows"]||[])[a]||{};d.write_shift(4,a),d.write_shift(4,0);var f=320;e.hpx?f=20*k4(e.hpx):e.hpt&&(f=20*e.hpt),d.write_shift(2,f),d.write_shift(1,0);var g=0;e.level&&(g|=e.level),e.hidden&&(g|=16),(e.hpx||e.hpt)&&(g|=32),d.write_shift(1,g),d.write_shift(1,0);var h=0,i=d.l;d.l+=4;for(var j={r:a,c:0},k=0;k<16;++k)if(!(b.s.c>k+1<<10)&&!(b.e.c<k<<10)){for(var l=-1,m=-1,n=k<<10;n<k+1<<10;++n)j.c=n,(Array.isArray(c)?(c[j.r]||[])[j.c]:c[iN(j)])&&(l<0&&(l=n),m=n);l<0||(++h,d.write_shift(4,l),d.write_shift(4,m))}var o=d.l;return d.l=i,d.write_shift(4,h),d.l=o,d.length>d.l?d.slice(0,d.l):d}(d,c,b);(e.length>17||(b["!rows"]||[])[d])&&iD(a,0,e)}(a,b,f,k);var l=!1;if(k<=f.e.r)for(var m=f.s.c;m<=f.e.c;++m){k===f.s.r&&(h[m]=iL(m)),e=h[m]+g;var n=i?(b[k]||[])[m]:b[e];if(!n){l=!1;continue}l=function(a,b,c,d,e,f,g){if(void 0===b.v)return!1;var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F="";switch(b.t){case"b":F=b.v?"1":"0";break;case"d":(b=g6(b)).z=b.z||gk[14],b.v=gY(g4(b.v)),b.t="n";break;case"n":case"e":F=""+b.v;break;default:F=b.v}var G={r:c,c:d};switch(G.s=l6(e.cellXfs,b,e),b.l&&f["!links"].push([iN(G),b.l]),b.c&&f["!comments"].push([iN(G),b.c]),b.t){case"s":case"str":return e.bookSST?(F=l3(e.Strings,b.v,e.revStrings),G.t="s",G.v=F,g)?iD(a,18,(null==h&&(h=iA(8)),i0(G,h),h.write_shift(4,G.v),h)):iD(a,7,(null==i&&(i=iA(12)),i$(G,i),i.write_shift(4,G.v),i)):(G.t="str",g)?iD(a,17,(j=b,null==k&&(k=iA(8+4*j.v.length)),i0(G,k),iX(j.v,k),k.length>k.l?k.slice(0,k.l):k)):iD(a,6,(l=b,null==m&&(m=iA(12+4*l.v.length)),i$(G,m),iX(l.v,m),m.length>m.l?m.slice(0,m.l):m)),!0;case"n":return b.v==(0|b.v)&&b.v>-1e3&&b.v<1e3?g?iD(a,13,(n=b,null==o&&(o=iA(8)),i0(G,o),i4(n.v,o),o)):iD(a,2,(p=b,null==q&&(q=iA(12)),i$(G,q),i4(p.v,q),q)):g?iD(a,16,(r=b,null==s&&(s=iA(12)),i0(G,s),i8(r.v,s),s)):iD(a,5,(t=b,null==u&&(u=iA(16)),i$(G,u),i8(t.v,u),u)),!0;case"b":return(G.t="b",g)?iD(a,15,(v=b,null==w&&(w=iA(5)),i0(G,w),w.write_shift(1,+!!v.v),w)):iD(a,4,(x=b,null==y&&(y=iA(9)),i$(G,y),y.write_shift(1,+!!x.v),y)),!0;case"e":return(G.t="e",g)?iD(a,14,(z=b,null==A&&(A=iA(8)),i0(G,A),A.write_shift(1,z.v),A.write_shift(2,0),A.write_shift(1,0),A)):iD(a,3,(B=b,null==C&&(C=iA(9)),i$(G,C),C.write_shift(1,B.v),C)),!0}return g?iD(a,12,(null==D&&(D=iA(4)),i0(G,D))):iD(a,1,(null==E&&(E=iA(8)),i$(G,E))),!0}(a,n,k,m,d,b,l)}}iD(a,146)}(n,p,0,b,c);p["!protect"]&&iD(n,535,(h=p["!protect"],null==i&&(i=iA(66)),i.write_shift(2,h.password?kS(h.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?i.write_shift(4,+(null!=h[a[0]]&&!h[a[0]])):i.write_shift(4,null!=h[a[0]]&&h[a[0]]?0:1)}),i)),!function(a,b,c,d){if(b["!autofilter"]){var e=b["!autofilter"],f="string"==typeof e.ref?e.ref:iP(e.ref);c.Workbook||(c.Workbook={Sheets:[]}),c.Workbook.Names||(c.Workbook.Names=[]);var g=c.Workbook.Names,h=iO(f);h.s.r==h.e.r&&(h.e.r=iO(b["!ref"]).e.r,f=iP(h));for(var i=0;i<g.length;++i){var j=g[i];if("_xlnm._FilterDatabase"==j.Name&&j.Sheet==d){j.Ref="'"+c.SheetNames[d]+"'!"+f;break}}i==g.length&&g.push({Name:"_xlnm._FilterDatabase",Sheet:d,Ref:"'"+c.SheetNames[d]+"'!"+f}),iD(a,161,i6(iQ(f))),iD(a,162)}}(n,p,c,a);p&&p["!merges"]&&(iD(n,177,(j=p["!merges"].length,null==k&&(k=iA(4)),k.write_shift(4,j),k)),p["!merges"].forEach(function(a){iD(n,176,i6(a))}),iD(n,178)),p["!links"].forEach(function(a){if(a[1].Target){var b,c,e=jr(d,-1,a[1].Target.replace(/#.*$/,""),jn.HLINK);iD(n,494,(b=iA(50+4*(a[1].Target.length+(a[1].Tooltip||"").length)),i6({s:iM(a[0]),e:iM(a[0])},b),i2("rId"+e,b),iX((-1==(c=a[1].Target.indexOf("#"))?"":a[1].Target.slice(c+1))||"",b),iX(a[1].Tooltip||"",b),iX("",b),b.slice(0,b.l)))}}),delete p["!links"],p["!margins"]&&iD(n,476,(l=p["!margins"],null==m&&(m=iA(48)),l5(l),mp.forEach(function(a){i8(l[a],m)}),m)),(!b||b.ignoreEC||void 0==b.ignoreEC)&&function(a,b){if(b&&b["!ref"]){var c,d;iD(a,648),iD(a,649,(c=iQ(b["!ref"]),(d=iA(24)).write_shift(4,4),d.write_shift(4,1),i6(c,d),d)),iD(a,650)}}(n,p);if(p["!comments"].length>0){var s=jr(d,-1,"../drawings/vmlDrawing"+(a+1)+".vml",jn.VML);iD(n,551,i2("rId"+s)),p["!legacy"]=s}return iD(n,130),n.end()}:mn)(t,v,a,r))),l.sheets.push(n),jr(b.wbrels,-1,"worksheets/sheet"+o+"."+j,jn.WS[0]),s){var t,u,v,w,x,y=s["!comments"],z=!1,A="";y&&y.length>0&&(hj(m,A="xl/comments"+o+"."+j,(w=A,x=b,(".bin"===w.slice(-4)?function(a){var b=iC(),c=[];return iD(b,628),iD(b,630),a.forEach(function(a){a[1].forEach(function(a){c.indexOf(a.a)>-1||(c.push(a.a.slice(0,54)),iD(b,632,iX(a.a.slice(0,54))))})}),iD(b,631),iD(b,633),a.forEach(function(a){a[1].forEach(function(d){var e,f,g,h,i,j;d.iauthor=c.indexOf(d.a),iD(b,635,(e=[{s:iM(a[0]),e:iM(a[0])},d],null==f&&(f=iA(36)),f.write_shift(4,e[1].iauthor),i6(e[0],f),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,0),f.write_shift(4,0),f)),d.t&&d.t.length>0&&iD(b,637,(h=!1,null==g&&(h=!0,g=iA(23+4*d.t.length)),g.write_shift(1,1),iX(d.t,g),g.write_shift(4,1),i={ich:0,ifnt:0},(j=g)||(j=iA(4)),j.write_shift(2,i.ich||0),j.write_shift(2,i.ifnt||0),h?g.slice(0,g.l):g)),iD(b,636),delete d.iauthor})}),iD(b,634),iD(b,629),b.end()}:lt)(y,x))),l.comments.push(A),jr(r,-1,"../comments"+o+"."+j,jn.CMNT),z=!0),s["!legacy"]&&z&&hj(m,"xl/drawings/vmlDrawing"+o+".vml",lr(o,s["!comments"])),delete s["!comments"],delete s["!legacy"]}r["!id"].rId1&&hj(m,jo(n),jq(r))}return null!=b.Strings&&b.Strings.length>0&&(hj(m,n="xl/sharedStrings."+j,(c=b.Strings,d=n,e=b,(".bin"===d.slice(-4)?function(a){var b,c=iC();iD(c,159,(b||(b=iA(8)),b.write_shift(4,a.Count),b.write_shift(4,a.Unique),b));for(var d=0;d<a.length;++d)iD(c,19,kN(a[d]));return iD(c,160),c.end()}:kM)(c,e))),l.strs.push(n),jr(b.wbrels,-1,"sharedStrings."+j,jn.SST)),hj(m,n="xl/workbook."+j,(f=n,g=b,(".bin"===f.slice(-4)?function(a,b){var c=iC();iD(c,131),iD(c,128,function(a,b){b||(b=iA(127));for(var c=0;4!=c;++c)b.write_shift(4,0);return iX("SheetJS",b),iX(fN.version,b),iX(fN.version,b),iX("7262",b),b.length>b.l?b.slice(0,b.l):b}()),iD(c,153,(e=a.Workbook&&a.Workbook.WBProps||null,f||(f=iA(72)),g=0,e&&e.filterPrivacy&&(g|=8),f.write_shift(4,g),f.write_shift(4,0),iX(e&&e.CodeName||"ThisWorkbook",f),f.slice(0,f.l))),function(a,b){if(b.Workbook&&b.Workbook.Sheets){for(var c,d,e=b.Workbook.Sheets,f=0,g=-1,h=-1;f<e.length;++f)e[f]&&(e[f].Hidden||-1!=g)?1==e[f].Hidden&&-1==h&&(h=f):g=f;h>g||(iD(a,135),iD(a,158,(c=g,d||(d=iA(29)),d.write_shift(-4,0),d.write_shift(-4,460),d.write_shift(4,28800),d.write_shift(4,17600),d.write_shift(4,500),d.write_shift(4,c),d.write_shift(4,c),d.write_shift(1,120),d.length>d.l?d.slice(0,d.l):d)),iD(a,136))}}(c,a,b);iD(c,143);for(var d=0;d!=a.SheetNames.length;++d){var e,f,g,h={Hidden:a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[d]&&a.Workbook.Sheets[d].Hidden||0,iTabID:d+1,strRelID:"rId"+(d+1),name:a.SheetNames[d]},i=void 0;iD(c,156,(i||(i=iA(127)),i.write_shift(4,h.Hidden),i.write_shift(4,h.iTabID),i2(h.strRelID,i),iX(h.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i))}return iD(c,144),iD(c,132),c.end()}:mA)(a,g))),l.workbooks.push(n),jr(b.rels,1,n,jn.WB),hj(m,n="xl/theme/theme1.xml",lo(a.Themes,b)),l.themes.push(n),jr(b.wbrels,-1,"theme/theme1.xml",jn.THEME),hj(m,n="xl/styles."+j,(h=n,i=b,(".bin"===h.slice(-4)?function(a,b){var c,d,e,f,g,h=iC();return iD(h,278),function(a,b){if(b){var c=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var d=a[0];d<=a[1];++d)null!=b[d]&&++c}),0!=c&&(iD(a,615,iV(c)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var d=c[0];d<=c[1];++d)null!=b[d]&&iD(a,44,function(a,b,c){c||(c=iA(6+4*b.length)),c.write_shift(2,a),iX(b,c);var d=c.length>c.l?c.slice(0,c.l):c;return null==c.l&&(c.l=c.length),d}(d,b[d]))}),iD(a,616))}}(h,a.SSF),function(a){var b,c,d,e,f,g;iD(a,611,iV(1)),iD(a,43,(b={sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"},c||(c=iA(153)),c.write_shift(2,20*b.sz),(d=c)||(d=iA(2)),e=2*!!b.italic|8*!!b.strike|16*!!b.outline|32*!!b.shadow|64*!!b.condense|128*!!b.extend,d.write_shift(1,e),d.write_shift(1,0),c.write_shift(2,b.bold?700:400),f=0,"superscript"==b.vertAlign?f=1:"subscript"==b.vertAlign&&(f=2),c.write_shift(2,f),c.write_shift(1,b.underline||0),c.write_shift(1,b.family||0),c.write_shift(1,b.charset||0),c.write_shift(1,0),i9(b.color,c),g=0,"major"==b.scheme&&(g=1),"minor"==b.scheme&&(g=2),c.write_shift(1,g),iX(b.name,c),c.length>c.l?c.slice(0,c.l):c)),iD(a,612)}(h,a),iD(h,603,iV(2)),iD(h,45,lc({patternType:"none"})),iD(h,45,lc({patternType:"gray125"})),iD(h,604),iD(h,613,iV(1)),iD(h,46,(c||(c=iA(51)),c.write_shift(1,0),le(null,c),le(null,c),le(null,c),le(null,c),le(null,c),c.length>c.l?c.slice(0,c.l):c)),iD(h,614),iD(h,626,iV(1)),iD(h,47,ld({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),iD(h,627),iD(h,617,iV((d=b.cellXfs).length)),d.forEach(function(a){iD(h,47,ld(a,0))}),iD(h,618),iD(h,619,iV(1)),iD(h,48,(e={xfId:0,builtinId:0,name:"Normal"},f||(f=iA(52)),f.write_shift(4,e.xfId),f.write_shift(2,1),f.write_shift(1,+e.builtinId),f.write_shift(1,0),i2(e.name||"",f),f.length>f.l?f.slice(0,f.l):f)),iD(h,620),iD(h,505,iV(0)),iD(h,506),iD(h,508,((g=iA(2052)).write_shift(4,0),i2("TableStyleMedium9",g),i2("PivotStyleMedium4",g),g.length>g.l?g.slice(0,g.l):g)),iD(h,509),iD(h,279),h.end()}:la)(a,i))),l.styles.push(n),jr(b.wbrels,-1,"styles."+j,jn.STY),a.vbaraw&&k&&(hj(m,n="xl/vbaProject.bin",a.vbaraw),l.vba.push(n),jr(b.wbrels,-1,"vbaProject.bin",jn.VBA)),hj(m,n="xl/metadata."+j,(".bin"===n.slice(-4)?function(){var a,b,c,d,e=iC();return iD(e,332),iD(e,334,iV(1)),iD(e,335,((b=iA(12+2*(a={name:"XLDAPR",version:12e4,flags:0xd06ac0b0}).name.length)).write_shift(4,a.flags),b.write_shift(4,a.version),iX(a.name,b),b.slice(0,b.l))),iD(e,336),iD(e,339,((c=iA(20)).write_shift(4,1),iX("XLDAPR",c),c.slice(0,c.l))),iD(e,52),iD(e,35,iV(514)),iD(e,4096,iV(0)),iD(e,4097,jY(1)),iD(e,36),iD(e,53),iD(e,340),iD(e,337,((d=iA(8)).write_shift(4,1),d.write_shift(4,1),d)),iD(e,51,function(a){var b=iA(4+8*a.length);b.write_shift(4,a.length);for(var c=0;c<a.length;++c)b.write_shift(4,a[c][0]),b.write_shift(4,a[c][1]);return b}([[1,0]])),iD(e,338),iD(e,333),e.end()}:lp)()),l.metadata.push(n),jr(b.wbrels,-1,"metadata."+j,jn.XLMETA),hj(m,"[Content_Types].xml",jm(l,b)),hj(m,"_rels/.rels",jq(b.rels)),hj(m,"xl/_rels/workbook."+j+".rels",jq(b.wbrels)),delete b.revssf,delete b.ssf,m}(b,e):function(a,b){lq=1024,a&&!a.SSF&&(a.SSF=g6(gk)),a&&a.SSF&&(gN(),gM(a.SSF),b.revssf=gW(a.SSF),b.revssf[a.SSF[65535]]=0,b.ssf=a.SSF),b.rels={},b.wbrels={},b.Strings=[],b.Strings.Count=0,b.Strings.Unique=0,l2?b.revStrings=new Map:(b.revStrings={},b.revStrings.foo=[],delete b.revStrings.foo);var c,d=lu.indexOf(b.bookType)>-1,e=jl();nh(b=b||{});var f=hk(),g="",h=0;if(b.cellXfs=[],l6(b.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),hj(f,g="docProps/core.xml",jy(a.Props,b)),e.coreprops.push(g),jr(b.rels,2,g,jn.CORE_PROPS),g="docProps/app.xml",a.Props&&a.Props.SheetNames);else if(a.Workbook&&a.Workbook.Sheets){for(var i=[],j=0;j<a.SheetNames.length;++j)2!=(a.Workbook.Sheets[j]||{}).Hidden&&i.push(a.SheetNames[j]);a.Props.SheetNames=i}else a.Props.SheetNames=a.SheetNames;a.Props.Worksheets=a.Props.SheetNames.length,hj(f,g,jC(a.Props,b)),e.extprops.push(g),jr(b.rels,3,g,jn.EXT_PROPS),a.Custprops!==a.Props&&gT(a.Custprops||{}).length>0&&(hj(f,g="docProps/custom.xml",jE(a.Custprops,b)),e.custprops.push(g),jr(b.rels,4,g,jn.CUST_PROPS));var k=["SheetJ5"];for(h=1,b.tcid=0;h<=a.SheetNames.length;++h){var l={"!id":{}},m=a.Sheets[a.SheetNames[h-1]];if((m||{})["!type"],hj(f,g="xl/worksheets/sheet"+h+".xml",mn(h-1,b,a,l)),e.sheets.push(g),jr(b.wbrels,-1,"worksheets/sheet"+h+".xml",jn.WS[0]),m){var n=m["!comments"],o=!1,p="";if(n&&n.length>0){var q=!1;n.forEach(function(a){a[1].forEach(function(a){!0==a.T&&(q=!0)})}),q&&(hj(f,p="xl/threadedComments/threadedComment"+h+".xml",function(a,b,c){var d=[hn,hV("ThreadedComments",null,{xmlns:hZ.TCMNT}).replace(/[\/]>/,">")];return a.forEach(function(a){var e="";(a[1]||[]).forEach(function(f,g){if(!f.T)return void delete f.ID;f.a&&-1==b.indexOf(f.a)&&b.push(f.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+c.tcid++).slice(-12)+"}"};0==g?e=h.id:h.parentId=e,f.ID=h.id,f.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+b.indexOf(f.a)).slice(-12)+"}"),d.push(hV("threadedComment",hT("text",f.t||""),h))})}),d.push("</ThreadedComments>"),d.join("")}(n,k,b)),e.threadedcomments.push(p),jr(l,-1,"../threadedComments/threadedComment"+h+".xml",jn.TCMNT)),hj(f,p="xl/comments"+h+".xml",lt(n,b)),e.comments.push(p),jr(l,-1,"../comments"+h+".xml",jn.CMNT),o=!0}m["!legacy"]&&o&&hj(f,"xl/drawings/vmlDrawing"+h+".vml",lr(h,m["!comments"])),delete m["!comments"],delete m["!legacy"]}l["!id"].rId1&&hj(f,jo(g),jq(l))}return null!=b.Strings&&b.Strings.length>0&&(hj(f,g="xl/sharedStrings.xml",kM(b.Strings,b)),e.strs.push(g),jr(b.wbrels,-1,"sharedStrings.xml",jn.SST)),hj(f,g="xl/workbook.xml",mA(a,b)),e.workbooks.push(g),jr(b.rels,1,g,jn.WB),hj(f,g="xl/theme/theme1.xml",lo(a.Themes,b)),e.themes.push(g),jr(b.wbrels,-1,"theme/theme1.xml",jn.THEME),hj(f,g="xl/styles.xml",la(a,b)),e.styles.push(g),jr(b.wbrels,-1,"styles.xml",jn.STY),a.vbaraw&&d&&(hj(f,g="xl/vbaProject.bin",a.vbaraw),e.vba.push(g),jr(b.wbrels,-1,"vbaProject.bin",jn.VBA)),hj(f,g="xl/metadata.xml",lp()),e.metadata.push(g),jr(b.wbrels,-1,"metadata.xml",jn.XLMETA),k.length>1&&(hj(f,g="xl/persons/person.xml",(c=[hn,hV("personList",null,{xmlns:hZ.TCMNT,"xmlns:x":h$[0]}).replace(/[\/]>/,">")],k.forEach(function(a,b){c.push(hV("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+b).slice(-12)+"}",userId:a,providerId:"None"}))}),c.push("</personList>"),c.join(""))),e.people.push(g),jr(b.wbrels,-1,"persons/person.xml",jn.PEOPLE)),hj(f,"[Content_Types].xml",jm(e,b)),hj(f,"_rels/.rels",jq(b.rels)),hj(f,"xl/_rels/workbook.xml.rels",jq(b.wbrels)),delete b.revssf,delete b.ssf,f}(b,e),e);default:throw Error("Unrecognized bookType |"+f.bookType+"|")}}(c,{bookType:"xlsx",type:"binary"}),l=new ArrayBuffer(k.length),m=new Uint8Array(l);for(let a=0;a<k.length;++a)m[a]=255&k.charCodeAt(a);let n=new Blob([l],{type:"application/octet-stream"}),o=URL.createObjectURL(n),p=document.createElement("a");p.href=o,p.download=`rfp-${i.fileName}`,p.click(),URL.revokeObjectURL(o),fD.oR.success(`Fichier export\xe9 (${j} lignes mises \xe0 jour).`)},disabled:p,children:"Exporter"})]})]}),(0,v.jsx)("div",{className:"border rounded-md overflow-x-auto",children:(0,v.jsx)(qR,{sensors:E,collisionDetection:pY,onDragEnd:a=>{let{active:b,over:c}=a;if(b.id!==c?.id){let a=f.indexOf(b.id),d=f.indexOf(c.id);g(qV(f,a,d))}},children:(0,v.jsxs)(ou,{style:{width:C.getTotalSize()},children:[(0,v.jsx)(ov,{children:C.getHeaderGroups().map(a=>(0,v.jsx)(ox,{children:(0,v.jsx)(q0,{items:f,strategy:qY,children:a.headers.map(a=>(0,v.jsx)(q9,{header:a},a.id))})},a.id))}),(0,v.jsx)(ow,{children:C.getRowModel().rows.map(a=>(0,v.jsx)(ox,{onClick:()=>c(a.index),className:`cursor-pointer ${(a=>{switch(a){case"Valid\xe9e":return"bg-green-50 hover:bg-green-100";case"Doute":return"bg-yellow-50 hover:bg-yellow-100";case"Refus\xe9e":return"bg-red-50 hover:bg-red-100";default:return"hover:bg-slate-50"}})(a.original.status)}`,children:a.getVisibleCells().map(a=>(0,v.jsx)(oz,{style:{width:a.column.getSize()},className:"align-top border-r",children:pn(a.column.columnDef.cell,a.getContext())},a.id))},a.id))})]})})}),(0,v.jsx)(q8,{})]})}function rb(){let{currentStep:a,setCurrentStep:b,llmConfigs:c,projectData:d,results:e}=D(),[f,g]=(0,w.useState)(!1),h=c.some(a=>a.isValidated),i=!!d?.questionColumn&&!!d?.answerColumn,j=e.length>0;return f?(0,v.jsxs)("div",{className:`${4===a?"container-fluid px-4 md:px-8":"container"} mx-auto p-4 md:p-8 min-h-screen`,children:[(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("h1",{className:"text-5xl font-extrabold tracking-tight bg-gradient-to-r from-blue-600 via-purple-500 to-indigo-400 text-transparent bg-clip-text",children:"RFP Studio"}),(0,v.jsx)("p",{className:"text-lg text-muted-foreground mt-2",children:"G\xe9n\xe9rez et validez des r\xe9ponses avanc\xe9es \xe0 grande \xe9chelle."})]}),(0,v.jsx)(F,{}),(0,v.jsx)("div",{className:`mt-12 ${4!==a?"max-w-4xl mx-auto":""}`,children:(()=>{switch(a){case 1:default:return(0,v.jsx)(fK,{});case 2:return(0,v.jsx)(nw,{});case 3:return(0,v.jsx)(ot,{});case 4:return(0,v.jsx)(ra,{})}})()}),(0,v.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto flex justify-between",children:[(0,v.jsx)(aR,{variant:"outline",onClick:()=>{a>1&&b(a-1)},disabled:1===a,children:" Pr\xe9c\xe9dent"}),a<4&&(0,v.jsx)(aR,{onClick:()=>{a<4&&b(a+1)},disabled:!(1===a?h:2===a?i:3===a&&j),children:"Suivant "})]})]}):(0,v.jsx)("div",{className:"w-screen h-screen flex items-center justify-center",children:(0,v.jsx)(fy.A,{className:"h-8 w-8 animate-spin text-primary"})})}},53476:(a,b)=>{"use strict";function c(a,b){if(0===b.length)return 0;if(0===a.length||b.length>a.length)return -1;for(let c=0;c<=a.length-b.length;c++){let d=!0;for(let e=0;e<b.length;e++)if(a[c+e]!==b[e]){d=!1;break}if(d)return c}return -1}function d(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function e(a,b){let d=c(a,b);if(0===d)return a.subarray(b.length);if(!(d>-1))return a;{let c=new Uint8Array(a.length-b.length);return c.set(a.slice(0,d)),c.set(a.slice(d+b.length),d),c}}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{indexOfUint8Array:function(){return c},isEquivalentUint8Arrays:function(){return d},removeFromUint8Array:function(){return e}})},54210:(a,b,c)=>{"use strict";let d;Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{arrayBufferToString:function(){return h},decrypt:function(){return k},encrypt:function(){return j},getActionEncryptionKey:function(){return p},getClientReferenceManifestForRsc:function(){return o},getServerModuleMap:function(){return n},setReferenceManifestsSingleton:function(){return m},stringToUint8Array:function(){return i}});let e=c(58871),f=c(17916),g=c(29294);function h(a){let b=new Uint8Array(a),c=b.byteLength;if(c<65535)return String.fromCharCode.apply(null,b);let d="";for(let a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}function i(a){let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function j(a,b,c){return crypto.subtle.encrypt({name:"AES-GCM",iv:b},a,c)}function k(a,b,c){return crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c)}let l=Symbol.for("next.server.action-manifests");function m({page:a,clientReferenceManifest:b,serverActionsManifest:c,serverModuleMap:d}){var e;let g=null==(e=globalThis[l])?void 0:e.clientReferenceManifestsPerPage;globalThis[l]={clientReferenceManifestsPerPage:{...g,[(0,f.normalizeAppPath)(a)]:b},serverActionsManifest:c,serverModuleMap:d}}function n(){let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});return a.serverModuleMap}function o(){let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let{clientReferenceManifestsPerPage:b}=a,c=g.workAsyncStorage.getStore();if(!c){var d=b;let a=Object.values(d),c={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let b of a)c.clientModules={...c.clientModules,...b.clientModules},c.edgeRscModuleMapping={...c.edgeRscModuleMapping,...b.edgeRscModuleMapping},c.rscModuleMapping={...c.rscModuleMapping,...b.rscModuleMapping};return c}let f=b[c.route];if(!f)throw Object.defineProperty(new e.InvariantError(`Missing Client Reference Manifest for ${c.route}.`),"__NEXT_ERROR_CODE",{value:"E570",enumerable:!1,configurable:!0});return f}async function p(){if(d)return d;let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let b=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||a.serverActionsManifest.encryptionKey;if(void 0===b)throw Object.defineProperty(new e.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return d=await crypto.subtle.importKey("raw",i(atob(b)),"AES-GCM",!0,["encrypt","decrypt"])}},54353:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DOC_PREFETCH_RANGE_HEADER_VALUE:function(){return d},doesExportedHtmlMatchBuildId:function(){return g},insertBuildIdComment:function(){return f}});let c="<!DOCTYPE html>",d="bytes=0-63";function e(a){return a.slice(0,24).replace(/-/g,"_")}function f(a,b){return b.includes("--\x3e")||!a.startsWith(c)?a:a.replace(c,c+"\x3c!--"+e(b)+"--\x3e")}function g(a,b){return a.startsWith(c+"\x3c!--"+e(b)+"--\x3e")}},54590:(a,b,c)=>{let d=c(49622),e=c(12132),f=c(47706),g=c(60174),h=c(77166),i=c(72481),j=c(33851),k=c(86386),l=c(69688),m=c(87706),n=c(44650),{KeyObject:o,createSecretKey:p,createPrivateKey:q}=c(55511),r=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];e&&r.splice(3,0,"PS256","PS384","PS512");let s={expiresIn:{isValid:function(a){return j(a)||m(a)&&a},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(a){return j(a)||m(a)&&a},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(a){return m(a)||Array.isArray(a)},message:'"audience" must be a string or array'},algorithm:{isValid:h.bind(null,r),message:'"algorithm" must be a valid string enum value'},header:{isValid:l,message:'"header" must be an object'},encoding:{isValid:m,message:'"encoding" must be a string'},issuer:{isValid:m,message:'"issuer" must be a string'},subject:{isValid:m,message:'"subject" must be a string'},jwtid:{isValid:m,message:'"jwtid" must be a string'},noTimestamp:{isValid:i,message:'"noTimestamp" must be a boolean'},keyid:{isValid:m,message:'"keyid" must be a string'},mutatePayload:{isValid:i,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:i,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:i,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},t={iat:{isValid:k,message:'"iat" should be a number of seconds'},exp:{isValid:k,message:'"exp" should be a number of seconds'},nbf:{isValid:k,message:'"nbf" should be a number of seconds'}};function u(a,b,c,d){if(!l(c))throw Error('Expected "'+d+'" to be a plain object.');Object.keys(c).forEach(function(e){let f=a[e];if(!f){if(!b)throw Error('"'+e+'" is not allowed in "'+d+'"');return}if(!f.isValid(c[e]))throw Error(f.message)})}let v={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},w=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];a.exports=function(a,b,c,e){var h,i;"function"==typeof c?(e=c,c={}):c=c||{};let j="object"==typeof a&&!Buffer.isBuffer(a),k=Object.assign({alg:c.algorithm||"HS256",typ:j?"JWT":void 0,kid:c.keyid},c.header);function l(a){if(e)return e(a);throw a}if(!b&&"none"!==c.algorithm)return l(Error("secretOrPrivateKey must have a value"));if(null!=b&&!(b instanceof o))try{b=q(b)}catch(a){try{b=p("string"==typeof b?Buffer.from(b):b)}catch(a){return l(Error("secretOrPrivateKey is not valid key material"))}}if(k.alg.startsWith("HS")&&"secret"!==b.type)return l(Error(`secretOrPrivateKey must be a symmetric key when using ${k.alg}`));if(/^(?:RS|PS|ES)/.test(k.alg)){if("private"!==b.type)return l(Error(`secretOrPrivateKey must be an asymmetric key when using ${k.alg}`));if(!c.allowInsecureKeySizes&&!k.alg.startsWith("ES")&&void 0!==b.asymmetricKeyDetails&&b.asymmetricKeyDetails.modulusLength<2048)return l(Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${k.alg}`))}if(void 0===a)return l(Error("payload is required"));if(j){try{h=a,u(t,!0,h,"payload")}catch(a){return l(a)}c.mutatePayload||(a=Object.assign({},a))}else{let b=w.filter(function(a){return void 0!==c[a]});if(b.length>0)return l(Error("invalid "+b.join(",")+" option for "+typeof a+" payload"))}if(void 0!==a.exp&&void 0!==c.expiresIn)return l(Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==a.nbf&&void 0!==c.notBefore)return l(Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{i=c,u(s,!1,i,"options")}catch(a){return l(a)}if(!c.allowInvalidAsymmetricKeyTypes)try{f(k.alg,b)}catch(a){return l(a)}let m=a.iat||Math.floor(Date.now()/1e3);if(c.noTimestamp?delete a.iat:j&&(a.iat=m),void 0!==c.notBefore){try{a.nbf=d(c.notBefore,m)}catch(a){return l(a)}if(void 0===a.nbf)return l(Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==c.expiresIn&&"object"==typeof a){try{a.exp=d(c.expiresIn,m)}catch(a){return l(a)}if(void 0===a.exp)return l(Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(v).forEach(function(b){let d=v[b];if(void 0!==c[b]){if(void 0!==a[d])return l(Error('Bad "options.'+b+'" option. The payload already has an "'+d+'" property.'));a[d]=c[b]}});let r=c.encoding||"utf8";if("function"==typeof e)e=e&&n(e),g.createSign({header:k,privateKey:b,payload:a,encoding:r}).once("error",e).once("done",function(a){if(!c.allowInsecureKeySizes&&/^(?:RS|PS)/.test(k.alg)&&a.length<256)return e(Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${k.alg}`));e(null,a)});else{let d=g.sign({header:k,payload:a,secret:b,encoding:r});if(!c.allowInsecureKeySizes&&/^(?:RS|PS)/.test(k.alg)&&d.length<256)throw Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${k.alg}`);return d}}},54848:(a,b)=>{"use strict";b.w=void 0,b.w={operationRequestMap:new WeakMap}},55017:(a,b,c)=>{var d=c(42596),e=function(a,b){d.call(this,a),this.name="NotBeforeError",this.date=b};e.prototype=Object.create(d.prototype),e.prototype.constructor=e,a.exports=e},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},57317:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b)=>new d(a,b).minor},57593:(a,b,c)=>{"use strict";let d=c(71635);a.exports=(a,b)=>{let c=d(a.trim().replace(/^[=v]+/,""),b);return c?c.version:null}},57941:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"MISSING_ROOT_TAGS_ERROR",{enumerable:!0,get:function(){return c}});let c="NEXT_MISSING_ROOT_TAGS";("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},57975:a=>{"use strict";a.exports=require("node:util")},57976:(a,b,c)=>{"use strict";let d=c(71635);a.exports=(a,b)=>{let c=d(a,b);return c&&c.prerelease.length?c.prerelease:null}},58337:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b)=>new d(a,b).major},58871:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"InvariantError",{enumerable:!0,get:function(){return c}});class c extends Error{constructor(a,b){super("Invariant: "+(a.endsWith(".")?a:a+".")+" This is a bug in Next.js.",b),this.name="InvariantError"}}},59218:a=>{"use strict";let b=/^[0-9]+$/,c=(a,c)=>{if("number"==typeof a&&"number"==typeof c)return a===c?0:a<c?-1:1;let d=b.test(a),e=b.test(c);return d&&e&&(a*=1,c*=1),a===c?0:d&&!e?-1:e&&!d?1:a<c?-1:1};a.exports={compareIdentifiers:c,rcompareIdentifiers:(a,b)=>c(b,a)}},59366:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>0>d(a,b,c)},60174:(a,b,c)=>{var d=c(1617),e=c(98746);b.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],b.sign=d.sign,b.verify=e.verify,b.decode=e.decode,b.isValid=e.isValid,b.createSign=function(a){return new d(a)},b.createVerify=function(a){return new e(a)}},60967:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/macramzi/Documents/rfpcopilot/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/macramzi/Documents/rfpcopilot/src/app/page.tsx","default")},61135:()=>{},61626:(a,b,c)=>{var d=c(79428).Buffer;a.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63489:(a,b,c)=>{"use strict";var d=c(74364).Buffer,e=c(93990);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}a.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var n=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var o=c-k,p=c-m,q=d.allocUnsafe(o+k+p+m);for(i=0;i<o;++i)q[i]=0;a.copy(q,i,l+Math.max(-o,0),l+k),i=c;for(var r=i;i<r+p;++i)q[i]=0;return a.copy(q,i,n+Math.max(-p,0),n+m),q=(q=q.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,n=m<128,o=d.allocUnsafe((n?2:3)+m),p=0;return o[p++]=48,n?o[p++]=m:(o[p++]=129,o[p++]=255&m),o[p++]=2,o[p++]=k,i<0?(o[p++]=0,p+=a.copy(o,p,0,c)):p+=a.copy(o,p,i,c),o[p++]=2,o[p++]=l,j<0?(o[p++]=0,a.copy(o,p,c)):a.copy(o,p,c+j),o}}},63535:a=>{"use strict";a.exports=(a,b=process.argv)=>{let c=a.startsWith("-")?"":1===a.length?"-":"--",d=b.indexOf(c+a),e=b.indexOf("--");return -1!==d&&(-1===e||d<e)}},67418:(a,b,c)=>{"use strict";let d=c(23948),e=c(97106),f=c(85327),g=c(94764),h=c(59366),i=c(97579);a.exports=(a,b,c,j)=>{switch(b){case"===":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a===c;case"!==":return"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),a!==c;case"":case"=":case"==":return d(a,c,j);case"!=":return e(a,c,j);case">":return f(a,c,j);case">=":return g(a,c,j);case"<":return h(a,c,j);case"<=":return i(a,c,j);default:throw TypeError(`Invalid operator: ${b}`)}}},67649:(a,b)=>{"use strict";b.w=void 0,b.w={instrumenterImplementation:void 0}},68131:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.HttpsProxyAgent=void 0;let h=f(c(91645)),i=f(c(34631)),j=g(c(12412)),k=g(c(90064)),l=c(2956),m=c(79551),n=c(11515),o=(0,k.default)("https-proxy-agent"),p=a=>void 0===a.servername&&a.host&&!h.isIP(a.host)?{...a,servername:a.host}:a;class q extends l.Agent{constructor(a,b){super(b),this.options={path:void 0},this.proxy="string"==typeof a?new m.URL(a):a,this.proxyHeaders=b?.headers??{},o("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let c=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),d=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...b?s(b,"headers"):null,host:c,port:d}}async connect(a,b){let c,{proxy:d}=this;if(!b.host)throw TypeError('No "host" provided');"https:"===d.protocol?(o("Creating `tls.Socket`: %o",this.connectOpts),c=i.connect(p(this.connectOpts))):(o("Creating `net.Socket`: %o",this.connectOpts),c=h.connect(this.connectOpts));let e="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},f=h.isIPv6(b.host)?`[${b.host}]`:b.host,g=`CONNECT ${f}:${b.port} HTTP/1.1\r
`;if(d.username||d.password){let a=`${decodeURIComponent(d.username)}:${decodeURIComponent(d.password)}`;e["Proxy-Authorization"]=`Basic ${Buffer.from(a).toString("base64")}`}for(let a of(e.Host=`${f}:${b.port}`,e["Proxy-Connection"]||(e["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(e)))g+=`${a}: ${e[a]}\r
`;let k=(0,n.parseProxyResponse)(c);c.write(`${g}\r
`);let{connect:l,buffered:m}=await k;if(a.emit("proxyConnect",l),this.emit("proxyConnect",l,a),200===l.statusCode)return(a.once("socket",r),b.secureEndpoint)?(o("Upgrading socket connection to TLS"),i.connect({...s(p(b),"host","path","port"),socket:c})):c;c.destroy();let q=new h.Socket({writable:!1});return q.readable=!0,a.once("socket",a=>{o("Replaying proxy buffer for failed request"),(0,j.default)(a.listenerCount("data")>0),a.push(m),a.push(null)}),q}}function r(a){a.resume()}function s(a,...b){let c,d={};for(c in a)b.includes(c)||(d[c]=a[c]);return d}q.protocols=["http","https"],b.HttpsProxyAgent=q},69688:a=>{var b,c,d=Object.prototype,e=Function.prototype.toString,f=d.hasOwnProperty,g=e.call(Object),h=d.toString,i=(b=Object.getPrototypeOf,c=Object,function(a){return b(c(a))});a.exports=function(a){if(!(a&&"object"==typeof a)||"[object Object]"!=h.call(a)||function(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(a){}return b}(a))return!1;var b=i(a);if(null===b)return!0;var c=f.call(b,"constructor")&&b.constructor;return"function"==typeof c&&c instanceof c&&e.call(c)==g}},69774:(a,b,c)=>{"use strict";let d=c(74502);a.exports=(a,b,c)=>d(a,b,">",c)},69948:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.HttpProxyAgent=void 0;let h=f(c(91645)),i=f(c(34631)),j=g(c(90064)),k=c(94735),l=c(2956),m=c(79551),n=(0,j.default)("http-proxy-agent");class o extends l.Agent{constructor(a,b){super(b),this.proxy="string"==typeof a?new m.URL(a):a,this.proxyHeaders=b?.headers??{},n("Creating new HttpProxyAgent instance: %o",this.proxy.href);let c=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),d=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={...b?function(a,...b){let c,d={};for(c in a)b.includes(c)||(d[c]=a[c]);return d}(b,"headers"):null,host:c,port:d}}addRequest(a,b){a._header=null,this.setRequestProps(a,b),super.addRequest(a,b)}setRequestProps(a,b){let{proxy:c}=this,d=b.secureEndpoint?"https:":"http:",e=a.getHeader("host")||"localhost",f=`${d}//${e}`,g=new m.URL(a.path,f);80!==b.port&&(g.port=String(b.port)),a.path=String(g);let h="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders};if(c.username||c.password){let a=`${decodeURIComponent(c.username)}:${decodeURIComponent(c.password)}`;h["Proxy-Authorization"]=`Basic ${Buffer.from(a).toString("base64")}`}for(let b of(h["Proxy-Connection"]||(h["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(h))){let c=h[b];c&&a.setHeader(b,c)}}async connect(a,b){let c,d,e;return a._header=null,a.path.includes("://")||this.setRequestProps(a,b),n("Regenerating stored HTTP header string for request"),a._implicitHeader(),a.outputData&&a.outputData.length>0&&(n("Patching connection write() output buffer with updated header"),d=(c=a.outputData[0].data).indexOf("\r\n\r\n")+4,a.outputData[0].data=a._header+c.substring(d),n("Output buffer: %o",a.outputData[0].data)),"https:"===this.proxy.protocol?(n("Creating `tls.Socket`: %o",this.connectOpts),e=i.connect(this.connectOpts)):(n("Creating `net.Socket`: %o",this.connectOpts),e=h.connect(this.connectOpts)),await (0,k.once)(e,"connect"),e}}o.protocols=["http","https"],b.HttpProxyAgent=o},70179:(a,b,c)=>{a.exports=function(a){function b(a){let c,e,f,g=null;function h(...a){if(!h.enabled)return;let d=Number(new Date);h.diff=d-(c||d),h.prev=c,h.curr=d,c=d,a[0]=b.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let e=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(c,d)=>{if("%%"===c)return"%";e++;let f=b.formatters[d];if("function"==typeof f){let b=a[e];c=f.call(h,b),a.splice(e,1),e--}return c}),b.formatArgs.call(h,a),(h.log||b.log).apply(h,a)}return h.namespace=a,h.useColors=b.useColors(),h.color=b.selectColor(a),h.extend=d,h.destroy=b.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==g?g:(e!==b.namespaces&&(e=b.namespaces,f=b.enabled(a)),f),set:a=>{g=a}}),"function"==typeof b.init&&b.init(h),h}function d(a,c){let d=b(this.namespace+(void 0===c?":":c)+a);return d.log=this.log,d}function e(a,b){let c=0,d=0,e=-1,f=0;for(;c<a.length;)if(d<b.length&&(b[d]===a[c]||"*"===b[d]))"*"===b[d]?(e=d,f=c):c++,d++;else{if(-1===e)return!1;d=e+1,c=++f}for(;d<b.length&&"*"===b[d];)d++;return d===b.length}return b.debug=b,b.default=b,b.coerce=function(a){return a instanceof Error?a.stack||a.message:a},b.disable=function(){let a=[...b.names,...b.skips.map(a=>"-"+a)].join(",");return b.enable(""),a},b.enable=function(a){for(let c of(b.save(a),b.namespaces=a,b.names=[],b.skips=[],("string"==typeof a?a:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===c[0]?b.skips.push(c.slice(1)):b.names.push(c)},b.enabled=function(a){for(let c of b.skips)if(e(a,c))return!1;for(let c of b.names)if(e(a,c))return!0;return!1},b.humanize=c(74088),b.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(c=>{b[c]=a[c]}),b.names=[],b.skips=[],b.formatters={},b.selectColor=function(a){let c=0;for(let b=0;b<a.length;b++)c=(c<<5)-c+a.charCodeAt(b)|0;return b.colors[Math.abs(c)%b.colors.length]},b.enable(b.load()),b}},70440:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(97523);let e=async a=>[{type:"image/x-icon",sizes:"16x16",url:(0,d.fillMetadataSegment)(".",await a.params,"favicon.ico")+""}]},71635:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b,c=!1)=>{if(a instanceof d)return a;try{return new d(a,b)}catch(a){if(!c)return null;throw a}}},71780:(a,b,c)=>{"use strict";let d=c(71635);a.exports=(a,b)=>{let c=d(a,b);return c?c.version:null}},71824:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},72481:a=>{var b=Object.prototype.toString;a.exports=function(a){var c;return!0===a||!1===a||!!(c=a)&&"object"==typeof c&&"[object Boolean]"==b.call(a)}},73024:a=>{"use strict";a.exports=require("node:fs")},73136:a=>{"use strict";a.exports=require("node:url")},73575:(a,b,c)=>{"use strict";let d=c(71635);a.exports=(a,b)=>{let c=d(a,null,!0),e=d(b,null,!0),f=c.compare(e);if(0===f)return null;let g=f>0,h=g?c:e,i=g?e:c,j=!!h.prerelease.length;if(i.prerelease.length&&!j){if(!i.patch&&!i.minor)return"major";if(0===i.compareMain(h))return i.minor&&!i.patch?"minor":"patch"}let k=j?"pre":"";return c.major!==e.major?k+"major":c.minor!==e.minor?k+"minor":c.patch!==e.patch?k+"patch":"prerelease"}},74088:a=>{function b(a,b,c,d){return Math.round(a/c)+" "+d+(b>=1.5*c?"s":"")}a.exports=function(a,c){c=c||{};var d,e,f,g,h=typeof a;if("string"===h&&a.length>0){var i=a;if(!((i=String(i)).length>100)){var j=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(j){var k=parseFloat(j[1]);switch((j[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*k;case"weeks":case"week":case"w":return 6048e5*k;case"days":case"day":case"d":return 864e5*k;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*k;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*k;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*k;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:break}}}return}if("number"===h&&isFinite(a)){return c.long?(e=Math.abs(d=a))>=864e5?b(d,e,864e5,"day"):e>=36e5?b(d,e,36e5,"hour"):e>=6e4?b(d,e,6e4,"minute"):e>=1e3?b(d,e,1e3,"second"):d+" ms":(g=Math.abs(f=a))>=864e5?Math.round(f/864e5)+"d":g>=36e5?Math.round(f/36e5)+"h":g>=6e4?Math.round(f/6e4)+"m":g>=1e3?Math.round(f/1e3)+"s":f+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},74364:(a,b,c)=>{var d=c(79428),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?a.exports=d:(f(d,b),b.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},74502:(a,b,c)=>{"use strict";let d=c(78871),e=c(50403),{ANY:f}=e,g=c(24346),h=c(32665),i=c(85327),j=c(59366),k=c(97579),l=c(94764);a.exports=(a,b,c,m)=>{let n,o,p,q,r;switch(a=new d(a,m),b=new g(b,m),c){case">":n=i,o=k,p=j,q=">",r=">=";break;case"<":n=j,o=l,p=i,q="<",r="<=";break;default:throw TypeError('Must provide a hilo val of "<" or ">"')}if(h(a,b,m))return!1;for(let c=0;c<b.set.length;++c){let d=b.set[c],g=null,h=null;if(d.forEach(a=>{a.semver===f&&(a=new e(">=0.0.0")),g=g||a,h=h||a,n(a.semver,g.semver,m)?g=a:p(a.semver,h.semver,m)&&(h=a)}),g.operator===q||g.operator===r||(!h.operator||h.operator===q)&&o(a,h.semver)||h.operator===r&&p(a,h.semver))return!1}return!0}},75692:(a,b,c)=>{a.exports=c(16260).satisfies(process.version,">=15.7.0")},76204:(a,b,c)=>{"use strict";var d=c(79428).Buffer,e=c(79428).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}a.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},76760:a=>{"use strict";a.exports=require("node:path")},77166:a=>{var b,c,d=1/0,e=0/0,f=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,i=/^0o[0-7]+$/i,j=/^(?:0|[1-9]\d*)$/,k=parseInt;function l(a){return a!=a}var m=Object.prototype,n=m.hasOwnProperty,o=m.toString,p=m.propertyIsEnumerable,q=(b=Object.keys,c=Object,function(a){return b(c(a))}),r=Math.max,s=Array.isArray;function t(a){var b,c,d;return null!=a&&"number"==typeof(b=a.length)&&b>-1&&b%1==0&&b<=0x1fffffffffffff&&"[object Function]"!=(d=u(c=a)?o.call(c):"")&&"[object GeneratorFunction]"!=d}function u(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function v(a){return!!a&&"object"==typeof a}a.exports=function(a,b,c,w){a=t(a)?a:function(a){return a?function(a,b){for(var c=-1,d=a?a.length:0,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}(t(a)?function(a,b){var c,d,e,f,g=s(a)||v(d=c=a)&&t(d)&&n.call(c,"callee")&&(!p.call(c,"callee")||"[object Arguments]"==o.call(c))?function(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}(a.length,String):[],h=g.length,i=!!h;for(var k in a){n.call(a,k)&&!(i&&("length"==k||(e=k,(f=null==(f=h)?0x1fffffffffffff:f)&&("number"==typeof e||j.test(e))&&e>-1&&e%1==0&&e<f)))&&g.push(k)}return g}(a):function(a){if(c=(b=a)&&b.constructor,b!==("function"==typeof c&&c.prototype||m))return q(a);var b,c,d=[];for(var e in Object(a))n.call(a,e)&&"constructor"!=e&&d.push(e);return d}(a),function(b){return a[b]}):[]}(a),c=c&&!w?(z=(y=(x=c)?(x=function(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||v(b)&&"[object Symbol]"==o.call(b))return e;if(u(a)){var b,c="function"==typeof a.valueOf?a.valueOf():a;a=u(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(f,"");var d=h.test(a);return d||i.test(a)?k(a.slice(2),d?2:8):g.test(a)?e:+a}(x))===d||x===-d?(x<0?-1:1)*17976931348623157e292:x==x?x:0:0===x?x:0)%1,y==y?z?y-z:y:0):0;var x,y,z,A,B=a.length;return c<0&&(c=r(B+c,0)),"string"==typeof(A=a)||!s(A)&&v(A)&&"[object String]"==o.call(A)?c<=B&&a.indexOf(b,c)>-1:!!B&&function(a,b,c){if(b!=b){for(var d,e=a.length,f=c+-1;d?f--:++f<e;)if(l(a[f],f,a))return f;return -1}for(var g=c-1,h=a.length;++g<h;)if(a[g]===b)return g;return -1}(a,b,c)>-1}},78448:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},78871:(a,b,c)=>{"use strict";let d=c(50627),{MAX_LENGTH:e,MAX_SAFE_INTEGER:f}=c(45053),{safeRe:g,t:h}=c(40329),i=c(47586),{compareIdentifiers:j}=c(59218);class k{constructor(a,b){if(b=i(b),a instanceof k)if(!!b.loose===a.loose&&!!b.includePrerelease===a.includePrerelease)return a;else a=a.version;else if("string"!=typeof a)throw TypeError(`Invalid version. Must be a string. Got type "${typeof a}".`);if(a.length>e)throw TypeError(`version is longer than ${e} characters`);d("SemVer",a,b),this.options=b,this.loose=!!b.loose,this.includePrerelease=!!b.includePrerelease;let c=a.trim().match(b.loose?g[h.LOOSE]:g[h.FULL]);if(!c)throw TypeError(`Invalid Version: ${a}`);if(this.raw=a,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>f||this.major<0)throw TypeError("Invalid major version");if(this.minor>f||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>f||this.patch<0)throw TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map(a=>{if(/^[0-9]+$/.test(a)){let b=+a;if(b>=0&&b<f)return b}return a}):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(a){if(d("SemVer.compare",this.version,this.options,a),!(a instanceof k)){if("string"==typeof a&&a===this.version)return 0;a=new k(a,this.options)}return a.version===this.version?0:this.compareMain(a)||this.comparePre(a)}compareMain(a){return(a instanceof k||(a=new k(a,this.options)),this.major<a.major)?-1:this.major>a.major?1:this.minor<a.minor?-1:this.minor>a.minor?1:this.patch<a.patch?-1:+(this.patch>a.patch)}comparePre(a){if(a instanceof k||(a=new k(a,this.options)),this.prerelease.length&&!a.prerelease.length)return -1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;let b=0;do{let c=this.prerelease[b],e=a.prerelease[b];if(d("prerelease compare",b,c,e),void 0===c&&void 0===e)return 0;if(void 0===e)return 1;if(void 0===c)return -1;else if(c===e)continue;else return j(c,e)}while(++b)}compareBuild(a){a instanceof k||(a=new k(a,this.options));let b=0;do{let c=this.build[b],e=a.build[b];if(d("build compare",b,c,e),void 0===c&&void 0===e)return 0;if(void 0===e)return 1;if(void 0===c)return -1;else if(c===e)continue;else return j(c,e)}while(++b)}inc(a,b,c){if(a.startsWith("pre")){if(!b&&!1===c)throw Error("invalid increment argument: identifier is empty");if(b){let a=`-${b}`.match(this.options.loose?g[h.PRERELEASELOOSE]:g[h.PRERELEASE]);if(!a||a[1]!==b)throw Error(`invalid identifier: ${b}`)}}switch(a){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",b,c);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",b,c);break;case"prepatch":this.prerelease.length=0,this.inc("patch",b,c),this.inc("pre",b,c);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",b,c),this.inc("pre",b,c);break;case"release":if(0===this.prerelease.length)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let a=+!!Number(c);if(0===this.prerelease.length)this.prerelease=[a];else{let d=this.prerelease.length;for(;--d>=0;)"number"==typeof this.prerelease[d]&&(this.prerelease[d]++,d=-2);if(-1===d){if(b===this.prerelease.join(".")&&!1===c)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(a)}}if(b){let d=[b,a];!1===c&&(d=[b]),0===j(this.prerelease[0],b)?isNaN(this.prerelease[1])&&(this.prerelease=d):this.prerelease=d}break}default:throw Error(`invalid increment argument: ${a}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}a.exports=k},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},83183:(a,b,c)=>{"use strict";a.exports=c(49754).vendored["react-rsc"].ReactServerDOMWebpackServer},83997:a=>{"use strict";a.exports=require("tty")},85327:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>d(a,b,c)>0},85384:(a,b)=>{"use strict";function c(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===d}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{isHangingPromiseRejectionError:function(){return c},makeDevtoolsIOAwarePromise:function(){return i},makeHangingPromise:function(){return g}});let d="HANGING_PROMISE_REJECTION";class e extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=d}}let f=new WeakMap;function g(a,b,c){if(a.aborted)return Promise.reject(new e(b,c));{let d=new Promise((d,g)=>{let h=g.bind(null,new e(b,c)),i=f.get(a);if(i)i.push(h);else{let b=[h];f.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(h),d}}function h(){}function i(a){return new Promise(b=>{setTimeout(()=>{b(a)},0)})}},85708:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{callServer:function(){return d.callServer},createServerReference:function(){return f.createServerReference},findSourceMapURL:function(){return e.findSourceMapURL}});let d=c(76779),e=c(6927),f=c(63188)},86038:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b,c,e,f)=>{"string"==typeof c&&(f=e,e=c,c=void 0);try{return new d(a instanceof d?a.version:a,c).inc(b,e,f).version}catch(a){return null}}},86331:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{atLeastOneTask:function(){return e},scheduleImmediate:function(){return d},scheduleOnNextTick:function(){return c},waitAtLeastOneReactRenderTask:function(){return f}});let c=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},d=a=>{setImmediate(a)};function e(){return new Promise(a=>d(a))}function f(){return new Promise(a=>setImmediate(a))}},86386:a=>{var b=Object.prototype.toString;a.exports=function(a){return"number"==typeof a||!!a&&"object"==typeof a&&"[object Number]"==b.call(a)}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87706:a=>{var b=Object.prototype.toString,c=Array.isArray;a.exports=function(a){var d;return"string"==typeof a||!c(a)&&!!(d=a)&&"object"==typeof d&&"[object String]"==b.call(a)}},90064:(a,b,c)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?a.exports=c(14620):a.exports=c(92752)},90151:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{Postpone:function(){return A},PreludeState:function(){return V},abortAndThrowOnSynchronousRequestDataAccess:function(){return x},abortOnSynchronousPlatformIOAccess:function(){return v},accessedDynamicData:function(){return I},annotateDynamicAccess:function(){return N},consumeDynamicAccess:function(){return J},createDynamicTrackingState:function(){return o},createDynamicValidationState:function(){return p},createHangingInputAbortSignal:function(){return M},createRenderInBrowserAbortSignal:function(){return L},delayUntilRuntimeStage:function(){return Y},formatDynamicAPIAccesses:function(){return K},getFirstDynamicReason:function(){return q},isDynamicPostpone:function(){return D},isPrerenderInterruptedError:function(){return H},logDisallowedDynamicError:function(){return W},markCurrentScopeAsDynamic:function(){return r},postponeWithTracking:function(){return B},throwIfDisallowedDynamic:function(){return X},throwToInterruptStaticGeneration:function(){return s},trackAllowedDynamicAccess:function(){return U},trackDynamicDataInDynamicRender:function(){return t},trackSynchronousPlatformIOAccessInDev:function(){return w},trackSynchronousRequestDataAccessInDev:function(){return z},useDynamicRouteParams:function(){return O},warnOnSyncDynamicError:function(){return y}});let d=function(a){return a&&a.__esModule?a:{default:a}}(c(46204)),e=c(52577),f=c(35119),g=c(63033),h=c(29294),i=c(85384),j=c(18633),k=c(86331),l=c(52318),m=c(58871),n="function"==typeof d.default.unstable_postpone;function o(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function p(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function q(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function r(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new f.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return B(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new e.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function s(a,b,c){let d=Object.defineProperty(new e.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function t(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function u(a,b,c){let d=G(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function v(a,b,c,d){let e=d.dynamicTracking;u(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function w(a){a.prerenderPhase=!1}function x(a,b,c,d){if(!1===d.controller.signal.aborted){u(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw G(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function y(a){a.syncDynamicErrorWithStack&&console.error(a.syncDynamicErrorWithStack)}let z=w;function A({reason:a,route:b}){let c=g.workUnitAsyncStorage.getStore();B(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function B(a,b,c){(function(){if(!n)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),d.default.unstable_postpone(C(a,b))}function C(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function D(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&E(a.message)}function E(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===E(C("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let F="NEXT_PRERENDER_INTERRUPTED";function G(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=F,b}function H(a){return"object"==typeof a&&null!==a&&a.digest===F&&"name"in a&&"message"in a&&a instanceof Error}function I(a){return a.length>0}function J(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function K(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function L(){let a=new AbortController;return a.abort(Object.defineProperty(new l.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function M(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,g.getRuntimeStagePromise)(a);c?c.then(()=>(0,k.scheduleOnNextTick)(()=>b.abort())):(0,k.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function N(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function O(a){let b=h.workAsyncStorage.getStore(),c=g.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let e=c.fallbackRouteParams;e&&e.size>0&&d.default.use((0,i.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return B(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new m.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new m.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}let P=/\n\s+at Suspense \(<anonymous>\)/,Q=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${j.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),R=RegExp(`\\n\\s+at ${j.METADATA_BOUNDARY_NAME}[\\n\\s]`),S=RegExp(`\\n\\s+at ${j.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),T=RegExp(`\\n\\s+at ${j.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function U(a,b,c,d){if(!T.test(b)){if(R.test(b)){c.hasDynamicMetadata=!0;return}if(S.test(b)){c.hasDynamicViewport=!0;return}if(Q.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(P.test(b)){c.hasAllowedDynamic=!0;return}else{if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let e=function(a,b){let c=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return c.stack=c.name+": "+a+b,c}(`Route "${a.route}": A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a "use cache" above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense`,b);return void c.dynamicErrors.push(e)}}}var V=function(a){return a[a.Full=0]="Full",a[a.Empty=1]="Empty",a[a.Errored=2]="Errored",a}({});function W(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function X(a,b,c,d){if(0!==b){if(c.hasSuspenseAboveBody)return;if(d.syncDynamicErrorWithStack)throw W(a,d.syncDynamicErrorWithStack),new f.StaticGenBailoutError;let e=c.dynamicErrors;if(e.length>0){for(let b=0;b<e.length;b++)W(a,e[b]);throw new f.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new f.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new f.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new f.StaticGenBailoutError}function Y(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},91488:(a,b,c)=>{"use strict";Object.defineProperty(b,"A",{enumerable:!0,get:function(){return d.registerServerReference}});let d=c(83183)},91645:a=>{"use strict";a.exports=require("net")},92752:(a,b,c)=>{let d=c(83997),e=c(28354);b.init=function(a){a.inspectOpts={};let c=Object.keys(b.inspectOpts);for(let d=0;d<c.length;d++)a.inspectOpts[c[d]]=b.inspectOpts[c[d]]},b.log=function(...a){return process.stderr.write(e.formatWithOptions(b.inspectOpts,...a)+"\n")},b.formatArgs=function(c){let{namespace:d,useColors:e}=this;if(e){let b=this.color,e="\x1b[3"+(b<8?b:"8;5;"+b),f=`  ${e};1m${d} \u001B[0m`;c[0]=f+c[0].split("\n").join("\n"+f),c.push(e+"m+"+a.exports.humanize(this.diff)+"\x1b[0m")}else c[0]=(b.inspectOpts.hideDate?"":new Date().toISOString()+" ")+d+" "+c[0]},b.save=function(a){a?process.env.DEBUG=a:delete process.env.DEBUG},b.load=function(){return process.env.DEBUG},b.useColors=function(){return"colors"in b.inspectOpts?!!b.inspectOpts.colors:d.isatty(process.stderr.fd)},b.destroy=e.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),b.colors=[6,2,3,4,5,1];try{let a=c(25386);a&&(a.stderr||a).level>=2&&(b.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(a){}b.inspectOpts=Object.keys(process.env).filter(a=>/^debug_/i.test(a)).reduce((a,b)=>{let c=b.substring(6).toLowerCase().replace(/_([a-z])/g,(a,b)=>b.toUpperCase()),d=process.env[b];return d=!!/^(yes|on|true|enabled)$/i.test(d)||!/^(no|off|false|disabled)$/i.test(d)&&("null"===d?null:Number(d)),a[c]=d,a},{}),a.exports=c(70179)(b);let{formatters:f}=a.exports;f.o=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts).split("\n").map(a=>a.trim()).join(" ")},f.O=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts)}},92869:a=>{"use strict";class b{constructor(){this.max=1e3,this.map=new Map}get(a){let b=this.map.get(a);if(void 0!==b)return this.map.delete(a),this.map.set(a,b),b}delete(a){return this.map.delete(a)}set(a,b){if(!this.delete(a)&&void 0!==b){if(this.map.size>=this.max){let a=this.map.keys().next().value;this.delete(a)}this.map.set(a,b)}return this}}a.exports=b},93047:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"ENCODED_TAGS",{enumerable:!0,get:function(){return c}});let c={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])},META:{ICON_MARK:new Uint8Array([60,109,101,116,97,32,110,97,109,101,61,34,194,171,110,120,116,45,105,99,111,110,194,187,34])}}},93689:(a,b,c)=>{"use strict";let d=c(74502);a.exports=(a,b,c)=>d(a,b,"<",c)},93990:a=>{"use strict";function b(a){return(a/8|0)+ +(a%8!=0)}var c={ES256:b(256),ES384:b(384),ES512:b(521)};a.exports=function(a){var b=c[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},94735:a=>{"use strict";a.exports=require("events")},94764:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>d(a,b,c)>=0},94839:(a,b,c)=>{var d=c(74364).Buffer,e=c(27910);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}c(28354).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},a.exports=f},95818:()=>{},96775:(a,b,c)=>{"use strict";let d=c(78871);a.exports=(a,b,c)=>new d(a,c).compare(new d(b,c))},97106:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>0!==d(a,b,c)},97579:(a,b,c)=>{"use strict";let d=c(96775);a.exports=(a,b,c)=>0>=d(a,b,c)},98038:(a,b,c)=>{a.exports=c(16260).satisfies(process.version,">=16.9.0")},98711:(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k,l,m;c.r(b),c.d(b,{"4077505fad787e7e08d33f9ed94e9c9d3f635581eb":()=>mi,"40872e551770e022325896aa5afeaa55e7ef5b1a6a":()=>mj,"700cf13863712079344a0b4e555b504e56b9b8a4aa":()=>mk});var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN=c(91488);function aO(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c}function aP(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)}c(27806);let aQ=function(){let{crypto:a}=globalThis;if(a?.randomUUID)return aQ=a.randomUUID.bind(a),a.randomUUID();let b=new Uint8Array(1),c=a?()=>a.getRandomValues(b)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^c()&15>>a/4).toString(16))};function aR(a){return"object"==typeof a&&null!==a&&("name"in a&&"AbortError"===a.name||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}let aS=a=>{if(a instanceof Error)return a;if("object"==typeof a&&null!==a){try{if("[object Error]"===Object.prototype.toString.call(a)){let b=Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(b.stack=a.stack),a.cause&&!b.cause&&(b.cause=a.cause),a.name&&(b.name=a.name),b}}catch{}try{return Error(JSON.stringify(a))}catch{}}return Error(a)};class aT extends Error{}class aU extends aT{constructor(a,b,c,d){super(`${aU.makeMessage(a,b,c)}`),this.status=a,this.headers=d,this.requestID=d?.get("x-request-id"),this.error=b,this.code=b?.code,this.param=b?.param,this.type=b?.type}static makeMessage(a,b,c){let d=b?.message?"string"==typeof b.message?b.message:JSON.stringify(b.message):b?JSON.stringify(b):c;return a&&d?`${a} ${d}`:a?`${a} status code (no body)`:d||"(no status code or body)"}static generate(a,b,c,d){if(!a||!d)return new aW({message:c,cause:aS(b)});let e=b?.error;return 400===a?new aY(a,e,c,d):401===a?new aZ(a,e,c,d):403===a?new a$(a,e,c,d):404===a?new a_(a,e,c,d):409===a?new a0(a,e,c,d):422===a?new a1(a,e,c,d):429===a?new a2(a,e,c,d):a>=500?new a3(a,e,c,d):new aU(a,e,c,d)}}class aV extends aU{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class aW extends aU{constructor({message:a,cause:b}){super(void 0,void 0,a||"Connection error.",void 0),b&&(this.cause=b)}}class aX extends aW{constructor({message:a}={}){super({message:a??"Request timed out."})}}class aY extends aU{}class aZ extends aU{}class a$ extends aU{}class a_ extends aU{}class a0 extends aU{}class a1 extends aU{}class a2 extends aU{}class a3 extends aU{}class a4 extends aT{constructor(){super("Could not parse response content as the length limit was reached")}}class a5 extends aT{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class a6 extends Error{constructor(a){super(a)}}let a7=/^[a-z][a-z0-9+.-]*:/i,a8=a=>(a8=Array.isArray)(a),a9=a8;function ba(a){return"object"!=typeof a?{}:a??{}}function bb(a){return null!=a&&"object"==typeof a&&!Array.isArray(a)}let bc=a=>new Promise(b=>setTimeout(b,a)),bd="6.3.0",be=a=>"x32"===a?"x32":"x86_64"===a||"x64"===a?"x64":"arm"===a?"arm":"aarch64"===a||"arm64"===a?"arm64":a?`other:${a}`:"unknown",bf=a=>(a=a.toLowerCase()).includes("ios")?"iOS":"android"===a?"Android":"darwin"===a?"MacOS":"win32"===a?"Windows":"freebsd"===a?"FreeBSD":"openbsd"===a?"OpenBSD":"linux"===a?"Linux":a?`Other:${a}`:"Unknown";function bg(...a){let b=globalThis.ReadableStream;if(void 0===b)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new b(...a)}function bh(a){let b=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator]();return bg({start(){},async pull(a){let{done:c,value:d}=await b.next();c?a.close():a.enqueue(d)},async cancel(){await b.return?.()}})}function bi(a){if(a[Symbol.asyncIterator])return a;let b=a.getReader();return{async next(){try{let a=await b.read();return a?.done&&b.releaseLock(),a}catch(a){throw b.releaseLock(),a}},async return(){let a=b.cancel();return b.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function bj(a){if(null===a||"object"!=typeof a)return;if(a[Symbol.asyncIterator])return void await a[Symbol.asyncIterator]().return?.();let b=a.getReader(),c=b.cancel();b.releaseLock(),await c}let bk=({headers:a,body:b})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(b)}),bl="RFC3986",bm=a=>String(a),bn={RFC1738:a=>String(a).replace(/%20/g,"+"),RFC3986:bm},bo=(a,b)=>(bo=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty))(a,b),bp=(()=>{let a=[];for(let b=0;b<256;++b)a.push("%"+((b<16?"0":"")+b.toString(16)).toUpperCase());return a})();function bq(a,b){if(a8(a)){let c=[];for(let d=0;d<a.length;d+=1)c.push(b(a[d]));return c}return b(a)}let br={brackets:a=>String(a)+"[]",comma:"comma",indices:(a,b)=>String(a)+"["+b+"]",repeat:a=>String(a)},bs=function(a,b){Array.prototype.push.apply(a,a8(b)?b:[b])},bt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(a,b,c,d,e)=>{if(0===a.length)return a;let f=a;if("symbol"==typeof a?f=Symbol.prototype.toString.call(a):"string"!=typeof a&&(f=String(a)),"iso-8859-1"===c)return escape(f).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let g="";for(let a=0;a<f.length;a+=1024){let b=f.length>=1024?f.slice(a,a+1024):f,c=[];for(let a=0;a<b.length;++a){let d=b.charCodeAt(a);if(45===d||46===d||95===d||126===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||"RFC1738"===e&&(40===d||41===d)){c[c.length]=b.charAt(a);continue}if(d<128){c[c.length]=bp[d];continue}if(d<2048){c[c.length]=bp[192|d>>6]+bp[128|63&d];continue}if(d<55296||d>=57344){c[c.length]=bp[224|d>>12]+bp[128|d>>6&63]+bp[128|63&d];continue}a+=1,d=65536+((1023&d)<<10|1023&b.charCodeAt(a)),c[c.length]=bp[240|d>>18]+bp[128|d>>12&63]+bp[128|d>>6&63]+bp[128|63&d]}g+=c.join("")}return g},encodeValuesOnly:!1,format:bl,formatter:bm,indices:!1,serializeDate:a=>(e??(e=Function.prototype.call.bind(Date.prototype.toISOString)))(a),skipNulls:!1,strictNullHandling:!1},bu={};function bv(a){let b;return(f??(f=(b=new globalThis.TextEncoder).encode.bind(b)))(a)}function bw(a){let b;return(g??(g=(b=new globalThis.TextDecoder).decode.bind(b)))(a)}class bx{constructor(){n.set(this,void 0),o.set(this,void 0),aO(this,n,new Uint8Array,"f"),aO(this,o,null,"f")}decode(a){let b;if(null==a)return[];let c=a instanceof ArrayBuffer?new Uint8Array(a):"string"==typeof a?bv(a):a;aO(this,n,function(a){let b=0;for(let c of a)b+=c.length;let c=new Uint8Array(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}([aP(this,n,"f"),c]),"f");let d=[];for(;null!=(b=function(a,b){for(let c=b??0;c<a.length;c++){if(10===a[c])return{preceding:c,index:c+1,carriage:!1};if(13===a[c])return{preceding:c,index:c+1,carriage:!0}}return null}(aP(this,n,"f"),aP(this,o,"f")));){if(b.carriage&&null==aP(this,o,"f")){aO(this,o,b.index,"f");continue}if(null!=aP(this,o,"f")&&(b.index!==aP(this,o,"f")+1||b.carriage)){d.push(bw(aP(this,n,"f").subarray(0,aP(this,o,"f")-1))),aO(this,n,aP(this,n,"f").subarray(aP(this,o,"f")),"f"),aO(this,o,null,"f");continue}let a=null!==aP(this,o,"f")?b.preceding-1:b.preceding,c=bw(aP(this,n,"f").subarray(0,a));d.push(c),aO(this,n,aP(this,n,"f").subarray(b.index),"f"),aO(this,o,null,"f")}return d}flush(){return aP(this,n,"f").length?this.decode("\n"):[]}}n=new WeakMap,o=new WeakMap,bx.NEWLINE_CHARS=new Set(["\n","\r"]),bx.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let by={off:0,error:200,warn:300,info:400,debug:500},bz=(a,b,c)=>{if(a){if(Object.prototype.hasOwnProperty.call(by,a))return a;bE(c).warn(`${b} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(by))}`)}};function bA(){}function bB(a,b,c){return!b||by[a]>by[c]?bA:b[a].bind(b)}let bC={error:bA,warn:bA,info:bA,debug:bA},bD=new WeakMap;function bE(a){let b=a.logger,c=a.logLevel??"off";if(!b)return bC;let d=bD.get(b);if(d&&d[0]===c)return d[1];let e={error:bB("error",b,c),warn:bB("warn",b,c),info:bB("info",b,c),debug:bB("debug",b,c)};return bD.set(b,[c,e]),e}let bF=a=>(a.options&&(a.options={...a.options},delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([a,b])=>[a,"authorization"===a.toLowerCase()||"cookie"===a.toLowerCase()||"set-cookie"===a.toLowerCase()?"***":b]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class bG{constructor(a,b,c){this.iterator=a,p.set(this,void 0),this.controller=b,aO(this,p,c,"f")}static fromSSEResponse(a,b,c){let d=!1,e=c?bE(c):console;async function*f(){if(d)throw new aT("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let c=!1;try{for await(let d of bH(a,b))if(!c){if(d.data.startsWith("[DONE]")){c=!0;continue}if(null!==d.event&&d.event.startsWith("thread.")){let a;try{a=JSON.parse(d.data)}catch(a){throw console.error("Could not parse message into JSON:",d.data),console.error("From chunk:",d.raw),a}if("error"==d.event)throw new aU(void 0,a.error,a.message,void 0);yield{event:d.event,data:a}}else{let b;try{b=JSON.parse(d.data)}catch(a){throw e.error("Could not parse message into JSON:",d.data),e.error("From chunk:",d.raw),a}if(b&&b.error)throw new aU(void 0,b.error,void 0,a.headers);yield b}}c=!0}catch(a){if(aR(a))return;throw a}finally{c||b.abort()}}return new bG(f,b,c)}static fromReadableStream(a,b,c){let d=!1;async function*e(){let b=new bx;for await(let c of bi(a))for(let a of b.decode(c))yield a;for(let a of b.flush())yield a}return new bG(async function*(){if(d)throw new aT("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let a=!1;try{for await(let b of e())!a&&b&&(yield JSON.parse(b));a=!0}catch(a){if(aR(a))return;throw a}finally{a||b.abort()}},b,c)}[(p=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let a=[],b=[],c=this.iterator(),d=d=>({next:()=>{if(0===d.length){let d=c.next();a.push(d),b.push(d)}return d.shift()}});return[new bG(()=>d(a),this.controller,aP(this,p,"f")),new bG(()=>d(b),this.controller,aP(this,p,"f"))]}toReadableStream(){let a,b=this;return bg({async start(){a=b[Symbol.asyncIterator]()},async pull(b){try{let{value:c,done:d}=await a.next();if(d)return b.close();let e=bv(JSON.stringify(c)+"\n");b.enqueue(e)}catch(a){b.error(a)}},async cancel(){await a.return?.()}})}}async function*bH(a,b){if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new aT("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new aT("Attempted to iterate over a response with no body")}let c=new bJ,d=new bx;for await(let b of bI(bi(a.body)))for(let a of d.decode(b)){let b=c.decode(a);b&&(yield b)}for(let a of d.flush()){let b=c.decode(a);b&&(yield b)}}async function*bI(a){let b=new Uint8Array;for await(let c of a){let a;if(null==c)continue;let d=c instanceof ArrayBuffer?new Uint8Array(c):"string"==typeof c?bv(c):c,e=new Uint8Array(b.length+d.length);for(e.set(b),e.set(d,b.length),b=e;-1!==(a=function(a){for(let b=0;b<a.length-1;b++){if(10===a[b]&&10===a[b+1]||13===a[b]&&13===a[b+1])return b+2;if(13===a[b]&&10===a[b+1]&&b+3<a.length&&13===a[b+2]&&10===a[b+3])return b+4}return -1}(b));)yield b.slice(0,a),b=b.slice(a)}b.length>0&&(yield b)}class bJ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;let a={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(a),a.startsWith(":"))return null;let[b,c,d]=function(a,b){let c=a.indexOf(":");return -1!==c?[a.substring(0,c),b,a.substring(c+b.length)]:[a,"",""]}(a,":");return d.startsWith(" ")&&(d=d.substring(1)),"event"===b?this.event=d:"data"===b&&this.data.push(d),null}}async function bK(a,b){let{response:c,requestLogID:d,retryOfRequestLogID:e,startTime:f}=b,g=await (async()=>{if(b.options.stream)return(bE(a).debug("response",c.status,c.url,c.headers,c.body),b.options.__streamClass)?b.options.__streamClass.fromSSEResponse(c,b.controller,a):bG.fromSSEResponse(c,b.controller,a);if(204===c.status)return null;if(b.options.__binaryResponse)return c;let d=c.headers.get("content-type"),e=d?.split(";")[0]?.trim();return e?.includes("application/json")||e?.endsWith("+json")?bL(await c.json(),c):await c.text()})();return bE(a).debug(`[${d}] response parsed`,bF({retryOfRequestLogID:e,url:c.url,status:c.status,body:g,durationMs:Date.now()-f})),g}function bL(a,b){return!a||"object"!=typeof a||Array.isArray(a)?a:Object.defineProperty(a,"_request_id",{value:b.headers.get("x-request-id"),enumerable:!1})}class bM extends Promise{constructor(a,b,c=bK){super(a=>{a(null)}),this.responsePromise=b,this.parseResponse=c,q.set(this,void 0),aO(this,q,a,"f")}_thenUnwrap(a){return new bM(aP(this,q,"f"),this.responsePromise,async(b,c)=>bL(a(await this.parseResponse(b,c),c),c.response))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){let[a,b]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:b,request_id:b.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(aP(this,q,"f"),a))),this.parsedPromise}then(a,b){return this.parse().then(a,b)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}q=new WeakMap;class bN{constructor(a,b,c,d){r.set(this,void 0),aO(this,r,a,"f"),this.options=d,this.response=b,this.body=c}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let a=this.nextPageRequestOptions();if(!a)throw new aT("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await aP(this,r,"f").requestAPIList(this.constructor,a)}async *iterPages(){let a=this;for(yield a;a.hasNextPage();)a=await a.getNextPage(),yield a}async *[(r=new WeakMap,Symbol.asyncIterator)](){for await(let a of this.iterPages())for(let b of a.getPaginatedItems())yield b}}class bO extends bM{constructor(a,b,c){super(a,b,async(a,b)=>new c(a,b.response,await bK(a,b),b.options))}async *[Symbol.asyncIterator](){for await(let a of(await this))yield a}}class bP extends bN{constructor(a,b,c,d){super(a,b,c,d),this.data=c.data||[],this.object=c.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class bQ extends bN{constructor(a,b,c,d){super(a,b,c,d),this.data=c.data||[],this.has_more=c.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let a=this.getPaginatedItems(),b=a[a.length-1]?.id;return b?{...this.options,query:{...ba(this.options.query),after:b}}:null}}class bR extends bN{constructor(a,b,c,d){super(a,b,c,d),this.data=c.data||[],this.has_more=c.has_more||!1,this.last_id=c.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let a=this.last_id;return a?{...this.options,query:{...ba(this.options.query),after:a}}:null}}let bS=()=>{if("undefined"==typeof File){let{process:a}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof a?.versions?.node&&20>parseInt(a.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function bT(a,b,c){return bS(),new File(a,b??"unknown_file",c)}function bU(a){return("object"==typeof a&&null!==a&&("name"in a&&a.name&&String(a.name)||"url"in a&&a.url&&String(a.url)||"filename"in a&&a.filename&&String(a.filename)||"path"in a&&a.path&&String(a.path))||"").split(/[\\/]/).pop()||void 0}let bV=a=>null!=a&&"object"==typeof a&&"function"==typeof a[Symbol.asyncIterator],bW=async(a,b)=>b_(a.body)?{...a,body:await bZ(a.body,b)}:a,bX=async(a,b)=>({...a,body:await bZ(a.body,b)}),bY=new WeakMap,bZ=async(a,b)=>{if(!await function(a){let b="function"==typeof a?a:a.fetch,c=bY.get(b);if(c)return c;let d=(async()=>{try{let a="Response"in b?b.Response:(await b("data:,")).constructor,c=new FormData;if(c.toString()===await new a(c).text())return!1;return!0}catch{return!0}})();return bY.set(b,d),d}(b))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let c=new FormData;return await Promise.all(Object.entries(a||{}).map(([a,b])=>b0(c,a,b))),c},b$=a=>a instanceof Blob&&"name"in a,b_=a=>{if((a=>"object"==typeof a&&null!==a&&(a instanceof Response||bV(a)||b$(a)))(a))return!0;if(Array.isArray(a))return a.some(b_);if(a&&"object"==typeof a){for(let b in a)if(b_(a[b]))return!0}return!1},b0=async(a,b,c)=>{if(void 0!==c){if(null==c)throw TypeError(`Received null for "${b}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof c||"number"==typeof c||"boolean"==typeof c)a.append(b,String(c));else if(c instanceof Response)a.append(b,bT([await c.blob()],bU(c)));else if(bV(c))a.append(b,bT([await new Response(bh(c)).blob()],bU(c)));else if(b$(c))a.append(b,c,bU(c));else if(Array.isArray(c))await Promise.all(c.map(c=>b0(a,b+"[]",c)));else if("object"==typeof c)await Promise.all(Object.entries(c).map(([c,d])=>b0(a,`${b}[${c}]`,d)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${c} instead`)}},b1=a=>null!=a&&"object"==typeof a&&"number"==typeof a.size&&"string"==typeof a.type&&"function"==typeof a.text&&"function"==typeof a.slice&&"function"==typeof a.arrayBuffer;async function b2(a,b,c){let d,e;if(bS(),null!=(d=a=await a)&&"object"==typeof d&&"string"==typeof d.name&&"number"==typeof d.lastModified&&b1(d))return a instanceof File?a:bT([await a.arrayBuffer()],a.name);if(null!=(e=a)&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob){let d=await a.blob();return b||(b=new URL(a.url).pathname.split(/[\\/]/).pop()),bT(await b3(d),b,c)}let f=await b3(a);if(b||(b=bU(a)),!c?.type){let a=f.find(a=>"object"==typeof a&&"type"in a&&a.type);"string"==typeof a&&(c={...c,type:a})}return bT(f,b,c)}async function b3(a){let b=[];if("string"==typeof a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)b.push(a);else if(b1(a))b.push(a instanceof Blob?a:await a.arrayBuffer());else if(bV(a))for await(let c of a)b.push(...await b3(c));else{let b=a?.constructor?.name;throw Error(`Unexpected data type: ${typeof a}${b?`; constructor: ${b}`:""}${function(a){if("object"!=typeof a||null===a)return"";let b=Object.getOwnPropertyNames(a);return`; props: [${b.map(a=>`"${a}"`).join(", ")}]`}(a)}`)}return b}class b4{constructor(a){this._client=a}}function b5(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let b6=Object.freeze(Object.create(null)),b7=((a=b5)=>function(b,...c){let d;if(1===b.length)return b[0];let e=!1,f=[],g=b.reduce((b,d,g)=>{/[?#]/.test(d)&&(e=!0);let h=c[g],i=(e?encodeURIComponent:a)(""+h);return g!==c.length&&(null==h||"object"==typeof h&&h.toString===Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??b6)??b6)?.toString)&&(i=h+"",f.push({start:b.length+d.length,length:i.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),b+d+(g===c.length?"":i)},""),h=g.split(/[?#]/,1)[0],i=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(d=i.exec(h));)f.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(f.sort((a,b)=>a.start-b.start),f.length>0){let a=0,b=f.reduce((b,c)=>{let d=" ".repeat(c.start-a),e="^".repeat(c.length);return a=c.start+c.length,b+d+e},"");throw new aT(`Path parameters result in path with invalid segments:
${f.map(a=>a.error).join("\n")}
${g}
${b}`)}return g})(b5);class b8 extends b4{list(a,b={},c){return this._client.getAPIList(b7`/chat/completions/${a}/messages`,bQ,{query:b,...c})}}function b9(a){return void 0!==a&&"function"in a&&void 0!==a.function}function ca(a){return a?.$brand==="auto-parseable-response-format"}function cb(a){return a?.$brand==="auto-parseable-tool"}function cc(a,b){let c=a.choices.map(a=>{var c,d;if("length"===a.finish_reason)throw new a4;if("content_filter"===a.finish_reason)throw new a5;return ce(a.message.tool_calls),{...a,message:{...a.message,...a.message.tool_calls?{tool_calls:a.message.tool_calls?.map(a=>(function(a,b){let c=a.tools?.find(a=>b9(a)&&a.function?.name===b.function.name);return{...b,function:{...b.function,parsed_arguments:cb(c)?c.$parseRaw(b.function.arguments):c?.function.strict?JSON.parse(b.function.arguments):null}}})(b,a))??void 0}:void 0,parsed:a.message.content&&!a.message.refusal?(c=b,d=a.message.content,c.response_format?.type!=="json_schema"?null:c.response_format?.type==="json_schema"?"$parseRaw"in c.response_format?c.response_format.$parseRaw(d):JSON.parse(d):null):null}}});return{...a,choices:c}}function cd(a){return!!ca(a.response_format)||(a.tools?.some(a=>cb(a)||"function"===a.type&&!0===a.function.strict)??!1)}function ce(a){for(let b of a||[])if("function"!==b.type)throw new aT(`Currently only \`function\` tool calls are supported; Received \`${b.type}\``)}let cf=a=>a?.role==="assistant",cg=a=>a?.role==="tool";class ch{constructor(){s.add(this),this.controller=new AbortController,t.set(this,void 0),u.set(this,()=>{}),v.set(this,()=>{}),w.set(this,void 0),x.set(this,()=>{}),y.set(this,()=>{}),z.set(this,{}),A.set(this,!1),B.set(this,!1),C.set(this,!1),D.set(this,!1),aO(this,t,new Promise((a,b)=>{aO(this,u,a,"f"),aO(this,v,b,"f")}),"f"),aO(this,w,new Promise((a,b)=>{aO(this,x,a,"f"),aO(this,y,b,"f")}),"f"),aP(this,t,"f").catch(()=>{}),aP(this,w,"f").catch(()=>{})}_run(a){setTimeout(()=>{a().then(()=>{this._emitFinal(),this._emit("end")},aP(this,s,"m",E).bind(this))},0)}_connected(){this.ended||(aP(this,u,"f").call(this),this._emit("connect"))}get ended(){return aP(this,A,"f")}get errored(){return aP(this,B,"f")}get aborted(){return aP(this,C,"f")}abort(){this.controller.abort()}on(a,b){return(aP(this,z,"f")[a]||(aP(this,z,"f")[a]=[])).push({listener:b}),this}off(a,b){let c=aP(this,z,"f")[a];if(!c)return this;let d=c.findIndex(a=>a.listener===b);return d>=0&&c.splice(d,1),this}once(a,b){return(aP(this,z,"f")[a]||(aP(this,z,"f")[a]=[])).push({listener:b,once:!0}),this}emitted(a){return new Promise((b,c)=>{aO(this,D,!0,"f"),"error"!==a&&this.once("error",c),this.once(a,b)})}async done(){aO(this,D,!0,"f"),await aP(this,w,"f")}_emit(a,...b){if(aP(this,A,"f"))return;"end"===a&&(aO(this,A,!0,"f"),aP(this,x,"f").call(this));let c=aP(this,z,"f")[a];if(c&&(aP(this,z,"f")[a]=c.filter(a=>!a.once),c.forEach(({listener:a})=>a(...b))),"abort"===a){let a=b[0];aP(this,D,"f")||c?.length||Promise.reject(a),aP(this,v,"f").call(this,a),aP(this,y,"f").call(this,a),this._emit("end");return}if("error"===a){let a=b[0];aP(this,D,"f")||c?.length||Promise.reject(a),aP(this,v,"f").call(this,a),aP(this,y,"f").call(this,a),this._emit("end")}}_emitFinal(){}}t=new WeakMap,u=new WeakMap,v=new WeakMap,w=new WeakMap,x=new WeakMap,y=new WeakMap,z=new WeakMap,A=new WeakMap,B=new WeakMap,C=new WeakMap,D=new WeakMap,s=new WeakSet,E=function(a){if(aO(this,B,!0,"f"),a instanceof Error&&"AbortError"===a.name&&(a=new aV),a instanceof aV)return aO(this,C,!0,"f"),this._emit("abort",a);if(a instanceof aT)return this._emit("error",a);if(a instanceof Error){let b=new aT(a.message);return b.cause=a,this._emit("error",b)}return this._emit("error",new aT(String(a)))};class ci extends ch{constructor(){super(...arguments),F.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(a){this._chatCompletions.push(a),this._emit("chatCompletion",a);let b=a.choices[0]?.message;return b&&this._addMessage(b),a}_addMessage(a,b=!0){if("content"in a||(a.content=null),this.messages.push(a),b){if(this._emit("message",a),cg(a)&&a.content)this._emit("functionToolCallResult",a.content);else if(cf(a)&&a.tool_calls)for(let b of a.tool_calls)"function"===b.type&&this._emit("functionToolCall",b.function)}}async finalChatCompletion(){await this.done();let a=this._chatCompletions[this._chatCompletions.length-1];if(!a)throw new aT("stream ended without producing a ChatCompletion");return a}async finalContent(){return await this.done(),aP(this,F,"m",G).call(this)}async finalMessage(){return await this.done(),aP(this,F,"m",H).call(this)}async finalFunctionToolCall(){return await this.done(),aP(this,F,"m",I).call(this)}async finalFunctionToolCallResult(){return await this.done(),aP(this,F,"m",J).call(this)}async totalUsage(){return await this.done(),aP(this,F,"m",K).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let a=this._chatCompletions[this._chatCompletions.length-1];a&&this._emit("finalChatCompletion",a);let b=aP(this,F,"m",H).call(this);b&&this._emit("finalMessage",b);let c=aP(this,F,"m",G).call(this);c&&this._emit("finalContent",c);let d=aP(this,F,"m",I).call(this);d&&this._emit("finalFunctionToolCall",d);let e=aP(this,F,"m",J).call(this);null!=e&&this._emit("finalFunctionToolCallResult",e),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",aP(this,F,"m",K).call(this))}async _createChatCompletion(a,b,c){let d=c?.signal;d&&(d.aborted&&this.controller.abort(),d.addEventListener("abort",()=>this.controller.abort())),aP(this,F,"m",L).call(this,b);let e=await a.chat.completions.create({...b,stream:!1},{...c,signal:this.controller.signal});return this._connected(),this._addChatCompletion(cc(e,b))}async _runChatCompletion(a,b,c){for(let a of b.messages)this._addMessage(a,!1);return await this._createChatCompletion(a,b,c)}async _runTools(a,b,c){let d="tool",{tool_choice:e="auto",stream:f,...g}=b,h="string"!=typeof e&&"function"===e.type&&e?.function?.name,{maxChatCompletions:i=10}=c||{},j=b.tools.map(a=>{if(cb(a)){if(!a.$callback)throw new aT("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:a.$callback,name:a.function.name,description:a.function.description||"",parameters:a.function.parameters,parse:a.$parseRaw,strict:!0}}}return a}),k={};for(let a of j)"function"===a.type&&(k[a.function.name||a.function.function.name]=a.function);let l="tools"in b?j.map(a=>"function"===a.type?{type:"function",function:{name:a.function.name||a.function.function.name,parameters:a.function.parameters,description:a.function.description,strict:a.function.strict}}:a):void 0;for(let a of b.messages)this._addMessage(a,!1);for(let b=0;b<i;++b){let b=await this._createChatCompletion(a,{...g,tool_choice:e,tools:l,messages:[...this.messages]},c),f=b.choices[0]?.message;if(!f)throw new aT("missing message in ChatCompletion response");if(!f.tool_calls?.length)break;for(let a of f.tool_calls){let b;if("function"!==a.type)continue;let c=a.id,{name:e,arguments:f}=a.function,g=k[e];if(g){if(h&&h!==e){let a=`Invalid tool_call: ${JSON.stringify(e)}. ${JSON.stringify(h)} requested. Please try again`;this._addMessage({role:d,tool_call_id:c,content:a});continue}}else{let a=`Invalid tool_call: ${JSON.stringify(e)}. Available options are: ${Object.keys(k).map(a=>JSON.stringify(a)).join(", ")}. Please try again`;this._addMessage({role:d,tool_call_id:c,content:a});continue}try{b="function"==typeof g.parse?await g.parse(f):f}catch(b){let a=b instanceof Error?b.message:String(b);this._addMessage({role:d,tool_call_id:c,content:a});continue}let i=await g.function(b,this),j=aP(this,F,"m",M).call(this,i);if(this._addMessage({role:d,tool_call_id:c,content:j}),h)return}}}}F=new WeakSet,G=function(){return aP(this,F,"m",H).call(this).content??null},H=function(){let a=this.messages.length;for(;a-- >0;){let b=this.messages[a];if(cf(b))return{...b,content:b.content??null,refusal:b.refusal??null}}throw new aT("stream ended without producing a ChatCompletionMessage with role=assistant")},I=function(){for(let a=this.messages.length-1;a>=0;a--){let b=this.messages[a];if(cf(b)&&b?.tool_calls?.length)return b.tool_calls.filter(a=>"function"===a.type).at(-1)?.function}},J=function(){for(let a=this.messages.length-1;a>=0;a--){let b=this.messages[a];if(cg(b)&&null!=b.content&&"string"==typeof b.content&&this.messages.some(a=>"assistant"===a.role&&a.tool_calls?.some(a=>"function"===a.type&&a.id===b.tool_call_id)))return b.content}},K=function(){let a={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:b}of this._chatCompletions)b&&(a.completion_tokens+=b.completion_tokens,a.prompt_tokens+=b.prompt_tokens,a.total_tokens+=b.total_tokens);return a},L=function(a){if(null!=a.n&&a.n>1)throw new aT("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},M=function(a){return"string"==typeof a?a:void 0===a?"undefined":JSON.stringify(a)};class cj extends ci{static runTools(a,b,c){let d=new cj,e={...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"runTools"}};return d._run(()=>d._runTools(a,b,e)),d}_addMessage(a,b=!0){super._addMessage(a,b),cf(a)&&a.content&&this._emit("content",a.content)}}let ck={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,ALL:511};class cl extends Error{}class cm extends Error{}let cn=a=>(function(a,b=ck.ALL){if("string"!=typeof a)throw TypeError(`expecting str, got ${typeof a}`);if(!a.trim())throw Error(`${a} is empty`);return((a,b)=>{let c=a.length,d=0,e=a=>{throw new cl(`${a} at position ${d}`)},f=a=>{throw new cm(`${a} at position ${d}`)},g=()=>(l(),d>=c&&e("Unexpected end of input"),'"'===a[d])?h():"{"===a[d]?i():"["===a[d]?j():"null"===a.substring(d,d+4)||ck.NULL&b&&c-d<4&&"null".startsWith(a.substring(d))?(d+=4,null):"true"===a.substring(d,d+4)||ck.BOOL&b&&c-d<4&&"true".startsWith(a.substring(d))?(d+=4,!0):"false"===a.substring(d,d+5)||ck.BOOL&b&&c-d<5&&"false".startsWith(a.substring(d))?(d+=5,!1):"Infinity"===a.substring(d,d+8)||ck.INFINITY&b&&c-d<8&&"Infinity".startsWith(a.substring(d))?(d+=8,1/0):"-Infinity"===a.substring(d,d+9)||ck.MINUS_INFINITY&b&&1<c-d&&c-d<9&&"-Infinity".startsWith(a.substring(d))?(d+=9,-1/0):"NaN"===a.substring(d,d+3)||ck.NAN&b&&c-d<3&&"NaN".startsWith(a.substring(d))?(d+=3,NaN):k(),h=()=>{let g=d,h=!1;for(d++;d<c&&('"'!==a[d]||h&&"\\"===a[d-1]);)h="\\"===a[d]&&!h,d++;if('"'==a.charAt(d))try{return JSON.parse(a.substring(g,++d-Number(h)))}catch(a){f(String(a))}else if(ck.STR&b)try{return JSON.parse(a.substring(g,d-Number(h))+'"')}catch(b){return JSON.parse(a.substring(g,a.lastIndexOf("\\"))+'"')}e("Unterminated string literal")},i=()=>{d++,l();let f={};try{for(;"}"!==a[d];){if(l(),d>=c&&ck.OBJ&b)return f;let e=h();l(),d++;try{let a=g();Object.defineProperty(f,e,{value:a,writable:!0,enumerable:!0,configurable:!0})}catch(a){if(ck.OBJ&b)return f;throw a}l(),","===a[d]&&d++}}catch(a){if(ck.OBJ&b)return f;e("Expected '}' at end of object")}return d++,f},j=()=>{d++;let c=[];try{for(;"]"!==a[d];)c.push(g()),l(),","===a[d]&&d++}catch(a){if(ck.ARR&b)return c;e("Expected ']' at end of array")}return d++,c},k=()=>{if(0===d){"-"===a&&ck.NUM&b&&e("Not sure what '-' is");try{return JSON.parse(a)}catch(c){if(ck.NUM&b)try{if("."===a[a.length-1])return JSON.parse(a.substring(0,a.lastIndexOf(".")));return JSON.parse(a.substring(0,a.lastIndexOf("e")))}catch(a){}f(String(c))}}let g=d;for("-"===a[d]&&d++;a[d]&&!",]}".includes(a[d]);)d++;d!=c||ck.NUM&b||e("Unterminated number literal");try{return JSON.parse(a.substring(g,d))}catch(c){"-"===a.substring(g,d)&&ck.NUM&b&&e("Not sure what '-' is");try{return JSON.parse(a.substring(g,a.lastIndexOf("e")))}catch(a){f(String(a))}}},l=()=>{for(;d<c&&" \n\r	".includes(a[d]);)d++};return g()})(a.trim(),b)})(a,ck.ALL^ck.NUM);class co extends ci{constructor(a){super(),N.add(this),O.set(this,void 0),P.set(this,void 0),Q.set(this,void 0),aO(this,O,a,"f"),aO(this,P,[],"f")}get currentChatCompletionSnapshot(){return aP(this,Q,"f")}static fromReadableStream(a){let b=new co(null);return b._run(()=>b._fromReadableStream(a)),b}static createChatCompletion(a,b,c){let d=new co(b);return d._run(()=>d._runChatCompletion(a,{...b,stream:!0},{...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"stream"}})),d}async _createChatCompletion(a,b,c){super._createChatCompletion;let d=c?.signal;d&&(d.aborted&&this.controller.abort(),d.addEventListener("abort",()=>this.controller.abort())),aP(this,N,"m",R).call(this);let e=await a.chat.completions.create({...b,stream:!0},{...c,signal:this.controller.signal});for await(let a of(this._connected(),e))aP(this,N,"m",T).call(this,a);if(e.controller.signal?.aborted)throw new aV;return this._addChatCompletion(aP(this,N,"m",W).call(this))}async _fromReadableStream(a,b){let c,d=b?.signal;d&&(d.aborted&&this.controller.abort(),d.addEventListener("abort",()=>this.controller.abort())),aP(this,N,"m",R).call(this),this._connected();let e=bG.fromReadableStream(a,this.controller);for await(let a of e)c&&c!==a.id&&this._addChatCompletion(aP(this,N,"m",W).call(this)),aP(this,N,"m",T).call(this,a),c=a.id;if(e.controller.signal?.aborted)throw new aV;return this._addChatCompletion(aP(this,N,"m",W).call(this))}[(O=new WeakMap,P=new WeakMap,Q=new WeakMap,N=new WeakSet,R=function(){this.ended||aO(this,Q,void 0,"f")},S=function(a){let b=aP(this,P,"f")[a.index];return b||(b={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},aP(this,P,"f")[a.index]=b),b},T=function(a){if(this.ended)return;let b=aP(this,N,"m",Y).call(this,a);for(let c of(this._emit("chunk",a,b),a.choices)){let a=b.choices[c.index];null!=c.delta.content&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",c.delta.content,a.message.content),this._emit("content.delta",{delta:c.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),null!=c.delta.refusal&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:c.delta.refusal,snapshot:a.message.refusal}),c.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:c.logprobs?.content,snapshot:a.logprobs?.content??[]}),c.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:c.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});let d=aP(this,N,"m",S).call(this,a);for(let b of(a.finish_reason&&(aP(this,N,"m",V).call(this,a),null!=d.current_tool_call_index&&aP(this,N,"m",U).call(this,a,d.current_tool_call_index)),c.delta.tool_calls??[]))d.current_tool_call_index!==b.index&&(aP(this,N,"m",V).call(this,a),null!=d.current_tool_call_index&&aP(this,N,"m",U).call(this,a,d.current_tool_call_index)),d.current_tool_call_index=b.index;for(let b of c.delta.tool_calls??[]){let c=a.message.tool_calls?.[b.index];c?.type&&(c?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:c.function?.name,index:b.index,arguments:c.function.arguments,parsed_arguments:c.function.parsed_arguments,arguments_delta:b.function?.arguments??""}):c?.type)}}},U=function(a,b){if(aP(this,N,"m",S).call(this,a).done_tool_calls.has(b))return;let c=a.message.tool_calls?.[b];if(!c)throw Error("no tool call snapshot");if(!c.type)throw Error("tool call snapshot missing `type`");if("function"===c.type){let a=aP(this,O,"f")?.tools?.find(a=>b9(a)&&a.function.name===c.function.name);this._emit("tool_calls.function.arguments.done",{name:c.function.name,index:b,arguments:c.function.arguments,parsed_arguments:cb(a)?a.$parseRaw(c.function.arguments):a?.function.strict?JSON.parse(c.function.arguments):null})}else c.type},V=function(a){let b=aP(this,N,"m",S).call(this,a);if(a.message.content&&!b.content_done){b.content_done=!0;let c=aP(this,N,"m",X).call(this);this._emit("content.done",{content:a.message.content,parsed:c?c.$parseRaw(a.message.content):null})}a.message.refusal&&!b.refusal_done&&(b.refusal_done=!0,this._emit("refusal.done",{refusal:a.message.refusal})),a.logprobs?.content&&!b.logprobs_content_done&&(b.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:a.logprobs.content})),a.logprobs?.refusal&&!b.logprobs_refusal_done&&(b.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:a.logprobs.refusal}))},W=function(){if(this.ended)throw new aT("stream has ended, this shouldn't happen");let a=aP(this,Q,"f");if(!a)throw new aT("request ended without sending any chunks");return aO(this,Q,void 0,"f"),aO(this,P,[],"f"),function(a,b){var c;let{id:d,choices:e,created:f,model:g,system_fingerprint:h,...i}=a;return c={...i,id:d,choices:e.map(({message:b,finish_reason:c,index:d,logprobs:e,...f})=>{if(!c)throw new aT(`missing finish_reason for choice ${d}`);let{content:g=null,function_call:h,tool_calls:i,...j}=b,k=b.role;if(!k)throw new aT(`missing role for choice ${d}`);if(h){let{arguments:a,name:i}=h;if(null==a)throw new aT(`missing function_call.arguments for choice ${d}`);if(!i)throw new aT(`missing function_call.name for choice ${d}`);return{...f,message:{content:g,function_call:{arguments:a,name:i},role:k,refusal:b.refusal??null},finish_reason:c,index:d,logprobs:e}}return i?{...f,index:d,finish_reason:c,logprobs:e,message:{...j,role:k,content:g,refusal:b.refusal??null,tool_calls:i.map((b,c)=>{let{function:e,type:f,id:g,...h}=b,{arguments:i,name:j,...k}=e||{};if(null==g)throw new aT(`missing choices[${d}].tool_calls[${c}].id
${cp(a)}`);if(null==f)throw new aT(`missing choices[${d}].tool_calls[${c}].type
${cp(a)}`);if(null==j)throw new aT(`missing choices[${d}].tool_calls[${c}].function.name
${cp(a)}`);if(null==i)throw new aT(`missing choices[${d}].tool_calls[${c}].function.arguments
${cp(a)}`);return{...h,id:g,type:f,function:{...k,name:j,arguments:i}}})}}:{...f,message:{...j,content:g,role:k,refusal:b.refusal??null},finish_reason:c,index:d,logprobs:e}}),created:f,model:g,object:"chat.completion",...h?{system_fingerprint:h}:{}},b&&cd(b)?cc(c,b):{...c,choices:c.choices.map(a=>(ce(a.message.tool_calls),{...a,message:{...a.message,parsed:null,...a.message.tool_calls?{tool_calls:a.message.tool_calls}:void 0}}))}}(a,aP(this,O,"f"))},X=function(){let a=aP(this,O,"f")?.response_format;return ca(a)?a:null},Y=function(a){var b,c,d,e;let f=aP(this,Q,"f"),{choices:g,...h}=a;for(let{delta:g,finish_reason:i,index:j,logprobs:k=null,...l}of(f?Object.assign(f,h):f=aO(this,Q,{...h,choices:[]},"f"),a.choices)){let a=f.choices[j];if(a||(a=f.choices[j]={finish_reason:i,index:j,message:{},logprobs:k,...l}),k)if(a.logprobs){let{content:d,refusal:e,...f}=k;Object.assign(a.logprobs,f),d&&((b=a.logprobs).content??(b.content=[]),a.logprobs.content.push(...d)),e&&((c=a.logprobs).refusal??(c.refusal=[]),a.logprobs.refusal.push(...e))}else a.logprobs=Object.assign({},k);if(i&&(a.finish_reason=i,aP(this,O,"f")&&cd(aP(this,O,"f")))){if("length"===i)throw new a4;if("content_filter"===i)throw new a5}if(Object.assign(a,l),!g)continue;let{content:h,refusal:m,function_call:n,role:o,tool_calls:p,...q}=g;if(Object.assign(a.message,q),m&&(a.message.refusal=(a.message.refusal||"")+m),o&&(a.message.role=o),n&&(a.message.function_call?(n.name&&(a.message.function_call.name=n.name),n.arguments&&((d=a.message.function_call).arguments??(d.arguments=""),a.message.function_call.arguments+=n.arguments)):a.message.function_call=n),h&&(a.message.content=(a.message.content||"")+h,!a.message.refusal&&aP(this,N,"m",X).call(this)&&(a.message.parsed=cn(a.message.content))),p)for(let{index:b,id:c,type:d,function:f,...g}of(a.message.tool_calls||(a.message.tool_calls=[]),p)){let h=(e=a.message.tool_calls)[b]??(e[b]={});Object.assign(h,g),c&&(h.id=c),d&&(h.type=d),f&&(h.function??(h.function={name:f.name??"",arguments:""})),f?.name&&(h.function.name=f.name),f?.arguments&&(h.function.arguments+=f.arguments,function(a,b){if(!a||!("tools"in a)||!a.tools)return!1;let c=a.tools?.find(a=>b9(a)&&a.function?.name===b.function.name);return b9(c)&&(cb(c)||c?.function.strict||!1)}(aP(this,O,"f"),h)&&(h.function.parsed_arguments=cn(h.function.arguments)))}}return f},Symbol.asyncIterator)](){let a=[],b=[],c=!1;return this.on("chunk",c=>{let d=b.shift();d?d.resolve(c):a.push(c)}),this.on("end",()=>{for(let a of(c=!0,b))a.resolve(void 0);b.length=0}),this.on("abort",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),this.on("error",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:c?{value:void 0,done:!0}:new Promise((a,c)=>b.push({resolve:a,reject:c})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new bG(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function cp(a){return JSON.stringify(a)}class cq extends co{static fromReadableStream(a){let b=new cq(null);return b._run(()=>b._fromReadableStream(a)),b}static runTools(a,b,c){let d=new cq(b),e={...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"runTools"}};return d._run(()=>d._runTools(a,b,e)),d}}class cr extends b4{constructor(){super(...arguments),this.messages=new b8(this._client)}create(a,b){return this._client.post("/chat/completions",{body:a,...b,stream:a.stream??!1})}retrieve(a,b){return this._client.get(b7`/chat/completions/${a}`,b)}update(a,b,c){return this._client.post(b7`/chat/completions/${a}`,{body:b,...c})}list(a={},b){return this._client.getAPIList("/chat/completions",bQ,{query:a,...b})}delete(a,b){return this._client.delete(b7`/chat/completions/${a}`,b)}parse(a,b){for(let b of a.tools??[]){if("function"!==b.type)throw new aT(`Currently only \`function\` tool types support auto-parsing; Received \`${b.type}\``);if(!0!==b.function.strict)throw new aT(`The \`${b.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}return this._client.chat.completions.create(a,{...b,headers:{...b?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(b=>cc(b,a))}runTools(a,b){return a.stream?cq.runTools(this._client,a,b):cj.runTools(this._client,a,b)}stream(a,b){return co.createChatCompletion(this._client,a,b)}}cr.Messages=b8;class cs extends b4{constructor(){super(...arguments),this.completions=new cr(this._client)}}cs.Completions=cr;let ct=Symbol("brand.privateNullableHeaders"),cu=a=>{let b=new Headers,c=new Set;for(let d of a){let a=new Set;for(let[e,f]of function*(a){let b;if(!a)return;if(ct in a){let{values:b,nulls:c}=a;for(let a of(yield*b.entries(),c))yield[a,null];return}let c=!1;for(let d of(a instanceof Headers?b=a.entries():a9(a)?b=a:(c=!0,b=Object.entries(a??{})),b)){let a=d[0];if("string"!=typeof a)throw TypeError("expected header name to be a string");let b=a9(d[1])?d[1]:[d[1]],e=!1;for(let d of b)void 0!==d&&(c&&!e&&(e=!0,yield[a,null]),yield[a,d])}}(d)){let d=e.toLowerCase();a.has(d)||(b.delete(e),a.add(d)),null===f?(b.delete(e),c.add(d)):(b.append(e,f),c.delete(d))}}return{[ct]:!0,values:b,nulls:c}};class cv extends b4{create(a,b){return this._client.post("/audio/speech",{body:a,...b,headers:cu([{Accept:"application/octet-stream"},b?.headers]),__binaryResponse:!0})}}class cw extends b4{create(a,b){return this._client.post("/audio/transcriptions",bX({body:a,...b,stream:a.stream??!1,__metadata:{model:a.model}},this._client))}}class cx extends b4{create(a,b){return this._client.post("/audio/translations",bX({body:a,...b,__metadata:{model:a.model}},this._client))}}class cy extends b4{constructor(){super(...arguments),this.transcriptions=new cw(this._client),this.translations=new cx(this._client),this.speech=new cv(this._client)}}cy.Transcriptions=cw,cy.Translations=cx,cy.Speech=cv;class cz extends b4{create(a,b){return this._client.post("/batches",{body:a,...b})}retrieve(a,b){return this._client.get(b7`/batches/${a}`,b)}list(a={},b){return this._client.getAPIList("/batches",bQ,{query:a,...b})}cancel(a,b){return this._client.post(b7`/batches/${a}/cancel`,b)}}class cA extends b4{create(a,b){return this._client.post("/assistants",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}retrieve(a,b){return this._client.get(b7`/assistants/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}update(a,b,c){return this._client.post(b7`/assistants/${a}`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a={},b){return this._client.getAPIList("/assistants",bQ,{query:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}delete(a,b){return this._client.delete(b7`/assistants/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}}class cB extends b4{create(a,b){return this._client.post("/realtime/sessions",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}}class cC extends b4{create(a,b){return this._client.post("/realtime/transcription_sessions",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}}class cD extends b4{constructor(){super(...arguments),this.sessions=new cB(this._client),this.transcriptionSessions=new cC(this._client)}}cD.Sessions=cB,cD.TranscriptionSessions=cC;class cE extends b4{create(a,b){return this._client.post("/chatkit/sessions",{body:a,...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])})}cancel(a,b){return this._client.post(b7`/chatkit/sessions/${a}/cancel`,{...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])})}}class cF extends b4{retrieve(a,b){return this._client.get(b7`/chatkit/threads/${a}`,{...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])})}list(a={},b){return this._client.getAPIList("/chatkit/threads",bR,{query:a,...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])})}delete(a,b){return this._client.delete(b7`/chatkit/threads/${a}`,{...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])})}listItems(a,b={},c){return this._client.getAPIList(b7`/chatkit/threads/${a}/items`,bR,{query:b,...c,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},c?.headers])})}}class cG extends b4{constructor(){super(...arguments),this.sessions=new cE(this._client),this.threads=new cF(this._client)}uploadFile(a,b){return this._client.post("/chatkit/files",bW({body:a,...b,headers:cu([{"OpenAI-Beta":"chatkit_beta=v1"},b?.headers])},this._client))}}cG.Sessions=cE,cG.Threads=cF;class cH extends b4{create(a,b,c){return this._client.post(b7`/threads/${a}/messages`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}retrieve(a,b,c){let{thread_id:d}=b;return this._client.get(b7`/threads/${d}/messages/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}update(a,b,c){let{thread_id:d,...e}=b;return this._client.post(b7`/threads/${d}/messages/${a}`,{body:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a,b={},c){return this._client.getAPIList(b7`/threads/${a}/messages`,bQ,{query:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}delete(a,b,c){let{thread_id:d}=b;return this._client.delete(b7`/threads/${d}/messages/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}}class cI extends b4{retrieve(a,b,c){let{thread_id:d,run_id:e,...f}=b;return this._client.get(b7`/threads/${d}/runs/${e}/steps/${a}`,{query:f,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a,b,c){let{thread_id:d,...e}=b;return this._client.getAPIList(b7`/threads/${d}/runs/${a}/steps`,bQ,{query:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}}let cJ=a=>void 0!==globalThis.process?globalThis.process.env?.[a]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(a)?.trim():void 0;class cK extends ch{constructor(){super(...arguments),Z.add(this),aa.set(this,[]),ab.set(this,{}),ac.set(this,{}),ad.set(this,void 0),ae.set(this,void 0),af.set(this,void 0),ag.set(this,void 0),ah.set(this,void 0),ai.set(this,void 0),aj.set(this,void 0),ak.set(this,void 0),al.set(this,void 0)}[(aa=new WeakMap,ab=new WeakMap,ac=new WeakMap,ad=new WeakMap,ae=new WeakMap,af=new WeakMap,ag=new WeakMap,ah=new WeakMap,ai=new WeakMap,aj=new WeakMap,ak=new WeakMap,al=new WeakMap,Z=new WeakSet,Symbol.asyncIterator)](){let a=[],b=[],c=!1;return this.on("event",c=>{let d=b.shift();d?d.resolve(c):a.push(c)}),this.on("end",()=>{for(let a of(c=!0,b))a.resolve(void 0);b.length=0}),this.on("abort",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),this.on("error",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:c?{value:void 0,done:!0}:new Promise((a,c)=>b.push({resolve:a,reject:c})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(a){let b=new _;return b._run(()=>b._fromReadableStream(a)),b}async _fromReadableStream(a,b){let c=b?.signal;c&&(c.aborted&&this.controller.abort(),c.addEventListener("abort",()=>this.controller.abort())),this._connected();let d=bG.fromReadableStream(a,this.controller);for await(let a of d)aP(this,Z,"m",am).call(this,a);if(d.controller.signal?.aborted)throw new aV;return this._addRun(aP(this,Z,"m",an).call(this))}toReadableStream(){return new bG(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(a,b,c,d){let e=new _;return e._run(()=>e._runToolAssistantStream(a,b,c,{...d,headers:{...d?.headers,"X-Stainless-Helper-Method":"stream"}})),e}async _createToolAssistantStream(a,b,c,d){let e=d?.signal;e&&(e.aborted&&this.controller.abort(),e.addEventListener("abort",()=>this.controller.abort()));let f={...c,stream:!0},g=await a.submitToolOutputs(b,f,{...d,signal:this.controller.signal});for await(let a of(this._connected(),g))aP(this,Z,"m",am).call(this,a);if(g.controller.signal?.aborted)throw new aV;return this._addRun(aP(this,Z,"m",an).call(this))}static createThreadAssistantStream(a,b,c){let d=new _;return d._run(()=>d._threadAssistantStream(a,b,{...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"stream"}})),d}static createAssistantStream(a,b,c,d){let e=new _;return e._run(()=>e._runAssistantStream(a,b,c,{...d,headers:{...d?.headers,"X-Stainless-Helper-Method":"stream"}})),e}currentEvent(){return aP(this,aj,"f")}currentRun(){return aP(this,ak,"f")}currentMessageSnapshot(){return aP(this,ad,"f")}currentRunStepSnapshot(){return aP(this,al,"f")}async finalRunSteps(){return await this.done(),Object.values(aP(this,ab,"f"))}async finalMessages(){return await this.done(),Object.values(aP(this,ac,"f"))}async finalRun(){if(await this.done(),!aP(this,ae,"f"))throw Error("Final run was not received.");return aP(this,ae,"f")}async _createThreadAssistantStream(a,b,c){let d=c?.signal;d&&(d.aborted&&this.controller.abort(),d.addEventListener("abort",()=>this.controller.abort()));let e={...b,stream:!0},f=await a.createAndRun(e,{...c,signal:this.controller.signal});for await(let a of(this._connected(),f))aP(this,Z,"m",am).call(this,a);if(f.controller.signal?.aborted)throw new aV;return this._addRun(aP(this,Z,"m",an).call(this))}async _createAssistantStream(a,b,c,d){let e=d?.signal;e&&(e.aborted&&this.controller.abort(),e.addEventListener("abort",()=>this.controller.abort()));let f={...c,stream:!0},g=await a.create(b,f,{...d,signal:this.controller.signal});for await(let a of(this._connected(),g))aP(this,Z,"m",am).call(this,a);if(g.controller.signal?.aborted)throw new aV;return this._addRun(aP(this,Z,"m",an).call(this))}static accumulateDelta(a,b){for(let[c,d]of Object.entries(b)){if(!a.hasOwnProperty(c)){a[c]=d;continue}let b=a[c];if(null==b||"index"===c||"type"===c){a[c]=d;continue}if("string"==typeof b&&"string"==typeof d)b+=d;else if("number"==typeof b&&"number"==typeof d)b+=d;else if(bb(b)&&bb(d))b=this.accumulateDelta(b,d);else if(Array.isArray(b)&&Array.isArray(d)){if(b.every(a=>"string"==typeof a||"number"==typeof a)){b.push(...d);continue}for(let a of d){if(!bb(a))throw Error(`Expected array delta entry to be an object but got: ${a}`);let c=a.index;if(null==c)throw console.error(a),Error("Expected array delta entry to have an `index` property");if("number"!=typeof c)throw Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);let d=b[c];null==d?b.push(a):b[c]=this.accumulateDelta(d,a)}continue}else throw Error(`Unhandled record type: ${c}, deltaValue: ${d}, accValue: ${b}`);a[c]=b}return a}_addRun(a){return a}async _threadAssistantStream(a,b,c){return await this._createThreadAssistantStream(b,a,c)}async _runAssistantStream(a,b,c,d){return await this._createAssistantStream(b,a,c,d)}async _runToolAssistantStream(a,b,c,d){return await this._createToolAssistantStream(b,a,c,d)}}_=cK,am=function(a){if(!this.ended)switch(aO(this,aj,a,"f"),aP(this,Z,"m",aq).call(this,a),a.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":aP(this,Z,"m",au).call(this,a);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":aP(this,Z,"m",ap).call(this,a);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":aP(this,Z,"m",ao).call(this,a);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},an=function(){if(this.ended)throw new aT("stream has ended, this shouldn't happen");if(!aP(this,ae,"f"))throw Error("Final run has not been received");return aP(this,ae,"f")},ao=function(a){let[b,c]=aP(this,Z,"m",as).call(this,a,aP(this,ad,"f"));for(let a of(aO(this,ad,b,"f"),aP(this,ac,"f")[b.id]=b,c)){let c=b.content[a.index];c?.type=="text"&&this._emit("textCreated",c.text)}switch(a.event){case"thread.message.created":this._emit("messageCreated",a.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",a.data.delta,b),a.data.delta.content)for(let c of a.data.delta.content){if("text"==c.type&&c.text){let a=c.text,d=b.content[c.index];if(d&&"text"==d.type)this._emit("textDelta",a,d.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(c.index!=aP(this,af,"f")){if(aP(this,ag,"f"))switch(aP(this,ag,"f").type){case"text":this._emit("textDone",aP(this,ag,"f").text,aP(this,ad,"f"));break;case"image_file":this._emit("imageFileDone",aP(this,ag,"f").image_file,aP(this,ad,"f"))}aO(this,af,c.index,"f")}aO(this,ag,b.content[c.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==aP(this,af,"f")){let b=a.data.content[aP(this,af,"f")];if(b)switch(b.type){case"image_file":this._emit("imageFileDone",b.image_file,aP(this,ad,"f"));break;case"text":this._emit("textDone",b.text,aP(this,ad,"f"))}}aP(this,ad,"f")&&this._emit("messageDone",a.data),aO(this,ad,void 0,"f")}},ap=function(a){let b=aP(this,Z,"m",ar).call(this,a);switch(aO(this,al,b,"f"),a.event){case"thread.run.step.created":this._emit("runStepCreated",a.data);break;case"thread.run.step.delta":let c=a.data.delta;if(c.step_details&&"tool_calls"==c.step_details.type&&c.step_details.tool_calls&&"tool_calls"==b.step_details.type)for(let a of c.step_details.tool_calls)a.index==aP(this,ah,"f")?this._emit("toolCallDelta",a,b.step_details.tool_calls[a.index]):(aP(this,ai,"f")&&this._emit("toolCallDone",aP(this,ai,"f")),aO(this,ah,a.index,"f"),aO(this,ai,b.step_details.tool_calls[a.index],"f"),aP(this,ai,"f")&&this._emit("toolCallCreated",aP(this,ai,"f")));this._emit("runStepDelta",a.data.delta,b);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":aO(this,al,void 0,"f"),"tool_calls"==a.data.step_details.type&&aP(this,ai,"f")&&(this._emit("toolCallDone",aP(this,ai,"f")),aO(this,ai,void 0,"f")),this._emit("runStepDone",a.data,b)}},aq=function(a){aP(this,aa,"f").push(a),this._emit("event",a)},ar=function(a){switch(a.event){case"thread.run.step.created":return aP(this,ab,"f")[a.data.id]=a.data,a.data;case"thread.run.step.delta":let b=aP(this,ab,"f")[a.data.id];if(!b)throw Error("Received a RunStepDelta before creation of a snapshot");let c=a.data;if(c.delta){let d=_.accumulateDelta(b,c.delta);aP(this,ab,"f")[a.data.id]=d}return aP(this,ab,"f")[a.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":aP(this,ab,"f")[a.data.id]=a.data}if(aP(this,ab,"f")[a.data.id])return aP(this,ab,"f")[a.data.id];throw Error("No snapshot available")},as=function(a,b){let c=[];switch(a.event){case"thread.message.created":return[a.data,c];case"thread.message.delta":if(!b)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let d=a.data;if(d.delta.content)for(let a of d.delta.content)if(a.index in b.content){let c=b.content[a.index];b.content[a.index]=aP(this,Z,"m",at).call(this,a,c)}else b.content[a.index]=a,c.push(a);return[b,c];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(b)return[b,c];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},at=function(a,b){return _.accumulateDelta(b,a)},au=function(a){switch(aO(this,ak,a.data,"f"),a.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":aO(this,ae,a.data,"f"),aP(this,ai,"f")&&(this._emit("toolCallDone",aP(this,ai,"f")),aO(this,ai,void 0,"f"))}};class cL extends b4{constructor(){super(...arguments),this.steps=new cI(this._client)}create(a,b,c){let{include:d,...e}=b;return this._client.post(b7`/threads/${a}/runs`,{query:{include:d},body:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers]),stream:b.stream??!1})}retrieve(a,b,c){let{thread_id:d}=b;return this._client.get(b7`/threads/${d}/runs/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}update(a,b,c){let{thread_id:d,...e}=b;return this._client.post(b7`/threads/${d}/runs/${a}`,{body:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a,b={},c){return this._client.getAPIList(b7`/threads/${a}/runs`,bQ,{query:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}cancel(a,b,c){let{thread_id:d}=b;return this._client.post(b7`/threads/${d}/runs/${a}/cancel`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}async createAndPoll(a,b,c){let d=await this.create(a,b,c);return await this.poll(d.id,{thread_id:a},c)}createAndStream(a,b,c){return cK.createAssistantStream(a,this._client.beta.threads.runs,b,c)}async poll(a,b,c){let d=cu([c?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":c?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:e,response:f}=await this.retrieve(a,b,{...c,headers:{...c?.headers,...d}}).withResponse();switch(e.status){case"queued":case"in_progress":case"cancelling":let g=5e3;if(c?.pollIntervalMs)g=c.pollIntervalMs;else{let a=f.headers.get("openai-poll-after-ms");if(a){let b=parseInt(a);isNaN(b)||(g=b)}}await bc(g);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return e}}}stream(a,b,c){return cK.createAssistantStream(a,this._client.beta.threads.runs,b,c)}submitToolOutputs(a,b,c){let{thread_id:d,...e}=b;return this._client.post(b7`/threads/${d}/runs/${a}/submit_tool_outputs`,{body:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers]),stream:b.stream??!1})}async submitToolOutputsAndPoll(a,b,c){let d=await this.submitToolOutputs(a,b,c);return await this.poll(d.id,b,c)}submitToolOutputsStream(a,b,c){return cK.createToolAssistantStream(a,this._client.beta.threads.runs,b,c)}}cL.Steps=cI;class cM extends b4{constructor(){super(...arguments),this.runs=new cL(this._client),this.messages=new cH(this._client)}create(a={},b){return this._client.post("/threads",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}retrieve(a,b){return this._client.get(b7`/threads/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}update(a,b,c){return this._client.post(b7`/threads/${a}`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}delete(a,b){return this._client.delete(b7`/threads/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}createAndRun(a,b){return this._client.post("/threads/runs",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers]),stream:a.stream??!1})}async createAndRunPoll(a,b){let c=await this.createAndRun(a,b);return await this.runs.poll(c.id,{thread_id:c.thread_id},b)}createAndRunStream(a,b){return cK.createThreadAssistantStream(a,this._client.beta.threads,b)}}cM.Runs=cL,cM.Messages=cH;class cN extends b4{constructor(){super(...arguments),this.realtime=new cD(this._client),this.chatkit=new cG(this._client),this.assistants=new cA(this._client),this.threads=new cM(this._client)}}cN.Realtime=cD,cN.ChatKit=cG,cN.Assistants=cA,cN.Threads=cM;class cO extends b4{create(a,b){return this._client.post("/completions",{body:a,...b,stream:a.stream??!1})}}class cP extends b4{retrieve(a,b,c){let{container_id:d}=b;return this._client.get(b7`/containers/${d}/files/${a}/content`,{...c,headers:cu([{Accept:"application/binary"},c?.headers]),__binaryResponse:!0})}}class cQ extends b4{constructor(){super(...arguments),this.content=new cP(this._client)}create(a,b,c){return this._client.post(b7`/containers/${a}/files`,bX({body:b,...c},this._client))}retrieve(a,b,c){let{container_id:d}=b;return this._client.get(b7`/containers/${d}/files/${a}`,c)}list(a,b={},c){return this._client.getAPIList(b7`/containers/${a}/files`,bQ,{query:b,...c})}delete(a,b,c){let{container_id:d}=b;return this._client.delete(b7`/containers/${d}/files/${a}`,{...c,headers:cu([{Accept:"*/*"},c?.headers])})}}cQ.Content=cP;class cR extends b4{constructor(){super(...arguments),this.files=new cQ(this._client)}create(a,b){return this._client.post("/containers",{body:a,...b})}retrieve(a,b){return this._client.get(b7`/containers/${a}`,b)}list(a={},b){return this._client.getAPIList("/containers",bQ,{query:a,...b})}delete(a,b){return this._client.delete(b7`/containers/${a}`,{...b,headers:cu([{Accept:"*/*"},b?.headers])})}}cR.Files=cQ;class cS extends b4{create(a,b,c){let{include:d,...e}=b;return this._client.post(b7`/conversations/${a}/items`,{query:{include:d},body:e,...c})}retrieve(a,b,c){let{conversation_id:d,...e}=b;return this._client.get(b7`/conversations/${d}/items/${a}`,{query:e,...c})}list(a,b={},c){return this._client.getAPIList(b7`/conversations/${a}/items`,bR,{query:b,...c})}delete(a,b,c){let{conversation_id:d}=b;return this._client.delete(b7`/conversations/${d}/items/${a}`,c)}}class cT extends b4{constructor(){super(...arguments),this.items=new cS(this._client)}create(a={},b){return this._client.post("/conversations",{body:a,...b})}retrieve(a,b){return this._client.get(b7`/conversations/${a}`,b)}update(a,b,c){return this._client.post(b7`/conversations/${a}`,{body:b,...c})}delete(a,b){return this._client.delete(b7`/conversations/${a}`,b)}}cT.Items=cS;class cU extends b4{create(a,b){let c=!!a.encoding_format,d=c?a.encoding_format:"base64";c&&bE(this._client).debug("embeddings/user defined encoding_format:",a.encoding_format);let e=this._client.post("/embeddings",{body:{...a,encoding_format:d},...b});return c?e:(bE(this._client).debug("embeddings/decoding base64 embeddings from base64"),e._thenUnwrap(a=>(a&&a.data&&a.data.forEach(a=>{let b=a.embedding;a.embedding=(a=>{if("undefined"!=typeof Buffer){let b=Buffer.from(a,"base64");return Array.from(new Float32Array(b.buffer,b.byteOffset,b.length/Float32Array.BYTES_PER_ELEMENT))}{let b=atob(a),c=b.length,d=new Uint8Array(c);for(let a=0;a<c;a++)d[a]=b.charCodeAt(a);return Array.from(new Float32Array(d.buffer))}})(b)}),a)))}}class cV extends b4{retrieve(a,b,c){let{eval_id:d,run_id:e}=b;return this._client.get(b7`/evals/${d}/runs/${e}/output_items/${a}`,c)}list(a,b,c){let{eval_id:d,...e}=b;return this._client.getAPIList(b7`/evals/${d}/runs/${a}/output_items`,bQ,{query:e,...c})}}class cW extends b4{constructor(){super(...arguments),this.outputItems=new cV(this._client)}create(a,b,c){return this._client.post(b7`/evals/${a}/runs`,{body:b,...c})}retrieve(a,b,c){let{eval_id:d}=b;return this._client.get(b7`/evals/${d}/runs/${a}`,c)}list(a,b={},c){return this._client.getAPIList(b7`/evals/${a}/runs`,bQ,{query:b,...c})}delete(a,b,c){let{eval_id:d}=b;return this._client.delete(b7`/evals/${d}/runs/${a}`,c)}cancel(a,b,c){let{eval_id:d}=b;return this._client.post(b7`/evals/${d}/runs/${a}`,c)}}cW.OutputItems=cV;class cX extends b4{constructor(){super(...arguments),this.runs=new cW(this._client)}create(a,b){return this._client.post("/evals",{body:a,...b})}retrieve(a,b){return this._client.get(b7`/evals/${a}`,b)}update(a,b,c){return this._client.post(b7`/evals/${a}`,{body:b,...c})}list(a={},b){return this._client.getAPIList("/evals",bQ,{query:a,...b})}delete(a,b){return this._client.delete(b7`/evals/${a}`,b)}}cX.Runs=cW;class cY extends b4{create(a,b){return this._client.post("/files",bX({body:a,...b},this._client))}retrieve(a,b){return this._client.get(b7`/files/${a}`,b)}list(a={},b){return this._client.getAPIList("/files",bQ,{query:a,...b})}delete(a,b){return this._client.delete(b7`/files/${a}`,b)}content(a,b){return this._client.get(b7`/files/${a}/content`,{...b,headers:cu([{Accept:"application/binary"},b?.headers]),__binaryResponse:!0})}async waitForProcessing(a,{pollInterval:b=5e3,maxWait:c=18e5}={}){let d=new Set(["processed","error","deleted"]),e=Date.now(),f=await this.retrieve(a);for(;!f.status||!d.has(f.status);)if(await bc(b),f=await this.retrieve(a),Date.now()-e>c)throw new aX({message:`Giving up on waiting for file ${a} to finish processing after ${c} milliseconds.`});return f}}class cZ extends b4{}class c$ extends b4{run(a,b){return this._client.post("/fine_tuning/alpha/graders/run",{body:a,...b})}validate(a,b){return this._client.post("/fine_tuning/alpha/graders/validate",{body:a,...b})}}class c_ extends b4{constructor(){super(...arguments),this.graders=new c$(this._client)}}c_.Graders=c$;class c0 extends b4{create(a,b,c){return this._client.getAPIList(b7`/fine_tuning/checkpoints/${a}/permissions`,bP,{body:b,method:"post",...c})}retrieve(a,b={},c){return this._client.get(b7`/fine_tuning/checkpoints/${a}/permissions`,{query:b,...c})}delete(a,b,c){let{fine_tuned_model_checkpoint:d}=b;return this._client.delete(b7`/fine_tuning/checkpoints/${d}/permissions/${a}`,c)}}class c1 extends b4{constructor(){super(...arguments),this.permissions=new c0(this._client)}}c1.Permissions=c0;class c2 extends b4{list(a,b={},c){return this._client.getAPIList(b7`/fine_tuning/jobs/${a}/checkpoints`,bQ,{query:b,...c})}}class c3 extends b4{constructor(){super(...arguments),this.checkpoints=new c2(this._client)}create(a,b){return this._client.post("/fine_tuning/jobs",{body:a,...b})}retrieve(a,b){return this._client.get(b7`/fine_tuning/jobs/${a}`,b)}list(a={},b){return this._client.getAPIList("/fine_tuning/jobs",bQ,{query:a,...b})}cancel(a,b){return this._client.post(b7`/fine_tuning/jobs/${a}/cancel`,b)}listEvents(a,b={},c){return this._client.getAPIList(b7`/fine_tuning/jobs/${a}/events`,bQ,{query:b,...c})}pause(a,b){return this._client.post(b7`/fine_tuning/jobs/${a}/pause`,b)}resume(a,b){return this._client.post(b7`/fine_tuning/jobs/${a}/resume`,b)}}c3.Checkpoints=c2;class c4 extends b4{constructor(){super(...arguments),this.methods=new cZ(this._client),this.jobs=new c3(this._client),this.checkpoints=new c1(this._client),this.alpha=new c_(this._client)}}c4.Methods=cZ,c4.Jobs=c3,c4.Checkpoints=c1,c4.Alpha=c_;class c5 extends b4{}class c6 extends b4{constructor(){super(...arguments),this.graderModels=new c5(this._client)}}c6.GraderModels=c5;class c7 extends b4{createVariation(a,b){return this._client.post("/images/variations",bX({body:a,...b},this._client))}edit(a,b){return this._client.post("/images/edits",bX({body:a,...b,stream:a.stream??!1},this._client))}generate(a,b){return this._client.post("/images/generations",{body:a,...b,stream:a.stream??!1})}}class c8 extends b4{retrieve(a,b){return this._client.get(b7`/models/${a}`,b)}list(a){return this._client.getAPIList("/models",bP,a)}delete(a,b){return this._client.delete(b7`/models/${a}`,b)}}class c9 extends b4{create(a,b){return this._client.post("/moderations",{body:a,...b})}}class da extends b4{accept(a,b,c){return this._client.post(b7`/realtime/calls/${a}/accept`,{body:b,...c,headers:cu([{Accept:"*/*"},c?.headers])})}hangup(a,b){return this._client.post(b7`/realtime/calls/${a}/hangup`,{...b,headers:cu([{Accept:"*/*"},b?.headers])})}refer(a,b,c){return this._client.post(b7`/realtime/calls/${a}/refer`,{body:b,...c,headers:cu([{Accept:"*/*"},c?.headers])})}reject(a,b={},c){return this._client.post(b7`/realtime/calls/${a}/reject`,{body:b,...c,headers:cu([{Accept:"*/*"},c?.headers])})}}class db extends b4{create(a,b){return this._client.post("/realtime/client_secrets",{body:a,...b})}}class dc extends b4{constructor(){super(...arguments),this.clientSecrets=new db(this._client),this.calls=new da(this._client)}}function dd(a,b){let c=a.output.map(a=>{if("function_call"===a.type)return{...a,parsed_arguments:function(a,b){var c,d;let e=(c=a.tools??[],d=b.name,c.find(a=>"function"===a.type&&a.name===d));return{...b,...b,parsed_arguments:e?.$brand==="auto-parseable-tool"?e.$parseRaw(b.arguments):e?.strict?JSON.parse(b.arguments):null}}(b,a)};if("message"===a.type){let c=a.content.map(a=>{var c,d;return"output_text"===a.type?{...a,parsed:(c=b,d=a.text,c.text?.format?.type!=="json_schema"?null:"$parseRaw"in c.text?.format?(c.text?.format).$parseRaw(d):JSON.parse(d))}:a});return{...a,content:c}}return a}),d=Object.assign({},a,{output:c});return Object.getOwnPropertyDescriptor(a,"output_text")||de(d),Object.defineProperty(d,"output_parsed",{enumerable:!0,get(){for(let a of d.output)if("message"===a.type){for(let b of a.content)if("output_text"===b.type&&null!==b.parsed)return b.parsed}return null}}),d}function de(a){let b=[];for(let c of a.output)if("message"===c.type)for(let a of c.content)"output_text"===a.type&&b.push(a.text);a.output_text=b.join("")}dc.ClientSecrets=db,dc.Calls=da;class df extends ch{constructor(a){super(),av.add(this),aw.set(this,void 0),ax.set(this,void 0),ay.set(this,void 0),aO(this,aw,a,"f")}static createResponse(a,b,c){let d=new df(b);return d._run(()=>d._createOrRetrieveResponse(a,b,{...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"stream"}})),d}async _createOrRetrieveResponse(a,b,c){let d,e=c?.signal;e&&(e.aborted&&this.controller.abort(),e.addEventListener("abort",()=>this.controller.abort())),aP(this,av,"m",az).call(this);let f=null;for await(let e of("response_id"in b?(d=await a.responses.retrieve(b.response_id,{stream:!0},{...c,signal:this.controller.signal,stream:!0}),f=b.starting_after??null):d=await a.responses.create({...b,stream:!0},{...c,signal:this.controller.signal}),this._connected(),d))aP(this,av,"m",aA).call(this,e,f);if(d.controller.signal?.aborted)throw new aV;return aP(this,av,"m",aB).call(this)}[(aw=new WeakMap,ax=new WeakMap,ay=new WeakMap,av=new WeakSet,az=function(){this.ended||aO(this,ax,void 0,"f")},aA=function(a,b){if(this.ended)return;let c=(a,c)=>{(null==b||c.sequence_number>b)&&this._emit(a,c)},d=aP(this,av,"m",aC).call(this,a);switch(c("event",a),a.type){case"response.output_text.delta":{let b=d.output[a.output_index];if(!b)throw new aT(`missing output at index ${a.output_index}`);if("message"===b.type){let d=b.content[a.content_index];if(!d)throw new aT(`missing content at index ${a.content_index}`);if("output_text"!==d.type)throw new aT(`expected content to be 'output_text', got ${d.type}`);c("response.output_text.delta",{...a,snapshot:d.text})}break}case"response.function_call_arguments.delta":{let b=d.output[a.output_index];if(!b)throw new aT(`missing output at index ${a.output_index}`);"function_call"===b.type&&c("response.function_call_arguments.delta",{...a,snapshot:b.arguments});break}default:c(a.type,a)}},aB=function(){if(this.ended)throw new aT("stream has ended, this shouldn't happen");let a=aP(this,ax,"f");if(!a)throw new aT("request ended without sending any events");aO(this,ax,void 0,"f");let b=function(a,b){var c;return b&&(c=b,ca(c.text?.format))?dd(a,b):{...a,output_parsed:null,output:a.output.map(a=>"function_call"===a.type?{...a,parsed_arguments:null}:"message"===a.type?{...a,content:a.content.map(a=>({...a,parsed:null}))}:a)}}(a,aP(this,aw,"f"));return aO(this,ay,b,"f"),b},aC=function(a){let b=aP(this,ax,"f");if(!b){if("response.created"!==a.type)throw new aT(`When snapshot hasn't been set yet, expected 'response.created' event, got ${a.type}`);return aO(this,ax,a.response,"f")}switch(a.type){case"response.output_item.added":b.output.push(a.item);break;case"response.content_part.added":{let c=b.output[a.output_index];if(!c)throw new aT(`missing output at index ${a.output_index}`);let d=c.type,e=a.part;"message"===d&&"reasoning_text"!==e.type?c.content.push(e):"reasoning"===d&&"reasoning_text"===e.type&&(c.content||(c.content=[]),c.content.push(e));break}case"response.output_text.delta":{let c=b.output[a.output_index];if(!c)throw new aT(`missing output at index ${a.output_index}`);if("message"===c.type){let b=c.content[a.content_index];if(!b)throw new aT(`missing content at index ${a.content_index}`);if("output_text"!==b.type)throw new aT(`expected content to be 'output_text', got ${b.type}`);b.text+=a.delta}break}case"response.function_call_arguments.delta":{let c=b.output[a.output_index];if(!c)throw new aT(`missing output at index ${a.output_index}`);"function_call"===c.type&&(c.arguments+=a.delta);break}case"response.reasoning_text.delta":{let c=b.output[a.output_index];if(!c)throw new aT(`missing output at index ${a.output_index}`);if("reasoning"===c.type){let b=c.content?.[a.content_index];if(!b)throw new aT(`missing content at index ${a.content_index}`);if("reasoning_text"!==b.type)throw new aT(`expected content to be 'reasoning_text', got ${b.type}`);b.text+=a.delta}break}case"response.completed":aO(this,ax,a.response,"f")}return b},Symbol.asyncIterator)](){let a=[],b=[],c=!1;return this.on("event",c=>{let d=b.shift();d?d.resolve(c):a.push(c)}),this.on("end",()=>{for(let a of(c=!0,b))a.resolve(void 0);b.length=0}),this.on("abort",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),this.on("error",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:c?{value:void 0,done:!0}:new Promise((a,c)=>b.push({resolve:a,reject:c})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let a=aP(this,ay,"f");if(!a)throw new aT("stream ended without producing a ChatCompletion");return a}}class dg extends b4{list(a,b={},c){return this._client.getAPIList(b7`/responses/${a}/input_items`,bQ,{query:b,...c})}}class dh extends b4{constructor(){super(...arguments),this.inputItems=new dg(this._client)}create(a,b){return this._client.post("/responses",{body:a,...b,stream:a.stream??!1})._thenUnwrap(a=>("object"in a&&"response"===a.object&&de(a),a))}retrieve(a,b={},c){return this._client.get(b7`/responses/${a}`,{query:b,...c,stream:b?.stream??!1})._thenUnwrap(a=>("object"in a&&"response"===a.object&&de(a),a))}delete(a,b){return this._client.delete(b7`/responses/${a}`,{...b,headers:cu([{Accept:"*/*"},b?.headers])})}parse(a,b){return this._client.responses.create(a,b)._thenUnwrap(b=>dd(b,a))}stream(a,b){return df.createResponse(this._client,a,b)}cancel(a,b){return this._client.post(b7`/responses/${a}/cancel`,b)}}dh.InputItems=dg;class di extends b4{create(a,b,c){return this._client.post(b7`/uploads/${a}/parts`,bX({body:b,...c},this._client))}}class dj extends b4{constructor(){super(...arguments),this.parts=new di(this._client)}create(a,b){return this._client.post("/uploads",{body:a,...b})}cancel(a,b){return this._client.post(b7`/uploads/${a}/cancel`,b)}complete(a,b,c){return this._client.post(b7`/uploads/${a}/complete`,{body:b,...c})}}dj.Parts=di;let dk=async a=>{let b=await Promise.allSettled(a),c=b.filter(a=>"rejected"===a.status);if(c.length){for(let a of c)console.error(a.reason);throw Error(`${c.length} promise(s) failed - see the above errors`)}let d=[];for(let a of b)"fulfilled"===a.status&&d.push(a.value);return d};class dl extends b4{create(a,b,c){return this._client.post(b7`/vector_stores/${a}/file_batches`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}retrieve(a,b,c){let{vector_store_id:d}=b;return this._client.get(b7`/vector_stores/${d}/file_batches/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}cancel(a,b,c){let{vector_store_id:d}=b;return this._client.post(b7`/vector_stores/${d}/file_batches/${a}/cancel`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}async createAndPoll(a,b,c){let d=await this.create(a,b);return await this.poll(a,d.id,c)}listFiles(a,b,c){let{vector_store_id:d,...e}=b;return this._client.getAPIList(b7`/vector_stores/${d}/file_batches/${a}/files`,bQ,{query:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}async poll(a,b,c){let d=cu([c?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":c?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:e,response:f}=await this.retrieve(b,{vector_store_id:a},{...c,headers:d}).withResponse();switch(e.status){case"in_progress":let g=5e3;if(c?.pollIntervalMs)g=c.pollIntervalMs;else{let a=f.headers.get("openai-poll-after-ms");if(a){let b=parseInt(a);isNaN(b)||(g=b)}}await bc(g);break;case"failed":case"cancelled":case"completed":return e}}}async uploadAndPoll(a,{files:b,fileIds:c=[]},d){if(null==b||0==b.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let e=Math.min(d?.maxConcurrency??5,b.length),f=this._client,g=b.values(),h=[...c];async function i(a){for(let b of a){let a=await f.files.create({file:b,purpose:"assistants"},d);h.push(a.id)}}let j=Array(e).fill(g).map(i);return await dk(j),await this.createAndPoll(a,{file_ids:h})}}class dm extends b4{create(a,b,c){return this._client.post(b7`/vector_stores/${a}/files`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}retrieve(a,b,c){let{vector_store_id:d}=b;return this._client.get(b7`/vector_stores/${d}/files/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}update(a,b,c){let{vector_store_id:d,...e}=b;return this._client.post(b7`/vector_stores/${d}/files/${a}`,{body:e,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a,b={},c){return this._client.getAPIList(b7`/vector_stores/${a}/files`,bQ,{query:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}delete(a,b,c){let{vector_store_id:d}=b;return this._client.delete(b7`/vector_stores/${d}/files/${a}`,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}async createAndPoll(a,b,c){let d=await this.create(a,b,c);return await this.poll(a,d.id,c)}async poll(a,b,c){let d=cu([c?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":c?.pollIntervalMs?.toString()??void 0}]);for(;;){let e=await this.retrieve(b,{vector_store_id:a},{...c,headers:d}).withResponse(),f=e.data;switch(f.status){case"in_progress":let g=5e3;if(c?.pollIntervalMs)g=c.pollIntervalMs;else{let a=e.response.headers.get("openai-poll-after-ms");if(a){let b=parseInt(a);isNaN(b)||(g=b)}}await bc(g);break;case"failed":case"completed":return f}}}async upload(a,b,c){let d=await this._client.files.create({file:b,purpose:"assistants"},c);return this.create(a,{file_id:d.id},c)}async uploadAndPoll(a,b,c){let d=await this.upload(a,b,c);return await this.poll(a,d.id,c)}content(a,b,c){let{vector_store_id:d}=b;return this._client.getAPIList(b7`/vector_stores/${d}/files/${a}/content`,bP,{...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}}class dn extends b4{constructor(){super(...arguments),this.files=new dm(this._client),this.fileBatches=new dl(this._client)}create(a,b){return this._client.post("/vector_stores",{body:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}retrieve(a,b){return this._client.get(b7`/vector_stores/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}update(a,b,c){return this._client.post(b7`/vector_stores/${a}`,{body:b,...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}list(a={},b){return this._client.getAPIList("/vector_stores",bQ,{query:a,...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}delete(a,b){return this._client.delete(b7`/vector_stores/${a}`,{...b,headers:cu([{"OpenAI-Beta":"assistants=v2"},b?.headers])})}search(a,b,c){return this._client.getAPIList(b7`/vector_stores/${a}/search`,bP,{body:b,method:"post",...c,headers:cu([{"OpenAI-Beta":"assistants=v2"},c?.headers])})}}dn.Files=dm,dn.FileBatches=dl;class dp extends b4{create(a,b){return this._client.post("/videos",bW({body:a,...b},this._client))}retrieve(a,b){return this._client.get(b7`/videos/${a}`,b)}list(a={},b){return this._client.getAPIList("/videos",bR,{query:a,...b})}delete(a,b){return this._client.delete(b7`/videos/${a}`,b)}downloadContent(a,b={},c){return this._client.get(b7`/videos/${a}/content`,{query:b,...c,headers:cu([{Accept:"application/binary"},c?.headers]),__binaryResponse:!0})}remix(a,b,c){return this._client.post(b7`/videos/${a}/remix`,bW({body:b,...c},this._client))}}class dq extends b4{constructor(){super(...arguments),aD.add(this)}async unwrap(a,b,c=this._client.webhookSecret,d=300){return await this.verifySignature(a,b,c,d),JSON.parse(a)}async verifySignature(a,b,c=this._client.webhookSecret,d=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");aP(this,aD,"m",aE).call(this,c);let e=cu([b]).values,f=aP(this,aD,"m",aF).call(this,e,"webhook-signature"),g=aP(this,aD,"m",aF).call(this,e,"webhook-timestamp"),h=aP(this,aD,"m",aF).call(this,e,"webhook-id"),i=parseInt(g,10);if(isNaN(i))throw new a6("Invalid webhook timestamp format");let j=Math.floor(Date.now()/1e3);if(j-i>d)throw new a6("Webhook timestamp is too old");if(i>j+d)throw new a6("Webhook timestamp is too new");let k=f.split(" ").map(a=>a.startsWith("v1,")?a.substring(3):a),l=c.startsWith("whsec_")?Buffer.from(c.replace("whsec_",""),"base64"):Buffer.from(c,"utf-8"),m=h?`${h}.${g}.${a}`:`${g}.${a}`,n=await crypto.subtle.importKey("raw",l,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let a of k)try{let b=Buffer.from(a,"base64");if(await crypto.subtle.verify("HMAC",n,b,new TextEncoder().encode(m)))return}catch{continue}throw new a6("The given webhook signature does not match the expected signature")}}aD=new WeakSet,aE=function(a){if("string"!=typeof a||0===a.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},aF=function(a,b){if(!a)throw Error("Headers are required");let c=a.get(b);if(null==c)throw Error(`Missing required header: ${b}`);return c};class dr{constructor({baseURL:a=cJ("OPENAI_BASE_URL"),apiKey:b=cJ("OPENAI_API_KEY"),organization:c=cJ("OPENAI_ORG_ID")??null,project:d=cJ("OPENAI_PROJECT_ID")??null,webhookSecret:e=cJ("OPENAI_WEBHOOK_SECRET")??null,...f}={}){if(aG.add(this),aI.set(this,void 0),this.completions=new cO(this),this.chat=new cs(this),this.embeddings=new cU(this),this.files=new cY(this),this.images=new c7(this),this.audio=new cy(this),this.moderations=new c9(this),this.models=new c8(this),this.fineTuning=new c4(this),this.graders=new c6(this),this.vectorStores=new dn(this),this.webhooks=new dq(this),this.beta=new cN(this),this.batches=new cz(this),this.uploads=new dj(this),this.responses=new dh(this),this.realtime=new dc(this),this.conversations=new cT(this),this.evals=new cX(this),this.containers=new cR(this),this.videos=new dp(this),void 0===b)throw new aT("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");let g={apiKey:b,organization:c,project:d,webhookSecret:e,...f,baseURL:a||"https://api.openai.com/v1"};if(!g.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new aT("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=g.baseURL,this.timeout=g.timeout??aH.DEFAULT_TIMEOUT,this.logger=g.logger??console;let h="warn";this.logLevel=h,this.logLevel=bz(g.logLevel,"ClientOptions.logLevel",this)??bz(cJ("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??h,this.fetchOptions=g.fetchOptions,this.maxRetries=g.maxRetries??2,this.fetch=g.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),aO(this,aI,bk,"f"),this._options=g,this.apiKey="string"==typeof b?b:"Missing Key",this.organization=c,this.project=d,this.webhookSecret=e}withOptions(a){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...a})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:b}){}async authHeaders(a){return cu([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(a){return function(a,b={}){let c,d=a,e=function(a=bt){let b;if(void 0!==a.allowEmptyArrays&&"boolean"!=typeof a.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==a.encodeDotInKeys&&"boolean"!=typeof a.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==a.encoder&&void 0!==a.encoder&&"function"!=typeof a.encoder)throw TypeError("Encoder has to be a function.");let c=a.charset||bt.charset;if(void 0!==a.charset&&"utf-8"!==a.charset&&"iso-8859-1"!==a.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let d=bl;if(void 0!==a.format){if(!bo(bn,a.format))throw TypeError("Unknown format option provided.");d=a.format}let e=bn[d],f=bt.filter;if(("function"==typeof a.filter||a8(a.filter))&&(f=a.filter),b=a.arrayFormat&&a.arrayFormat in br?a.arrayFormat:"indices"in a?a.indices?"indices":"repeat":bt.arrayFormat,"commaRoundTrip"in a&&"boolean"!=typeof a.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let g=void 0===a.allowDots?!0==!!a.encodeDotInKeys||bt.allowDots:!!a.allowDots;return{addQueryPrefix:"boolean"==typeof a.addQueryPrefix?a.addQueryPrefix:bt.addQueryPrefix,allowDots:g,allowEmptyArrays:"boolean"==typeof a.allowEmptyArrays?!!a.allowEmptyArrays:bt.allowEmptyArrays,arrayFormat:b,charset:c,charsetSentinel:"boolean"==typeof a.charsetSentinel?a.charsetSentinel:bt.charsetSentinel,commaRoundTrip:!!a.commaRoundTrip,delimiter:void 0===a.delimiter?bt.delimiter:a.delimiter,encode:"boolean"==typeof a.encode?a.encode:bt.encode,encodeDotInKeys:"boolean"==typeof a.encodeDotInKeys?a.encodeDotInKeys:bt.encodeDotInKeys,encoder:"function"==typeof a.encoder?a.encoder:bt.encoder,encodeValuesOnly:"boolean"==typeof a.encodeValuesOnly?a.encodeValuesOnly:bt.encodeValuesOnly,filter:f,format:d,formatter:e,serializeDate:"function"==typeof a.serializeDate?a.serializeDate:bt.serializeDate,skipNulls:"boolean"==typeof a.skipNulls?a.skipNulls:bt.skipNulls,sort:"function"==typeof a.sort?a.sort:null,strictNullHandling:"boolean"==typeof a.strictNullHandling?a.strictNullHandling:bt.strictNullHandling}}(b);"function"==typeof e.filter?d=(0,e.filter)("",d):a8(e.filter)&&(c=e.filter);let f=[];if("object"!=typeof d||null===d)return"";let g=br[e.arrayFormat],h="comma"===g&&e.commaRoundTrip;c||(c=Object.keys(d)),e.sort&&c.sort(e.sort);let i=new WeakMap;for(let a=0;a<c.length;++a){let b=c[a];e.skipNulls&&null===d[b]||bs(f,function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t,u;let v,w=b,x=s,y=0,z=!1;for(;void 0!==(x=x.get(bu))&&!z;){let a=x.get(b);if(y+=1,void 0!==a)if(a===y)throw RangeError("Cyclic object value");else z=!0;void 0===x.get(bu)&&(y=0)}if("function"==typeof k?w=k(c,w):w instanceof Date?w=n?.(w):"comma"===d&&a8(w)&&(w=bq(w,function(a){return a instanceof Date?n?.(a):a})),null===w){if(g)return j&&!q?j(c,bt.encoder,r,"key",o):c;w=""}if("string"==typeof(t=w)||"number"==typeof t||"boolean"==typeof t||"symbol"==typeof t||"bigint"==typeof t||(u=w)&&"object"==typeof u&&u.constructor&&u.constructor.isBuffer&&u.constructor.isBuffer(u)){if(j){let a=q?c:j(c,bt.encoder,r,"key",o);return[p?.(a)+"="+p?.(j(w,bt.encoder,r,"value",o))]}return[p?.(c)+"="+p?.(String(w))]}let A=[];if(void 0===w)return A;if("comma"===d&&a8(w))q&&j&&(w=bq(w,j)),v=[{value:w.length>0?w.join(",")||null:void 0}];else if(a8(k))v=k;else{let a=Object.keys(w);v=l?a.sort(l):a}let B=i?String(c).replace(/\./g,"%2E"):String(c),C=e&&a8(w)&&1===w.length?B+"[]":B;if(f&&a8(w)&&0===w.length)return C+"[]";for(let c=0;c<v.length;++c){let t=v[c],u="object"==typeof t&&void 0!==t.value?t.value:w[t];if(h&&null===u)continue;let x=m&&i?t.replace(/\./g,"%2E"):t,z=a8(w)?"function"==typeof d?d(C,x):C:C+(m?"."+x:"["+x+"]");s.set(b,y);let B=new WeakMap;B.set(bu,s),bs(A,a(u,z,d,e,f,g,h,i,"comma"===d&&q&&a8(w)?null:j,k,l,m,n,o,p,q,r,B))}return A}(d[b],b,g,h,e.allowEmptyArrays,e.strictNullHandling,e.skipNulls,e.encodeDotInKeys,e.encode?e.encoder:null,e.filter,e.sort,e.allowDots,e.serializeDate,e.format,e.formatter,e.encodeValuesOnly,e.charset,i))}let j=f.join(e.delimiter),k=!0===e.addQueryPrefix?"?":"";return e.charsetSentinel&&("iso-8859-1"===e.charset?k+="utf8=%26%2310003%3B&":k+="utf8=%E2%9C%93&"),j.length>0?k+j:""}(a,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${bd}`}defaultIdempotencyKey(){return`stainless-node-retry-${aQ()}`}makeStatusError(a,b,c,d){return aU.generate(a,b,c,d)}async _callApiKey(){let a,b=this._options.apiKey;if("function"!=typeof b)return!1;try{a=await b()}catch(a){if(a instanceof aT)throw a;throw new aT(`Failed to get token from 'apiKey' function: ${a.message}`,{cause:a})}if("string"!=typeof a||!a)throw new aT(`Expected 'apiKey' function argument to return a string but it returned ${a}`);return this.apiKey=a,!0}buildURL(a,b,c){let d=!aP(this,aG,"m",aJ).call(this)&&c||this.baseURL,e=new URL(a7.test(a)?a:d+(d.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return!function(a){if(!a)return!0;for(let b in a)return!1;return!0}(f)&&(b={...f,...b}),"object"==typeof b&&b&&!Array.isArray(b)&&(e.search=this.stringifyQuery(b)),e.toString()}async prepareOptions(a){await this._callApiKey()}async prepareRequest(a,{url:b,options:c}){}get(a,b){return this.methodRequest("get",a,b)}post(a,b){return this.methodRequest("post",a,b)}patch(a,b){return this.methodRequest("patch",a,b)}put(a,b){return this.methodRequest("put",a,b)}delete(a,b){return this.methodRequest("delete",a,b)}methodRequest(a,b,c){return this.request(Promise.resolve(c).then(c=>({method:a,path:b,...c})))}request(a,b=null){return new bM(this,this.makeRequest(a,b,void 0))}async makeRequest(a,b,c){let d=await a,e=d.maxRetries??this.maxRetries;null==b&&(b=e),await this.prepareOptions(d);let{req:f,url:g,timeout:h}=await this.buildRequest(d,{retryCount:e-b});await this.prepareRequest(f,{url:g,options:d});let i="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),j=void 0===c?"":`, retryOf: ${c}`,k=Date.now();if(bE(this).debug(`[${i}] sending request`,bF({retryOfRequestLogID:c,method:d.method,url:g,options:d,headers:f.headers})),d.signal?.aborted)throw new aV;let l=new AbortController,m=await this.fetchWithTimeout(g,f,h,l).catch(aS),n=Date.now();if(m instanceof globalThis.Error){let a=`retrying, ${b} attempts remaining`;if(d.signal?.aborted)throw new aV;let e=aR(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(b)return bE(this).info(`[${i}] connection ${e?"timed out":"failed"} - ${a}`),bE(this).debug(`[${i}] connection ${e?"timed out":"failed"} (${a})`,bF({retryOfRequestLogID:c,url:g,durationMs:n-k,message:m.message})),this.retryRequest(d,b,c??i);if(bE(this).info(`[${i}] connection ${e?"timed out":"failed"} - error; no more retries left`),bE(this).debug(`[${i}] connection ${e?"timed out":"failed"} (error; no more retries left)`,bF({retryOfRequestLogID:c,url:g,durationMs:n-k,message:m.message})),e)throw new aX;throw new aW({cause:m})}let o=[...m.headers.entries()].filter(([a])=>"x-request-id"===a).map(([a,b])=>", "+a+": "+JSON.stringify(b)).join(""),p=`[${i}${j}${o}] ${f.method} ${g} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${n-k}ms`;if(!m.ok){let a=await this.shouldRetry(m);if(b&&a){let a=`retrying, ${b} attempts remaining`;return await bj(m.body),bE(this).info(`${p} - ${a}`),bE(this).debug(`[${i}] response error (${a})`,bF({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,durationMs:n-k})),this.retryRequest(d,b,c??i,m.headers)}let e=a?"error; no more retries left":"error; not retryable";bE(this).info(`${p} - ${e}`);let f=await m.text().catch(a=>aS(a).message),g=(a=>{try{return JSON.parse(a)}catch(a){return}})(f),h=g?void 0:f;throw bE(this).debug(`[${i}] response error (${e})`,bF({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,message:h,durationMs:Date.now()-k})),this.makeStatusError(m.status,g,h,m.headers)}return bE(this).info(p),bE(this).debug(`[${i}] response start`,bF({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,durationMs:n-k})),{response:m,options:d,controller:l,requestLogID:i,retryOfRequestLogID:c,startTime:k}}getAPIList(a,b,c){return this.requestAPIList(b,{method:"get",path:a,...c})}requestAPIList(a,b){return new bO(this,this.makeRequest(b,null,void 0),a)}async fetchWithTimeout(a,b,c,d){let{signal:e,method:f,...g}=b||{};e&&e.addEventListener("abort",()=>d.abort());let h=setTimeout(()=>d.abort(),c),i=globalThis.ReadableStream&&g.body instanceof globalThis.ReadableStream||"object"==typeof g.body&&null!==g.body&&Symbol.asyncIterator in g.body,j={signal:d.signal,...i?{duplex:"half"}:{},method:"GET",...g};f&&(j.method=f.toUpperCase());try{return await this.fetch.call(void 0,a,j)}finally{clearTimeout(h)}}async shouldRetry(a){let b=a.headers.get("x-should-retry");return"true"===b||"false"!==b&&(408===a.status||409===a.status||429===a.status||!!(a.status>=500))}async retryRequest(a,b,c,d){let e,f=d?.get("retry-after-ms");if(f){let a=parseFloat(f);Number.isNaN(a)||(e=a)}let g=d?.get("retry-after");if(g&&!e){let a=parseFloat(g);e=Number.isNaN(a)?Date.parse(g)-Date.now():1e3*a}if(!(e&&0<=e&&e<6e4)){let c=a.maxRetries??this.maxRetries;e=this.calculateDefaultRetryTimeoutMillis(b,c)}return await bc(e),this.makeRequest(a,b-1,c)}calculateDefaultRetryTimeoutMillis(a,b){return Math.min(.5*Math.pow(2,b-a),8)*(1-.25*Math.random())*1e3}async buildRequest(a,{retryCount:b=0}={}){let c={...a},{method:d,path:e,query:f,defaultBaseURL:g}=c,h=this.buildURL(e,f,g);"timeout"in c&&((a,b)=>{if("number"!=typeof b||!Number.isInteger(b))throw new aT(`${a} must be an integer`);if(b<0)throw new aT(`${a} must be a positive integer`)})("timeout",c.timeout),c.timeout=c.timeout??this.timeout;let{bodyHeaders:i,body:j}=this.buildBody({options:c}),k=await this.buildHeaders({options:a,method:d,bodyHeaders:i,retryCount:b});return{req:{method:d,headers:k,...c.signal&&{signal:c.signal},...globalThis.ReadableStream&&j instanceof globalThis.ReadableStream&&{duplex:"half"},...j&&{body:j},...this.fetchOptions??{},...c.fetchOptions??{}},url:h,timeout:c.timeout}}async buildHeaders({options:a,method:b,bodyHeaders:c,retryCount:e}){let f={};this.idempotencyHeader&&"get"!==b&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),f[this.idempotencyHeader]=a.idempotencyKey);let g=cu([f,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(e),...a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{},...d??(d=(()=>{let a="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===a)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bd,"X-Stainless-OS":bf(Deno.build.os),"X-Stainless-Arch":be(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===a)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bd,"X-Stainless-OS":bf(globalThis.process.platform??"unknown"),"X-Stainless-Arch":be(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let b=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:a,pattern:b}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let c=b.exec(navigator.userAgent);if(c){let b=c[1]||0,d=c[2]||0,e=c[3]||0;return{browser:a,version:`${b}.${d}.${e}`}}}return null}();return b?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${b.browser}`,"X-Stainless-Runtime-Version":b.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(a),this._options.defaultHeaders,c,a.headers]);return this.validateHeaders(g),g.values}buildBody({options:{body:a,headers:b}}){if(!a)return{bodyHeaders:void 0,body:void 0};let c=cu([b]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||"string"==typeof a&&c.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:"object"==typeof a&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&"function"==typeof a.next)?{bodyHeaders:void 0,body:bh(a)}:aP(this,aI,"f").call(this,{body:a,headers:c})}}aH=dr,aI=new WeakMap,aG=new WeakSet,aJ=function(){return"https://api.openai.com/v1"!==this.baseURL},dr.OpenAI=aH,dr.DEFAULT_TIMEOUT=6e5,dr.OpenAIError=aT,dr.APIError=aU,dr.APIConnectionError=aW,dr.APIConnectionTimeoutError=aX,dr.APIUserAbortError=aV,dr.NotFoundError=a_,dr.ConflictError=a0,dr.RateLimitError=a2,dr.BadRequestError=aY,dr.AuthenticationError=aZ,dr.InternalServerError=a3,dr.PermissionDeniedError=a$,dr.UnprocessableEntityError=a1,dr.InvalidWebhookSignatureError=a6,dr.toFile=b2,dr.Completions=cO,dr.Chat=cs,dr.Embeddings=cU,dr.Files=cY,dr.Images=c7,dr.Audio=cy,dr.Moderations=c9,dr.Models=c8,dr.FineTuning=c4,dr.Graders=c6,dr.VectorStores=dn,dr.Webhooks=dq,dr.Beta=cN,dr.Batches=cz,dr.Uploads=dj,dr.Responses=dh,dr.Realtime=dc,dr.Conversations=cT,dr.Evals=cX,dr.Containers=cR,dr.Videos=dp;class ds extends dr{constructor({baseURL:a=cJ("OPENAI_BASE_URL"),apiKey:b=cJ("AZURE_OPENAI_API_KEY"),apiVersion:c=cJ("OPENAI_API_VERSION"),endpoint:d,deployment:e,azureADTokenProvider:f,dangerouslyAllowBrowser:g,...h}={}){if(!c)throw new aT("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if("function"==typeof f&&(g=!0),!f&&!b)throw new aT("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(f&&b)throw new aT("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(h.defaultQuery={...h.defaultQuery,"api-version":c},a){if(d)throw new aT("baseURL and endpoint are mutually exclusive")}else{if(d||(d=process.env.AZURE_OPENAI_ENDPOINT),!d)throw new aT("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");a=`${d}/openai`}super({apiKey:f??b,baseURL:a,...h,...void 0!==g?{dangerouslyAllowBrowser:g}:{}}),this.apiVersion="",this.apiVersion=c,this.deploymentName=e}async buildRequest(a,b={}){if(dt.has(a.path)&&"post"===a.method&&void 0!==a.body){if(!bb(a.body))throw Error("Expected request body to be an object");let b=this.deploymentName||a.body.model||a.__metadata?.model;void 0===b||this.baseURL.includes("/deployments")||(a.path=`/deployments/${b}${a.path}`)}return super.buildRequest(a,b)}async authHeaders(a){return"string"==typeof this._options.apiKey?cu([{"api-key":this.apiKey}]):super.authHeaders(a)}}let dt=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations","/batches","/images/edits"]),du="4.13.0",dv="04b07795-8ddb-461a-bbee-02f9e1bf7b46";!function(a){a.AzureChina="https://login.chinacloudapi.cn",a.AzureGermany="https://login.microsoftonline.de",a.AzureGovernment="https://login.microsoftonline.us",a.AzurePublicCloud="https://login.microsoftonline.com"}(aK||(aK={}));let dw=aK.AzurePublicCloud,dx=["*"],dy={missing:(a,b,c)=>`${a} was requested, but no plugin was configured or no authentication record was found. You must install the ${b} plugin package (npm install --save ${b}) and enable it by importing \`useIdentityPlugin\` from \`@azure/identity\` and calling useIdentityPlugin(${c}) before using enableBroker.`,unavailable:(a,b)=>`${a} was requested, and the plugin is configured, but the broker is unavailable. Ensure the ${a} plugin is properly installed and configured. Check for missing native dependencies and ensure the package is properly installed. See the README for prerequisites on installing and using ${b}.`},dz={vsCode:{credentialName:"Visual Studio Code Credential",packageName:"@azure/identity-vscode",pluginVar:"vsCodePlugin",get brokerInfo(){return m}},native:{credentialName:"Broker for WAM",packageName:"@azure/identity-broker",pluginVar:"nativeBrokerPlugin",get brokerInfo(){return k}}},dA={generatePluginConfiguration:function(a){let b={cache:{},broker:{...a.brokerOptions,isEnabled:a.brokerOptions?.enabled??!1,enableMsaPassthrough:a.brokerOptions?.legacyEnableMsaPassthrough??!1}};if(a.tokenCachePersistenceOptions?.enabled){if(void 0===j)throw Error("Persistent token caching was requested, but no persistence provider was configured. You must install the identity-cache-persistence plugin package (`npm install --save @azure/identity-cache-persistence`) and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling `useIdentityPlugin(cachePersistencePlugin)` before using `tokenCachePersistenceOptions`.");let c=a.tokenCachePersistenceOptions.name||"msal.cache";b.cache.cachePlugin=j({name:`${c}.nocae`,...a.tokenCachePersistenceOptions}),b.cache.cachePluginCae=j({name:`${c}.cae`,...a.tokenCachePersistenceOptions})}return a.brokerOptions?.enabled&&(b.broker.nativeBrokerPlugin=function(a){let{credentialName:b,packageName:c,pluginVar:d,brokerInfo:e}=dz[a?"vsCode":"native"];if(void 0===e)throw Error(dy.missing(b,c,d));if(!1===e.broker.isBrokerAvailable)throw Error(dy.unavailable(b,c));return e.broker}(a.isVSCodeCredential||!1)),b}};class dB extends Error{constructor(a,b){super(a,b),this.name="CredentialUnavailableError"}}let dC="AuthenticationError";class dD extends Error{statusCode;errorResponse;constructor(a,b,c){let d={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(function(a){return a&&"string"==typeof a.error&&"string"==typeof a.error_description}(b))d=dF(b);else if("string"==typeof b)try{let a=JSON.parse(b);d=dF(a)}catch(c){d=400===a?{error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${b}`}:{error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${b}`}}else d={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${d.error} Status code: ${a}
More details:
${d.errorDescription},`,c),this.statusCode=a,this.errorResponse=d,this.name=dC}}class dE extends Error{errors;constructor(a,b){super(`${b}
${a.join("\n")}`),this.errors=a,this.name="AggregateAuthenticationError"}}function dF(a){return{error:a.error,errorDescription:a.error_description,correlationId:a.correlation_id,errorCodes:a.error_codes,timestamp:a.timestamp,traceId:a.trace_id}}class dG extends Error{scopes;getTokenOptions;constructor(a){super(a.message,a.cause?{cause:a.cause}:void 0),this.scopes=a.scopes,this.getTokenOptions=a.getTokenOptions,this.name="AuthenticationRequiredError"}}var dH=c(48161),dI=c(57975),dJ=c(1708);let dK="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,dL=[],dM=[],dN=[];dK&&dP(dK);let dO=Object.assign(a=>dS(a),{enable:dP,enabled:dQ,disable:function(){let a=h||"";return dP(""),a},log:function(a,...b){dJ.stderr.write(`${dI.format(a,...b)}${dH.EOL}`)}});function dP(a){for(let b of(h=a,dL=[],dM=[],a.split(",").map(a=>a.trim())))b.startsWith("-")?dM.push(b.substring(1)):dL.push(b);for(let a of dN)a.enabled=dQ(a.namespace)}function dQ(a){if(a.endsWith("*"))return!0;for(let b of dM)if(dR(a,b))return!1;for(let b of dL)if(dR(a,b))return!0;return!1}function dR(a,b){if(-1===b.indexOf("*"))return a===b;let c=b;if(-1!==b.indexOf("**")){let a=[],d="";for(let c of b)if("*"===c&&"*"===d)continue;else d=c,a.push(c);c=a.join("")}let d=0,e=0,f=c.length,g=a.length,h=-1,i=-1;for(;d<g&&e<f;)if("*"===c[e]){if(h=e,++e===f)return!0;for(;a[d]!==c[e];)if(++d===g)return!1;i=d,d++,e++;continue}else if(c[e]===a[d])e++,d++;else{if(!(h>=0)||(e=h+1,(d=i+1)===g))return!1;for(;a[d]!==c[e];)if(++d===g)return!1;i=d,d++,e++;continue}let j=d===a.length,k=e===c.length,l=e===c.length-1&&"*"===c[e];return j&&(k||l)}function dS(a){let b=Object.assign(function(...c){b.enabled&&(c.length>0&&(c[0]=`${a} ${c[0]}`),b.log(...c))},{enabled:dQ(a),destroy:dT,log:dO.log,namespace:a,extend:dU});return dN.push(b),b}function dT(){let a=dN.indexOf(this);return a>=0&&(dN.splice(a,1),!0)}function dU(a){let b=dS(`${this.namespace}:${a}`);return b.log=this.log,b}let dV=["verbose","info","warning","error"],dW={verbose:400,info:300,warning:200,error:100};function dX(a,b){b.log=(...b)=>{a.log(...b)}}function dY(a){return dV.includes(a)}function dZ(a){let b,c=new Set,d="undefined"!=typeof process&&process.env&&process.env[a.logLevelEnvVarName]||void 0,e=dO(a.namespace);function f(a){if(a&&!dY(a))throw Error(`Unknown log level '${a}'. Acceptable values: ${dV.join(",")}`);b=a;let d=[];for(let a of c)g(a)&&d.push(a.namespace);dO.enable(d.join(","))}function g(a){return!!(b&&dW[a.level]<=dW[b])}function h(a,b){let d=Object.assign(a.extend(b),{level:b});if(dX(a,d),g(d)){let a=dO.disable();dO.enable(a+","+d.namespace)}return c.add(d),d}return e.log=(...a)=>{dO.log(...a)},d&&(dY(d)?f(d):console.error(`${a.logLevelEnvVarName} set to unknown log level '${d}'; logging is not enabled. Acceptable values: ${dV.join(", ")}.`)),{setLogLevel:f,getLogLevel:function(){return b},createClientLogger:function(a){let b=e.extend(a);return dX(e,b),{error:h(b,"error"),warning:h(b,"warning"),info:h(b,"info"),verbose:h(b,"verbose")}},logger:e}}let d$=dZ({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});function d_(a){return d$.createClientLogger(a)}d$.logger;let d0=dZ({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function d1(){return d0.getLogLevel()}function d2(a){return d0.createClientLogger(a)}d0.logger;let d3=d2("identity");function d4(a){return a.reduce((a,b)=>(process.env[b]?a.assigned.push(b):a.missing.push(b),a),{missing:[],assigned:[]})}function d5(a){return`SUCCESS. Scopes: ${Array.isArray(a)?a.join(", "):a}.`}function d6(a,b){let c="ERROR.";return a?.length&&(c+=` Scopes: ${Array.isArray(a)?a.join(", "):a}.`),`${c} Error message: ${"string"==typeof b?b:b.message}.`}function d7(a,b,c=d3){let d=b?`${b.fullTitle} ${a}`:a;return{title:a,fullTitle:d,info:function(a){c.info(`${d} =>`,a)},warning:function(a){c.warning(`${d} =>`,a)},verbose:function(a){c.verbose(`${d} =>`,a)},error:function(a){c.error(`${d} =>`,a)}}}function d8(a,b=d3){let c=d7(a,void 0,b);return{...c,parent:b,getToken:d7("=> getToken()",c,b)}}let d9={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};class ea{_contextMap;constructor(a){this._contextMap=a instanceof ea?new Map(a._contextMap):new Map}setValue(a,b){let c=new ea(this);return c._contextMap.set(a,b),c}getValue(a){return this._contextMap.get(a)}deleteValue(a){let b=new ea(this);return b._contextMap.delete(a),b}}let eb=c(67649).w;function ec(){return eb.instrumenterImplementation||(eb.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(a,b)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}},tracingContext:function(a={}){let b=new ea(a.parentContext);return a.span&&(b=b.setValue(d9.span,a.span)),a.namespace&&(b=b.setValue(d9.namespace,a.namespace)),b}({parentContext:b.tracingContext})}),withContext:(a,b,...c)=>b(...c)}),eb.instrumenterImplementation}function ed(a){let{namespace:b,packageName:c,packageVersion:d}=a;function e(a,e,f){let g=ec().startSpan(a,{...f,packageName:c,packageVersion:d,tracingContext:e?.tracingOptions?.tracingContext}),h=g.tracingContext,i=g.span;return h.getValue(d9.namespace)||(h=h.setValue(d9.namespace,b)),i.setAttribute("az.namespace",h.getValue(d9.namespace)),{span:i,updatedOptions:Object.assign({},e,{tracingOptions:{...e?.tracingOptions,tracingContext:h}})}}async function f(a,b,c,d){let{span:f,updatedOptions:h}=e(a,b,d);try{let a=await g(h.tracingOptions.tracingContext,()=>Promise.resolve(c(h,f)));return f.setStatus({status:"success"}),a}catch(a){throw f.setStatus({status:"error",error:a}),a}finally{f.end()}}function g(a,b,...c){return ec().withContext(a,b,...c)}return{startSpan:e,withSpan:f,withContext:g,parseTraceparentHeader:function(a){return ec().parseTraceparentHeader(a)},createRequestHeaders:function(a){return ec().createRequestHeaders(a)}}}let ee=ed({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:du}),ef=d8("ChainedTokenCredential");class eg{_sources=[];constructor(...a){this._sources=a}async getToken(a,b={}){let{token:c}=await this.getTokenInternal(a,b);return c}async getTokenInternal(a,b={}){let c,d=null,e=[];return ee.withSpan("ChainedTokenCredential.getToken",b,async b=>{for(let f=0;f<this._sources.length&&null===d;f++)try{d=await this._sources[f].getToken(a,b),c=this._sources[f]}catch(b){if("CredentialUnavailableError"===b.name||"AuthenticationRequiredError"===b.name)e.push(b);else throw ef.getToken.info(d6(a,b)),b}if(!d&&e.length>0){let b=new dE(e,"ChainedTokenCredential authentication failed.");throw ef.getToken.info(d6(a,b)),b}if(ef.getToken.info(`Result for ${c.constructor.name}: ${d5(a)}`),null===d)throw new dB("Failed to retrieve a valid token");return{token:d,successfulCredential:c}})}}let eh={SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],INVALID_INSTANCE:"invalid_instance"},ei={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599},ej=[eh.OPENID_SCOPE,eh.PROFILE_SCOPE,eh.OFFLINE_ACCESS_SCOPE],ek=[...ej,eh.EMAIL_SCOPE],el={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},em={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},en={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},eo={SELECT_ACCOUNT:"select_account",NONE:"none"},ep={S256:"S256"},eq={CODE:"code",IDTOKEN_TOKEN:"id_token token"},er={QUERY:"query"},es={AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},et={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},eu={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},ev={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},ew="appmetadata",ex={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},ey={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},ez={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},eA={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},eB={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},eC={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},eD={username:"username",password:"password"},eE={FAILED_AUTO_DETECTION:"1",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},eF={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},eG={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},eH={BASE64:"base64",HEX:"hex",UTF8:"utf-8"},eI="https://login.microsoftonline.com/managed_identity/",eJ={AUTHORIZATION_HEADER_NAME:"Authorization",METADATA_HEADER_NAME:"Metadata",APP_SERVICE_SECRET_HEADER_NAME:"X-IDENTITY-HEADER",ML_AND_SF_SECRET_HEADER_NAME:"secret"},eK={API_VERSION:"api-version",RESOURCE:"resource",SHA256_TOKEN_TO_REFRESH:"token_sha256_to_refresh",XMS_CC:"xms_cc"},eL={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",DEFAULT_IDENTITY_CLIENT_ID:"DEFAULT_IDENTITY_CLIENT_ID",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"},eM={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",MACHINE_LEARNING:"MachineLearning",SERVICE_FABRIC:"ServiceFabric"},eN={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},eO={GET:"get",POST:"post"},eP={SUCCESS_RANGE_START:ei.SUCCESS_RANGE_START,SUCCESS_RANGE_END:ei.SUCCESS_RANGE_END,SERVER_ERROR:ei.SERVER_ERROR},eQ={SHA256:"sha256"},eR={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},eS={KEY_SEPARATOR:"-"},eT={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},eU={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},eV={RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"},eW={INTERVAL_MS:100,TIMEOUT_MS:5e3},eX="unexpected_error",eY="post_request_failed",eZ={[eX]:"Unexpected error in authentication.",[eY]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};eZ[eX],eZ[eY];class e$ extends Error{constructor(a,b,c){super(b?`${a}: ${b}`:a),Object.setPrototypeOf(this,e$.prototype),this.errorCode=a||eh.EMPTY_STRING,this.errorMessage=b||eh.EMPTY_STRING,this.subError=c||eh.EMPTY_STRING,this.name="AuthError"}setCorrelationId(a){this.correlationId=a}}class e_{constructor(a,b){this.cacheOutcome=eG.NOT_APPLICABLE,this.cacheManager=b,this.apiId=a.apiId,this.correlationId=a.correlationId,this.wrapperSKU=a.wrapperSKU||eh.EMPTY_STRING,this.wrapperVer=a.wrapperVer||eh.EMPTY_STRING,this.telemetryCacheKey=ez.CACHE_KEY+eu.CACHE_KEY_SEPARATOR+a.clientId}generateCurrentRequestHeaderValue(){let a=`${this.apiId}${ez.VALUE_SEPARATOR}${this.cacheOutcome}`,b=[this.wrapperSKU,this.wrapperVer],c=this.getNativeBrokerErrorCode();c?.length&&b.push(`broker_error=${c}`);let d=b.join(ez.VALUE_SEPARATOR),e=[a,this.getRegionDiscoveryFields()].join(ez.VALUE_SEPARATOR);return[ez.SCHEMA_VERSION,e,d].join(ez.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let a=this.getLastRequests(),b=e_.maxErrorsToSend(a),c=a.failedRequests.slice(0,2*b).join(ez.VALUE_SEPARATOR),d=a.errors.slice(0,b).join(ez.VALUE_SEPARATOR),e=a.errors.length,f=b<e?ez.OVERFLOW_TRUE:ez.OVERFLOW_FALSE,g=[e,f].join(ez.VALUE_SEPARATOR);return[ez.SCHEMA_VERSION,a.cacheHits,c,d,g].join(ez.CATEGORY_SEPARATOR)}cacheFailedRequest(a){let b=this.getLastRequests();b.errors.length>=ez.MAX_CACHED_ERRORS&&(b.failedRequests.shift(),b.failedRequests.shift(),b.errors.shift()),b.failedRequests.push(this.apiId,this.correlationId),a instanceof Error&&a&&a.toString()?a instanceof e$?a.subError?b.errors.push(a.subError):a.errorCode?b.errors.push(a.errorCode):b.errors.push(a.toString()):b.errors.push(a.toString()):b.errors.push(ez.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,b,this.correlationId)}incrementCacheHits(){let a=this.getLastRequests();return a.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,a,this.correlationId),a.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){let a=this.getLastRequests(),b=e_.maxErrorsToSend(a);if(b===a.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let c={failedRequests:a.failedRequests.slice(2*b),errors:a.errors.slice(b),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,c,this.correlationId)}}static maxErrorsToSend(a){let b,c=0,d=0,e=a.errors.length;for(b=0;b<e;b++){let e=a.failedRequests[2*b]||eh.EMPTY_STRING,f=a.failedRequests[2*b+1]||eh.EMPTY_STRING,g=a.errors[b]||eh.EMPTY_STRING;if((d+=e.toString().length+f.toString().length+g.length+3)<ez.MAX_LAST_HEADER_BYTES)c+=1;else break}return c}getRegionDiscoveryFields(){let a=[];return a.push(this.regionUsed||eh.EMPTY_STRING),a.push(this.regionSource||eh.EMPTY_STRING),a.push(this.regionOutcome||eh.EMPTY_STRING),a.join(",")}updateRegionDiscoveryMetadata(a){this.regionUsed=a.region_used,this.regionSource=a.region_source,this.regionOutcome=a.region_outcome}setCacheOutcome(a){this.cacheOutcome=a}setNativeBrokerErrorCode(a){let b=this.getLastRequests();b.nativeBrokerErrorCode=a,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,b,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let a=this.getLastRequests();delete a.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,a,this.correlationId)}static makeExtraSkuString(a){let{skus:b,libraryName:c,libraryVersion:d,extensionName:e,extensionVersion:f}=a,g=new Map([[0,[c,d]],[2,[e,f]]]),h=[];if(b?.length){if((h=b.split(",")).length<4)return b}else h=Array.from({length:4},()=>"|");return g.forEach((a,b)=>{2===a.length&&a[0]?.length&&a[1]?.length&&function(a){let{skuArr:b,index:c,skuName:d,skuVersion:e}=a;c>=b.length||(b[c]=[d,e].join("|"))}({skuArr:h,index:b,skuName:a[0],skuVersion:a[1]})}),h.join(",")}}let e0="client_id",e1="redirect_uri",e2="token_type",e3="req_cnf",e4="return_spa_code",e5="x-client-xtra-sku",e6="brk_client_id",e7="brk_redirect_uri",e8="instance_aware";class e9 extends e${constructor(a,b,c,d,e){super(a,b,c),this.name="ServerError",this.errorNo=d,this.status=e,Object.setPrototypeOf(this,e9.prototype)}}!function(a){a[a.Error=0]="Error",a[a.Warning=1]="Warning",a[a.Info=2]="Info",a[a.Verbose=3]="Verbose",a[a.Trace=4]="Trace"}(aL||(aL={}));class fa{constructor(a,b,c){this.level=aL.Info;let d=a||fa.createDefaultLoggerOptions();this.localCallback=d.loggerCallback||(()=>{}),this.piiLoggingEnabled=d.piiLoggingEnabled||!1,this.level="number"==typeof d.logLevel?d.logLevel:aL.Info,this.correlationId=d.correlationId||eh.EMPTY_STRING,this.packageName=b||eh.EMPTY_STRING,this.packageVersion=c||eh.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:aL.Info}}clone(a,b,c){return new fa({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:c||this.correlationId},a,b)}logMessage(a,b){if(b.logLevel>this.level||!this.piiLoggingEnabled&&b.containsPii)return;let c=new Date().toUTCString(),d=`[${c}] : [${b.correlationId||this.correlationId||""}]`,e=`${d} : ${this.packageName}@${this.packageVersion} : ${aL[b.logLevel]} - ${a}`;this.executeCallback(b.logLevel,e,b.containsPii||!1)}executeCallback(a,b,c){this.localCallback&&this.localCallback(a,b,c)}error(a,b){this.logMessage(a,{logLevel:aL.Error,containsPii:!1,correlationId:b||eh.EMPTY_STRING})}errorPii(a,b){this.logMessage(a,{logLevel:aL.Error,containsPii:!0,correlationId:b||eh.EMPTY_STRING})}warning(a,b){this.logMessage(a,{logLevel:aL.Warning,containsPii:!1,correlationId:b||eh.EMPTY_STRING})}warningPii(a,b){this.logMessage(a,{logLevel:aL.Warning,containsPii:!0,correlationId:b||eh.EMPTY_STRING})}info(a,b){this.logMessage(a,{logLevel:aL.Info,containsPii:!1,correlationId:b||eh.EMPTY_STRING})}infoPii(a,b){this.logMessage(a,{logLevel:aL.Info,containsPii:!0,correlationId:b||eh.EMPTY_STRING})}verbose(a,b){this.logMessage(a,{logLevel:aL.Verbose,containsPii:!1,correlationId:b||eh.EMPTY_STRING})}verbosePii(a,b){this.logMessage(a,{logLevel:aL.Verbose,containsPii:!0,correlationId:b||eh.EMPTY_STRING})}trace(a,b){this.logMessage(a,{logLevel:aL.Trace,containsPii:!1,correlationId:b||eh.EMPTY_STRING})}tracePii(a,b){this.logMessage(a,{logLevel:aL.Trace,containsPii:!0,correlationId:b||eh.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}let fb={Default:0,Adfs:1,Dsts:2,Ciam:3},fc="redirect_uri_empty",fd="claims_request_parsing_error",fe="authority_uri_insecure",ff="url_parse_error",fg="empty_url_error",fh="empty_input_scopes_error",fi="invalid_claims",fj="token_request_empty",fk="logout_request_empty",fl="invalid_code_challenge_method",fm="pkce_params_missing",fn="invalid_cloud_discovery_metadata",fo="invalid_authority_metadata",fp="untrusted_authority",fq="missing_ssh_jwk",fr="missing_ssh_kid",fs="missing_nonce_authentication_header",ft="invalid_authentication_header",fu="cannot_set_OIDCOptions",fv="cannot_allow_platform_broker",fw="authority_mismatch",fx="invalid_request_method_for_EAR",fy="invalid_authorize_post_body_parameters",fz="invalid_platform_broker_configuration",fA={[fc]:"A redirect URI is required for all calls, and none has been set.",[fd]:"Could not parse the given claims request object.",[fe]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[ff]:"URL could not be parsed into appropriate segments.",[fg]:"URL was empty or null.",[fh]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[fi]:"Given claims parameter must be a stringified JSON object.",[fj]:"Token request was empty and not found in cache.",[fk]:"The logout request was null or undefined.",[fl]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[fm]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[fn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[fo]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[fp]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[fq]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[fr]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[fs]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[ft]:"Invalid authentication header provided",[fu]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[fv]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[fw]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[fy]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[fx]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST.",[fz]:"Invalid platform broker configuration. `allowPlatformBrokerWithDOM` can only be enabled when `allowPlatformBroker` is enabled."};fA[fc],fA[fd],fA[fe],fA[ff],fA[fg],fA[fh],fA[fi],fA[fj],fA[fk],fA[fl],fA[fm],fA[fn],fA[fo],fA[fp],fA[fq],fA[fr],fA[fs],fA[ft],fA[fu],fA[fv],fA[fw],fA[fy],fA[fx],fA[fz];class fB extends e${constructor(a){super(a,fA[a]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,fB.prototype)}}function fC(a){return new fB(a)}class fD{static isEmptyObj(a){if(a)try{let b=JSON.parse(a);return 0===Object.keys(b).length}catch(a){}return!0}static startsWith(a,b){return 0===a.indexOf(b)}static endsWith(a,b){return a.length>=b.length&&a.lastIndexOf(b)===a.length-b.length}static queryStringToObject(a){let b={},c=a.split("&"),d=a=>decodeURIComponent(a.replace(/\+/g," "));return c.forEach(a=>{if(a.trim()){let[c,e]=a.split(/=(.+)/g,2);c&&e&&(b[d(c)]=d(e))}}),b}static trimArrayEntries(a){return a.map(a=>a.trim())}static removeEmptyStringsFromArray(a){return a.filter(a=>!!a)}static jsonParseHelper(a){try{return JSON.parse(a)}catch(a){return null}}static matchPattern(a,b){return new RegExp(a.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(b)}}let fE="client_info_decoding_error",fF="client_info_empty_error",fG="token_parsing_error",fH="null_or_empty_token",fI="endpoints_resolution_error",fJ="network_error",fK="openid_config_error",fL="hash_not_deserialized",fM="invalid_state",fN="state_mismatch",fO="state_not_found",fP="nonce_mismatch",fQ="auth_time_not_found",fR="max_age_transpired",fS="multiple_matching_tokens",fT="multiple_matching_accounts",fU="multiple_matching_appMetadata",fV="request_cannot_be_made",fW="cannot_remove_empty_scope",fX="cannot_append_scopeset",fY="empty_input_scopeset",fZ="device_code_polling_cancelled",f$="device_code_expired",f_="device_code_unknown_error",f0="no_account_in_silent_request",f1="invalid_cache_record",f2="invalid_cache_environment",f3="no_account_found",f4="no_crypto_object",f5="unexpected_credential_type",f6="invalid_assertion",f7="invalid_client_credential",f8="token_refresh_required",f9="user_timeout_reached",ga="token_claims_cnf_required_for_signedjwt",gb="authorization_code_missing_from_server_response",gc="binding_key_not_removed",gd="end_session_endpoint_not_supported",ge="key_id_missing",gf="no_network_connectivity",gg="user_canceled",gh="missing_tenant_id_error",gi="method_not_implemented",gj="nested_app_auth_bridge_disabled",gk="platform_broker_error",gl={[fE]:"The client info could not be parsed/decoded correctly",[fF]:"The client info was empty",[fG]:"Token cannot be parsed",[fH]:"The token is null or empty",[fI]:"Endpoints cannot be resolved",[fJ]:"Network request failed",[fK]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[fL]:"The hash parameters could not be deserialized",[fM]:"State was not the expected format",[fN]:"State mismatch error",[fO]:"State not found",[fP]:"Nonce mismatch error",[fQ]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[fR]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[fS]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[fT]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[fU]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[fV]:"Token request cannot be made without authorization code or refresh token.",[fW]:"Cannot remove null or empty scope from ScopeSet",[fX]:"Cannot append ScopeSet",[fY]:"Empty input ScopeSet cannot be processed",[fZ]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[f$]:"Device code is expired.",[f_]:"Device code stopped polling for unknown reasons.",[f0]:"Please pass an account object, silent flow is not supported without account information",[f1]:"Cache record object was null or undefined.",[f2]:"Invalid environment when attempting to create cache entry",[f3]:"No account found in cache for given key.",[f4]:"No crypto object detected.",[f5]:"Unexpected credential type.",[f6]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[f7]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[f8]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[f9]:"User defined timeout for device code polling reached",[ga]:"Cannot generate a POP jwt if the token_claims are not populated",[gb]:"Server response does not contain an authorization code to proceed",[gc]:"Could not remove the credential's binding key from storage.",[gd]:"The provided authority does not support logout",[ge]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[gf]:"No network connectivity. Check your internet connection.",[gg]:"User cancelled the flow.",[gh]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[gi]:"This method has not been implemented",[gj]:"The nested app auth bridge is disabled",[gk]:"An error occurred in the native broker. See the platformBrokerError property for details."};gl[fE],gl[fF],gl[fG],gl[fH],gl[fI],gl[fJ],gl[fK],gl[fL],gl[fM],gl[fN],gl[fO],gl[fP],gl[fQ],gl[fR],gl[fS],gl[fT],gl[fU],gl[fV],gl[fW],gl[fX],gl[fY],gl[fZ],gl[f$],gl[f_],gl[f0],gl[f1],gl[f2],gl[f3],gl[f4],gl[f5],gl[f6],gl[f7],gl[f8],gl[f9],gl[ga],gl[gb],gl[gc],gl[gd],gl[ge],gl[gf],gl[gg],gl[gh],gl[gj],gl[gk];class gm extends e${constructor(a,b){super(a,b?`${gl[a]}: ${b}`:gl[a]),this.name="ClientAuthError",Object.setPrototypeOf(this,gm.prototype)}}function gn(a,b){return new gm(a,b)}function go(a){if(!a||0>a.indexOf("="))return null;try{let b=a.startsWith("#/")?a.substring(2):a.startsWith("#")||a.startsWith("?")?a.substring(1):a,c=Object.fromEntries(new URLSearchParams(b));if(c.code||c.ear_jwe||c.error||c.error_description||c.state)return c}catch(a){throw gn(fL)}return null}function gp(a,b=!0,c){let d=[];return a.forEach((a,e)=>{!b&&c&&e in c?d.push(`${e}=${a}`):d.push(`${e}=${encodeURIComponent(a)}`)}),d.join("&")}class gq{get urlString(){return this._urlString}constructor(a){if(this._urlString=a,!this._urlString)throw fC(fg);a.includes("#")||(this._urlString=gq.canonicalizeUri(a))}static canonicalizeUri(a){if(a){let b=a.toLowerCase();return fD.endsWith(b,"?")?b=b.slice(0,-1):fD.endsWith(b,"?/")&&(b=b.slice(0,-2)),fD.endsWith(b,"/")||(b+="/"),b}return a}validateAsUri(){let a;try{a=this.getUrlComponents()}catch(a){throw fC(ff)}if(!a.HostNameAndPort||!a.PathSegments)throw fC(ff);if(!a.Protocol||"https:"!==a.Protocol.toLowerCase())throw fC(fe)}static appendQueryString(a,b){return b?0>a.indexOf("?")?`${a}?${b}`:`${a}&${b}`:a}static removeHashFromUrl(a){return gq.canonicalizeUri(a.split("#")[0])}replaceTenantPath(a){let b=this.getUrlComponents(),c=b.PathSegments;return a&&0!==c.length&&(c[0]===em.COMMON||c[0]===em.ORGANIZATIONS)&&(c[0]=a),gq.constructAuthorityUriFromObject(b)}getUrlComponents(){let a=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),b=this.urlString.match(a);if(!b)throw fC(ff);let c={Protocol:b[1],HostNameAndPort:b[4],AbsolutePath:b[5],QueryString:b[7]},d=c.AbsolutePath.split("/");return c.PathSegments=d=d.filter(a=>a&&a.length>0),c.QueryString&&c.QueryString.endsWith("/")&&(c.QueryString=c.QueryString.substring(0,c.QueryString.length-1)),c}static getDomainFromUrl(a){let b=RegExp("^([^:/?#]+://)?([^/?#]*)"),c=a.match(b);if(!c)throw fC(ff);return c[2]}static getAbsoluteUrl(a,b){if(a[0]===eh.FORWARD_SLASH){let c=new gq(b).getUrlComponents();return c.Protocol+"//"+c.HostNameAndPort+a}return a}static constructAuthorityUriFromObject(a){return new gq(a.Protocol+"//"+a.HostNameAndPort+"/"+a.PathSegments.join("/"))}static hashContainsKnownProperties(a){return!!go(a)}}let gr={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},gs=gr.endpointMetadata,gt=gr.instanceDiscoveryMetadata,gu=new Set;function gv(a,b,c,d){if(d?.trace(`getAliasesFromMetadata called with source: ${c}`),a&&b){let e=gw(b,a);if(e)return d?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${c}, returning aliases`),e.aliases;d?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${c}`)}return null}function gw(a,b){for(let c=0;c<a.length;c++){let d=a[c];if(d.aliases.includes(b))return d}return null}gt.metadata.forEach(a=>{a.aliases.forEach(a=>{gu.add(a)})});let gx={AAD:"AAD",OIDC:"OIDC"},gy={None:"none"},gz={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"};gz.AcquireTokenByCode,gz.AcquireTokenByRefreshToken,gz.AcquireTokenSilent,gz.AcquireTokenSilentAsync,gz.AcquireTokenPopup,gz.AcquireTokenRedirect,gz.CryptoOptsGetPublicKeyThumbprint,gz.CryptoOptsSignJwt,gz.SilentCacheClientAcquireToken,gz.SilentIframeClientAcquireToken,gz.SilentRefreshClientAcquireToken,gz.SsoSilent,gz.StandardInteractionClientGetDiscoveredAuthority,gz.FetchAccountIdWithNativeBroker,gz.NativeInteractionClientAcquireToken,gz.BaseClientCreateTokenRequestHeaders,gz.NetworkClientSendPostRequestAsync,gz.RefreshTokenClientExecutePostToTokenEndpoint,gz.AuthorizationCodeClientExecutePostToTokenEndpoint,gz.BrokerHandhshake,gz.AcquireTokenByRefreshTokenInBroker,gz.AcquireTokenByBroker,gz.RefreshTokenClientExecuteTokenRequest,gz.RefreshTokenClientAcquireToken,gz.RefreshTokenClientAcquireTokenWithCachedRefreshToken,gz.RefreshTokenClientAcquireTokenByRefreshToken,gz.RefreshTokenClientCreateTokenRequestBody,gz.AcquireTokenFromCache,gz.SilentFlowClientAcquireCachedToken,gz.SilentFlowClientGenerateResultFromCacheRecord,gz.AcquireTokenBySilentIframe,gz.InitializeBaseRequest,gz.InitializeSilentRequest,gz.InitializeClientApplication,gz.InitializeCache,gz.ImportExistingCache,gz.SetUserData,gz.LocalStorageUpdated,gz.SilentIframeClientTokenHelper,gz.SilentHandlerInitiateAuthRequest,gz.SilentHandlerMonitorIframeForHash,gz.SilentHandlerLoadFrame,gz.SilentHandlerLoadFrameSync,gz.StandardInteractionClientCreateAuthCodeClient,gz.StandardInteractionClientGetClientConfiguration,gz.StandardInteractionClientInitializeAuthorizationRequest,gz.GetAuthCodeUrl,gz.HandleCodeResponseFromServer,gz.HandleCodeResponse,gz.HandleResponseEar,gz.HandleResponseCode,gz.HandleResponsePlatformBroker,gz.UpdateTokenEndpointAuthority,gz.AuthClientAcquireToken,gz.AuthClientExecuteTokenRequest,gz.AuthClientCreateTokenRequestBody,gz.PopTokenGenerateCnf,gz.PopTokenGenerateKid,gz.HandleServerTokenResponse,gz.DeserializeResponse,gz.AuthorityFactoryCreateDiscoveredInstance,gz.AuthorityResolveEndpointsAsync,gz.AuthorityResolveEndpointsFromLocalSources,gz.AuthorityGetCloudDiscoveryMetadataFromNetwork,gz.AuthorityUpdateCloudDiscoveryMetadata,gz.AuthorityGetEndpointMetadataFromNetwork,gz.AuthorityUpdateEndpointMetadata,gz.AuthorityUpdateMetadataWithRegionalInformation,gz.RegionDiscoveryDetectRegion,gz.RegionDiscoveryGetRegionFromIMDS,gz.RegionDiscoveryGetCurrentVersion,gz.AcquireTokenByCodeAsync,gz.GetEndpointMetadataFromNetwork,gz.GetCloudDiscoveryMetadataFromNetworkMeasurement,gz.HandleRedirectPromiseMeasurement,gz.HandleNativeRedirectPromiseMeasurement,gz.UpdateCloudDiscoveryMetadataMeasurement,gz.UsernamePasswordClientAcquireToken,gz.NativeMessageHandlerHandshake,gz.NativeGenerateAuthResult,gz.RemoveHiddenIframe,gz.ClearTokensAndKeysWithClaims,gz.CacheManagerGetRefreshToken,gz.GeneratePkceCodes,gz.GenerateCodeVerifier,gz.GenerateCodeChallengeFromVerifier,gz.Sha256Digest,gz.GetRandomValues,gz.GenerateHKDF,gz.GenerateBaseKey,gz.Base64Decode,gz.UrlEncodeArr,gz.Encrypt,gz.Decrypt,gz.GenerateEarKey,gz.DecryptEarResponse;let gA={InProgress:1},gB=(a,b,c,d,e)=>(...f)=>{c.trace(`Executing function ${b}`);let g=d?.startMeasurement(b,e);return e&&d?.incrementFields({[b+"CallCount"]:1},e),d?.setPreQueueTime(b,e),a(...f).then(a=>(c.trace(`Returning result from ${b}`),g?.end({success:!0}),a)).catch(a=>{c.trace(`Error occurred in ${b}`);try{c.trace(JSON.stringify(a))}catch(a){c.trace("Unable to print error message.")}throw g?.end({success:!1},a),a})};class gC{constructor(a,b,c,d){this.networkInterface=a,this.logger=b,this.performanceClient=c,this.correlationId=d}async detectRegion(a,b){this.performanceClient?.addQueueMeasurement(gz.RegionDiscoveryDetectRegion,this.correlationId);let c=a;if(c)b.region_source=eE.ENVIRONMENT_VARIABLE;else{let a=gC.IMDS_OPTIONS;try{let d=await gB(this.getRegionFromIMDS.bind(this),gz.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(eh.IMDS_VERSION,a);if(d.status===ei.SUCCESS&&(c=d.body,b.region_source=eE.IMDS),d.status===ei.BAD_REQUEST){let d=await gB(this.getCurrentVersion.bind(this),gz.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(a);if(!d)return b.region_source=eE.FAILED_AUTO_DETECTION,null;let e=await gB(this.getRegionFromIMDS.bind(this),gz.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(d,a);e.status===ei.SUCCESS&&(c=e.body,b.region_source=eE.IMDS)}}catch(a){return b.region_source=eE.FAILED_AUTO_DETECTION,null}}return c||(b.region_source=eE.FAILED_AUTO_DETECTION),c||null}async getRegionFromIMDS(a,b){return this.performanceClient?.addQueueMeasurement(gz.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${eh.IMDS_ENDPOINT}?api-version=${a}&format=text`,b,eh.IMDS_TIMEOUT)}async getCurrentVersion(a){this.performanceClient?.addQueueMeasurement(gz.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let b=await this.networkInterface.sendGetRequestAsync(`${eh.IMDS_ENDPOINT}?format=json`,a);if(b.status===ei.BAD_REQUEST&&b.body&&b.body["newest-versions"]&&b.body["newest-versions"].length>0)return b.body["newest-versions"][0];return null}catch(a){return null}}}function gD(a,b){let c=function(a){if(!a)throw gn(fH);let b=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(a);if(!b||b.length<4)throw gn(fG);return b[2]}(a);try{let a=b(c);return JSON.parse(a)}catch(a){throw gn(fG)}}function gE(a,b){if(0===b||Date.now()-3e5>a+b)throw gn(fR)}function gF(){return Math.round(new Date().getTime()/1e3)}function gG(a){return a?new Date(1e3*Number(a)):new Date}function gH(a,b){let c=Number(a)||0;return gF()+b>c}function gI(a){return a.hasOwnProperty("homeAccountId")&&a.hasOwnProperty("environment")&&a.hasOwnProperty("credentialType")&&a.hasOwnProperty("clientId")&&a.hasOwnProperty("secret")}function gJ(a){return!!a&&gI(a)&&a.hasOwnProperty("realm")&&a.hasOwnProperty("target")&&(a.credentialType===ev.ACCESS_TOKEN||a.credentialType===ev.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function gK(a){return!!a&&gI(a)&&a.hasOwnProperty("realm")&&a.credentialType===ev.ID_TOKEN}function gL(a){return!!a&&gI(a)&&a.credentialType===ev.REFRESH_TOKEN}function gM(a,b){return!!b&&0===a.indexOf(ew)&&b.hasOwnProperty("clientId")&&b.hasOwnProperty("environment")}function gN(){return gF()+ex.REFRESH_TIME_SECONDS}function gO(a,b,c){a.authorization_endpoint=b.authorization_endpoint,a.token_endpoint=b.token_endpoint,a.end_session_endpoint=b.end_session_endpoint,a.issuer=b.issuer,a.endpointsFromNetwork=c,a.jwks_uri=b.jwks_uri}function gP(a,b,c){a.aliases=b.aliases,a.preferred_cache=b.preferred_cache,a.preferred_network=b.preferred_network,a.aliasesFromNetwork=c}function gQ(a){return a.expiresAt<=gF()}gC.IMDS_OPTIONS={headers:{Metadata:"true"}};class gR{constructor(a,b,c,d,e,f,g,h){this.canonicalAuthority=a,this._canonicalAuthority.validateAsUri(),this.networkInterface=b,this.cacheManager=c,this.authorityOptions=d,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=e,this.performanceClient=g,this.correlationId=f,this.managedIdentity=h||!1,this.regionDiscovery=new gC(b,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(a){if(a.HostNameAndPort.endsWith(eh.CIAM_AUTH_URL))return fb.Ciam;let b=a.PathSegments;if(b.length)switch(b[0].toLowerCase()){case eh.ADFS:return fb.Adfs;case eh.DSTS:return fb.Dsts}return fb.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(a){this._canonicalAuthority=new gq(a),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw gn(fI)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw gn(fI)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw gn(fI)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw gn(gd);return this.replacePath(this.metadata.end_session_endpoint)}throw gn(fI)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw gn(fI)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw gn(fI)}canReplaceTenant(a){return 1===a.PathSegments.length&&!gR.reservedTenantDomains.has(a.PathSegments[0])&&this.getAuthorityType(a)===fb.Default&&this.protocolMode!==gx.OIDC}replaceTenant(a){return a.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(a){let b=a,c=new gq(this.metadata.canonical_authority).getUrlComponents(),d=c.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,e)=>{let f=d[e];if(0===e&&this.canReplaceTenant(c)){let a=new gq(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];f!==a&&(this.logger.verbose(`Replacing tenant domain name ${f} with id ${a}`),f=a)}a!==f&&(b=b.replace(`/${f}/`,`/${a}/`))}),this.replaceTenant(b)}get defaultOpenIdConfigurationEndpoint(){let a=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===fb.Adfs||this.protocolMode===gx.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(a)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(gz.AuthorityResolveEndpointsAsync,this.correlationId);let a=this.getCurrentMetadataEntity(),b=await gB(this.updateCloudDiscoveryMetadata.bind(this),gz.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(a);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,a.preferred_network);let c=await gB(this.updateEndpointMetadata.bind(this),gz.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(a);this.updateCachedMetadata(a,b,{source:c}),this.performanceClient?.addFields({cloudDiscoverySource:b,authorityEndpointSource:c},this.correlationId)}getCurrentMetadataEntity(){let a=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return a||(a={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:gN(),jwks_uri:""}),a}updateCachedMetadata(a,b,c){b!==ey.CACHE&&c?.source!==ey.CACHE&&(a.expiresAt=gN(),a.canonical_authority=this.canonicalAuthority);let d=this.cacheManager.generateAuthorityMetadataCacheKey(a.preferred_cache);this.cacheManager.setAuthorityMetadata(d,a),this.metadata=a}async updateEndpointMetadata(a){this.performanceClient?.addQueueMeasurement(gz.AuthorityUpdateEndpointMetadata,this.correlationId);let b=this.updateEndpointMetadataFromLocalSources(a);if(b)return b.source===ey.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&b.metadata&&(gO(a,await gB(this.updateMetadataWithRegionalInformation.bind(this),gz.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(b.metadata),!1),a.canonical_authority=this.canonicalAuthority),b.source;let c=await gB(this.getEndpointMetadataFromNetwork.bind(this),gz.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(c)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(c=await gB(this.updateMetadataWithRegionalInformation.bind(this),gz.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(c)),gO(a,c,!0),ey.NETWORK;throw gn(fK,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(a){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let b=this.getEndpointMetadataFromConfig();if(b)return this.logger.verbose("Found endpoint metadata in authority configuration"),gO(a,b,!1),{source:ey.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let b=this.getEndpointMetadataFromHardcodedValues();if(b)return gO(a,b,!1),{source:ey.HARDCODED_VALUES,metadata:b};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let c=gQ(a);return this.isAuthoritySameType(a)&&a.endpointsFromNetwork&&!c?(this.logger.verbose("Found endpoint metadata in the cache."),{source:ey.CACHE}):(c&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(a){return new gq(a.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(a){throw fC(fo)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(gz.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let a=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${a}`);try{var b;let c=await this.networkInterface.sendGetRequestAsync(a,{});if((b=c.body).hasOwnProperty("authorization_endpoint")&&b.hasOwnProperty("token_endpoint")&&b.hasOwnProperty("issuer")&&b.hasOwnProperty("jwks_uri"))return c.body;return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null}catch(a){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${a}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in gs?gs[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(a){this.performanceClient?.addQueueMeasurement(gz.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let b=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(b){if(b!==eh.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=eF.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=b,gR.replaceWithRegionalInformation(a,b);let c=await gB(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),gz.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(c)return this.regionDiscoveryMetadata.region_outcome=eF.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=c,gR.replaceWithRegionalInformation(a,c);this.regionDiscoveryMetadata.region_outcome=eF.AUTO_DETECTION_REQUESTED_FAILED}return a}async updateCloudDiscoveryMetadata(a){this.performanceClient?.addQueueMeasurement(gz.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let b=this.updateCloudDiscoveryMetadataFromLocalSources(a);if(b)return b;let c=await gB(this.getCloudDiscoveryMetadataFromNetwork.bind(this),gz.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(c)return gP(a,c,!0),ey.NETWORK;throw fC(fp)}updateCloudDiscoveryMetadataFromLocalSources(a){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||eh.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||eh.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${a.canonical_authority||eh.NOT_APPLICABLE}`);let b=this.getCloudDiscoveryMetadataFromConfig();if(b)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),gP(a,b,!1),ey.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{var c;let b=(c=this.hostnameAndPort,gw(gt.metadata,c));if(b)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),gP(a,b,!1),ey.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let d=gQ(a);return this.isAuthoritySameType(a)&&a.aliasesFromNetwork&&!d?(this.logger.verbose("Found cloud discovery metadata in the cache."),ey.CACHE):(d&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===fb.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),gR.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let a=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),b=gw(a.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),b)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),b;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(a){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),fC(fn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),gR.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(gz.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let a=`${eh.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,b=null;try{var c,d;let e,f,g=await this.networkInterface.sendGetRequestAsync(a,{});if((c=g.body).hasOwnProperty("tenant_discovery_endpoint")&&c.hasOwnProperty("metadata"))f=(e=g.body).metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${e.tenant_discovery_endpoint}`);else{if(!((d=g.body).hasOwnProperty("error")&&d.hasOwnProperty("error_description")))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${g.status}`),(e=g.body).error===eh.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${e.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${e.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),f=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),b=gw(f,this.hostnameAndPort)}catch(a){return a instanceof e$?this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${a.errorCode}
Error Description: ${a.errorMessage}`):this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${a.name}
Error Description: ${a.message}`),null}return b||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),b=gR.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),b}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(a=>a&&gq.getDomainFromUrl(a).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(a,b){let c;if(b&&b.azureCloudInstance!==gy.None){let a=b.tenant?b.tenant:eh.DEFAULT_COMMON_TENANT;c=`${b.azureCloudInstance}/${a}/`}return c||a}static createCloudDiscoveryMetadataFromHost(a){return{preferred_network:a,preferred_cache:a,aliases:[a]}}getPreferredCache(){if(this.managedIdentity)return eh.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw gn(fI)}isAlias(a){return this.metadata.aliases.indexOf(a)>-1}isAliasOfKnownMicrosoftAuthority(a){return gu.has(a)}static isPublicCloudAuthority(a){return eh.KNOWN_PUBLIC_CLOUDS.indexOf(a)>=0}static buildRegionalAuthorityString(a,b,c){let d=new gq(a);d.validateAsUri();let e=d.getUrlComponents(),f=`${b}.${e.HostNameAndPort}`;this.isPublicCloudAuthority(e.HostNameAndPort)&&(f=`${b}.${eh.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let g=gq.constructAuthorityUriFromObject({...d.getUrlComponents(),HostNameAndPort:f}).urlString;return c?`${g}?${c}`:g}static replaceWithRegionalInformation(a,b){let c={...a};return c.authorization_endpoint=gR.buildRegionalAuthorityString(c.authorization_endpoint,b),c.token_endpoint=gR.buildRegionalAuthorityString(c.token_endpoint,b),c.end_session_endpoint&&(c.end_session_endpoint=gR.buildRegionalAuthorityString(c.end_session_endpoint,b)),c}static transformCIAMAuthority(a){let b=a,c=new gq(a).getUrlComponents();if(0===c.PathSegments.length&&c.HostNameAndPort.endsWith(eh.CIAM_AUTH_URL)){let a=c.HostNameAndPort.split(".")[0];b=`${b}${a}${eh.AAD_TENANT_DOMAIN_SUFFIX}`}return b}}function gS(a){return a.endsWith(eh.FORWARD_SLASH)?a:`${a}${eh.FORWARD_SLASH}`}gR.reservedTenantDomains=new Set(["{tenant}","{tenantid}",em.COMMON,em.CONSUMERS,em.ORGANIZATIONS]);let gT={createNewGuid:()=>{throw gn(gi)},base64Decode:()=>{throw gn(gi)},base64Encode:()=>{throw gn(gi)},base64UrlEncode:()=>{throw gn(gi)},encodeKid:()=>{throw gn(gi)},async getPublicKeyThumbprint(){throw gn(gi)},async removeTokenBindingKey(){throw gn(gi)},async clearKeystore(){throw gn(gi)},async signJwt(){throw gn(gi)},async hashString(){throw gn(gi)}},gU="@azure/msal-common",gV="15.13.3";class gW{constructor(a){let b=a?fD.trimArrayEntries([...a]):[],c=b?fD.removeEmptyStringsFromArray(b):[];if(!c||!c.length)throw fC(fh);this.scopes=new Set,c.forEach(a=>this.scopes.add(a))}static fromString(a){return new gW((a||eh.EMPTY_STRING).split(" "))}static createSearchScopes(a){let b=new gW(a&&a.length>0?a:[...ej]);return b.containsOnlyOIDCScopes()?b.removeScope(eh.OFFLINE_ACCESS_SCOPE):b.removeOIDCScopes(),b}containsScope(a){let b=new gW(this.printScopesLowerCase().split(" "));return!!a&&b.scopes.has(a.toLowerCase())}containsScopeSet(a){return!!a&&!(a.scopes.size<=0)&&this.scopes.size>=a.scopes.size&&a.asArray().every(a=>this.containsScope(a))}containsOnlyOIDCScopes(){let a=0;return ek.forEach(b=>{this.containsScope(b)&&(a+=1)}),this.scopes.size===a}appendScope(a){a&&this.scopes.add(a.trim())}appendScopes(a){try{a.forEach(a=>this.appendScope(a))}catch(a){throw gn(fX)}}removeScope(a){if(!a)throw gn(fW);this.scopes.delete(a.trim())}removeOIDCScopes(){ek.forEach(a=>{this.scopes.delete(a)})}unionScopeSets(a){if(!a)throw gn(fY);let b=new Set;return a.scopes.forEach(a=>b.add(a.toLowerCase())),this.scopes.forEach(a=>b.add(a.toLowerCase())),b}intersectingScopeSets(a){if(!a)throw gn(fY);a.containsOnlyOIDCScopes()||a.removeOIDCScopes();let b=this.unionScopeSets(a),c=a.getScopeCount(),d=this.getScopeCount();return b.size<d+c}getScopeCount(){return this.scopes.size}asArray(){let a=[];return this.scopes.forEach(b=>a.push(b)),a}printScopes(){return this.scopes?this.asArray().join(" "):eh.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function gX(a,b){if(!a)throw gn(fF);try{let c=b(a);return JSON.parse(c)}catch(a){throw gn(fE)}}function gY(a){if(!a)throw gn(fE);let b=a.split(eu.CLIENT_INFO_SEPARATOR,2);return{uid:b[0],utid:b.length<2?eh.EMPTY_STRING:b[1]}}function gZ(a,b){return!!a&&!!b&&a===b.split(".")[1]}function g$(a,b,c,d){if(!d)return{tenantId:c,localAccountId:b,username:"",isHomeTenant:gZ(c,a)};{let{oid:b,sub:c,tid:e,name:f,tfp:g,acr:h,preferred_username:i,upn:j,login_hint:k}=d,l=e||g||h||"";return{tenantId:l,localAccountId:b||c||"",name:f,username:i||j||"",loginHint:k,isHomeTenant:gZ(l,a)}}}function g_(a,b,c,d){let e=a;if(b){let{isHomeTenant:c,...d}=b;e={...a,...d}}if(c){let{isHomeTenant:b,...f}=g$(a.homeAccountId,a.localAccountId,a.tenantId,c);e={...e,...f,idTokenClaims:c,idToken:d}}return e}function g0(a){return a&&(a.tid||a.tfp||a.acr)||null}class g1{static getAccountInfo(a){return{homeAccountId:a.homeAccountId,environment:a.environment,tenantId:a.realm,username:a.username,localAccountId:a.localAccountId,loginHint:a.loginHint,name:a.name,nativeAccountId:a.nativeAccountId,authorityType:a.authorityType,tenantProfiles:new Map((a.tenantProfiles||[]).map(a=>[a.tenantId,a])),dataBoundary:a.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(a,b,c){let d,e=new g1;b.authorityType===fb.Adfs?e.authorityType=et.ADFS_ACCOUNT_TYPE:b.protocolMode===gx.OIDC?e.authorityType=et.GENERIC_ACCOUNT_TYPE:e.authorityType=et.MSSTS_ACCOUNT_TYPE,a.clientInfo&&c&&(d=gX(a.clientInfo,c)).xms_tdbr&&(e.dataBoundary="EU"===d.xms_tdbr?"EU":"None"),e.clientInfo=a.clientInfo,e.homeAccountId=a.homeAccountId,e.nativeAccountId=a.nativeAccountId;let f=a.environment||b&&b.getPreferredCache();if(!f)throw gn(f2);e.environment=f,e.realm=d?.utid||g0(a.idTokenClaims)||"",e.localAccountId=d?.uid||a.idTokenClaims?.oid||a.idTokenClaims?.sub||"";let g=a.idTokenClaims?.preferred_username||a.idTokenClaims?.upn,h=a.idTokenClaims?.emails?a.idTokenClaims.emails[0]:null;if(e.username=g||h||"",e.loginHint=a.idTokenClaims?.login_hint,e.name=a.idTokenClaims?.name||"",e.cloudGraphHostName=a.cloudGraphHostName,e.msGraphHost=a.msGraphHost,a.tenantProfiles)e.tenantProfiles=a.tenantProfiles;else{let b=g$(a.homeAccountId,e.localAccountId,e.realm,a.idTokenClaims);e.tenantProfiles=[b]}return e}static createFromAccountInfo(a,b,c){let d=new g1;return d.authorityType=a.authorityType||et.GENERIC_ACCOUNT_TYPE,d.homeAccountId=a.homeAccountId,d.localAccountId=a.localAccountId,d.nativeAccountId=a.nativeAccountId,d.realm=a.tenantId,d.environment=a.environment,d.username=a.username,d.name=a.name,d.loginHint=a.loginHint,d.cloudGraphHostName=b,d.msGraphHost=c,d.tenantProfiles=Array.from(a.tenantProfiles?.values()||[]),d.dataBoundary=a.dataBoundary,d}static generateHomeAccountId(a,b,c,d,e){if(b!==fb.Adfs&&b!==fb.Dsts){if(a)try{let b=gX(a,d.base64Decode);if(b.uid&&b.utid)return`${b.uid}.${b.utid}`}catch(a){}c.warning("No client info in response")}return e?.sub||""}static isAccountEntity(a){return!!a&&a.hasOwnProperty("homeAccountId")&&a.hasOwnProperty("environment")&&a.hasOwnProperty("realm")&&a.hasOwnProperty("localAccountId")&&a.hasOwnProperty("username")&&a.hasOwnProperty("authorityType")}static accountInfoIsEqual(a,b,c){if(!a||!b)return!1;let d=!0;if(c){let c=a.idTokenClaims||{},e=b.idTokenClaims||{};d=c.iat===e.iat&&c.nonce===e.nonce}return a.homeAccountId===b.homeAccountId&&a.localAccountId===b.localAccountId&&a.username===b.username&&a.tenantId===b.tenantId&&a.loginHint===b.loginHint&&a.environment===b.environment&&a.nativeAccountId===b.nativeAccountId&&d}}let g2="cache_quota_exceeded",g3="cache_error_unknown",g4={[g2]:"Exceeded cache storage capacity.",[g3]:"Unexpected error occurred when using cache storage."};class g5 extends e${constructor(a,b){let c=b||(g4[a]?g4[a]:g4[g3]);super(`${a}: ${c}`),Object.setPrototypeOf(this,g5.prototype),this.name="CacheError",this.errorCode=a,this.errorMessage=c}}class g6{constructor(a,b,c,d,e){this.clientId=a,this.cryptoImpl=b,this.commonLogger=c.clone(gU,gV),this.staticAuthorityOptions=e,this.performanceClient=d}getAllAccounts(a,b){return this.buildTenantProfiles(this.getAccountsFilteredBy(a,b),b,a)}getAccountInfoFilteredBy(a,b){if(0===Object.keys(a).length||Object.values(a).every(a=>!a))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;let c=this.getAllAccounts(a,b);return c.length>1?c.sort(a=>a.idTokenClaims?-1:1)[0]:1===c.length?c[0]:null}getBaseAccountInfo(a,b){let c=this.getAccountsFilteredBy(a,b);return c.length>0?g1.getAccountInfo(c[0]):null}buildTenantProfiles(a,b,c){return a.flatMap(a=>this.getTenantProfilesFromAccountEntity(a,b,c?.tenantId,c))}getTenantedAccountInfoByFilter(a,b,c,d,e){let f;if(e&&!this.tenantProfileMatchesFilter(c,e))return null;let g=this.getIdToken(a,d,b,c.tenantId);return g&&(f=gD(g.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(f,e))?null:g_(a,c,f,g?.secret)}getTenantProfilesFromAccountEntity(a,b,c,d){let e=g1.getAccountInfo(a),f=e.tenantProfiles||new Map,g=this.getTokenKeys();if(c){let a=f.get(c);if(!a)return[];f=new Map([[c,a]])}let h=[];return f.forEach(a=>{let c=this.getTenantedAccountInfoByFilter(e,g,a,b,d);c&&h.push(c)}),h}tenantProfileMatchesFilter(a,b){return(!b.localAccountId||!!this.matchLocalAccountIdFromTenantProfile(a,b.localAccountId))&&(!b.name||a.name===b.name)&&(void 0===b.isHomeTenant||a.isHomeTenant===b.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(a,b){return(!b||(!b.localAccountId||!!this.matchLocalAccountIdFromTokenClaims(a,b.localAccountId))&&(!b.loginHint||!!this.matchLoginHintFromTokenClaims(a,b.loginHint))&&(!b.username||!!this.matchUsername(a.preferred_username,b.username))&&(!b.name||!!this.matchName(a,b.name))&&(!b.sid||!!this.matchSid(a,b.sid)))&&!0}async saveCacheRecord(a,b,c,d){if(!a)throw gn(f1);try{a.account&&await this.setAccount(a.account,b,c),a.idToken&&d?.idToken!==!1&&await this.setIdTokenCredential(a.idToken,b,c),a.accessToken&&d?.accessToken!==!1&&await this.saveAccessToken(a.accessToken,b,c),a.refreshToken&&d?.refreshToken!==!1&&await this.setRefreshTokenCredential(a.refreshToken,b,c),a.appMetadata&&this.setAppMetadata(a.appMetadata,b)}catch(a){if(this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),a instanceof e$)throw a;throw a instanceof Error?"QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||a.message.includes("exceeded the quota")?new g5(g2):new g5(a.name,a.message):new g5(g3)}}async saveAccessToken(a,b,c){let d={clientId:a.clientId,credentialType:a.credentialType,environment:a.environment,homeAccountId:a.homeAccountId,realm:a.realm,tokenType:a.tokenType,requestedClaimsHash:a.requestedClaimsHash},e=this.getTokenKeys(),f=gW.fromString(a.target);e.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,d,!1))return;let c=this.getAccessTokenCredential(a,b);c&&this.credentialMatchesFilter(c,d)&&gW.fromString(c.target).intersectingScopeSets(f)&&this.removeAccessToken(a,b)}),await this.setAccessTokenCredential(a,b,c)}getAccountsFilteredBy(a,b){let c=this.getAccountKeys(),d=[];return c.forEach(c=>{let e=this.getAccount(c,b);if(!e||a.homeAccountId&&!this.matchHomeAccountId(e,a.homeAccountId)||a.username&&!this.matchUsername(e.username,a.username)||a.environment&&!this.matchEnvironment(e,a.environment)||a.realm&&!this.matchRealm(e,a.realm)||a.nativeAccountId&&!this.matchNativeAccountId(e,a.nativeAccountId)||a.authorityType&&!this.matchAuthorityType(e,a.authorityType))return;let f={localAccountId:a?.localAccountId,name:a?.name},g=e.tenantProfiles?.filter(a=>this.tenantProfileMatchesFilter(a,f));g&&0===g.length||d.push(e)}),d}credentialMatchesFilter(a,b){return(!b.clientId||!!this.matchClientId(a,b.clientId))&&(!b.userAssertionHash||!!this.matchUserAssertionHash(a,b.userAssertionHash))&&("string"!=typeof b.homeAccountId||!!this.matchHomeAccountId(a,b.homeAccountId))&&(!b.environment||!!this.matchEnvironment(a,b.environment))&&(!b.realm||!!this.matchRealm(a,b.realm))&&(!b.credentialType||!!this.matchCredentialType(a,b.credentialType))&&(!b.familyId||!!this.matchFamilyId(a,b.familyId))&&(!b.target||!!this.matchTarget(a,b.target))&&(!b.requestedClaimsHash&&!a.requestedClaimsHash||a.requestedClaimsHash===b.requestedClaimsHash)&&(a.credentialType!==ev.ACCESS_TOKEN_WITH_AUTH_SCHEME||(!b.tokenType||!!this.matchTokenType(a,b.tokenType))&&(b.tokenType!==eA.SSH||!b.keyId||!!this.matchKeyId(a,b.keyId)))&&!0}getAppMetadataFilteredBy(a){let b=this.getKeys(),c={};return b.forEach(b=>{if(!this.isAppMetadata(b))return;let d=this.getAppMetadata(b);d&&(!a.environment||this.matchEnvironment(d,a.environment))&&(!a.clientId||this.matchClientId(d,a.clientId))&&(c[b]=d)}),c}getAuthorityMetadataByAlias(a){let b=this.getAuthorityMetadataKeys(),c=null;return b.forEach(b=>{if(!this.isAuthorityMetadata(b)||-1===b.indexOf(this.clientId))return;let d=this.getAuthorityMetadata(b);d&&-1!==d.aliases.indexOf(a)&&(c=d)}),c}removeAllAccounts(a){this.getAllAccounts({},a).forEach(b=>{this.removeAccount(b,a)})}removeAccount(a,b){this.removeAccountContext(a,b),this.getAccountKeys().filter(b=>b.includes(a.homeAccountId)&&b.includes(a.environment)).forEach(a=>{this.removeItem(a,b),this.performanceClient.incrementFields({accountsRemoved:1},b)})}removeAccountContext(a,b){let c=this.getTokenKeys(),d=b=>b.includes(a.homeAccountId)&&b.includes(a.environment);c.idToken.filter(d).forEach(a=>{this.removeIdToken(a,b)}),c.accessToken.filter(d).forEach(a=>{this.removeAccessToken(a,b)}),c.refreshToken.filter(d).forEach(a=>{this.removeRefreshToken(a,b)})}removeAccessToken(a,b){let c=this.getAccessTokenCredential(a,b);if(this.removeItem(a,b),this.performanceClient.incrementFields({accessTokensRemoved:1},b),!c||c.credentialType.toLowerCase()!==ev.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||c.tokenType!==eA.POP)return;let d=c.keyId;d&&this.cryptoImpl.removeTokenBindingKey(d).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${d}`,b),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},b)})}removeAppMetadata(a){return this.getKeys().forEach(b=>{this.isAppMetadata(b)&&this.removeItem(b,a)}),!0}getIdToken(a,b,c,d,e){this.commonLogger.trace("CacheManager - getIdToken called");let f={homeAccountId:a.homeAccountId,environment:a.environment,credentialType:ev.ID_TOKEN,clientId:this.clientId,realm:d},g=this.getIdTokensByFilter(f,b,c),h=g.size;if(h<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(h>1){let c=g;if(!d){let b=new Map;g.forEach((c,d)=>{c.realm===a.tenantId&&b.set(d,c)});let d=b.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),g.values().next().value;if(1===d)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),b.values().next().value;c=b}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((a,c)=>{this.removeIdToken(c,b)}),e&&b&&e.addFields({multiMatchedID:g.size},b),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),g.values().next().value}getIdTokensByFilter(a,b,c){let d=c&&c.idToken||this.getTokenKeys().idToken,e=new Map;return d.forEach(c=>{if(!this.idTokenKeyMatchesFilter(c,{clientId:this.clientId,...a}))return;let d=this.getIdTokenCredential(c,b);d&&this.credentialMatchesFilter(d,a)&&e.set(c,d)}),e}idTokenKeyMatchesFilter(a,b){let c=a.toLowerCase();return(!b.clientId||-1!==c.indexOf(b.clientId.toLowerCase()))&&(!b.homeAccountId||-1!==c.indexOf(b.homeAccountId.toLowerCase()))}removeIdToken(a,b){this.removeItem(a,b)}removeRefreshToken(a,b){this.removeItem(a,b)}getAccessToken(a,b,c,d){let e=b.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",e);let f=gW.createSearchScopes(b.scopes),g=b.authenticationScheme||eA.BEARER,h=g&&g.toLowerCase()!==eA.BEARER.toLowerCase()?ev.ACCESS_TOKEN_WITH_AUTH_SCHEME:ev.ACCESS_TOKEN,i={homeAccountId:a.homeAccountId,environment:a.environment,credentialType:h,clientId:this.clientId,realm:d||a.tenantId,target:f,tokenType:g,keyId:b.sshKid,requestedClaimsHash:b.requestedClaimsHash},j=c&&c.accessToken||this.getTokenKeys().accessToken,k=[];j.forEach(a=>{if(this.accessTokenKeyMatchesFilter(a,i,!0)){let b=this.getAccessTokenCredential(a,e);b&&this.credentialMatchesFilter(b,i)&&k.push(b)}});let l=k.length;return l<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",e),null):l>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",e),k.forEach(a=>{this.removeAccessToken(this.generateCredentialKey(a),e)}),this.performanceClient.addFields({multiMatchedAT:k.length},e),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",e),k[0])}accessTokenKeyMatchesFilter(a,b,c){let d=a.toLowerCase();if(b.clientId&&-1===d.indexOf(b.clientId.toLowerCase())||b.homeAccountId&&-1===d.indexOf(b.homeAccountId.toLowerCase())||b.realm&&-1===d.indexOf(b.realm.toLowerCase())||b.requestedClaimsHash&&-1===d.indexOf(b.requestedClaimsHash.toLowerCase()))return!1;if(b.target){let a=b.target.asArray();for(let b=0;b<a.length;b++)if(c&&!d.includes(a[b].toLowerCase()))return!1;else if(!c&&d.includes(a[b].toLowerCase()))break}return!0}getAccessTokensByFilter(a,b){let c=this.getTokenKeys(),d=[];return c.accessToken.forEach(c=>{if(!this.accessTokenKeyMatchesFilter(c,a,!0))return;let e=this.getAccessTokenCredential(c,b);e&&this.credentialMatchesFilter(e,a)&&d.push(e)}),d}getRefreshToken(a,b,c,d,e){this.commonLogger.trace("CacheManager - getRefreshToken called");let f={homeAccountId:a.homeAccountId,environment:a.environment,credentialType:ev.REFRESH_TOKEN,clientId:this.clientId,familyId:b?"1":void 0},g=d&&d.refreshToken||this.getTokenKeys().refreshToken,h=[];g.forEach(a=>{if(this.refreshTokenKeyMatchesFilter(a,f)){let b=this.getRefreshTokenCredential(a,c);b&&this.credentialMatchesFilter(b,f)&&h.push(b)}});let i=h.length;return i<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(i>1&&e&&c&&e.addFields({multiMatchedRT:i},c),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),h[0])}refreshTokenKeyMatchesFilter(a,b){let c=a.toLowerCase();return(!b.familyId||-1!==c.indexOf(b.familyId.toLowerCase()))&&(!!b.familyId||!b.clientId||-1!==c.indexOf(b.clientId.toLowerCase()))&&(!b.homeAccountId||-1!==c.indexOf(b.homeAccountId.toLowerCase()))}readAppMetadataFromCache(a){let b={environment:a,clientId:this.clientId},c=this.getAppMetadataFilteredBy(b),d=Object.keys(c).map(a=>c[a]),e=d.length;if(e<1)return null;if(e>1)throw gn(fU);return d[0]}isAppMetadataFOCI(a){let b=this.readAppMetadataFromCache(a);return!!(b&&"1"===b.familyId)}matchHomeAccountId(a,b){return"string"==typeof a.homeAccountId&&b===a.homeAccountId}matchLocalAccountIdFromTokenClaims(a,b){return b===(a.oid||a.sub)}matchLocalAccountIdFromTenantProfile(a,b){return a.localAccountId===b}matchName(a,b){return b.toLowerCase()===a.name?.toLowerCase()}matchUsername(a,b){return!!(a&&"string"==typeof a&&b?.toLowerCase()===a.toLowerCase())}matchUserAssertionHash(a,b){return!!(a.userAssertionHash&&b===a.userAssertionHash)}matchEnvironment(a,b){if(this.staticAuthorityOptions){let c=function(a,b){let c,d=a.canonicalAuthority;if(d){let e=new gq(d).getUrlComponents().HostNameAndPort;c=gv(e,a.cloudDiscoveryMetadata?.metadata,ey.CONFIG,b)||gv(e,gt.metadata,ey.HARDCODED_VALUES,b)||a.knownAuthorities}return c||[]}(this.staticAuthorityOptions,this.commonLogger);if(c.includes(b)&&c.includes(a.environment))return!0}let c=this.getAuthorityMetadataByAlias(b);return!!(c&&c.aliases.indexOf(a.environment)>-1)}matchCredentialType(a,b){return a.credentialType&&b.toLowerCase()===a.credentialType.toLowerCase()}matchClientId(a,b){return!!(a.clientId&&b===a.clientId)}matchFamilyId(a,b){return!!(a.familyId&&b===a.familyId)}matchRealm(a,b){return a.realm?.toLowerCase()===b.toLowerCase()}matchNativeAccountId(a,b){return!!(a.nativeAccountId&&b===a.nativeAccountId)}matchLoginHintFromTokenClaims(a,b){return a.login_hint===b||a.preferred_username===b||a.upn===b}matchSid(a,b){return a.sid===b}matchAuthorityType(a,b){return!!(a.authorityType&&b.toLowerCase()===a.authorityType.toLowerCase())}matchTarget(a,b){return(a.credentialType===ev.ACCESS_TOKEN||a.credentialType===ev.ACCESS_TOKEN_WITH_AUTH_SCHEME)&&!!a.target&&gW.fromString(a.target).containsScopeSet(b)}matchTokenType(a,b){return!!(a.tokenType&&a.tokenType===b)}matchKeyId(a,b){return!!(a.keyId&&a.keyId===b)}isAppMetadata(a){return -1!==a.indexOf(ew)}isAuthorityMetadata(a){return -1!==a.indexOf(ex.CACHE_KEY)}generateAuthorityMetadataCacheKey(a){return`${ex.CACHE_KEY}-${this.clientId}-${a}`}static toObject(a,b){for(let c in b)a[c]=b[c];return a}}class g7 extends g6{async setAccount(){throw gn(gi)}getAccount(){throw gn(gi)}async setIdTokenCredential(){throw gn(gi)}getIdTokenCredential(){throw gn(gi)}async setAccessTokenCredential(){throw gn(gi)}getAccessTokenCredential(){throw gn(gi)}async setRefreshTokenCredential(){throw gn(gi)}getRefreshTokenCredential(){throw gn(gi)}setAppMetadata(){throw gn(gi)}getAppMetadata(){throw gn(gi)}setServerTelemetry(){throw gn(gi)}getServerTelemetry(){throw gn(gi)}setAuthorityMetadata(){throw gn(gi)}getAuthorityMetadata(){throw gn(gi)}getAuthorityMetadataKeys(){throw gn(gi)}setThrottlingCache(){throw gn(gi)}getThrottlingCache(){throw gn(gi)}removeItem(){throw gn(gi)}getKeys(){throw gn(gi)}getAccountKeys(){throw gn(gi)}getTokenKeys(){throw gn(gi)}generateCredentialKey(){throw gn(gi)}generateAccountKey(){throw gn(gi)}}class g8{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class g9{generateId(){return"callback-id"}startMeasurement(a,b){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:gA.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:a,startTimeMs:Date.now(),correlationId:b||""},measurement:new g8}}startPerformanceMeasurement(){return new g8}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}let ha={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},hb={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:aL.Info,correlationId:eh.EMPTY_STRING},hc={claimsBasedCachingEnabled:!1},hd={async sendGetRequestAsync(){throw gn(gi)},async sendPostRequestAsync(){throw gn(gi)}},he={sku:eh.SKU,version:gV,cpu:eh.EMPTY_STRING,os:eh.EMPTY_STRING},hf={clientSecret:eh.EMPTY_STRING,clientAssertion:void 0},hg={azureCloudInstance:gy.None,tenant:`${eh.DEFAULT_COMMON_TENANT}`},hh={application:{appName:"",appVersion:""}};function hi(a){return a.authOptions.authority.options.protocolMode===gx.OIDC}let hj={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};function hk(a,b,c){if(!b)return;let d=a.get(e0);d&&a.has(e6)&&c?.addFields({embeddedClientId:d,embeddedRedirectUri:a.get(e1)},b)}function hl(a,b){a.set("response_type",b)}function hm(a,b,c=!0,d=ej){!c||d.includes("openid")||b.includes("openid")||d.push("openid");let e=new gW(c?[...b||[],...d]:b||[]);a.set("scope",e.printScopes())}function hn(a,b){a.set(e0,b)}function ho(a,b){a.set("login_hint",b)}function hp(a,b){a.set(el.CCS_HEADER,`UPN:${b}`)}function hq(a,b){a.set(el.CCS_HEADER,`Oid:${b.uid}@${b.utid}`)}function hr(a,b){a.set("sid",b)}function hs(a,b,c){let d=function(a,b){let c;if(a)try{c=JSON.parse(a)}catch(a){throw fC(fi)}else c={};return b&&b.length>0&&(c.hasOwnProperty(en.ACCESS_TOKEN)||(c[en.ACCESS_TOKEN]={}),c[en.ACCESS_TOKEN][en.XMS_CC]={values:b}),JSON.stringify(c)}(b,c);try{JSON.parse(d)}catch(a){throw fC(fi)}a.set("claims",d)}function ht(a,b){a.set("client-request-id",b)}function hu(a,b){a.set("x-client-SKU",b.sku),a.set("x-client-VER",b.version),b.os&&a.set("x-client-OS",b.os),b.cpu&&a.set("x-client-CPU",b.cpu)}function hv(a,b){b?.appName&&a.set("x-app-name",b.appName),b?.appVersion&&a.set("x-app-ver",b.appVersion)}function hw(a,b){b&&a.set("state",b)}function hx(a,b){a.set("client_secret",b)}function hy(a,b){b&&a.set("client_assertion",b)}function hz(a,b){b&&a.set("client_assertion_type",b)}function hA(a,b){a.set("grant_type",b)}function hB(a){a.set("client_info","1")}function hC(a){a.has(e8)||a.set(e8,"true")}function hD(a,b){Object.entries(b).forEach(([b,c])=>{!a.has(b)&&c&&a.set(b,c)})}function hE(a,b){b&&(a.set(e2,eA.POP),a.set(e3,b))}function hF(a,b){b&&(a.set(e2,eA.SSH),a.set(e3,b))}function hG(a,b){a.set("x-client-current-telemetry",b.generateCurrentRequestHeaderValue()),a.set("x-client-last-telemetry",b.generateLastRequestHeaderValue())}function hH(a){a.set("x-ms-lib-capability",eB.X_MS_LIB_CAPABILITY_VALUE)}function hI(a,b,c){a.has(e6)||a.set(e6,b),a.has(e7)||a.set(e7,c)}async function hJ(a,b,c,d,e,f,g){g?.addQueueMeasurement(gz.AuthorityFactoryCreateDiscoveredInstance,f);let h=gR.transformCIAMAuthority(gS(a)),i=new gR(h,b,c,d,e,f,g);try{return await gB(i.resolveEndpointsAsync.bind(i),gz.AuthorityResolveEndpointsAsync,e,g,f)(),i}catch(a){throw gn(fI)}}function hK(a,b,c){return{clientId:a,authority:b.authority,scopes:b.scopes,homeAccountIdentifier:c,claims:b.claims,authenticationScheme:b.authenticationScheme,resourceRequestMethod:b.resourceRequestMethod,resourceRequestUri:b.resourceRequestUri,shrClaims:b.shrClaims,sshKid:b.sshKid,embeddedClientId:b.embeddedClientId||b.tokenBodyParameters?.clientId}}class hL{static generateThrottlingStorageKey(a){return`${eB.THROTTLING_PREFIX}.${JSON.stringify(a)}`}static preProcess(a,b,c){let d=hL.generateThrottlingStorageKey(b),e=a.getThrottlingCache(d);if(e){if(e.throttleTime<Date.now())return void a.removeItem(d,c);throw new e9(e.errorCodes?.join(" ")||eh.EMPTY_STRING,e.errorMessage,e.subError)}}static postProcess(a,b,c,d){if(hL.checkResponseStatus(c)||hL.checkResponseForRetryAfter(c)){let e={throttleTime:hL.calculateThrottleTime(parseInt(c.headers[el.RETRY_AFTER])),error:c.body.error,errorCodes:c.body.error_codes,errorMessage:c.body.error_description,subError:c.body.suberror};a.setThrottlingCache(hL.generateThrottlingStorageKey(b),e,d)}}static checkResponseStatus(a){return 429===a.status||a.status>=500&&a.status<600}static checkResponseForRetryAfter(a){return!!a.headers&&a.headers.hasOwnProperty(el.RETRY_AFTER)&&(a.status<200||a.status>=300)}static calculateThrottleTime(a){let b=Date.now()/1e3;return Math.floor(1e3*Math.min(b+((a<=0?0:a)||eB.DEFAULT_THROTTLE_TIME_SECONDS),b+eB.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(a,b,c,d){let e=hK(b,c,d),f=this.generateThrottlingStorageKey(e);a.removeItem(f,c.correlationId)}}class hM extends e${constructor(a,b,c){super(a.errorCode,a.errorMessage,a.subError),Object.setPrototypeOf(this,hM.prototype),this.name="NetworkError",this.error=a,this.httpStatus=b,this.responseHeaders=c}}class hN{constructor(a,b){this.config=function({authOptions:a,systemOptions:b,loggerOptions:c,cacheOptions:d,storageInterface:e,networkInterface:f,cryptoInterface:g,clientCredentials:h,libraryInfo:i,telemetry:j,serverTelemetryManager:k,persistencePlugin:l,serializableCache:m}){let n={...hb,...c};return{authOptions:{clientCapabilities:[],azureCloudOptions:hg,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...a},systemOptions:{...ha,...b},loggerOptions:n,cacheOptions:{...hc,...d},storageInterface:e||new g7(a.clientId,gT,new fa(n),new g9),networkInterface:f||hd,cryptoInterface:g||gT,clientCredentials:h||hf,libraryInfo:{...he,...i},telemetry:{...hh,...j},serverTelemetryManager:k||null,persistencePlugin:l||null,serializableCache:m||null}}(a),this.logger=new fa(this.config.loggerOptions,gU,gV),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=b}createTokenRequestHeaders(a){let b={};if(b[el.CONTENT_TYPE]=eh.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case hj.HOME_ACCOUNT_ID:try{let c=gY(a.credential);b[el.CCS_HEADER]=`Oid:${c.uid}@${c.utid}`}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case hj.UPN:b[el.CCS_HEADER]=`UPN: ${a.credential}`}return b}async executePostToTokenEndpoint(a,b,c,d,e,f){f&&this.performanceClient?.addQueueMeasurement(f,e);let g=await this.sendPostRequest(d,a,{body:b,headers:c},e);return this.config.serverTelemetryManager&&g.status<500&&429!==g.status&&this.config.serverTelemetryManager.clearTelemetryCache(),g}async sendPostRequest(a,b,c,d){let e;hL.preProcess(this.cacheManager,a,d);try{let a=(e=await gB(this.networkClient.sendPostRequestAsync.bind(this.networkClient),gz.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,d)(b,c)).headers||{};this.performanceClient?.addFields({refreshTokenSize:e.body.refresh_token?.length||0,httpVerToken:a[el.X_MS_HTTP_VERSION]||"",requestId:a[el.X_MS_REQUEST_ID]||""},d)}catch(a){if(a instanceof hM){let b=a.responseHeaders;throw b&&this.performanceClient?.addFields({httpVerToken:b[el.X_MS_HTTP_VERSION]||"",requestId:b[el.X_MS_REQUEST_ID]||"",contentTypeHeader:b[el.CONTENT_TYPE]||void 0,contentLengthHeader:b[el.CONTENT_LENGTH]||void 0,httpStatus:a.httpStatus},d),a.error}if(a instanceof e$)throw a;throw gn(fJ)}return hL.postProcess(this.cacheManager,a,e,d),e}async updateAuthority(a,b){this.performanceClient?.addQueueMeasurement(gz.UpdateTokenEndpointAuthority,b);let c=`https://${a}/${this.authority.tenant}/`,d=await hJ(c,this.networkClient,this.cacheManager,this.authority.options,this.logger,b,this.performanceClient);this.authority=d}createTokenQueryParameters(a){let b=new Map;return a.embeddedClientId&&hI(b,this.config.authOptions.clientId,this.config.authOptions.redirectUri),a.tokenQueryParameters&&hD(b,a.tokenQueryParameters),ht(b,a.correlationId),hk(b,a.correlationId,this.performanceClient),gp(b)}}let hO="no_tokens_found",hP="native_account_unavailable",hQ="refresh_token_expired",hR="ux_not_allowed",hS="bad_token",hT=["interaction_required","consent_required","login_required",hS,hR],hU=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],hV={[hO]:"No refresh token found in the cache. Please sign-in.",[hP]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[hQ]:"Refresh token has expired.",[hS]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[hR]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};hV[hO],hV[hP],hV[hS];class hW extends e${constructor(a,b,c,d,e,f,g,h){super(a,b,c),Object.setPrototypeOf(this,hW.prototype),this.timestamp=d||eh.EMPTY_STRING,this.traceId=e||eh.EMPTY_STRING,this.correlationId=f||eh.EMPTY_STRING,this.claims=g||eh.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=h}}function hX(a){return new hW(a,hV[a])}class hY{static setRequestState(a,b,c){let d=hY.generateLibraryState(a,c);return b?`${d}${eh.RESOURCE_DELIM}${b}`:d}static generateLibraryState(a,b){if(!a)throw gn(f4);let c={id:a.createNewGuid()};b&&(c.meta=b);let d=JSON.stringify(c);return a.base64Encode(d)}static parseRequestState(a,b){if(!a)throw gn(f4);if(!b)throw gn(fM);try{let c=b.split(eh.RESOURCE_DELIM),d=c[0],e=c.length>1?c.slice(1).join(eh.RESOURCE_DELIM):eh.EMPTY_STRING,f=a.base64Decode(d),g=JSON.parse(f);return{userRequestState:e||eh.EMPTY_STRING,libraryState:g}}catch(a){throw gn(fM)}}}let hZ={SW:"sw"};class h${constructor(a,b){this.cryptoUtils=a,this.performanceClient=b}async generateCnf(a,b){this.performanceClient?.addQueueMeasurement(gz.PopTokenGenerateCnf,a.correlationId);let c=await gB(this.generateKid.bind(this),gz.PopTokenGenerateCnf,b,this.performanceClient,a.correlationId)(a),d=this.cryptoUtils.base64UrlEncode(JSON.stringify(c));return{kid:c.kid,reqCnfString:d}}async generateKid(a){return this.performanceClient?.addQueueMeasurement(gz.PopTokenGenerateKid,a.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(a),xms_ksl:hZ.SW}}async signPopToken(a,b,c){return this.signPayload(a,b,c)}async signPayload(a,b,c,d){let{resourceRequestMethod:e,resourceRequestUri:f,shrClaims:g,shrNonce:h,shrOptions:i}=c,j=f?new gq(f):void 0,k=j?.getUrlComponents();return this.cryptoUtils.signJwt({at:a,ts:gF(),m:e?.toUpperCase(),u:k?.HostNameAndPort,nonce:h||this.cryptoUtils.createNewGuid(),p:k?.AbsolutePath,q:k?.QueryString?[[],k.QueryString]:void 0,client_claims:g||void 0,...d},b,i,c.correlationId)}}class h_{constructor(a,b){this.cache=a,this.hasChanged=b}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class h0{constructor(a,b,c,d,e,f,g){this.clientId=a,this.cacheStorage=b,this.cryptoObj=c,this.logger=d,this.serializableCache=e,this.persistencePlugin=f,this.performanceClient=g}validateTokenResponse(a,b){if(a.error||a.error_description||a.suberror){let c=`Error(s): ${a.error_codes||eh.NOT_AVAILABLE} - Timestamp: ${a.timestamp||eh.NOT_AVAILABLE} - Description: ${a.error_description||eh.NOT_AVAILABLE} - Correlation ID: ${a.correlation_id||eh.NOT_AVAILABLE} - Trace ID: ${a.trace_id||eh.NOT_AVAILABLE}`,d=a.error_codes?.length?a.error_codes[0]:void 0,e=new e9(a.error,c,a.suberror,d,a.status);if(b&&a.status&&a.status>=ei.SERVER_ERROR_RANGE_START&&a.status<=ei.SERVER_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${e}`);if(b&&a.status&&a.status>=ei.CLIENT_ERROR_RANGE_START&&a.status<=ei.CLIENT_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${e}`);if(function(a,b,c){let d=!!a&&hT.indexOf(a)>-1,e=!!c&&hU.indexOf(c)>-1,f=!!b&&hT.some(a=>b.indexOf(a)>-1);return d||f||e}(a.error,a.error_description,a.suberror))throw new hW(a.error,a.error_description,a.suberror,a.timestamp||eh.EMPTY_STRING,a.trace_id||eh.EMPTY_STRING,a.correlation_id||eh.EMPTY_STRING,a.claims||eh.EMPTY_STRING,d);throw e}}async handleServerTokenResponse(a,b,c,d,e,f,g,h,i){let j,k,l;if(this.performanceClient?.addQueueMeasurement(gz.HandleServerTokenResponse,a.correlation_id),a.id_token){if(j=gD(a.id_token||eh.EMPTY_STRING,this.cryptoObj.base64Decode),e&&e.nonce&&j.nonce!==e.nonce)throw gn(fP);if(d.maxAge||0===d.maxAge){let a=j.auth_time;if(!a)throw gn(fQ);gE(a,d.maxAge)}}this.homeAccountIdentifier=g1.generateHomeAccountId(a.client_info||eh.EMPTY_STRING,b.authorityType,this.logger,this.cryptoObj,j),e&&e.state&&(k=hY.parseRequestState(this.cryptoObj,e.state)),a.key_id=a.key_id||d.sshKid||void 0;let m=this.generateCacheRecord(a,b,c,d,j,f,e);try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),l=new h_(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(l)),g&&!h&&m.account){let a=this.cacheStorage.generateAccountKey(g1.getAccountInfo(m.account));if(!this.cacheStorage.getAccount(a,d.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await h0.generateAuthenticationResult(this.cryptoObj,b,m,!1,d,j,k,void 0,i)}await this.cacheStorage.saveCacheRecord(m,d.correlationId,function(a){if(!a.signin_state)return!1;let b=["kmsi","dvc_dmjd"];return a.signin_state.some(a=>b.includes(a.trim().toLowerCase()))}(j||{}),d.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&l&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(l))}return h0.generateAuthenticationResult(this.cryptoObj,b,m,!1,d,j,k,a,i)}generateCacheRecord(a,b,c,d,e,f,g){let h,i,j=b.getPreferredCache();if(!j)throw gn(f2);let k=g0(e);if(a.id_token&&e){var l,m,n,o;l=this.homeAccountIdentifier,m=a.id_token,n=this.clientId,o=k||"",h={credentialType:ev.ID_TOKEN,homeAccountId:l,environment:j,clientId:n,secret:m,realm:o,lastUpdatedAt:Date.now().toString()},i=function(a,b,c,d,e,f,g,h,i,j,k,l){l?.verbose("setCachedAccount called");let m=a.getAccountKeys().find(a=>a.startsWith(c)),n=null;m&&(n=a.getAccount(m,e));let o=n||g1.createAccount({homeAccountId:c,idTokenClaims:f,clientInfo:g,environment:h,cloudGraphHostName:j?.cloud_graph_host_name,msGraphHost:j?.msgraph_host,nativeAccountId:k},b,d),p=o.tenantProfiles||[],q=i||o.realm;if(q&&!p.find(a=>a.tenantId===q)){let a=g$(c,o.localAccountId,q,f);p.push(a)}return o.tenantProfiles=p,o}(this.cacheStorage,b,this.homeAccountIdentifier,this.cryptoObj.base64Decode,d.correlationId,e,a.client_info,j,k,g,void 0,this.logger)}let p=null;if(a.access_token){let e=a.scope?gW.fromString(a.scope):new gW(d.scopes||[]),g=("string"==typeof a.expires_in?parseInt(a.expires_in,10):a.expires_in)||0,h=("string"==typeof a.ext_expires_in?parseInt(a.ext_expires_in,10):a.ext_expires_in)||0,i=("string"==typeof a.refresh_in?parseInt(a.refresh_in,10):a.refresh_in)||void 0,l=c+g;p=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){let p={homeAccountId:a,credentialType:ev.ACCESS_TOKEN,secret:c,cachedAt:gF().toString(),expiresOn:g.toString(),extendedExpiresOn:h.toString(),environment:b,clientId:d,realm:e,target:f,tokenType:k||eA.BEARER,lastUpdatedAt:Date.now().toString()};if(l&&(p.userAssertionHash=l),j&&(p.refreshOn=j.toString()),n&&(p.requestedClaims=n,p.requestedClaimsHash=o),p.tokenType?.toLowerCase()!==eA.BEARER.toLowerCase())switch(p.credentialType=ev.ACCESS_TOKEN_WITH_AUTH_SCHEME,p.tokenType){case eA.POP:let q=gD(c,i);if(!q?.cnf?.kid)throw gn(ga);p.keyId=q.cnf.kid;break;case eA.SSH:p.keyId=m}return p}(this.homeAccountIdentifier,j,a.access_token,this.clientId,k||b.tenant||"",e.printScopes(),l,l+h,this.cryptoObj.base64Decode,i&&i>0?c+i:void 0,a.token_type,f,a.key_id,d.claims,d.requestedClaimsHash)}let q=null;if(a.refresh_token){let b;a.refresh_token_expires_in&&(b=c+("string"==typeof a.refresh_token_expires_in?parseInt(a.refresh_token_expires_in,10):a.refresh_token_expires_in)),q=function(a,b,c,d,e,f,g){let h={credentialType:ev.REFRESH_TOKEN,homeAccountId:a,environment:b,clientId:d,secret:c,lastUpdatedAt:Date.now().toString()};return f&&(h.userAssertionHash=f),e&&(h.familyId=e),g&&(h.expiresOn=g.toString()),h}(this.homeAccountIdentifier,j,a.refresh_token,this.clientId,a.foci,f,b)}let r=null;return a.foci&&(r={clientId:this.clientId,environment:j,familyId:a.foci}),{account:i,idToken:h,accessToken:p,refreshToken:q,appMetadata:r}}static async generateAuthenticationResult(a,b,c,d,e,f,g,h,i){let j,k,l=eh.EMPTY_STRING,m=[],n=null,o=eh.EMPTY_STRING;if(c.accessToken){if(c.accessToken.tokenType!==eA.POP||e.popKid)l=c.accessToken.secret;else{let b=new h$(a),{secret:d,keyId:f}=c.accessToken;if(!f)throw gn(ge);l=await b.signPopToken(d,f,e)}m=gW.fromString(c.accessToken.target).asArray(),n=gG(c.accessToken.expiresOn),j=gG(c.accessToken.extendedExpiresOn),c.accessToken.refreshOn&&(k=gG(c.accessToken.refreshOn))}c.appMetadata&&(o="1"===c.appMetadata.familyId?"1":"");let p=f?.oid||f?.sub||"",q=f?.tid||"";h?.spa_accountid&&c.account&&(c.account.nativeAccountId=h?.spa_accountid);let r=c.account?g_(g1.getAccountInfo(c.account),void 0,f,c.idToken?.secret):null;return{authority:b.canonicalAuthority,uniqueId:p,tenantId:q,scopes:m,account:r,idToken:c?.idToken?.secret||"",idTokenClaims:f||{},accessToken:l,fromCache:d,expiresOn:n,extExpiresOn:j,refreshOn:k,correlationId:e.correlationId,requestId:i||eh.EMPTY_STRING,familyId:o,tokenType:c.accessToken?.tokenType||eh.EMPTY_STRING,state:g?g.userRequestState:eh.EMPTY_STRING,cloudGraphHostName:c.account?.cloudGraphHostName||eh.EMPTY_STRING,msGraphHost:c.account?.msGraphHost||eh.EMPTY_STRING,code:h?.spa_code,fromNativeBroker:!1}}}async function h1(a,b,c){return"string"==typeof a?a:a({clientId:b,tokenEndpoint:c})}class h2 extends hN{constructor(a,b){super(a,b),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(a,b){if(this.performanceClient?.addQueueMeasurement(gz.AuthClientAcquireToken,a.correlationId),!a.code)throw gn(fV);let c=gF(),d=await gB(this.executeTokenRequest.bind(this),gz.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,a.correlationId)(this.authority,a),e=d.headers?.[el.X_MS_REQUEST_ID],f=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return f.validateTokenResponse(d.body),gB(f.handleServerTokenResponse.bind(f),gz.HandleServerTokenResponse,this.logger,this.performanceClient,a.correlationId)(d.body,this.authority,c,a,b,void 0,void 0,void 0,e)}getLogoutUri(a){if(!a)throw fC(fk);let b=this.createLogoutUrlQueryString(a);return gq.appendQueryString(this.authority.endSessionEndpoint,b)}async executeTokenRequest(a,b){let c;this.performanceClient?.addQueueMeasurement(gz.AuthClientExecuteTokenRequest,b.correlationId);let d=this.createTokenQueryParameters(b),e=gq.appendQueryString(a.tokenEndpoint,d),f=await gB(this.createTokenRequestBody.bind(this),gz.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,b.correlationId)(b);if(b.clientInfo)try{let a=gX(b.clientInfo,this.cryptoUtils.base64Decode);c={credential:`${a.uid}${eu.CLIENT_INFO_SEPARATOR}${a.utid}`,type:hj.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}let g=this.createTokenRequestHeaders(c||b.ccsCredential),h=hK(this.config.authOptions.clientId,b);return gB(this.executePostToTokenEndpoint.bind(this),gz.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,b.correlationId)(e,f,g,h,b.correlationId,gz.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(a){var b,c,d;let e;this.performanceClient?.addQueueMeasurement(gz.AuthClientCreateTokenRequestBody,a.correlationId);let f=new Map;if(hn(f,a.embeddedClientId||a.tokenBodyParameters?.[e0]||this.config.authOptions.clientId),this.includeRedirectUri)b=a.redirectUri,f.set(e1,b);else if(!a.redirectUri)throw fC(fc);if(hm(f,a.scopes,!0,this.oidcDefaultScopes),c=a.code,f.set("code",c),hu(f,this.config.libraryInfo),hv(f,this.config.telemetry.application),hH(f),this.serverTelemetryManager&&!hi(this.config)&&hG(f,this.serverTelemetryManager),a.codeVerifier&&(d=a.codeVerifier,f.set("code_verifier",d)),this.config.clientCredentials.clientSecret&&hx(f,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let b=this.config.clientCredentials.clientAssertion;hy(f,await h1(b.assertion,this.config.authOptions.clientId,a.resourceRequestUri)),hz(f,b.assertionType)}if(hA(f,es.AUTHORIZATION_CODE_GRANT),hB(f),a.authenticationScheme===eA.POP){let b=new h$(this.cryptoUtils,this.performanceClient);hE(f,a.popKid?this.cryptoUtils.encodeKid(a.popKid):(await gB(b.generateCnf.bind(b),gz.PopTokenGenerateCnf,this.logger,this.performanceClient,a.correlationId)(a,this.logger)).reqCnfString)}else if(a.authenticationScheme===eA.SSH)if(a.sshJwk)hF(f,a.sshJwk);else throw fC(fq);if((!fD.isEmptyObj(a.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(f,a.claims,this.config.authOptions.clientCapabilities),a.clientInfo)try{let b=gX(a.clientInfo,this.cryptoUtils.base64Decode);e={credential:`${b.uid}${eu.CLIENT_INFO_SEPARATOR}${b.utid}`,type:hj.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else e=a.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case hj.HOME_ACCOUNT_ID:try{let a=gY(e.credential);hq(f,a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case hj.UPN:hp(f,e.credential)}return a.embeddedClientId&&hI(f,this.config.authOptions.clientId,this.config.authOptions.redirectUri),a.tokenBodyParameters&&hD(f,a.tokenBodyParameters),!a.enableSpaAuthorizationCode||a.tokenBodyParameters&&a.tokenBodyParameters[e4]||hD(f,{[e4]:"1"}),hk(f,a.correlationId,this.performanceClient),gp(f)}createLogoutUrlQueryString(a){var b,c,d;let e=new Map;return a.postLogoutRedirectUri&&(b=a.postLogoutRedirectUri,e.set("post_logout_redirect_uri",b)),a.correlationId&&ht(e,a.correlationId),a.idTokenHint&&(c=a.idTokenHint,e.set("id_token_hint",c)),a.state&&hw(e,a.state),a.logoutHint&&(d=a.logoutHint,e.set("logout_hint",d)),a.extraQueryParameters&&hD(e,a.extraQueryParameters),this.config.authOptions.instanceAware&&hC(e),gp(e,this.config.authOptions.encodeExtraQueryParams,a.extraQueryParameters)}}class h3 extends hN{constructor(a,b){super(a,b)}async acquireToken(a){this.performanceClient?.addQueueMeasurement(gz.RefreshTokenClientAcquireToken,a.correlationId);let b=gF(),c=await gB(this.executeTokenRequest.bind(this),gz.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,a.correlationId)(a,this.authority),d=c.headers?.[el.X_MS_REQUEST_ID],e=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return e.validateTokenResponse(c.body),gB(e.handleServerTokenResponse.bind(e),gz.HandleServerTokenResponse,this.logger,this.performanceClient,a.correlationId)(c.body,this.authority,b,a,void 0,void 0,!0,a.forceCache,d)}async acquireTokenByRefreshToken(a){if(!a)throw fC(fj);if(this.performanceClient?.addQueueMeasurement(gz.RefreshTokenClientAcquireTokenByRefreshToken,a.correlationId),!a.account)throw gn(f0);if(this.cacheManager.isAppMetadataFOCI(a.account.environment))try{return await gB(this.acquireTokenWithCachedRefreshToken.bind(this),gz.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,a.correlationId)(a,!0)}catch(c){let a=c instanceof hW&&c.errorCode===hO,b=c instanceof e9&&c.errorCode===eC.INVALID_GRANT_ERROR&&c.subError===eC.CLIENT_MISMATCH_ERROR;if(a||b);else throw c}return gB(this.acquireTokenWithCachedRefreshToken.bind(this),gz.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,a.correlationId)(a,!1)}async acquireTokenWithCachedRefreshToken(a,b){let c,d,e,f,g;this.performanceClient?.addQueueMeasurement(gz.RefreshTokenClientAcquireTokenWithCachedRefreshToken,a.correlationId);let h=(c=this.cacheManager.getRefreshToken.bind(this.cacheManager),d=gz.CacheManagerGetRefreshToken,e=this.logger,f=this.performanceClient,g=a.correlationId,(...a)=>{e.trace(`Executing function ${d}`);let b=f?.startMeasurement(d,g);g&&f?.incrementFields({[d+"CallCount"]:1},g);try{let f=c(...a);return b?.end({success:!0}),e.trace(`Returning result from ${d}`),f}catch(a){e.trace(`Error occurred in ${d}`);try{e.trace(JSON.stringify(a))}catch(a){e.trace("Unable to print error message.")}throw b?.end({success:!1},a),a}})(a.account,b,a.correlationId,void 0,this.performanceClient);if(!h)throw hX(hO);if(h.expiresOn&&gH(h.expiresOn,a.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(h.expiresOn)},a.correlationId),hX(hQ);let i={...a,refreshToken:h.secret,authenticationScheme:a.authenticationScheme||eA.BEARER,ccsCredential:{credential:a.account.homeAccountId,type:hj.HOME_ACCOUNT_ID}};try{return await gB(this.acquireToken.bind(this),gz.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,a.correlationId)(i)}catch(b){if(b instanceof hW&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(h.expiresOn)},a.correlationId),b.subError===hS)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let b=this.cacheManager.generateCredentialKey(h);this.cacheManager.removeRefreshToken(b,a.correlationId)}throw b}}async executeTokenRequest(a,b){this.performanceClient?.addQueueMeasurement(gz.RefreshTokenClientExecuteTokenRequest,a.correlationId);let c=this.createTokenQueryParameters(a),d=gq.appendQueryString(b.tokenEndpoint,c),e=await gB(this.createTokenRequestBody.bind(this),gz.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,a.correlationId)(a),f=this.createTokenRequestHeaders(a.ccsCredential),g=hK(this.config.authOptions.clientId,a);return gB(this.executePostToTokenEndpoint.bind(this),gz.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,a.correlationId)(d,e,f,g,a.correlationId,gz.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(a){var b,c;this.performanceClient?.addQueueMeasurement(gz.RefreshTokenClientCreateTokenRequestBody,a.correlationId);let d=new Map;if(hn(d,a.embeddedClientId||a.tokenBodyParameters?.[e0]||this.config.authOptions.clientId),a.redirectUri&&(b=a.redirectUri,d.set(e1,b)),hm(d,a.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),hA(d,es.REFRESH_TOKEN_GRANT),hB(d),hu(d,this.config.libraryInfo),hv(d,this.config.telemetry.application),hH(d),this.serverTelemetryManager&&!hi(this.config)&&hG(d,this.serverTelemetryManager),c=a.refreshToken,d.set("refresh_token",c),this.config.clientCredentials.clientSecret&&hx(d,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let b=this.config.clientCredentials.clientAssertion;hy(d,await h1(b.assertion,this.config.authOptions.clientId,a.resourceRequestUri)),hz(d,b.assertionType)}if(a.authenticationScheme===eA.POP){let b=new h$(this.cryptoUtils,this.performanceClient);hE(d,a.popKid?this.cryptoUtils.encodeKid(a.popKid):(await gB(b.generateCnf.bind(b),gz.PopTokenGenerateCnf,this.logger,this.performanceClient,a.correlationId)(a,this.logger)).reqCnfString)}else if(a.authenticationScheme===eA.SSH)if(a.sshJwk)hF(d,a.sshJwk);else throw fC(fq);if((!fD.isEmptyObj(a.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(d,a.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&a.ccsCredential)switch(a.ccsCredential.type){case hj.HOME_ACCOUNT_ID:try{let b=gY(a.ccsCredential.credential);hq(d,b)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case hj.UPN:hp(d,a.ccsCredential.credential)}return a.embeddedClientId&&hI(d,this.config.authOptions.clientId,this.config.authOptions.redirectUri),a.tokenBodyParameters&&hD(d,a.tokenBodyParameters),hk(d,a.correlationId,this.performanceClient),gp(d)}}class h4 extends hN{constructor(a,b){super(a,b)}async acquireCachedToken(a){this.performanceClient?.addQueueMeasurement(gz.SilentFlowClientAcquireCachedToken,a.correlationId);let b=eG.NOT_APPLICABLE;if(a.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!fD.isEmptyObj(a.claims))throw this.setCacheOutcome(eG.FORCE_REFRESH_OR_CLAIMS,a.correlationId),gn(f8);if(!a.account)throw gn(f0);let c=a.account.tenantId||function(a){let b=new gq(a).getUrlComponents(),c=b.PathSegments.slice(-1)[0]?.toLowerCase();switch(c){case em.COMMON:case em.ORGANIZATIONS:case em.CONSUMERS:return;default:return c}}(a.authority),d=this.cacheManager.getTokenKeys(),e=this.cacheManager.getAccessToken(a.account,a,d,c);if(e)if(Number(e.cachedAt)>gF()||gH(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(eG.CACHED_ACCESS_TOKEN_EXPIRED,a.correlationId),gn(f8);else e.refreshOn&&gH(e.refreshOn,0)&&(b=eG.PROACTIVELY_REFRESHED);else throw this.setCacheOutcome(eG.NO_CACHED_ACCESS_TOKEN,a.correlationId),gn(f8);let f=a.authority||this.authority.getPreferredCache(),g={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(a.account),a.correlationId),accessToken:e,idToken:this.cacheManager.getIdToken(a.account,a.correlationId,d,c,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(f)};return this.setCacheOutcome(b,a.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await gB(this.generateResultFromCacheRecord.bind(this),gz.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,a.correlationId)(g,a),b]}setCacheOutcome(a,b){this.serverTelemetryManager?.setCacheOutcome(a),this.performanceClient?.addFields({cacheOutcome:a},b),a!==eG.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${a}`)}async generateResultFromCacheRecord(a,b){let c;if(this.performanceClient?.addQueueMeasurement(gz.SilentFlowClientGenerateResultFromCacheRecord,b.correlationId),a.idToken&&(c=gD(a.idToken.secret,this.config.cryptoInterface.base64Decode)),b.maxAge||0===b.maxAge){let a=c?.auth_time;if(!a)throw gn(fQ);gE(a,b.maxAge)}return h0.generateAuthenticationResult(this.cryptoUtils,this.authority,a,!0,b,c)}}class h5{static getNetworkResponse(a,b,c){return{headers:a,body:b,status:c}}static urlToHttpOptions(a){let b={protocol:a.protocol,hostname:a.hostname&&a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,hash:a.hash,search:a.search,pathname:a.pathname,path:`${a.pathname||""}${a.search||""}`,href:a.href};return""!==a.port&&(b.port=Number(a.port)),(a.username||a.password)&&(b.auth=`${decodeURIComponent(a.username)}:${decodeURIComponent(a.password)}`),b}}let h6="@azure/msal-node",h7="3.8.4";var h8=c(81630),h9=c(55591);class ia{constructor(a,b,c){this.networkRequestViaProxy=(a,b,c,d)=>{let e=new URL(b),f=new URL(this.proxyUrl),g=c?.headers||{},h={host:f.hostname,port:f.port,method:"CONNECT",path:e.hostname,headers:g};this.customAgentOptions&&Object.keys(this.customAgentOptions).length&&(h.agent=new h8.Agent(this.customAgentOptions));let i="";if(a===eO.POST){let a=c?.body||"";i=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${a.length}\r
\r
${a}`}else d&&(h.timeout=d);let j=`${a.toUpperCase()} ${e.href} HTTP/1.1\r
Host: ${e.host}\r
Connection: close\r
`+i+"\r\n";return new Promise((c,e)=>{let f=h8.request(h);d&&f.on("timeout",()=>{this.logUrlWithPiiAwareness(`Request timeout after ${d}ms for URL`,b),f.destroy(),e(Error(`Request time out after ${d}ms`))}),f.end(),f.on("connect",(a,b)=>{let d=a?.statusCode||eP.SERVER_ERROR;(d<eP.SUCCESS_RANGE_START||d>eP.SUCCESS_RANGE_END)&&(f.destroy(),b.destroy(),e(Error(`Error connecting to proxy. Http status code: ${a.statusCode}. Http status message: ${a?.statusMessage||"Unknown"}`))),b.write(j);let g=[];b.on("data",a=>{g.push(a)}),b.on("end",()=>{let a=Buffer.concat([...g]).toString().split("\r\n"),b=parseInt(a[0].split(" ")[1]),d=a[0].split(" ").slice(2).join(" "),e=a[a.length-1],h=a.slice(1,a.length-2),i=new Map;h.forEach(a=>{let b=a.split(new RegExp(/:\s(.*)/s)),c=b[0],d=b[1];try{let a=JSON.parse(d);a&&"object"==typeof a&&(d=a)}catch(a){}i.set(c,d)});let j=Object.fromEntries(i),k=h5.getNetworkResponse(j,this.parseBody(b,d,j,e),b);this.shouldDestroyRequest(b,k)&&f.destroy(),c(k)}),b.on("error",a=>{f.destroy(),b.destroy(),e(Error(a.toString()))})}),f.on("error",c=>{this.logger.error(`HttpClient - Proxy request error: ${c.toString()}`,""),this.logUrlWithPiiAwareness("Destination URL",b),this.logUrlWithPiiAwareness("Proxy URL",this.proxyUrl),this.logger.error(`HttpClient - Method: ${a}`,""),this.logger.errorPii(`HttpClient - Headers: ${JSON.stringify(g)}`,""),f.destroy(),e(Error(c.toString()))})})},this.networkRequestViaHttps=(a,b,c,d)=>{let e=a===eO.POST,f=c?.body||"",g=new URL(b),h=c?.headers||{},i={method:a,headers:h,...h5.urlToHttpOptions(g)};return this.customAgentOptions&&Object.keys(this.customAgentOptions).length&&(i.agent=new h9.Agent(this.customAgentOptions)),e?i.headers={...i.headers,"Content-Length":f.length}:d&&(i.timeout=d),new Promise((c,g)=>{let j;j="http:"===i.protocol?h8.request(i):h9.request(i),e&&j.write(f),d&&j.on("timeout",()=>{this.logUrlWithPiiAwareness(`HTTPS request timeout after ${d}ms for URL`,b),j.destroy(),g(Error(`Request time out after ${d}ms`))}),j.end(),j.on("response",a=>{let b=a.headers,d=a.statusCode,e=a.statusMessage,f=[];a.on("data",a=>{f.push(a)}),a.on("end",()=>{let a=Buffer.concat([...f]).toString(),g=h5.getNetworkResponse(b,this.parseBody(d,e,b,a),d);this.shouldDestroyRequest(d,g)&&j.destroy(),c(g)})}),j.on("error",c=>{this.logger.error(`HttpClient - HTTPS request error: ${c.toString()}`,""),this.logUrlWithPiiAwareness("URL",b),this.logger.error(`HttpClient - Method: ${a}`,""),this.logger.errorPii(`HttpClient - Headers: ${JSON.stringify(h)}`,""),j.destroy(),g(Error(c.toString()))})})},this.parseBody=(a,b,c,d)=>{let e;try{e=JSON.parse(d)}catch(g){let d,f;a>=ei.CLIENT_ERROR_RANGE_START&&a<=ei.CLIENT_ERROR_RANGE_END?(d="client_error",f="A client"):a>=ei.SERVER_ERROR_RANGE_START&&a<=ei.SERVER_ERROR_RANGE_END?(d="server_error",f="A server"):(d="unknown_error",f="An unknown"),e={error:d,error_description:`${f} error occured.
Http status code: ${a}
Http status message: ${b||"Unknown"}
Headers: ${JSON.stringify(c)}`}}return e},this.logUrlWithPiiAwareness=(a,b)=>{if(this.isPiiEnabled)this.logger.errorPii(`HttpClient - ${a}: ${b}`,"");else{let c;try{let a=new URL(b);c=`${a.protocol}//${a.host}${a.pathname}`}catch{c=b.split("?")[0]||"unknown"}this.logger.error(`HttpClient - ${a}: ${c} [Enable PII logging to see additional details]`,"")}},this.shouldDestroyRequest=(a,b)=>(a<ei.SUCCESS_RANGE_START||a>ei.SUCCESS_RANGE_END)&&!(b.body&&"object"==typeof b.body&&"error"in b.body&&b.body.error===eT.AUTHORIZATION_PENDING),this.proxyUrl=a||"",this.customAgentOptions=b||{},this.logger=new fa(c||{},h6,h7),this.isPiiEnabled=this.logger.isPiiLoggingEnabled()}async sendGetRequestAsync(a,b,c){return this.proxyUrl?this.networkRequestViaProxy(eO.GET,a,b,c):this.networkRequestViaHttps(eO.GET,a,b,c)}async sendPostRequestAsync(a,b){return this.proxyUrl?this.networkRequestViaProxy(eO.POST,a,b):this.networkRequestViaHttps(eO.POST,a,b)}}let ib="invalid_file_extension",ic="invalid_file_path",id="invalid_managed_identity_id_type",ie="invalid_secret",ig="platform_not_supported",ih="unable_to_create_azure_arc",ii="unable_to_create_cloud_shell",ij="unable_to_create_source",ik="unable_to_read_secret_file",il="www_authenticate_header_missing",im="www_authenticate_header_unsupported_format",io={[eL.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[eL.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[eL.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[eL.MSI_ENDPOINT]:"msi_endpoint_url_malformed"},ip={[ib]:"The file path in the WWW-Authenticate header does not contain a .key file.",[ic]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[id]:"More than one ManagedIdentityIdType was provided.",[ie]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[ig]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",missing_client_id:"A ManagedIdentityId id was not provided.",[io.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${eL.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[io.IDENTITY_ENDPOINT]:`The Managed Identity's '${eL.IDENTITY_ENDPOINT}' environment variable is malformed.`,[io.IMDS_ENDPOINT]:`The Managed Identity's '${eL.IMDS_ENDPOINT}' environment variable is malformed.`,[io.MSI_ENDPOINT]:`The Managed Identity's '${eL.MSI_ENDPOINT}' environment variable is malformed.`,network_unavailable:"Authentication unavailable. The request to the managed identity endpoint timed out.",[ih]:"Azure Arc Managed Identities can only be system assigned.",[ii]:"Cloud Shell Managed Identities can only be system assigned.",[ij]:"Unable to create a Managed Identity source based on environment variables.",[ik]:"Unable to read the secret file.",user_assigned_not_available_at_runtime:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[il]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[im]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."};class iq extends e${constructor(a){super(a,ip[a]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,iq.prototype)}}function ir(a){return new iq(a)}class is{get id(){return this._id}set id(a){this._id=a}get idType(){return this._idType}set idType(a){this._idType=a}constructor(a){let b=a?.userAssignedClientId,c=a?.userAssignedResourceId,d=a?.userAssignedObjectId;if(b){if(c||d)throw ir(id);this.id=b,this.idType=eN.USER_ASSIGNED_CLIENT_ID}else if(c){if(b||d)throw ir(id);this.id=c,this.idType=eN.USER_ASSIGNED_RESOURCE_ID}else if(d){if(b||c)throw ir(id);this.id=d,this.idType=eN.USER_ASSIGNED_OBJECT_ID}else this.id="system_assigned_managed_identity",this.idType=eN.SYSTEM_ASSIGNED}}let it={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."},redirectUriNotSupported:{code:"redirect_uri_not_supported",desc:"RedirectUri is not supported in this scenario. Please remove redirectUri from the request."}};class iu extends e${constructor(a,b){super(a,b),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new iu(it.invalidLoopbackAddressType.code,`${it.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new iu(it.unableToLoadRedirectUri.code,`${it.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new iu(it.noAuthCodeInResponse.code,`${it.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new iu(it.noLoopbackServerExists.code,`${it.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new iu(it.loopbackServerAlreadyExists.code,`${it.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new iu(it.loopbackServerTimeout.code,`${it.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new iu(it.stateNotFoundError.code,it.stateNotFoundError.desc)}static createThumbprintMissingError(){return new iu(it.thumbprintMissing.code,it.thumbprintMissing.desc)}static createRedirectUriNotSupportedError(){return new iu(it.redirectUriNotSupported.code,it.redirectUriNotSupported.desc)}}let iv={clientId:eh.EMPTY_STRING,authority:eh.DEFAULT_AUTHORITY,clientSecret:eh.EMPTY_STRING,clientAssertion:eh.EMPTY_STRING,clientCertificate:{thumbprint:eh.EMPTY_STRING,thumbprintSha256:eh.EMPTY_STRING,privateKey:eh.EMPTY_STRING,x5c:eh.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:eh.EMPTY_STRING,authorityMetadata:eh.EMPTY_STRING,clientCapabilities:[],protocolMode:gx.AAD,azureCloudOptions:{azureCloudInstance:gy.None,tenant:eh.EMPTY_STRING},skipAuthorityMetadataCache:!1,encodeExtraQueryParams:!1},iw={claimsBasedCachingEnabled:!1},ix={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:aL.Info},iy={loggerOptions:ix,networkClient:new ia,proxyUrl:eh.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},iz={application:{appName:eh.EMPTY_STRING,appVersion:eh.EMPTY_STRING}};var iA=c(55511),iB=c.n(iA);let iC=new Uint8Array(256),iD=iC.length,iE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,iF=[];for(let a=0;a<256;++a)iF.push((a+256).toString(16).substr(1));let iG=function(a,b=0){let c=(iF[a[b+0]]+iF[a[b+1]]+iF[a[b+2]]+iF[a[b+3]]+"-"+iF[a[b+4]]+iF[a[b+5]]+"-"+iF[a[b+6]]+iF[a[b+7]]+"-"+iF[a[b+8]]+iF[a[b+9]]+"-"+iF[a[b+10]]+iF[a[b+11]]+iF[a[b+12]]+iF[a[b+13]]+iF[a[b+14]]+iF[a[b+15]]).toLowerCase();if(!("string"==typeof c&&iE.test(c)))throw TypeError("Stringified UUID is invalid");return c},iH=function(a,b,c){let d=(a=a||{}).random||(a.rng||function(){return iD>iC.length-16&&(iB().randomFillSync(iC),iD=0),iC.slice(iD,iD+=16)})();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,b){c=c||0;for(let a=0;a<16;++a)b[c+a]=d[a];return b}return iG(d)};class iI{generateGuid(){return iH()}isGuid(a){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}}class iJ{static base64Encode(a,b){return Buffer.from(a,b).toString(eH.BASE64)}static base64EncodeUrl(a,b){return iJ.base64Encode(a,b).replace(/=/g,eh.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(a){return Buffer.from(a,eH.BASE64).toString("utf8")}static base64DecodeUrl(a){let b=a.replace(/-/g,"+").replace(/_/g,"/");for(;b.length%4;)b+="=";return iJ.base64Decode(b)}}class iK{sha256(a){return iA.createHash(eQ.SHA256).update(a).digest()}}class iL{constructor(){this.hashUtils=new iK}async generatePkceCodes(){let a=this.generateCodeVerifier(),b=this.generateCodeChallengeFromVerifier(a);return{verifier:a,challenge:b}}generateCodeVerifier(){let a=[],b=256-256%eR.CV_CHARSET.length;for(;a.length<=32;){let c=iA.randomBytes(1)[0];if(c>=b)continue;let d=c%eR.CV_CHARSET.length;a.push(eR.CV_CHARSET[d])}let c=a.join(eh.EMPTY_STRING);return iJ.base64EncodeUrl(c)}generateCodeChallengeFromVerifier(a){return iJ.base64EncodeUrl(this.hashUtils.sha256(a).toString(eH.BASE64),eH.BASE64)}}class iM{constructor(){this.pkceGenerator=new iL,this.guidGenerator=new iI,this.hashUtils=new iK}base64UrlEncode(){throw Error("Method not implemented.")}encodeKid(){throw Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(a){return iJ.base64Encode(a)}base64Decode(a){return iJ.base64Decode(a)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw Error("Method not implemented.")}removeTokenBindingKey(){throw Error("Method not implemented.")}clearKeystore(){throw Error("Method not implemented.")}signJwt(){throw Error("Method not implemented.")}async hashString(a){return iJ.base64EncodeUrl(this.hashUtils.sha256(a).toString(eH.BASE64),eH.BASE64)}}class iN{static deserializeJSONBlob(a){return a?JSON.parse(a):{}}static deserializeAccounts(a){let b={};return a&&Object.keys(a).map(function(c){let d=a[c],e={homeAccountId:d.home_account_id,environment:d.environment,realm:d.realm,localAccountId:d.local_account_id,username:d.username,authorityType:d.authority_type,name:d.name,clientInfo:d.client_info,lastModificationTime:d.last_modification_time,lastModificationApp:d.last_modification_app,tenantProfiles:d.tenantProfiles?.map(a=>JSON.parse(a)),lastUpdatedAt:Date.now().toString()},f=new g1;g6.toObject(f,e),b[c]=f}),b}static deserializeIdTokens(a){let b={};return a&&Object.keys(a).map(function(c){let d=a[c],e={homeAccountId:d.home_account_id,environment:d.environment,credentialType:d.credential_type,clientId:d.client_id,secret:d.secret,realm:d.realm,lastUpdatedAt:Date.now().toString()};b[c]=e}),b}static deserializeAccessTokens(a){let b={};return a&&Object.keys(a).map(function(c){let d=a[c],e={homeAccountId:d.home_account_id,environment:d.environment,credentialType:d.credential_type,clientId:d.client_id,secret:d.secret,realm:d.realm,target:d.target,cachedAt:d.cached_at,expiresOn:d.expires_on,extendedExpiresOn:d.extended_expires_on,refreshOn:d.refresh_on,keyId:d.key_id,tokenType:d.token_type,requestedClaims:d.requestedClaims,requestedClaimsHash:d.requestedClaimsHash,userAssertionHash:d.userAssertionHash,lastUpdatedAt:Date.now().toString()};b[c]=e}),b}static deserializeRefreshTokens(a){let b={};return a&&Object.keys(a).map(function(c){let d=a[c],e={homeAccountId:d.home_account_id,environment:d.environment,credentialType:d.credential_type,clientId:d.client_id,secret:d.secret,familyId:d.family_id,target:d.target,realm:d.realm,lastUpdatedAt:Date.now().toString()};b[c]=e}),b}static deserializeAppMetadata(a){let b={};return a&&Object.keys(a).map(function(c){let d=a[c];b[c]={clientId:d.client_id,environment:d.environment,familyId:d.family_id}}),b}static deserializeAllCache(a){return{accounts:a.Account?this.deserializeAccounts(a.Account):{},idTokens:a.IdToken?this.deserializeIdTokens(a.IdToken):{},accessTokens:a.AccessToken?this.deserializeAccessTokens(a.AccessToken):{},refreshTokens:a.RefreshToken?this.deserializeRefreshTokens(a.RefreshToken):{},appMetadata:a.AppMetadata?this.deserializeAppMetadata(a.AppMetadata):{}}}}class iO{static serializeJSONBlob(a){return JSON.stringify(a)}static serializeAccounts(a){let b={};return Object.keys(a).map(function(c){let d=a[c];b[c]={home_account_id:d.homeAccountId,environment:d.environment,realm:d.realm,local_account_id:d.localAccountId,username:d.username,authority_type:d.authorityType,name:d.name,client_info:d.clientInfo,last_modification_time:d.lastModificationTime,last_modification_app:d.lastModificationApp,tenantProfiles:d.tenantProfiles?.map(a=>JSON.stringify(a))}}),b}static serializeIdTokens(a){let b={};return Object.keys(a).map(function(c){let d=a[c];b[c]={home_account_id:d.homeAccountId,environment:d.environment,credential_type:d.credentialType,client_id:d.clientId,secret:d.secret,realm:d.realm}}),b}static serializeAccessTokens(a){let b={};return Object.keys(a).map(function(c){let d=a[c];b[c]={home_account_id:d.homeAccountId,environment:d.environment,credential_type:d.credentialType,client_id:d.clientId,secret:d.secret,realm:d.realm,target:d.target,cached_at:d.cachedAt,expires_on:d.expiresOn,extended_expires_on:d.extendedExpiresOn,refresh_on:d.refreshOn,key_id:d.keyId,token_type:d.tokenType,requestedClaims:d.requestedClaims,requestedClaimsHash:d.requestedClaimsHash,userAssertionHash:d.userAssertionHash}}),b}static serializeRefreshTokens(a){let b={};return Object.keys(a).map(function(c){let d=a[c];b[c]={home_account_id:d.homeAccountId,environment:d.environment,credential_type:d.credentialType,client_id:d.clientId,secret:d.secret,family_id:d.familyId,target:d.target,realm:d.realm}}),b}static serializeAppMetadata(a){let b={};return Object.keys(a).map(function(c){let d=a[c];b[c]={client_id:d.clientId,environment:d.environment,family_id:d.familyId}}),b}static serializeAllCache(a){return{Account:this.serializeAccounts(a.accounts),IdToken:this.serializeIdTokens(a.idTokens),AccessToken:this.serializeAccessTokens(a.accessTokens),RefreshToken:this.serializeRefreshTokens(a.refreshTokens),AppMetadata:this.serializeAppMetadata(a.appMetadata)}}}class iP extends g6{constructor(a,b,c,d){super(b,c,a,new g9,d),this.cache={},this.changeEmitters=[],this.logger=a}registerChangeEmitter(a){this.changeEmitters.push(a)}emitChange(){this.changeEmitters.forEach(a=>a.call(null))}cacheToInMemoryCache(a){let b={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let c in a){let d=a[c];if("object"==typeof d)if(d instanceof g1)b.accounts[c]=d;else if(gK(d))b.idTokens[c]=d;else if(gJ(d))b.accessTokens[c]=d;else if(gL(d))b.refreshTokens[c]=d;else{if(!gM(c,d))continue;b.appMetadata[c]=d}}return b}inMemoryCacheToCache(a){let b=this.getCache();return{...b,...a.accounts,...a.idTokens,...a.accessTokens,...a.refreshTokens,...a.appMetadata}}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(a){this.logger.trace("Setting in-memory cache");let b=this.inMemoryCacheToCache(a);this.setCache(b),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(a){this.logger.trace("Setting cache key value store"),this.cache=a,this.emitChange()}getItem(a){return this.logger.tracePii(`Item key: ${a}`),this.getCache()[a]}setItem(a,b){this.logger.tracePii(`Item key: ${a}`);let c=this.getCache();c[a]=b,this.setCache(c)}generateCredentialKey(a){let b=a.credentialType===ev.REFRESH_TOKEN&&a.familyId||a.clientId,c=a.tokenType&&a.tokenType.toLowerCase()!==eA.BEARER.toLowerCase()?a.tokenType.toLowerCase():"";return[a.homeAccountId,a.environment,a.credentialType,b,a.realm||"",a.target||"",a.requestedClaimsHash||"",c].join(eS.KEY_SEPARATOR).toLowerCase()}generateAccountKey(a){let b=a.homeAccountId.split(".")[1];return[a.homeAccountId,a.environment,b||a.tenantId||""].join(eS.KEY_SEPARATOR).toLowerCase()}getAccountKeys(){return Object.keys(this.getInMemoryCache().accounts)}getTokenKeys(){let a=this.getInMemoryCache();return{idToken:Object.keys(a.idTokens),accessToken:Object.keys(a.accessTokens),refreshToken:Object.keys(a.refreshTokens)}}getAccount(a){return this.getItem(a)?Object.assign(new g1,this.getItem(a)):null}async setAccount(a){let b=this.generateAccountKey(g1.getAccountInfo(a));this.setItem(b,a)}getIdTokenCredential(a){let b=this.getItem(a);return gK(b)?b:null}async setIdTokenCredential(a){let b=this.generateCredentialKey(a);this.setItem(b,a)}getAccessTokenCredential(a){let b=this.getItem(a);return gJ(b)?b:null}async setAccessTokenCredential(a){let b=this.generateCredentialKey(a);this.setItem(b,a)}getRefreshTokenCredential(a){let b=this.getItem(a);return gL(b)?b:null}async setRefreshTokenCredential(a){let b=this.generateCredentialKey(a);this.setItem(b,a)}getAppMetadata(a){let b=this.getItem(a);return gM(a,b)?b:null}setAppMetadata(a){let b=function({environment:a,clientId:b}){return[ew,a,b].join(eu.CACHE_KEY_SEPARATOR).toLowerCase()}(a);this.setItem(b,a)}getServerTelemetry(a){let b=this.getItem(a);return b&&function(a,b){let c=0===a.indexOf(ez.CACHE_KEY),d=!0;return b&&(d=b.hasOwnProperty("failedRequests")&&b.hasOwnProperty("errors")&&b.hasOwnProperty("cacheHits")),c&&d}(a,b)?b:null}setServerTelemetry(a,b){this.setItem(a,b)}getAuthorityMetadata(a){let b=this.getItem(a);return b&&b&&0===a.indexOf(ex.CACHE_KEY)&&b.hasOwnProperty("aliases")&&b.hasOwnProperty("preferred_cache")&&b.hasOwnProperty("preferred_network")&&b.hasOwnProperty("canonical_authority")&&b.hasOwnProperty("authorization_endpoint")&&b.hasOwnProperty("token_endpoint")&&b.hasOwnProperty("issuer")&&b.hasOwnProperty("aliasesFromNetwork")&&b.hasOwnProperty("endpointsFromNetwork")&&b.hasOwnProperty("expiresAt")&&b.hasOwnProperty("jwks_uri")?b:null}getAuthorityMetadataKeys(){return this.getKeys().filter(a=>this.isAuthorityMetadata(a))}setAuthorityMetadata(a,b){this.setItem(a,b)}getThrottlingCache(a){let b,c,d=this.getItem(a);return d&&(b=!1,a&&(b=0===a.indexOf(eB.THROTTLING_PREFIX)),c=!0,d&&(c=d.hasOwnProperty("throttleTime")),b&&c)?d:null}setThrottlingCache(a,b){this.setItem(a,b)}removeItem(a){this.logger.tracePii(`Item key: ${a}`);let b=!1,c=this.getCache();return c[a]&&(delete c[a],b=!0),b&&(this.setCache(c),this.emitChange()),b}removeOutdatedAccount(a){this.removeItem(a)}containsKey(a){return this.getKeys().includes(a)}getKeys(){return this.logger.trace("Retrieving all cache keys"),[...Object.keys(this.getCache())]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(a=>{this.removeItem(a)}),this.emitChange()}static generateInMemoryCache(a){return iN.deserializeAllCache(iN.deserializeJSONBlob(a))}static generateJsonCache(a){return iO.serializeAllCache(a)}updateCredentialCacheKey(a,b){let c=this.generateCredentialKey(b);if(a!==c){let d=this.getItem(a);if(d)return this.removeItem(a),this.setItem(c,d),this.logger.verbose(`Updated an outdated ${b.credentialType} cache key`),c;this.logger.error(`Attempted to update an outdated ${b.credentialType} cache key but no item matching the outdated key was found in storage`)}return a}}let iQ={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}};class iR{constructor(a,b,c){this.cacheHasChanged=!1,this.storage=a,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),c&&(this.persistence=c),this.logger=b}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let a=iO.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),a=this.mergeState(JSON.parse(this.cacheSnapshot),a)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(a)}deserialize(a){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=a,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let a=iN.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(a)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let a=iP.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(a)}async getAllAccounts(a=new iM().createNewGuid()){let b;this.logger.trace("getAllAccounts called");try{return this.persistence&&(b=new h_(this,!1),await this.persistence.beforeCacheAccess(b)),this.storage.getAllAccounts({},a)}finally{this.persistence&&b&&await this.persistence.afterCacheAccess(b)}}async getAccountByHomeId(a){let b=await this.getAllAccounts();return a&&b&&b.length&&b.filter(b=>b.homeAccountId===a)[0]||null}async getAccountByLocalId(a){let b=await this.getAllAccounts();return a&&b&&b.length&&b.filter(b=>b.localAccountId===a)[0]||null}async removeAccount(a,b){let c;this.logger.trace("removeAccount called");try{this.persistence&&(c=new h_(this,!0),await this.persistence.beforeCacheAccess(c)),this.storage.removeAccount(a,b||new iI().generateGuid())}finally{this.persistence&&c&&await this.persistence.afterCacheAccess(c)}}async overwriteCache(){if(!this.persistence)return void this.logger.info("No persistence layer specified, cache cannot be overwritten");this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let a=new h_(this,!1);await this.persistence.beforeCacheAccess(a);let b=this.getCacheSnapshot();this.storage.setCache(b),await this.persistence.afterCacheAccess(a)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(a,b){this.logger.trace("Merging in-memory cache with cache snapshot");let c=this.mergeRemovals(a,b);return this.mergeUpdates(c,b)}mergeUpdates(a,b){return Object.keys(b).forEach(c=>{let d=b[c];if(a.hasOwnProperty(c)){let b=null!==d,e="object"==typeof d,f=!Array.isArray(d),g=void 0!==a[c]&&null!==a[c];b&&e&&f&&g?this.mergeUpdates(a[c],d):a[c]=d}else null!==d&&(a[c]=d)}),a}mergeRemovals(a,b){this.logger.trace("Remove updated entries in cache");let c=a.Account?this.mergeRemovalsDict(a.Account,b.Account):a.Account,d=a.AccessToken?this.mergeRemovalsDict(a.AccessToken,b.AccessToken):a.AccessToken,e=a.RefreshToken?this.mergeRemovalsDict(a.RefreshToken,b.RefreshToken):a.RefreshToken,f=a.IdToken?this.mergeRemovalsDict(a.IdToken,b.IdToken):a.IdToken,g=a.AppMetadata?this.mergeRemovalsDict(a.AppMetadata,b.AppMetadata):a.AppMetadata;return{...a,Account:c,AccessToken:d,RefreshToken:e,IdToken:f,AppMetadata:g}}mergeRemovalsDict(a,b){let c={...a};return Object.keys(a).forEach(a=>{b&&b.hasOwnProperty(a)||delete c[a]}),c}overlayDefaults(a){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...iQ.Account,...a.Account},IdToken:{...iQ.IdToken,...a.IdToken},AccessToken:{...iQ.AccessToken,...a.AccessToken},RefreshToken:{...iQ.RefreshToken,...a.RefreshToken},AppMetadata:{...iQ.AppMetadata,...a.AppMetadata}}}}var iS=c(23435);class iT{static fromAssertion(a){let b=new iT;return b.jwt=a,b}static fromCertificate(a,b,c){let d=new iT;return d.privateKey=b,d.thumbprint=a,d.useSha256=!1,c&&(d.publicCertificate=this.parseCertificate(c)),d}static fromCertificateWithSha256Thumbprint(a,b,c){let d=new iT;return d.privateKey=b,d.thumbprint=a,d.useSha256=!0,c&&(d.publicCertificate=this.parseCertificate(c)),d}getJwt(a,b,c){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&b===this.issuer&&c===this.jwtAudience?this.jwt:this.createJwt(a,b,c);if(this.jwt)return this.jwt;throw gn(f6)}createJwt(a,b,c){this.issuer=b,this.jwtAudience=c;let d=gF();this.expirationTime=d+600;let e={alg:this.useSha256?eV.PSS_256:eV.RSA_256};Object.assign(e,{[this.useSha256?eV.X5T_256:eV.X5T]:iJ.base64EncodeUrl(this.thumbprint,eH.HEX)}),this.publicCertificate&&Object.assign(e,{[eV.X5C]:this.publicCertificate});let f={[eV.AUDIENCE]:this.jwtAudience,[eV.EXPIRATION_TIME]:this.expirationTime,[eV.ISSUER]:this.issuer,[eV.SUBJECT]:this.issuer,[eV.NOT_BEFORE]:d,[eV.JWT_ID]:a.createNewGuid()};return this.jwt=iS.sign(f,this.privateKey,{header:e}),this.jwt}isExpired(){return this.expirationTime<gF()}static parseCertificate(a){let b,c=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,d=[];for(;null!==(b=c.exec(a));)d.push(b[1].replace(/\r*\n/g,eh.EMPTY_STRING));return d}}class iU extends hN{constructor(a){super(a)}async acquireToken(a){this.logger.info("in acquireToken call in username-password client");let b=gF(),c=await this.executeTokenRequest(this.authority,a),d=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return d.validateTokenResponse(c.body),d.handleServerTokenResponse(c.body,this.authority,b,a)}async executeTokenRequest(a,b){let c=this.createTokenQueryParameters(b),d=gq.appendQueryString(a.tokenEndpoint,c),e=await this.createTokenRequestBody(b),f=this.createTokenRequestHeaders({credential:b.username,type:hj.UPN}),g={clientId:this.config.authOptions.clientId,authority:a.canonicalAuthority,scopes:b.scopes,claims:b.claims,authenticationScheme:b.authenticationScheme,resourceRequestMethod:b.resourceRequestMethod,resourceRequestUri:b.resourceRequestUri,shrClaims:b.shrClaims,sshKid:b.sshKid};return this.executePostToTokenEndpoint(d,e,f,g,b.correlationId)}async createTokenRequestBody(a){var b,c;let d=new Map;hn(d,this.config.authOptions.clientId),b=a.username,d.set(eD.username,b),c=a.password,d.set(eD.password,c),hm(d,a.scopes),hl(d,eq.IDTOKEN_TOKEN),hA(d,es.RESOURCE_OWNER_PASSWORD_GRANT),hB(d),hu(d,this.config.libraryInfo),hv(d,this.config.telemetry.application),hH(d),this.serverTelemetryManager&&hG(d,this.serverTelemetryManager),ht(d,a.correlationId||this.config.cryptoInterface.createNewGuid()),this.config.clientCredentials.clientSecret&&hx(d,this.config.clientCredentials.clientSecret);let e=this.config.clientCredentials.clientAssertion;return e&&(hy(d,await h1(e.assertion,this.config.authOptions.clientId,a.resourceRequestUri)),hz(d,e.assertionType)),(!fD.isEmptyObj(a.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(d,a.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&a.username&&hp(d,a.username),gp(d)}}class iV{constructor(a){this.config=function({auth:a,broker:b,cache:c,system:d,telemetry:e}){let f={...iy,networkClient:new ia(d?.proxyUrl,d?.customAgentOptions),loggerOptions:d?.loggerOptions||ix,disableInternalRetries:d?.disableInternalRetries||!1};if(a.clientCertificate&&!a.clientCertificate.thumbprint&&!a.clientCertificate.thumbprintSha256)throw iu.createStateNotFoundError();return{auth:{...iv,...a},broker:{...b},cache:{...iw,...c},system:{...f,...d},telemetry:{...iz,...e}}}(a),this.cryptoProvider=new iM,this.logger=new fa(this.config.system.loggerOptions,h6,h7),this.storage=new iP(this.logger,this.config.auth.clientId,this.cryptoProvider,function(a){let b,c=a.cloudDiscoveryMetadata;if(c)try{b=JSON.parse(c)}catch(a){throw fC(fn)}return{canonicalAuthority:a.authority?gS(a.authority):void 0,knownAuthorities:a.knownAuthorities,cloudDiscoveryMetadata:b}}(this.config.auth)),this.tokenCache=new iR(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(a){this.logger.info("getAuthCodeUrl called",a.correlationId);let b={...a,...await this.initializeBaseRequest(a),responseMode:a.responseMode||er.QUERY,authenticationScheme:eA.BEARER,state:a.state||"",nonce:a.nonce||""},c=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions);return function(a,b,c,d){let e=function(a,b,c,d){var e,f,g,h,i,j,k;let l=b.correlationId,m=new Map;if(hn(m,b.embeddedClientId||b.extraQueryParameters?.[e0]||a.clientId),hm(m,[...b.scopes||[],...b.extraScopesToConsent||[]],!0,a.authority.options.OIDCOptions?.defaultScopes),e=b.redirectUri,m.set(e1,e),ht(m,l),f=b.responseMode,m.set("response_mode",f||er.QUERY),hB(m),b.prompt&&(g=b.prompt,m.set("prompt",g)),b.domainHint&&(h=b.domainHint,m.set("domain_hint",h)),b.prompt!==eo.SELECT_ACCOUNT)if(b.sid&&b.prompt===eo.NONE)c.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),hr(m,b.sid),d?.addFields({sidFromRequest:!0},l);else if(b.account){let a=(j=b.account,j.idTokenClaims?.sid||null),e=(k=b.account).loginHint||k.idTokenClaims?.login_hint||null;if(e&&b.domainHint&&(c.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),e=null),e){c.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),ho(m,e),d?.addFields({loginHintFromClaim:!0},l);try{let a=gY(b.account.homeAccountId);hq(m,a)}catch(a){c.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&b.prompt===eo.NONE){c.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),hr(m,a),d?.addFields({sidFromClaim:!0},l);try{let a=gY(b.account.homeAccountId);hq(m,a)}catch(a){c.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(b.loginHint)c.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),ho(m,b.loginHint),hp(m,b.loginHint),d?.addFields({loginHintFromRequest:!0},l);else if(b.account.username){c.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),ho(m,b.account.username),d?.addFields({loginHintFromUpn:!0},l);try{let a=gY(b.account.homeAccountId);hq(m,a)}catch(a){c.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else b.loginHint&&(c.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),ho(m,b.loginHint),hp(m,b.loginHint),d?.addFields({loginHintFromRequest:!0},l));else c.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return b.nonce&&(i=b.nonce,m.set("nonce",i)),b.state&&hw(m,b.state),(b.claims||a.clientCapabilities&&a.clientCapabilities.length>0)&&hs(m,b.claims,a.clientCapabilities),b.embeddedClientId&&hI(m,a.clientId,a.redirectUri),!a.instanceAware||b.extraQueryParameters&&Object.keys(b.extraQueryParameters).includes(e8)||hC(m),m}({...a.auth,authority:b,redirectUri:c.redirectUri||""},c,d);return hu(e,{sku:eT.MSAL_SKU,version:h7,cpu:process.arch||"",os:process.platform||""}),a.auth.protocolMode!==gx.OIDC&&hv(e,a.telemetry.application),hl(e,eq.CODE),c.codeChallenge&&c.codeChallengeMethod&&function(a,b,c){if(b&&c)a.set("code_challenge",b),a.set("code_challenge_method",c);else throw fC(fm)}(e,c.codeChallenge,c.codeChallengeMethod),hD(e,c.extraQueryParameters||{}),function(a,b,c,d){let e=gp(b,c,d);return gq.appendQueryString(a.authorizationEndpoint,e)}(b,e,a.auth.encodeExtraQueryParams,c.extraQueryParameters)}(this.config,c,b,this.logger)}async acquireTokenByCode(a,b){this.logger.info("acquireTokenByCode called"),a.state&&b&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(a.state,b.state||""),b={...b,state:""});let c={...a,...await this.initializeBaseRequest(a),authenticationScheme:eA.BEARER},d=this.initializeServerTelemetryManager(eU.acquireTokenByCode,c.correlationId);try{let e=await this.createAuthority(c.authority,c.correlationId,void 0,a.azureCloudOptions),f=await this.buildOauthClientConfiguration(e,c.correlationId,c.redirectUri,d),g=new h2(f);return this.logger.verbose("Auth code client created",c.correlationId),await g.acquireToken(c,b)}catch(a){throw a instanceof e$&&a.setCorrelationId(c.correlationId),d.cacheFailedRequest(a),a}}async acquireTokenByRefreshToken(a){this.logger.info("acquireTokenByRefreshToken called",a.correlationId);let b={...a,...await this.initializeBaseRequest(a),authenticationScheme:eA.BEARER},c=this.initializeServerTelemetryManager(eU.acquireTokenByRefreshToken,b.correlationId);try{let d=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions),e=await this.buildOauthClientConfiguration(d,b.correlationId,b.redirectUri||"",c),f=new h3(e);return this.logger.verbose("Refresh token client created",b.correlationId),await f.acquireToken(b)}catch(a){throw a instanceof e$&&a.setCorrelationId(b.correlationId),c.cacheFailedRequest(a),a}}async acquireTokenSilent(a){let b={...a,...await this.initializeBaseRequest(a),forceRefresh:a.forceRefresh||!1},c=this.initializeServerTelemetryManager(eU.acquireTokenSilent,b.correlationId,b.forceRefresh);try{let d=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions),e=await this.buildOauthClientConfiguration(d,b.correlationId,b.redirectUri||"",c),f=new h4(e);this.logger.verbose("Silent flow client created",b.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(b,f,e)}catch(a){if(a instanceof gm&&a.errorCode===f8)return new h3(e).acquireTokenByRefreshToken(b);throw a}}catch(a){throw a instanceof e$&&a.setCorrelationId(b.correlationId),c.cacheFailedRequest(a),a}}async acquireCachedTokenSilent(a,b,c){let[d,e]=await b.acquireCachedToken({...a,scopes:a.scopes?.length?a.scopes:[...ej]});if(e===eG.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let b=new h3(c);try{await b.acquireTokenByRefreshToken(a)}catch{}}return d}async acquireTokenByUsernamePassword(a){this.logger.info("acquireTokenByUsernamePassword called",a.correlationId);let b={...a,...await this.initializeBaseRequest(a)},c=this.initializeServerTelemetryManager(eU.acquireTokenByUsernamePassword,b.correlationId);try{let d=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions),e=await this.buildOauthClientConfiguration(d,b.correlationId,"",c),f=new iU(e);return this.logger.verbose("Username password client created",b.correlationId),await f.acquireToken(b)}catch(a){throw a instanceof e$&&a.setCorrelationId(b.correlationId),c.cacheFailedRequest(a),a}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(a,b){if(!a)throw iu.createStateNotFoundError();if(a!==b)throw gn(fN)}getLogger(){return this.logger}setLogger(a){this.logger=a}async buildOauthClientConfiguration(a,b,c,d){return this.logger.verbose("buildOauthClientConfiguration called",b),this.logger.info(`Building oauth client configuration with the following authority: ${a.tokenEndpoint}.`,b),d?.updateRegionDiscoveryMetadata(a.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:c},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:b},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:d,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(a)},libraryInfo:{sku:eT.MSAL_SKU,version:h7,cpu:process.arch||eh.EMPTY_STRING,os:process.platform||eh.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(a){return this.developerProvidedClientAssertion&&(this.clientAssertion=iT.fromAssertion(await h1(this.developerProvidedClientAssertion,this.config.auth.clientId,a.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,a.tokenEndpoint),assertionType:eT.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(a){return this.logger.verbose("initializeRequestScopes called",a.correlationId),a.authenticationScheme&&a.authenticationScheme===eA.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",a.correlationId),a.authenticationScheme=eA.BEARER,this.config.cache.claimsBasedCachingEnabled&&a.claims&&!fD.isEmptyObj(a.claims)&&(a.requestedClaimsHash=await this.cryptoProvider.hashString(a.claims)),{...a,scopes:[...a&&a.scopes||[],...ej],correlationId:a&&a.correlationId||this.cryptoProvider.createNewGuid(),authority:a.authority||this.config.auth.authority}}initializeServerTelemetryManager(a,b,c){return new e_({clientId:this.config.auth.clientId,correlationId:b,apiId:a,forceRefresh:c||!1},this.storage)}async createAuthority(a,b,c,d){this.logger.verbose("createAuthority called",b);let e=gR.generateAuthority(a,d||this.config.auth.azureCloudOptions),f={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:c,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return hJ(e,this.config.system.networkClient,this.storage,f,this.logger,b)}clearCache(){this.storage.clear()}}class iW{async listenForAuthCode(a,b){if(this.server)throw iu.createLoopbackServerAlreadyExistsError();return new Promise((c,d)=>{this.server=h8.createServer((e,f)=>{let g=e.url;if(g){if(g===eh.FORWARD_SLASH)return void f.end(a||"Auth code was successfully acquired. You can close this window now.")}else{f.end(b||"Error occurred loading redirectUrl"),d(iu.createUnableToLoadRedirectUrlError());return}let h=this.getRedirectUri(),i=go(new URL(g,h).search)||{};i.code&&(f.writeHead(ei.REDIRECT,{location:h}),f.end()),i.error&&f.end(b||`Error occurred: ${i.error}`),c(i)}),this.server.listen(0,"127.0.0.1")})}getRedirectUri(){if(!this.server||!this.server.listening)throw iu.createNoLoopbackServerExistsError();let a=this.server.address();if(!a||"string"==typeof a||!a.port)throw this.closeServer(),iu.createInvalidLoopbackAddressTypeError();let b=a&&a.port;return`${eT.HTTP_PROTOCOL}${eT.LOCALHOST}:${b}`}closeServer(){this.server&&(this.server.close(),"function"==typeof this.server.closeAllConnections&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}}class iX extends hN{constructor(a){super(a)}async acquireToken(a){let b=await this.getDeviceCode(a);a.deviceCodeCallback(b);let c=gF(),d=await this.acquireTokenWithDeviceCode(a,b),e=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return e.validateTokenResponse(d),e.handleServerTokenResponse(d,this.authority,c,a)}async getDeviceCode(a){let b=this.createExtraQueryParameters(a),c=gq.appendQueryString(this.authority.deviceCodeEndpoint,b),d=this.createQueryString(a),e=this.createTokenRequestHeaders(),f={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes,claims:a.claims,authenticationScheme:a.authenticationScheme,resourceRequestMethod:a.resourceRequestMethod,resourceRequestUri:a.resourceRequestUri,shrClaims:a.shrClaims,sshKid:a.sshKid};return this.executePostRequestToDeviceCodeEndpoint(c,d,e,f,a.correlationId)}createExtraQueryParameters(a){let b=new Map;return a.extraQueryParameters&&hD(b,a.extraQueryParameters),gp(b)}async executePostRequestToDeviceCodeEndpoint(a,b,c,d,e){let{body:{user_code:f,device_code:g,verification_uri:h,expires_in:i,interval:j,message:k}}=await this.sendPostRequest(d,a,{body:b,headers:c},e);return{userCode:f,deviceCode:g,verificationUri:h,expiresIn:i,interval:j,message:k}}createQueryString(a){let b=new Map;return hm(b,a.scopes),hn(b,this.config.authOptions.clientId),a.extraQueryParameters&&hD(b,a.extraQueryParameters),(a.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(b,a.claims,this.config.authOptions.clientCapabilities),gp(b)}continuePolling(a,b,c){if(c)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),gn(fZ);if(b&&b<a&&gF()>b)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${b}`),gn(f9);if(gF()>a)throw b&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${b}`),this.logger.error(`Device code expired. Expiration time of device code was ${a}`),gn(f$);return!0}async acquireTokenWithDeviceCode(a,b){let c=this.createTokenQueryParameters(a),d=gq.appendQueryString(this.authority.tokenEndpoint,c),e=this.createTokenRequestBody(a,b),f=this.createTokenRequestHeaders(),g=a.timeout?gF()+a.timeout:void 0,h=gF()+b.expiresIn,i=1e3*b.interval;for(;this.continuePolling(h,g,a.cancel);){let b={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes,claims:a.claims,authenticationScheme:a.authenticationScheme,resourceRequestMethod:a.resourceRequestMethod,resourceRequestUri:a.resourceRequestUri,shrClaims:a.shrClaims,sshKid:a.sshKid},c=await this.executePostToTokenEndpoint(d,e,f,b,a.correlationId);if(!c.body||!c.body.error)return this.logger.verbose("Authorization completed successfully. Polling stopped."),c.body;if(c.body.error===eh.AUTHORIZATION_PENDING)this.logger.info("Authorization pending. Continue polling."),await function(a,b){return new Promise(b=>setTimeout(()=>b(void 0),a))}(i);else{var j;throw this.logger.info("Unexpected error in polling from the server"),new e$(eY,(j=c.body.error)?`${eZ[eY]} ${j}`:eZ[eY])}}throw this.logger.error("Polling stopped for unknown reasons."),gn(f_)}createTokenRequestBody(a,b){var c;let d=new Map;return hm(d,a.scopes),hn(d,this.config.authOptions.clientId),hA(d,es.DEVICE_CODE_GRANT),c=b.deviceCode,d.set("device_code",c),ht(d,a.correlationId||this.config.cryptoInterface.createNewGuid()),hB(d),hu(d,this.config.libraryInfo),hv(d,this.config.telemetry.application),hH(d),this.serverTelemetryManager&&hG(d,this.serverTelemetryManager),(!fD.isEmptyObj(a.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(d,a.claims,this.config.authOptions.clientCapabilities),gp(d)}}class iY extends iV{constructor(a){super(a),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=e_.makeExtraSkuString({libraryName:eT.MSAL_SKU,libraryVersion:h7})}async acquireTokenByDeviceCode(a){this.logger.info("acquireTokenByDeviceCode called",a.correlationId);let b=Object.assign(a,await this.initializeBaseRequest(a)),c=this.initializeServerTelemetryManager(eU.acquireTokenByDeviceCode,b.correlationId);try{let d=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions),e=await this.buildOauthClientConfiguration(d,b.correlationId,"",c),f=new iX(e);return this.logger.verbose("Device code client created",b.correlationId),await f.acquireToken(b)}catch(a){throw a instanceof e$&&a.setCorrelationId(b.correlationId),c.cacheFailedRequest(a),a}}async acquireTokenInteractive(a){let b=a.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",b);let{openBrowser:c,successTemplate:d,errorTemplate:e,windowHandle:f,loopbackClient:g,...h}=a;if(this.nativeBrokerPlugin){let c={...h,clientId:this.config.auth.clientId,scopes:a.scopes||ej,redirectUri:a.redirectUri||"",authority:a.authority||this.config.auth.authority,correlationId:b,extraParameters:{...h.extraQueryParameters,...h.tokenQueryParameters,[e5]:this.skus},accountId:h.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(c,f)}if(a.redirectUri){if(!this.config.broker.nativeBrokerPlugin)throw iu.createRedirectUriNotSupportedError();a.redirectUri=""}let{verifier:i,challenge:j}=await this.cryptoProvider.generatePkceCodes(),k=g||new iW,l={},m=null;try{let f=k.listenForAuthCode(d,e).then(a=>{l=a}).catch(a=>{m=a}),g=await this.waitForRedirectUri(k),n={...h,correlationId:b,scopes:a.scopes||ej,redirectUri:g,responseMode:er.QUERY,codeChallenge:j,codeChallengeMethod:ep.S256},o=await this.getAuthCodeUrl(n);if(await c(o),await f,m)throw m;if(l.error)throw new e9(l.error,l.error_description,l.suberror);if(!l.code)throw iu.createNoAuthCodeInResponseError();let p=l.client_info,q={code:l.code,codeVerifier:i,clientInfo:p||eh.EMPTY_STRING,...n};return await this.acquireTokenByCode(q)}finally{k.closeServer()}}async acquireTokenSilent(a){let b=a.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",b),this.nativeBrokerPlugin){let c={...a,clientId:this.config.auth.clientId,scopes:a.scopes||ej,redirectUri:a.redirectUri||"",authority:a.authority||this.config.auth.authority,correlationId:b,extraParameters:{...a.tokenQueryParameters,[e5]:this.skus},accountId:a.account.nativeAccountId,forceRefresh:a.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(c)}if(a.redirectUri){if(!this.config.broker.nativeBrokerPlugin)throw iu.createRedirectUriNotSupportedError();a.redirectUri=""}return super.acquireTokenSilent(a)}async signOut(a){if(this.nativeBrokerPlugin&&a.account.nativeAccountId){let b={clientId:this.config.auth.clientId,accountId:a.account.nativeAccountId,correlationId:a.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(b)}await this.getTokenCache().removeAccount(a.account,a.correlationId)}async getAllAccounts(){if(this.nativeBrokerPlugin){let a=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,a)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(a){return new Promise((b,c)=>{let d=0,e=setInterval(()=>{if(eW.TIMEOUT_MS/eW.INTERVAL_MS<d){clearInterval(e),c(iu.createLoopbackServerTimeoutError());return}try{let c=a.getRedirectUri();clearInterval(e),b(c);return}catch(a){if(a instanceof e$&&a.errorCode===it.noLoopbackServerExists.code)return void d++;clearInterval(e),c(a);return}},eW.INTERVAL_MS)})}}class iZ extends hN{constructor(a,b){super(a),this.appTokenProvider=b}async acquireToken(a){if(a.skipCache||a.claims)return this.executeTokenRequest(a,this.authority);let[b,c]=await this.getCachedAuthenticationResult(a,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return b?(c===eG.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(a,this.authority,!0)),b):this.executeTokenRequest(a,this.authority)}async getCachedAuthenticationResult(a,b,c,d,e,f){let g,h=eG.NOT_APPLICABLE;b.serializableCache&&b.persistencePlugin&&(g=new h_(b.serializableCache,!1),await b.persistencePlugin.beforeCacheAccess(g));let i=this.readAccessTokenFromCache(d,b.managedIdentityId?.id||b.authOptions.clientId,new gW(a.scopes||[]),e,a.correlationId);return(b.serializableCache&&b.persistencePlugin&&g&&await b.persistencePlugin.afterCacheAccess(g),i)?gH(i.expiresOn,b.systemOptions?.tokenRenewalOffsetSeconds||300)?(f?.setCacheOutcome(eG.CACHED_ACCESS_TOKEN_EXPIRED),[null,eG.CACHED_ACCESS_TOKEN_EXPIRED]):(i.refreshOn&&gH(i.refreshOn.toString(),0)&&(h=eG.PROACTIVELY_REFRESHED,f?.setCacheOutcome(eG.PROACTIVELY_REFRESHED)),[await h0.generateAuthenticationResult(c,d,{account:null,idToken:null,accessToken:i,refreshToken:null,appMetadata:null},!0,a),h]):(f?.setCacheOutcome(eG.NO_CACHED_ACCESS_TOKEN),[null,eG.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(a,b,c,d,e){let f={homeAccountId:eh.EMPTY_STRING,environment:a.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ev.ACCESS_TOKEN,clientId:b,realm:a.tenant,target:gW.createSearchScopes(c.asArray())},g=d.getAccessTokensByFilter(f,e);if(g.length<1)return null;if(g.length>1)throw gn(fS);return g[0]}async executeTokenRequest(a,b,c){let d,e;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let b={correlationId:a.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:a.scopes,claims:a.claims};e=gF();let c=await this.appTokenProvider(b);d={access_token:c.accessToken,expires_in:c.expiresInSeconds,refresh_in:c.refreshInSeconds,token_type:eA.BEARER}}else{let c=this.createTokenQueryParameters(a),f=gq.appendQueryString(b.tokenEndpoint,c),g=await this.createTokenRequestBody(a),h=this.createTokenRequestHeaders(),i={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes,claims:a.claims,authenticationScheme:a.authenticationScheme,resourceRequestMethod:a.resourceRequestMethod,resourceRequestUri:a.resourceRequestUri,shrClaims:a.shrClaims,sshKid:a.sshKid};this.logger.info("Sending token request to endpoint: "+b.tokenEndpoint),e=gF();let j=await this.executePostToTokenEndpoint(f,g,h,i,a.correlationId);(d=j.body).status=j.status}let f=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return f.validateTokenResponse(d,c),await f.handleServerTokenResponse(d,this.authority,e,a)}async createTokenRequestBody(a){let b=new Map;hn(b,this.config.authOptions.clientId),hm(b,a.scopes,!1),hA(b,es.CLIENT_CREDENTIALS_GRANT),hu(b,this.config.libraryInfo),hv(b,this.config.telemetry.application),hH(b),this.serverTelemetryManager&&hG(b,this.serverTelemetryManager),ht(b,a.correlationId||this.config.cryptoInterface.createNewGuid()),this.config.clientCredentials.clientSecret&&hx(b,this.config.clientCredentials.clientSecret);let c=a.clientAssertion||this.config.clientCredentials.clientAssertion;return c&&(hy(b,await h1(c.assertion,this.config.authOptions.clientId,a.resourceRequestUri)),hz(b,c.assertionType)),(!fD.isEmptyObj(a.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(b,a.claims,this.config.authOptions.clientCapabilities),gp(b)}}class i$ extends hN{constructor(a){super(a)}async acquireToken(a){if(this.scopeSet=new gW(a.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(a.oboAssertion),a.skipCache||a.claims)return this.executeTokenRequest(a,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(a)}catch(b){return await this.executeTokenRequest(a,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(a){let b,c=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,a);if(c){if(gH(c.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(eG.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),gn(f8)}else throw this.serverTelemetryManager?.setCacheOutcome(eG.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),gn(f8);let d=this.readIdTokenFromCacheForOBO(c.homeAccountId,a.correlationId),e=null;if(d){let c=(b=gD(d.secret,iJ.base64Decode)).oid||b.sub,f={homeAccountId:d.homeAccountId,environment:d.environment,tenantId:d.realm,username:eh.EMPTY_STRING,localAccountId:c||eh.EMPTY_STRING};e=this.cacheManager.getAccount(this.cacheManager.generateAccountKey(f),a.correlationId)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),h0.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:e,accessToken:c,idToken:d,refreshToken:null,appMetadata:null},!0,a,b)}readIdTokenFromCacheForOBO(a,b){let c={homeAccountId:a,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ev.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},d=this.cacheManager.getIdTokensByFilter(c,b);return Object.values(d).length<1?null:Object.values(d)[0]}readAccessTokenFromCacheForOBO(a,b){let c=b.authenticationScheme||eA.BEARER,d={credentialType:c&&c.toLowerCase()!==eA.BEARER.toLowerCase()?ev.ACCESS_TOKEN_WITH_AUTH_SCHEME:ev.ACCESS_TOKEN,clientId:a,target:gW.createSearchScopes(this.scopeSet.asArray()),tokenType:c,keyId:b.sshKid,requestedClaimsHash:b.requestedClaimsHash,userAssertionHash:this.userAssertionHash},e=this.cacheManager.getAccessTokensByFilter(d,b.correlationId),f=e.length;if(f<1)return null;if(f>1)throw gn(fS);return e[0]}async executeTokenRequest(a,b,c){let d=this.createTokenQueryParameters(a),e=gq.appendQueryString(b.tokenEndpoint,d),f=await this.createTokenRequestBody(a),g=this.createTokenRequestHeaders(),h={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes,claims:a.claims,authenticationScheme:a.authenticationScheme,resourceRequestMethod:a.resourceRequestMethod,resourceRequestUri:a.resourceRequestUri,shrClaims:a.shrClaims,sshKid:a.sshKid},i=gF(),j=await this.executePostToTokenEndpoint(e,f,g,h,a.correlationId),k=new h0(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return k.validateTokenResponse(j.body),await k.handleServerTokenResponse(j.body,this.authority,i,a,void 0,c)}async createTokenRequestBody(a){var b;let c=new Map;hn(c,this.config.authOptions.clientId),hm(c,a.scopes),hA(c,es.JWT_BEARER),hB(c),hu(c,this.config.libraryInfo),hv(c,this.config.telemetry.application),hH(c),this.serverTelemetryManager&&hG(c,this.serverTelemetryManager),ht(c,a.correlationId||this.config.cryptoInterface.createNewGuid()),c.set("requested_token_use","on_behalf_of"),b=a.oboAssertion,c.set("assertion",b),this.config.clientCredentials.clientSecret&&hx(c,this.config.clientCredentials.clientSecret);let d=this.config.clientCredentials.clientAssertion;return d&&(hy(c,await h1(d.assertion,this.config.authOptions.clientId,a.resourceRequestUri)),hz(c,d.assertionType)),(a.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hs(c,a.claims,this.config.authOptions.clientCapabilities),gp(c)}}class i_ extends iV{constructor(a){super(a);let b=!!this.config.auth.clientSecret,c=!!this.config.auth.clientAssertion,d=(!!this.config.auth.clientCertificate?.thumbprint||!!this.config.auth.clientCertificate?.thumbprintSha256)&&!!this.config.auth.clientCertificate?.privateKey;if(this.appTokenProvider)return;if(b&&c||c&&d||b&&d)throw gn(f7);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(d)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?iT.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):iT.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw gn(f7);this.appTokenProvider=void 0}SetAppTokenProvider(a){this.appTokenProvider=a}async acquireTokenByClientCredential(a){let b,c;this.logger.info("acquireTokenByClientCredential called",a.correlationId),a.clientAssertion&&(b={assertion:await h1(a.clientAssertion,this.config.auth.clientId),assertionType:eT.JWT_BEARER_ASSERTION_TYPE});let d=await this.initializeBaseRequest(a),e={...d,scopes:d.scopes.filter(a=>!ej.includes(a))},f={...a,...e,clientAssertion:b},g=new gq(f.authority).getUrlComponents().PathSegments[0];if(Object.values(em).includes(g))throw gn(gh);let h=process.env.MSAL_FORCE_REGION;"DisableMsalForceRegion"!==f.azureRegion&&(c=!f.azureRegion&&h?h:f.azureRegion);let i={azureRegion:c,environmentRegion:process.env.REGION_NAME},j=this.initializeServerTelemetryManager(eU.acquireTokenByClientCredential,f.correlationId,f.skipCache);try{let b=await this.createAuthority(f.authority,f.correlationId,i,a.azureCloudOptions),c=await this.buildOauthClientConfiguration(b,f.correlationId,"",j),d=new iZ(c,this.appTokenProvider);return this.logger.verbose("Client credential client created",f.correlationId),await d.acquireToken(f)}catch(a){throw a instanceof e$&&a.setCorrelationId(f.correlationId),j.cacheFailedRequest(a),a}}async acquireTokenOnBehalfOf(a){this.logger.info("acquireTokenOnBehalfOf called",a.correlationId);let b={...a,...await this.initializeBaseRequest(a)};try{let c=await this.createAuthority(b.authority,b.correlationId,void 0,a.azureCloudOptions),d=await this.buildOauthClientConfiguration(c,b.correlationId,"",void 0),e=new i$(d);return this.logger.verbose("On behalf of client created",b.correlationId),await e.acquireToken(b)}catch(a){throw a instanceof e$&&a.setCorrelationId(b.correlationId),a}}}class i0{constructor(a,b,c){this.httpClientNoRetries=a,this.retryPolicy=b,this.logger=c}async sendNetworkRequestAsyncHelper(a,b,c){return a===eO.GET?this.httpClientNoRetries.sendGetRequestAsync(b,c):this.httpClientNoRetries.sendPostRequestAsync(b,c)}async sendNetworkRequestAsync(a,b,c){let d=await this.sendNetworkRequestAsyncHelper(a,b,c);"isNewRequest"in this.retryPolicy&&(this.retryPolicy.isNewRequest=!0);let e=0;for(;await this.retryPolicy.pauseForRetry(d.status,e,this.logger,d.headers[el.RETRY_AFTER]);)d=await this.sendNetworkRequestAsyncHelper(a,b,c),e++;return d}async sendGetRequestAsync(a,b){return this.sendNetworkRequestAsync(eO.GET,a,b)}async sendPostRequestAsync(a,b){return this.sendNetworkRequestAsync(eO.POST,a,b)}}let i1={MANAGED_IDENTITY_CLIENT_ID_2017:"clientid",MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"};class i2{constructor(a,b,c,d,e){this.logger=a,this.nodeStorage=b,this.networkClient=c,this.cryptoProvider=d,this.disableInternalRetries=e}async getServerTokenResponseAsync(a,b,c,d){return this.getServerTokenResponse(a)}getServerTokenResponse(a){let b,c;return a.body.expires_on&&(function(a){if("string"!=typeof a)return!1;let b=new Date(a);return!isNaN(b.getTime())&&b.toISOString()===a}(a.body.expires_on)&&(a.body.expires_on=new Date(a.body.expires_on).getTime()/1e3),(c=a.body.expires_on-gF())>7200&&(b=c/2)),{status:a.status,access_token:a.body.access_token,expires_in:c,scope:a.body.resource,token_type:a.body.token_type,refresh_in:b,correlation_id:a.body.correlation_id||a.body.correlationId,error:"string"==typeof a.body.error?a.body.error:a.body.error?.code,error_description:a.body.message||("string"==typeof a.body.error?a.body.error_description:a.body.error?.message),error_codes:a.body.error_codes,timestamp:a.body.timestamp,trace_id:a.body.trace_id}}async acquireTokenWithManagedIdentity(a,b,c,d){let e,f=this.createRequest(a.resource,b);if(a.revokedTokenSha256Hash&&(this.logger.info(`[Managed Identity] The following claims are present in the request: ${a.claims}`),f.queryParameters[eK.SHA256_TOKEN_TO_REFRESH]=a.revokedTokenSha256Hash),a.clientCapabilities?.length){let b=a.clientCapabilities.toString();this.logger.info(`[Managed Identity] The following client capabilities are present in the request: ${b}`),f.queryParameters[eK.XMS_CC]=b}let g=f.headers;g[el.CONTENT_TYPE]=eh.URL_FORM_CONTENT_TYPE;let h={headers:g};Object.keys(f.bodyParameters).length&&(h.body=f.computeParametersBodyString());let i=this.disableInternalRetries?this.networkClient:new i0(this.networkClient,f.retryPolicy,this.logger),j=gF();try{e=f.httpMethod===eO.POST?await i.sendPostRequestAsync(f.computeUri(),h):await i.sendGetRequestAsync(f.computeUri(),h)}catch(a){if(a instanceof e$)throw a;throw gn(fJ)}let k=new h0(b.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),l=await this.getServerTokenResponseAsync(e,i,f,h);return k.validateTokenResponse(l,d),k.handleServerTokenResponse(l,c,j,a)}getManagedIdentityUserAssignedIdQueryParameterKey(a,b,c){switch(a){case eN.USER_ASSIGNED_CLIENT_ID:return this.logger.info(`[Managed Identity] [API version ${c?"2017+":"2019+"}] Adding user assigned client id to the request.`),c?i1.MANAGED_IDENTITY_CLIENT_ID_2017:i1.MANAGED_IDENTITY_CLIENT_ID;case eN.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),b?i1.MANAGED_IDENTITY_RESOURCE_ID_IMDS:i1.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case eN.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),i1.MANAGED_IDENTITY_OBJECT_ID;default:throw ir(id)}}}i2.getValidatedEnvVariableUrlString=(a,b,c,d)=>{try{return new gq(b).urlString}catch(b){throw d.info(`[Managed Identity] ${c} managed identity is unavailable because the '${a}' environment variable is malformed.`),ir(io[a])}};class i3{calculateDelay(a,b){if(!a)return b;let c=Math.round(1e3*parseFloat(a));return isNaN(c)&&(c=new Date(a).valueOf()-new Date().valueOf()),Math.max(b,c)}}let i4=[ei.NOT_FOUND,ei.REQUEST_TIMEOUT,ei.TOO_MANY_REQUESTS,ei.SERVER_ERROR,ei.SERVICE_UNAVAILABLE,ei.GATEWAY_TIMEOUT];class i5{constructor(){this.linearRetryStrategy=new i3}static get DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS(){return 1e3}async pauseForRetry(a,b,c,d){if(i4.includes(a)&&b<3){let a=this.linearRetryStrategy.calculateDelay(d,i5.DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS);return c.verbose(`Retrying request in ${a}ms (retry attempt: ${b+1})`),await new Promise(b=>setTimeout(b,a)),!0}return!1}}class i6{constructor(a,b,c){this.httpMethod=a,this._baseEndpoint=b,this.headers={},this.bodyParameters={},this.queryParameters={},this.retryPolicy=c||new i5}computeUri(){let a=new Map;this.queryParameters&&hD(a,this.queryParameters);let b=gp(a);return gq.appendQueryString(this._baseEndpoint,b)}computeParametersBodyString(){let a=new Map;return this.bodyParameters&&hD(a,this.bodyParameters),gp(a)}}class i7 extends i2{constructor(a,b,c,d,e,f,g){super(a,b,c,d,e),this.identityEndpoint=f,this.identityHeader=g}static getEnvironmentVariables(){return[process.env[eL.IDENTITY_ENDPOINT],process.env[eL.IDENTITY_HEADER]]}static tryCreate(a,b,c,d,e){let[f,g]=i7.getEnvironmentVariables();if(!f||!g)return a.info(`[Managed Identity] ${eM.APP_SERVICE} managed identity is unavailable because one or both of the '${eL.IDENTITY_HEADER}' and '${eL.IDENTITY_ENDPOINT}' environment variables are not defined.`),null;let h=i7.getValidatedEnvVariableUrlString(eL.IDENTITY_ENDPOINT,f,eM.APP_SERVICE,a);return a.info(`[Managed Identity] Environment variables validation passed for ${eM.APP_SERVICE} managed identity. Endpoint URI: ${h}. Creating ${eM.APP_SERVICE} managed identity.`),new i7(a,b,c,d,e,f,g)}createRequest(a,b){let c=new i6(eO.GET,this.identityEndpoint);return c.headers[eJ.APP_SERVICE_SECRET_HEADER_NAME]=this.identityHeader,c.queryParameters[eK.API_VERSION]="2019-08-01",c.queryParameters[eK.RESOURCE]=a,b.idType!==eN.SYSTEM_ASSIGNED&&(c.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(b.idType)]=b.id),c}}let i8=require("fs");var i9=c(33873);let ja="http://127.0.0.1:40342/metadata/identity/oauth2/token",jb="N/A: himds executable exists",jc={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},jd={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"};class je extends i2{constructor(a,b,c,d,e,f){super(a,b,c,d,e),this.identityEndpoint=f}static getEnvironmentVariables(){let a=process.env[eL.IDENTITY_ENDPOINT],b=process.env[eL.IMDS_ENDPOINT];if(!a||!b){let c=jd[process.platform];try{(0,i8.accessSync)(c,i8.constants.F_OK|i8.constants.R_OK),a=ja,b=jb}catch(a){}}return[a,b]}static tryCreate(a,b,c,d,e,f){let[g,h]=je.getEnvironmentVariables();if(!g||!h)return a.info(`[Managed Identity] ${eM.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${eL.IDENTITY_ENDPOINT}' and '${eL.IMDS_ENDPOINT}' are not defined. ${eM.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(h===jb)a.info(`[Managed Identity] ${eM.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${eM.AZURE_ARC} endpoint: ${ja}. Creating ${eM.AZURE_ARC} managed identity.`);else{let b=je.getValidatedEnvVariableUrlString(eL.IDENTITY_ENDPOINT,g,eM.AZURE_ARC,a);b.endsWith("/")&&b.slice(0,-1),je.getValidatedEnvVariableUrlString(eL.IMDS_ENDPOINT,h,eM.AZURE_ARC,a),a.info(`[Managed Identity] Environment variables validation passed for ${eM.AZURE_ARC} managed identity. Endpoint URI: ${b}. Creating ${eM.AZURE_ARC} managed identity.`)}if(f.idType!==eN.SYSTEM_ASSIGNED)throw ir(ih);return new je(a,b,c,d,e,g)}createRequest(a){let b=new i6(eO.GET,this.identityEndpoint.replace("localhost","127.0.0.1"));return b.headers[eJ.METADATA_HEADER_NAME]="true",b.queryParameters[eK.API_VERSION]="2019-11-01",b.queryParameters[eK.RESOURCE]=a,b}async getServerTokenResponseAsync(a,b,c,d){let e;if(a.status===ei.UNAUTHORIZED){let f,g,h=a.headers["www-authenticate"];if(!h)throw ir(il);if(!h.includes("Basic realm="))throw ir(im);let i=h.split("Basic realm=")[1];if(!jc.hasOwnProperty(process.platform))throw ir(ig);let j=jc[process.platform],k=i9.basename(i);if(!k.endsWith(".key"))throw ir(ib);if(j+k!==i)throw ir(ic);try{f=await (0,i8.statSync)(i).size}catch(a){throw ir(ik)}if(f>4096)throw ir(ie);try{g=(0,i8.readFileSync)(i,eH.UTF8)}catch(a){throw ir(ik)}let l=`Basic ${g}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),c.headers[eJ.AUTHORIZATION_HEADER_NAME]=l;try{e=await b.sendGetRequestAsync(c.computeUri(),d)}catch(a){if(a instanceof e$)throw a;throw gn(fJ)}}return this.getServerTokenResponse(e||a)}}class jf extends i2{constructor(a,b,c,d,e,f){super(a,b,c,d,e),this.msiEndpoint=f}static getEnvironmentVariables(){return[process.env[eL.MSI_ENDPOINT]]}static tryCreate(a,b,c,d,e,f){let[g]=jf.getEnvironmentVariables();if(!g)return a.info(`[Managed Identity] ${eM.CLOUD_SHELL} managed identity is unavailable because the '${eL.MSI_ENDPOINT} environment variable is not defined.`),null;let h=jf.getValidatedEnvVariableUrlString(eL.MSI_ENDPOINT,g,eM.CLOUD_SHELL,a);if(a.info(`[Managed Identity] Environment variable validation passed for ${eM.CLOUD_SHELL} managed identity. Endpoint URI: ${h}. Creating ${eM.CLOUD_SHELL} managed identity.`),f.idType!==eN.SYSTEM_ASSIGNED)throw ir(ii);return new jf(a,b,c,d,e,g)}createRequest(a){let b=new i6(eO.POST,this.msiEndpoint);return b.headers[eJ.METADATA_HEADER_NAME]="true",b.bodyParameters[eK.RESOURCE]=a,b}}class jg{constructor(a,b,c){this.minExponentialBackoff=a,this.maxExponentialBackoff=b,this.exponentialDeltaBackoff=c}calculateDelay(a){return 0===a?this.minExponentialBackoff:Math.min(Math.pow(2,a-1)*this.exponentialDeltaBackoff,this.maxExponentialBackoff)}}let jh=[ei.NOT_FOUND,ei.REQUEST_TIMEOUT,ei.GONE,ei.TOO_MANY_REQUESTS];class ji{constructor(){this.exponentialRetryStrategy=new jg(ji.MIN_EXPONENTIAL_BACKOFF_MS,ji.MAX_EXPONENTIAL_BACKOFF_MS,ji.EXPONENTIAL_DELTA_BACKOFF_MS)}static get MIN_EXPONENTIAL_BACKOFF_MS(){return 1e3}static get MAX_EXPONENTIAL_BACKOFF_MS(){return 4e3}static get EXPONENTIAL_DELTA_BACKOFF_MS(){return 2e3}static get HTTP_STATUS_GONE_RETRY_AFTER_MS(){return 1e4}set isNewRequest(a){this._isNewRequest=a}async pauseForRetry(a,b,c){if(this._isNewRequest&&(this._isNewRequest=!1,this.maxRetries=a===ei.GONE?7:3),(jh.includes(a)||a>=ei.SERVER_ERROR_RANGE_START&&a<=ei.SERVER_ERROR_RANGE_END&&b<this.maxRetries)&&b<this.maxRetries){let d=a===ei.GONE?ji.HTTP_STATUS_GONE_RETRY_AFTER_MS:this.exponentialRetryStrategy.calculateDelay(b);return c.verbose(`Retrying request in ${d}ms (retry attempt: ${b+1})`),await new Promise(a=>setTimeout(a,d)),!0}return!1}}let jj="/metadata/identity/oauth2/token",jk=`http://169.254.169.254${jj}`;class jl extends i2{constructor(a,b,c,d,e,f){super(a,b,c,d,e),this.identityEndpoint=f}static tryCreate(a,b,c,d,e){let f;return process.env[eL.AZURE_POD_IDENTITY_AUTHORITY_HOST]?(a.info(`[Managed Identity] Environment variable ${eL.AZURE_POD_IDENTITY_AUTHORITY_HOST} for ${eM.IMDS} returned endpoint: ${process.env[eL.AZURE_POD_IDENTITY_AUTHORITY_HOST]}`),f=jl.getValidatedEnvVariableUrlString(eL.AZURE_POD_IDENTITY_AUTHORITY_HOST,`${process.env[eL.AZURE_POD_IDENTITY_AUTHORITY_HOST]}${jj}`,eM.IMDS,a)):(a.info(`[Managed Identity] Unable to find ${eL.AZURE_POD_IDENTITY_AUTHORITY_HOST} environment variable for ${eM.IMDS}, using the default endpoint.`),f=jk),new jl(a,b,c,d,e,f)}createRequest(a,b){let c=new i6(eO.GET,this.identityEndpoint);return c.headers[eJ.METADATA_HEADER_NAME]="true",c.queryParameters[eK.API_VERSION]="2018-02-01",c.queryParameters[eK.RESOURCE]=a,b.idType!==eN.SYSTEM_ASSIGNED&&(c.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(b.idType,!0)]=b.id),c.retryPolicy=new ji,c}}class jm extends i2{constructor(a,b,c,d,e,f,g){super(a,b,c,d,e),this.identityEndpoint=f,this.identityHeader=g}static getEnvironmentVariables(){let a=process.env[eL.IDENTITY_ENDPOINT];return[a,process.env[eL.IDENTITY_HEADER],process.env[eL.IDENTITY_SERVER_THUMBPRINT]]}static tryCreate(a,b,c,d,e,f){let[g,h,i]=jm.getEnvironmentVariables();if(!g||!h||!i)return a.info(`[Managed Identity] ${eM.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${eL.IDENTITY_HEADER}', '${eL.IDENTITY_ENDPOINT}' or '${eL.IDENTITY_SERVER_THUMBPRINT}' environment variables are not defined.`),null;let j=jm.getValidatedEnvVariableUrlString(eL.IDENTITY_ENDPOINT,g,eM.SERVICE_FABRIC,a);return a.info(`[Managed Identity] Environment variables validation passed for ${eM.SERVICE_FABRIC} managed identity. Endpoint URI: ${j}. Creating ${eM.SERVICE_FABRIC} managed identity.`),f.idType!==eN.SYSTEM_ASSIGNED&&a.warning(`[Managed Identity] ${eM.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new jm(a,b,c,d,e,g,h)}createRequest(a,b){let c=new i6(eO.GET,this.identityEndpoint);return c.headers[eJ.ML_AND_SF_SECRET_HEADER_NAME]=this.identityHeader,c.queryParameters[eK.API_VERSION]="2019-07-01-preview",c.queryParameters[eK.RESOURCE]=a,b.idType!==eN.SYSTEM_ASSIGNED&&(c.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(b.idType)]=b.id),c}}let jn=`Only client id is supported for user-assigned managed identity in ${eM.MACHINE_LEARNING}.`;class jo extends i2{constructor(a,b,c,d,e,f,g){super(a,b,c,d,e),this.msiEndpoint=f,this.secret=g}static getEnvironmentVariables(){return[process.env[eL.MSI_ENDPOINT],process.env[eL.MSI_SECRET]]}static tryCreate(a,b,c,d,e){let[f,g]=jo.getEnvironmentVariables();if(!f||!g)return a.info(`[Managed Identity] ${eM.MACHINE_LEARNING} managed identity is unavailable because one or both of the '${eL.MSI_ENDPOINT}' and '${eL.MSI_SECRET}' environment variables are not defined.`),null;let h=jo.getValidatedEnvVariableUrlString(eL.MSI_ENDPOINT,f,eM.MACHINE_LEARNING,a);return a.info(`[Managed Identity] Environment variables validation passed for ${eM.MACHINE_LEARNING} managed identity. Endpoint URI: ${h}. Creating ${eM.MACHINE_LEARNING} managed identity.`),new jo(a,b,c,d,e,f,g)}createRequest(a,b){let c=new i6(eO.GET,this.msiEndpoint);if(c.headers[eJ.METADATA_HEADER_NAME]="true",c.headers[eJ.ML_AND_SF_SECRET_HEADER_NAME]=this.secret,c.queryParameters[eK.API_VERSION]="2017-09-01",c.queryParameters[eK.RESOURCE]=a,b.idType===eN.SYSTEM_ASSIGNED)c.queryParameters[i1.MANAGED_IDENTITY_CLIENT_ID_2017]=process.env[eL.DEFAULT_IDENTITY_CLIENT_ID];else if(b.idType===eN.USER_ASSIGNED_CLIENT_ID)c.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(b.idType,!1,!0)]=b.id;else throw Error(jn);return c}}class jp{constructor(a,b,c,d,e){this.logger=a,this.nodeStorage=b,this.networkClient=c,this.cryptoProvider=d,this.disableInternalRetries=e}async sendManagedIdentityTokenRequest(a,b,c,d){return jp.identitySource||(jp.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,this.disableInternalRetries,b)),jp.identitySource.acquireTokenWithManagedIdentity(a,b,c,d)}allEnvironmentVariablesAreDefined(a){return Object.values(a).every(a=>void 0!==a)}getManagedIdentitySource(){return jp.sourceName=this.allEnvironmentVariablesAreDefined(jm.getEnvironmentVariables())?eM.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(i7.getEnvironmentVariables())?eM.APP_SERVICE:this.allEnvironmentVariablesAreDefined(jo.getEnvironmentVariables())?eM.MACHINE_LEARNING:this.allEnvironmentVariablesAreDefined(jf.getEnvironmentVariables())?eM.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(je.getEnvironmentVariables())?eM.AZURE_ARC:eM.DEFAULT_TO_IMDS,jp.sourceName}selectManagedIdentitySource(a,b,c,d,e,f){let g=jm.tryCreate(a,b,c,d,e,f)||i7.tryCreate(a,b,c,d,e)||jo.tryCreate(a,b,c,d,e)||jf.tryCreate(a,b,c,d,e,f)||je.tryCreate(a,b,c,d,e,f)||jl.tryCreate(a,b,c,d,e);if(!g)throw ir(ij);return g}}let jq=[eM.SERVICE_FABRIC];class jr{constructor(a){this.config=function({clientCapabilities:a,managedIdentityIdParams:b,system:c}){let d=new is(b);return{clientCapabilities:a||[],managedIdentityId:d,system:{loggerOptions:c?.loggerOptions||ix,networkClient:c?.networkClient?c.networkClient:new ia(c?.proxyUrl,c?.customAgentOptions)},disableInternalRetries:c?.disableInternalRetries||!1}}(a||{}),this.logger=new fa(this.config.system.loggerOptions,h6,h7);let b={canonicalAuthority:eh.DEFAULT_AUTHORITY};jr.nodeStorage||(jr.nodeStorage=new iP(this.logger,this.config.managedIdentityId.id,gT,b)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new iM;let c={protocolMode:gx.AAD,knownAuthorities:[eI],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new gR(eI,this.networkClient,jr.nodeStorage,c,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new iZ({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new jp(this.logger,jr.nodeStorage,this.networkClient,this.cryptoProvider,this.config.disableInternalRetries),this.hashUtils=new iK}async acquireToken(a){if(!a.resource)throw fC(fg);let b={forceRefresh:a.forceRefresh,resource:a.resource.replace("/.default",""),scopes:[a.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid(),claims:a.claims,clientCapabilities:this.config.clientCapabilities};if(b.forceRefresh)return this.acquireTokenFromManagedIdentity(b,this.config.managedIdentityId,this.fakeAuthority);let[c,d]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(b,this.config,this.cryptoProvider,this.fakeAuthority,jr.nodeStorage);if(b.claims){let a=this.managedIdentityClient.getManagedIdentitySource();return c&&jq.includes(a)&&(b.revokedTokenSha256Hash=this.hashUtils.sha256(c.accessToken).toString(eH.HEX)),this.acquireTokenFromManagedIdentity(b,this.config.managedIdentityId,this.fakeAuthority)}return c?(d===eG.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.acquireTokenFromManagedIdentity(b,this.config.managedIdentityId,this.fakeAuthority,!0)),c):this.acquireTokenFromManagedIdentity(b,this.config.managedIdentityId,this.fakeAuthority)}async acquireTokenFromManagedIdentity(a,b,c,d){return this.managedIdentityClient.sendManagedIdentityTokenRequest(a,b,c,d)}getManagedIdentitySource(){return jp.sourceName||this.managedIdentityClient.getManagedIdentitySource()}}function js(a,b){var c,d;let e=b.retryDelayInMs*Math.pow(2,a),f=Math.min(b.maxRetryDelayInMs,e);return{retryAfterInMs:f/2+(c=0,d=f/2,c=Math.ceil(c),Math.floor(Math.random()*((d=Math.floor(d))-c+1))+c)}}function jt(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)&&!(a instanceof RegExp)&&!(a instanceof Date)}function ju(a){if(jt(a)){let b="string"==typeof a.name,c="string"==typeof a.message;return b&&c}return!1}let jv=require("node:crypto");"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof self?.importScripts&&(self.constructor?.name==="DedicatedWorkerGlobalScope"||self.constructor?.name==="ServiceWorkerGlobalScope"||self.constructor?.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;let jw=void 0!==globalThis.process&&!!globalThis.process.version&&!!globalThis.process.versions?.node;"undefined"!=typeof navigator&&navigator?.product;let jx="REDACTED",jy=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],jz=["api-version"];class jA{allowedHeaderNames;allowedQueryParameters;constructor({additionalAllowedHeaderNames:a=[],additionalAllowedQueryParameters:b=[]}={}){a=jy.concat(a),b=jz.concat(b),this.allowedHeaderNames=new Set(a.map(a=>a.toLowerCase())),this.allowedQueryParameters=new Set(b.map(a=>a.toLowerCase()))}sanitize(a){let b=new Set;return JSON.stringify(a,(a,c)=>{if(c instanceof Error)return{...c,name:c.name,message:c.message};if("headers"===a)return this.sanitizeHeaders(c);if("url"===a)return this.sanitizeUrl(c);if("query"===a)return this.sanitizeQuery(c);if("body"!==a){if("response"===a)return;else if("operationSpec"===a)return;else if(Array.isArray(c)||jt(c)){if(b.has(c))return"[Circular]";b.add(c)}return c}},2)}sanitizeUrl(a){if("string"!=typeof a||null===a||""===a)return a;let b=new URL(a);if(!b.search)return a;for(let[a]of b.searchParams)this.allowedQueryParameters.has(a.toLowerCase())||b.searchParams.set(a,jx);return b.toString()}sanitizeHeaders(a){let b={};for(let c of Object.keys(a))this.allowedHeaderNames.has(c.toLowerCase())?b[c]=a[c]:b[c]=jx;return b}sanitizeQuery(a){if("object"!=typeof a||null===a)return a;let b={};for(let c of Object.keys(a))this.allowedQueryParameters.has(c.toLowerCase())?b[c]=a[c]:b[c]=jx;return b}}class jB extends Error{constructor(a){super(a),this.name="AbortError"}}function jC(a){if(ju(a))return a.message;{let b;try{b="object"==typeof a&&a?JSON.stringify(a):String(a)}catch(a){b="[unable to stringify input]"}return`Unknown error ${b}`}}let jD=jw,jE=d8("IdentityUtils");function jF(a,b,c){let d=b=>(jE.getToken.info(b),new dG({scopes:Array.isArray(a)?a:[a],getTokenOptions:c,message:b}));if(!b)throw d("No response");if(!b.expiresOn)throw d('Response had no "expiresOn" property.');if(!b.accessToken)throw d('Response had no "accessToken" property.')}function jG(a){let b=a?.authorityHost;return!b&&jw&&(b=process.env.AZURE_AUTHORITY_HOST),b??dw}function jH(a,b){return(b||(b=dw),RegExp(`${a}/?$`).test(b))?b:b.endsWith("/")?b+a:`${b}/${a}`}let jI=(a,b=jD?"Node":"Browser")=>(c,d,e)=>{if(!e)switch(c){case aL.Error:a.info(`MSAL ${b} V2 error: ${d}`);return;case aL.Info:a.info(`MSAL ${b} V2 info message: ${d}`);return;case aL.Verbose:a.info(`MSAL ${b} V2 verbose message: ${d}`);return;case aL.Warning:a.info(`MSAL ${b} V2 warning: ${d}`);return}};function jJ(a){switch(a){case"error":return aL.Error;case"info":default:return aL.Info;case"verbose":return aL.Verbose;case"warning":return aL.Warning}}function jK(a,b,c){if("AuthError"===b.name||"ClientAuthError"===b.name||"BrowserAuthError"===b.name)switch(b.errorCode){case"endpoints_resolution_error":return jE.info(d6(a,b.message)),new dB(b.message);case"device_code_polling_cancelled":return new jB("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":jE.info(d6(a,`Authentication returned errorCode ${b.errorCode}`));break;default:jE.info(d6(a,`Failed to acquire token: ${b.message}`))}return"ClientConfigurationError"===b.name||"BrowserConfigurationAuthError"===b.name||"AbortError"===b.name||"AuthenticationError"===b.name?b:"NativeAuthError"===b.name?(jE.info(d6(a,`Error from the native broker: ${b.message} with status code: ${b.statusCode}`)),b):new dG({scopes:a,getTokenOptions:c,message:b.message})}let jL={Sequence:"Sequence",String:"String",Stream:"Stream"};class jM extends Error{constructor(a){super(a),this.name="AbortError"}}function jN(a){return a.toLowerCase()}class jO{_headersMap;constructor(a){if(this._headersMap=new Map,a)for(let b of Object.keys(a))this.set(b,a[b])}set(a,b){this._headersMap.set(jN(a),{name:a,value:String(b).trim()})}get(a){return this._headersMap.get(jN(a))?.value}has(a){return this._headersMap.has(jN(a))}delete(a){this._headersMap.delete(jN(a))}toJSON(a={}){let b={};if(a.preserveCase)for(let a of this._headersMap.values())b[a.name]=a.value;else for(let[a,c]of this._headersMap)b[a]=c.value;return b}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(a){for(let b of a.values())yield[b.name,b.value]}(this._headersMap)}}function jP(a){return new jO(a)}function jQ(){return crypto.randomUUID()}class jR{url;method;headers;timeout;withCredentials;body;multipartBody;formData;streamResponseStatusCodes;enableBrowserStreams;proxySettings;disableKeepAlive;abortSignal;requestId;allowInsecureConnection;onUploadProgress;onDownloadProgress;requestOverrides;authSchemes;constructor(a){this.url=a.url,this.body=a.body,this.headers=a.headers??jP(),this.method=a.method??"GET",this.timeout=a.timeout??0,this.multipartBody=a.multipartBody,this.formData=a.formData,this.disableKeepAlive=a.disableKeepAlive??!1,this.proxySettings=a.proxySettings,this.streamResponseStatusCodes=a.streamResponseStatusCodes,this.withCredentials=a.withCredentials??!1,this.abortSignal=a.abortSignal,this.onUploadProgress=a.onUploadProgress,this.onDownloadProgress=a.onDownloadProgress,this.requestId=a.requestId||jQ(),this.allowInsecureConnection=a.allowInsecureConnection??!1,this.enableBrowserStreams=a.enableBrowserStreams??!1,this.requestOverrides=a.requestOverrides,this.authSchemes=a.authSchemes}}let jS=new Set(["Deserialize","Serialize","Retry","Sign"]);class jT{_policies=[];_orderedPolicies;constructor(a){this._policies=a?.slice(0)??[],this._orderedPolicies=void 0}addPolicy(a,b={}){if(b.phase&&b.afterPhase)throw Error("Policies inside a phase cannot specify afterPhase.");if(b.phase&&!jS.has(b.phase))throw Error(`Invalid phase name: ${b.phase}`);if(b.afterPhase&&!jS.has(b.afterPhase))throw Error(`Invalid afterPhase name: ${b.afterPhase}`);this._policies.push({policy:a,options:b}),this._orderedPolicies=void 0}removePolicy(a){let b=[];return this._policies=this._policies.filter(c=>(!a.name||c.policy.name!==a.name)&&(!a.phase||c.options.phase!==a.phase)||(b.push(c.policy),!1)),this._orderedPolicies=void 0,b}sendRequest(a,b){return this.getOrderedPolicies().reduceRight((a,b)=>c=>b.sendRequest(c,a),b=>a.sendRequest(b))(b)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new jT(this._policies)}static create(){return new jT}orderPolicies(){let a=[],b=new Map;function c(a){return{name:a,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let d=c("Serialize"),e=c("None"),f=c("Deserialize"),g=c("Retry"),h=c("Sign"),i=[d,e,f,g,h];function j(a){return"Retry"===a?g:"Serialize"===a?d:"Deserialize"===a?f:"Sign"===a?h:e}for(let a of this._policies){let c=a.policy,d=a.options,e=c.name;if(b.has(e))throw Error("Duplicate policy names not allowed in pipeline");let f={policy:c,dependsOn:new Set,dependants:new Set};d.afterPhase&&(f.afterPhase=j(d.afterPhase),f.afterPhase.hasAfterPolicies=!0),b.set(e,f),j(d.phase).policies.add(f)}for(let a of this._policies){let{policy:c,options:d}=a,e=c.name,f=b.get(e);if(!f)throw Error(`Missing node for policy ${e}`);if(d.afterPolicies)for(let a of d.afterPolicies){let c=b.get(a);c&&(f.dependsOn.add(c),c.dependants.add(f))}if(d.beforePolicies)for(let a of d.beforePolicies){let c=b.get(a);c&&(c.dependsOn.add(f),f.dependants.add(c))}}function k(c){for(let d of(c.hasRun=!0,c.policies))if((!d.afterPhase||d.afterPhase.hasRun&&!d.afterPhase.policies.size)&&0===d.dependsOn.size){for(let b of(a.push(d.policy),d.dependants))b.dependsOn.delete(d);b.delete(d.policy.name),c.policies.delete(d)}}let l=0;for(;b.size>0;){l++;let b=a.length;if(!function(){for(let a of i){if(k(a),a.policies.size>0&&a!==e){e.hasRun||k(e);return}a.hasAfterPolicies&&k(e)}}(),a.length<=b&&l>1)throw Error("Cannot satisfy policy dependencies due to requirements cycle.")}return a}}let jU=dI.inspect.custom,jV=new jA;class jW extends Error{static REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";static PARSE_ERROR="PARSE_ERROR";code;statusCode;request;response;details;constructor(a,b={}){super(a),this.name="RestError",this.code=b.code,this.statusCode=b.statusCode,Object.defineProperty(this,"request",{value:b.request,enumerable:!1}),Object.defineProperty(this,"response",{value:b.response,enumerable:!1});let c=this.request?.agent?{maxFreeSockets:this.request.agent.maxFreeSockets,maxSockets:this.request.agent.maxSockets}:void 0;Object.defineProperty(this,jU,{value:()=>`RestError: ${this.message} 
 ${jV.sanitize({...this,request:{...this.request,agent:c},response:this.response})}`,enumerable:!1}),Object.setPrototypeOf(this,jW.prototype)}}let jX=require("node:http"),jY=require("node:https"),jZ=require("node:zlib"),j$=require("node:stream"),j_=d_("ts-http-runtime"),j0={};function j1(a){return a&&"function"==typeof a.pipe}function j2(a){return!1===a.readable?Promise.resolve():new Promise(b=>{let c=()=>{b(),a.removeListener("close",c),a.removeListener("end",c),a.removeListener("error",c)};a.on("close",c),a.on("end",c),a.on("error",c)})}function j3(a){return a&&"number"==typeof a.byteLength}class j4 extends j$.Transform{loadedBytes=0;progressCallback;_transform(a,b,c){this.push(a),this.loadedBytes+=a.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),c()}catch(a){c(a)}}constructor(a){super(),this.progressCallback=a}}class j5{cachedHttpAgent;cachedHttpsAgents=new WeakMap;async sendRequest(a){let b,c,d,e=new AbortController;if(a.abortSignal){if(a.abortSignal.aborted)throw new jM("The operation was aborted. Request has already been canceled.");b=a=>{"abort"===a.type&&e.abort()},a.abortSignal.addEventListener("abort",b)}a.timeout>0&&(c=setTimeout(()=>{let b=new jA;j_.info(`request to '${b.sanitizeUrl(a.url)}' timed out. canceling...`),e.abort()},a.timeout));let f=a.headers.get("Accept-Encoding"),g=f?.includes("gzip")||f?.includes("deflate"),h="function"==typeof a.body?a.body():a.body;if(h&&!a.headers.has("Content-Length")){let b=function(a){if(!a)return 0;if(Buffer.isBuffer(a))return a.length;if(j1(a))return null;if(j3(a))return a.byteLength;if("string"==typeof a)return Buffer.from(a).length;else return null}(h);null!==b&&a.headers.set("Content-Length",b)}try{var i;if(h&&a.onUploadProgress){let b=a.onUploadProgress,c=new j4(b);c.on("error",a=>{j_.error("Error in upload progress",a)}),j1(h)?h.pipe(c):c.end(h),h=c}let b=await this.makeRequest(a,e,h);void 0!==c&&clearTimeout(c);let f=function(a){let b=jP();for(let c of Object.keys(a.headers)){let d=a.headers[c];Array.isArray(d)?d.length>0&&b.set(c,d[0]):d&&b.set(c,d)}return b}(b),j={status:b.statusCode??0,headers:f,request:a};if("HEAD"===a.method)return b.resume(),j;d=g?function(a,b){let c=b.get("Content-Encoding");if("gzip"===c){let b=jZ.createGunzip();return a.pipe(b),b}if("deflate"===c){let b=jZ.createInflate();return a.pipe(b),b}return a}(b,f):b;let k=a.onDownloadProgress;if(k){let a=new j4(k);a.on("error",a=>{j_.error("Error in download progress",a)}),d.pipe(a),d=a}return a.streamResponseStatusCodes?.has(1/0)||a.streamResponseStatusCodes?.has(j.status)?j.readableStreamBody=d:j.bodyAsText=await (i=d,new Promise((a,b)=>{let c=[];i.on("data",a=>{Buffer.isBuffer(a)?c.push(a):c.push(Buffer.from(a))}),i.on("end",()=>{a(Buffer.concat(c).toString("utf8"))}),i.on("error",a=>{a&&a?.name==="AbortError"?b(a):b(new jW(`Error reading response as text: ${a.message}`,{code:jW.PARSE_ERROR}))})})),j}finally{if(a.abortSignal&&b){let c=Promise.resolve();j1(h)&&(c=j2(h));let e=Promise.resolve();j1(d)&&(e=j2(d)),Promise.all([c,e]).then(()=>{b&&a.abortSignal?.removeEventListener("abort",b)}).catch(a=>{j_.warning("Error when cleaning up abortListener on httpRequest",a)})}}}makeRequest(a,b,c){let d=new URL(a.url),e="https:"!==d.protocol;if(e&&!a.allowInsecureConnection)throw Error(`Cannot connect to ${a.url} while allowInsecureConnection is false.`);let f={agent:a.agent??this.getOrCreateAgent(a,e),hostname:d.hostname,path:`${d.pathname}${d.search}`,port:d.port,method:a.method,headers:a.headers.toJSON({preserveCase:!0}),...a.requestOverrides};return new Promise((d,g)=>{let h=e?jX.request(f,d):jY.request(f,d);h.once("error",b=>{g(new jW(b.message,{code:b.code??jW.REQUEST_SEND_ERROR,request:a}))}),b.signal.addEventListener("abort",()=>{let a=new jM("The operation was aborted. Rejecting from abort signal callback while making request.");h.destroy(a),g(a)}),c&&j1(c)?c.pipe(h):c?"string"==typeof c||Buffer.isBuffer(c)?h.end(c):j3(c)?h.end(ArrayBuffer.isView(c)?Buffer.from(c.buffer):Buffer.from(c)):(j_.error("Unrecognized body type",c),g(new jW("Unrecognized body type"))):h.end()})}getOrCreateAgent(a,b){let c=a.disableKeepAlive;if(b)return c?jX.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new jX.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(c&&!a.tlsSettings)return jY.globalAgent;let b=a.tlsSettings??j0,d=this.cachedHttpsAgents.get(b);return d&&!c===d.options.keepAlive||(j_.info("No cached TLS Agent exist, creating a new Agent"),d=new jY.Agent({keepAlive:!c,...b}),this.cachedHttpsAgents.set(b,d)),d}}}let j6="Retry-After",j7=["retry-after-ms","x-ms-retry-after-ms",j6];function j8(a){if(a&&[429,503].includes(a.status))try{for(let b of j7){let c=function(a,b){let c=a.headers.get(b);if(!c)return;let d=Number(c);if(!Number.isNaN(d))return d}(a,b);if(0===c||c){let a=b===j6?1e3:1;return c*a}}let b=a.headers.get(j6);if(!b)return;let c=Date.parse(b)-Date.now();return Number.isFinite(c)?Math.max(0,c):void 0}catch{return}}let j9=d_("ts-http-runtime retryPolicy");function ka(a,b={maxRetries:3}){let c=b.logger||j9;return{name:"retryPolicy",async sendRequest(d,e){let f,g,h=-1;g:for(;;){h+=1,f=void 0,g=void 0;try{c.info(`Retry ${h}: Attempting to send request`,d.requestId),f=await e(d),c.info(`Retry ${h}: Received a response from request`,d.requestId)}catch(a){if(c.error(`Retry ${h}: Received an error from request`,d.requestId),g=a,!a||"RestError"!==g.name)throw a;f=g.response}if(d.abortSignal?.aborted)throw c.error(`Retry ${h}: Request aborted.`),new jM;if(h>=(b.maxRetries??3)){if(c.info(`Retry ${h}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),g)throw g;if(f)return f;throw Error("Maximum retries reached with no response or error to throw")}for(let b of(c.info(`Retry ${h}: Processing ${a.length} retry strategies.`),a)){let a=b.logger||c;a.info(`Retry ${h}: Processing retry strategy ${b.name}.`);let e=b.retry({retryCount:h,response:f,responseError:g});if(e.skipStrategy){a.info(`Retry ${h}: Skipped.`);continue}let{errorToThrow:i,retryAfterInMs:j,redirectTo:k}=e;if(i)throw a.error(`Retry ${h}: Retry strategy ${b.name} throws error:`,i),i;if(j||0===j){a.info(`Retry ${h}: Retry strategy ${b.name} retries after ${j}`),await function(a,b,c){return new Promise((d,e)=>{let f,g,h=()=>e(new jM(c?.abortErrorMsg?c?.abortErrorMsg:"The operation was aborted.")),i=()=>{c?.abortSignal&&g&&c.abortSignal.removeEventListener("abort",g)};if(g=()=>(f&&clearTimeout(f),i(),h()),c?.abortSignal&&c.abortSignal.aborted)return h();f=setTimeout(()=>{i(),d(b)},a),c?.abortSignal&&c.abortSignal.addEventListener("abort",g)})}(j,void 0,{abortSignal:d.abortSignal});continue g}if(k){a.info(`Retry ${h}: Retry strategy ${b.name} redirects to ${k}`),d.url=k;continue g}}if(g)throw c.info("None of the retry strategies could work with the received error. Throwing it."),g;if(f)return c.info("None of the retry strategies could work with the received response. Returning it."),f}}}}function kb(a,b){return Buffer.from(a,b)}async function kc(a,b){let c=b.headers.get("Content-Type");if(c&&!c.startsWith("multipart/form-data"))return;b.headers.set("Content-Type",c??"multipart/form-data");let d=[];for(let[b,c]of Object.entries(a))for(let a of Array.isArray(c)?c:[c])if("string"==typeof a)d.push({headers:jP({"Content-Disposition":`form-data; name="${b}"`}),body:kb(a,"utf-8")});else if(null==a||"object"!=typeof a)throw Error(`Unexpected value for key ${b}: ${a}. Value should be serialized to string first.`);else{let c=a.name||"blob",e=jP();e.set("Content-Disposition",`form-data; name="${b}"; filename="${c}"`),e.set("Content-Type",a.type||"application/octet-stream"),d.push({headers:e,body:a})}b.multipartBody={parts:d}}var kd=c(68131),ke=c(69948);let kf=[],kg=!1,kh=new Map;function ki(a){return process.env[a]?process.env[a]:process.env[a.toLowerCase()]?process.env[a.toLowerCase()]:void 0}function kj(a){let b;try{b=new URL(a.host)}catch{throw Error(`Expecting a valid host string in proxy settings, but found "${a.host}".`)}return b.port=String(a.port),a.username&&(b.username=a.username),a.password&&(b.password=a.password),b}function kk(a,b,c){if(a.agent)return;let d="https:"!==new URL(a.url).protocol;a.tlsSettings&&j_.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let e=a.headers.toJSON();d?(b.httpProxyAgent||(b.httpProxyAgent=new ke.HttpProxyAgent(c,{headers:e})),a.agent=b.httpProxyAgent):(b.httpsProxyAgent||(b.httpsProxyAgent=new kd.HttpsProxyAgent(c,{headers:e})),a.agent=b.httpsProxyAgent)}function kl(a){return"function"==typeof a.stream}var km=c(27910);async function*kn(){let a=this.getReader();try{for(;;){let{done:b,value:c}=await a.read();if(b)return;yield c}}finally{a.releaseLock()}}function ko(a){return a instanceof ReadableStream?(a[Symbol.asyncIterator]||(a[Symbol.asyncIterator]=kn.bind(a)),a.values||(a.values=kn.bind(a)),km.Readable.fromWeb(a)):a}function kp(a){return a instanceof Uint8Array?km.Readable.from(Buffer.from(a)):kl(a)?ko(a.stream()):ko(a)}async function kq(a){return function(){let b=a.map(a=>"function"==typeof a?a():a).map(kp);return km.Readable.from(async function*(){for(let a of b)for await(let b of a)yield b}())}}async function kr(a,b,c){let d=[kb(`--${c}`,"utf-8"),...b.flatMap(a=>[kb("\r\n","utf-8"),kb(function(a){let b="";for(let[c,d]of a)b+=`${c}: ${d}\r
`;return b}(a.headers),"utf-8"),kb("\r\n","utf-8"),a.body,kb(`\r
--${c}`,"utf-8")]),kb("--\r\n\r\n","utf-8")],e=function(a){let b=0;for(let c of a){let a=c instanceof Uint8Array?c.byteLength:kl(c)?-1===c.size?void 0:c.size:void 0;if(void 0===a)return;b+=a}return b}(d);e&&a.headers.set("Content-Length",e),a.body=await kq(d)}let ks="multipartPolicy",kt=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function ku(){return jT.create()}let kv=d2("core-rest-pipeline"),kw=["GET","HEAD"];async function kx(a,b,c,d=0){let{request:e,status:f,headers:g}=b,h=g.get("location");if(h&&(300===f||301===f&&kw.includes(e.method)||302===f&&kw.includes(e.method)||303===f&&"POST"===e.method||307===f)&&d<c){let b=new URL(h,e.url);e.url=b.toString(),303===f&&(e.method="GET",e.headers.delete("Content-Length"),delete e.body),e.headers.delete("Authorization");let g=await a(e);return kx(a,g,c,d+1)}return b}async function ky(a){if(dJ&&dJ.versions){let b=`${dH.type()} ${dH.release()}; ${dH.arch()}`,c=dJ.versions;c.bun?a.set("Bun",`${c.bun} (${b})`):c.deno?a.set("Deno",`${c.deno} (${b})`):c.node&&a.set("Node",`${c.node} (${b})`)}}let kz="1.22.2";async function kA(a){let b=new Map;b.set("core-rest-pipeline",kz),await ky(b);let c=function(a){let b=[];for(let[c,d]of a){let a=d?`${c}/${d}`:c;b.push(a)}return b.join(" ")}(b);return a?`${a} ${c}`:c}let kB="User-Agent",kC=Symbol("rawContent");function kD(a){return"function"==typeof a[kC]}function kE(a){return a instanceof jW||ju(a)&&"RestError"===a.name}function kF(a){if(a instanceof AbortSignal)return{abortSignal:a};if(a.aborted)return{abortSignal:AbortSignal.abort(a.reason)};let b=new AbortController,c=!0;function d(){c&&(a.removeEventListener("abort",e),c=!1)}function e(){b.abort(a.reason),d()}return a.addEventListener("abort",e),{abortSignal:b.signal,cleanup:d}}function kG(a){return new jR(a)}let kH=d2("core-rest-pipeline retryPolicy"),kI={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};async function kJ(a,b,c){async function d(){if(Date.now()<c)try{return await a()}catch{return null}{let b=await a();if(null===b)throw Error("Failed to refresh access token.");return b}}let e=await d();for(;null===e;)await function(a,b){let c,{abortSignal:d,abortErrorMsg:e}=(void 0)??{};return function(a,b){let{cleanupBeforeAbort:c,abortSignal:d,abortErrorMsg:e}=b??{};return new Promise((b,f)=>{function g(){f(new jB(e??"The operation was aborted."))}function h(){d?.removeEventListener("abort",i)}function i(){c?.(),h(),g()}if(d?.aborted)return g();try{a(a=>{h(),b(a)},a=>{h(),f(a)})}catch(a){f(a)}d?.addEventListener("abort",i)})}(b=>{c=setTimeout(b,a)},{cleanupBeforeAbort:()=>clearTimeout(c),abortSignal:d,abortErrorMsg:e??"The delay was aborted."})}(b),e=await d();return e}async function kK(a,b){try{return[await b(a),void 0]}catch(a){if(kE(a)&&a.response)return[a.response,a];throw a}}async function kL(a){let{scopes:b,getAccessToken:c,request:d}=a,e={abortSignal:d.abortSignal,tracingOptions:d.tracingOptions,enableCae:!0},f=await c(b,e);f&&a.request.headers.set("Authorization",`Bearer ${f.token}`)}function kM(a){return 401===a.status&&a.headers.has("WWW-Authenticate")}async function kN(a,b){let{scopes:c}=a,d=await a.getAccessToken(c,{enableCae:!0,claims:b});return!!d&&(a.request.headers.set("Authorization",`${d.tokenType??"Bearer"} ${d.token}`),!0)}function kO(a){let{credential:b,scopes:c,challengeCallbacks:d}=a,e=a.logger||kv,f={authorizeRequest:d?.authorizeRequest?.bind(d)??kL,authorizeRequestOnChallenge:d?.authorizeRequestOnChallenge?.bind(d)},g=b?function(a,b){let c,d=null,e=null,f={...kI,...void 0},g={get isRefreshing(){return null!==d},get shouldRefresh(){if(g.isRefreshing)return!1;if(e?.refreshAfterTimestamp&&e.refreshAfterTimestamp<Date.now())return!0;return(e?.expiresOnTimestamp??0)-f.refreshWindowInMs<Date.now()},get mustRefresh(){return null===e||e.expiresOnTimestamp-f.forcedRefreshWindowInMs<Date.now()}};function h(b,h){return g.isRefreshing||(d=kJ(()=>a.getToken(b,h),f.retryIntervalInMs,e?.expiresOnTimestamp??Date.now()).then(a=>(d=null,e=a,c=h.tenantId,e)).catch(a=>{throw d=null,e=null,c=void 0,a})),d}return async(a,b)=>{let d=!!b.claims,f=c!==b.tenantId;return(d&&(e=null),f||d||g.mustRefresh)?h(a,b):(g.shouldRefresh&&h(a,b),e)}}(b):()=>Promise.resolve(null);return{name:"bearerTokenAuthenticationPolicy",async sendRequest(a,b){let d,h;if(!a.url.toLowerCase().startsWith("https://"))throw Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");if(await f.authorizeRequest({scopes:Array.isArray(c)?c:[c],request:a,getAccessToken:g,logger:e}),[d,h]=await kK(a,b),kM(d)){let i=kP(d.headers.get("WWW-Authenticate"));if(i){let f;try{f=atob(i)}catch(a){return e.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${i}`),d}await kN({scopes:Array.isArray(c)?c:[c],response:d,request:a,getAccessToken:g,logger:e},f)&&([d,h]=await kK(a,b))}else if(f.authorizeRequestOnChallenge&&(await f.authorizeRequestOnChallenge({scopes:Array.isArray(c)?c:[c],request:a,response:d,getAccessToken:g,logger:e})&&([d,h]=await kK(a,b)),kM(d))&&(i=kP(d.headers.get("WWW-Authenticate")))){let f;try{f=atob(i)}catch(a){return e.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${i}`),d}await kN({scopes:Array.isArray(c)?c:[c],response:d,request:a,getAccessToken:g,logger:e},f)&&([d,h]=await kK(a,b))}}if(!h)return d;throw h}}}function kP(a){if(!a)return;let b=function(a){let b,c=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,d=/(\w+)="([^"]*)"/g,e=[];for(;null!==(b=c.exec(a));){let a,c=b[1],f=b[2],g={};for(;null!==(a=d.exec(f));)g[a[1]]=a[2];e.push({scheme:c,params:g})}return e}(a);return b.find(a=>"Bearer"===a.scheme&&a.params.claims&&"insufficient_claims"===a.params.error)?.params.claims}let kQ=c(54848).w;function kR(a,b,c){let d,e=b.parameterPath,f=b.mapper;if("string"==typeof e&&(e=[e]),Array.isArray(e)){if(e.length>0)if(f.isConstant)d=f.defaultValue;else{let b=kS(a,e);!b.propertyFound&&c&&(b=kS(c,e));let g=!1;b.propertyFound||(g=f.required||"options"===e[0]&&2===e.length),d=g?f.defaultValue:b.propertyValue}}else for(let b in f.required&&(d={}),e){let g=f.type.modelProperties[b],h=kR(a,{parameterPath:e[b],mapper:g},c);void 0!==h&&(d||(d={}),d[b]=h)}return d}function kS(a,b){let c={propertyFound:!1},d=0;for(;d<b.length;++d){let c=b[d];if(a&&c in a)a=a[c];else break}return d===b.length&&(c.propertyValue=a,c.propertyFound=!0),c}let kT=Symbol.for("@azure/core-client original request");function kU(a){if(kT in a)return kU(a[kT]);let b=kQ.operationRequestMap.get(a);return b||(b={},kQ.operationRequestMap.set(a,b)),b}let kV=["application/json","text/json"],kW=["application/xml","application/atom+xml"];async function kX(a,b,c,d,e){let f=await kY(a,b,c,d,e);if(!function(a){let b=kU(a.request),c=b?.shouldDeserialize;return void 0===c||("boolean"==typeof c?c:c(a))}(f))return f;let g=kU(f.request),h=g?.operationSpec;if(!h||!h.responses)return f;let i=function(a){let b,c=kU(a.request),d=c?.operationSpec;return d&&(b=c?.operationResponseGetter?c?.operationResponseGetter(d,a):d.responses[a.status]),b}(f),{error:j,shouldReturnResponse:k}=function(a,b,c,d){let e=200<=a.status&&a.status<300;if(!function(a){let b=Object.keys(a.responses);return 0===b.length||1===b.length&&"default"===b[0]}(b)?!!c:e){if(!c)return{error:null,shouldReturnResponse:!1};else if(!c.isError)return{error:null,shouldReturnResponse:!1}}let f=c??b.responses.default,g=new jW(a.request.streamResponseStatusCodes?.has(a.status)?`Unexpected status code: ${a.status}`:a.bodyAsText,{statusCode:a.status,request:a.request,response:a});if(!f&&!(a.parsedBody?.error?.code&&a.parsedBody?.error?.message))throw g;let h=f?.bodyMapper,i=f?.headersMapper;try{if(a.parsedBody){let c,e=a.parsedBody;if(h){let a=e;if(b.isXML&&h.type.name===jL.Sequence){a=[];let b=h.xmlElementName;"object"==typeof e&&b&&(a=e[b])}c=b.serializer.deserialize(h,a,"error.response.parsedBody",d)}let f=e.error||c||e;g.code=f.code,f.message&&(g.message=f.message),h&&(g.response.parsedBody=c)}a.headers&&i&&(g.response.parsedHeaders=b.serializer.deserialize(i,a.headers.toJSON(),"operationRes.parsedHeaders"))}catch(b){g.message=`Error "${b.message}" occurred in deserializing the responseBody - "${a.bodyAsText}" for the default response.`}return{error:g,shouldReturnResponse:!1}}(f,h,i,d);if(j)throw j;if(k)return f;if(i){if(i.bodyMapper){let a=f.parsedBody;h.isXML&&i.bodyMapper.type.name===jL.Sequence&&(a="object"==typeof a?a[i.bodyMapper.xmlElementName]:[]);try{f.parsedBody=h.serializer.deserialize(i.bodyMapper,a,"operationRes.parsedBody",d)}catch(a){throw new jW(`Error ${a} occurred in deserializing the responseBody - ${f.bodyAsText}`,{statusCode:f.status,request:f.request,response:f})}}else"HEAD"===h.httpMethod&&(f.parsedBody=c.status>=200&&c.status<300);i.headersMapper&&(f.parsedHeaders=h.serializer.deserialize(i.headersMapper,f.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return f}async function kY(a,b,c,d,e){if(!c.request.streamResponseStatusCodes?.has(c.status)&&c.bodyAsText){let f=c.bodyAsText,g=c.headers.get("Content-Type")||"",h=g?g.split(";").map(a=>a.toLowerCase()):[];try{if(0===h.length||h.some(b=>-1!==a.indexOf(b)))c.parsedBody=JSON.parse(f);else if(h.some(a=>-1!==b.indexOf(a))){if(!e)throw Error("Parsing XML not supported.");c.parsedBody=await e(f,d.xml)}}catch(d){let a=`Error "${d}" occurred while parsing the response body - ${c.bodyAsText}.`,b=d.code||jW.PARSE_ERROR;throw new jW(a,{code:b,statusCode:c.status,request:c.request,response:c})}}return c}function kZ(a){let{parameterPath:b,mapper:c}=a;return"string"==typeof b?b:Array.isArray(b)?b.join("."):c.serializedName}function k$(a,b){let c=a.parsedHeaders;if("HEAD"===a.request.method)return{...c,body:a.parsedBody};let d=b&&b.bodyMapper,e=!!d?.nullable,f=d?.type.name;if("Stream"===f)return{...c,blobBody:a.blobBody,readableStreamBody:a.readableStreamBody};let g="Composite"===f&&d.type.modelProperties||{},h=Object.keys(g).some(a=>""===g[a].serializedName);if("Sequence"===f||h){let b=a.parsedBody??[];for(let c of Object.keys(g))g[c].serializedName&&(b[c]=a.parsedBody?.[c]);if(c)for(let a of Object.keys(c))b[a]=c[a];return!e||a.parsedBody||c||0!==Object.getOwnPropertyNames(g).length?b:null}var i,j={body:a.parsedBody,headers:c,hasNullableType:e,shouldWrapBody:(i=a.parsedBody,"Composite"!==f&&"Dictionary"!==f&&("string"==typeof i||"number"==typeof i||"boolean"==typeof i||f?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||null==i))};let k={...j.headers,...j.body};return j.hasNullableType&&0===Object.getOwnPropertyNames(k).length?j.shouldWrapBody?{body:null}:null:j.shouldWrapBody?{...j.headers,body:j.body}:k}let k_={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function k0(a,b){let c=a;for(let[a,d]of b)c=c.split(a).join(d);return c}let k1=d2("core-client");class k2{_endpoint;_requestContentType;_allowInsecureConnection;_httpClient;pipeline;constructor(a={}){if(this._requestContentType=a.requestContentType,this._endpoint=a.endpoint??a.baseUri,a.baseUri&&k1.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=a.allowInsecureConnection,this._httpClient=a.httpClient||(i||(i=function(){let a=new j5;return{async sendRequest(b){let{abortSignal:c,cleanup:d}=b.abortSignal?kF(b.abortSignal):{};try{return b.abortSignal=c,await a.sendRequest(b)}finally{d?.()}}}}()),i),this.pipeline=a.pipeline||function(a){let b=function(a){if(a.credentialScopes)return a.credentialScopes;if(a.endpoint)return`${a.endpoint}/.default`;if(a.baseUri)return`${a.baseUri}/.default`;if(a.credential&&!a.credentialScopes)throw Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}(a),c=a.credential&&b?{credentialScopes:b,credential:a.credential}:void 0;return function(a={}){let b=function(a){let b=ku();if(jw){var c,d;a.agent&&b.addPolicy((c=a.agent,{name:"agentPolicy",sendRequest:async(a,b)=>(a.agent||(a.agent=c),b(a))})),a.tlsOptions&&b.addPolicy((d=a.tlsOptions,{name:"tlsPolicy",sendRequest:async(a,b)=>(a.tlsSettings||(a.tlsSettings=d),b(a))})),b.addPolicy(function(a,b){var c=void 0;kg||kf.push(...function(){let a=ki("NO_PROXY");return(kg=!0,a)?a.split(",").map(a=>a.trim()).filter(a=>a.length):[]}());let d=a?kj(a):function(){let a=function(){if(!process)return;let a=ki("HTTPS_PROXY"),b=ki("ALL_PROXY"),c=ki("HTTP_PROXY");return a||b||c}();return a?new URL(a):void 0}(),e={};return{name:"proxyPolicy",sendRequest:async(a,b)=>(!a.proxySettings&&d&&!function(a,b,c){if(0===b.length)return!1;let d=new URL(a).hostname;if(c?.has(d))return c.get(d);let e=!1;for(let a of b)"."===a[0]?d.endsWith(a)?e=!0:d.length===a.length-1&&d===a.slice(1)&&(e=!0):d===a&&(e=!0);return c?.set(d,e),e}(a.url,c?.customNoProxyList??kf,c?.customNoProxyList?void 0:kh)?kk(a,e,d):a.proxySettings&&kk(a,e,kj(a.proxySettings)),b(a))}}(a.proxyOptions)),b.addPolicy({name:"decompressResponsePolicy",sendRequest:async(a,b)=>("HEAD"!==a.method&&a.headers.set("Accept-Encoding","gzip,deflate"),b(a))})}return b.addPolicy({name:"wrapAbortSignalLikePolicy",sendRequest:async(a,b)=>{if(!a.abortSignal)return b(a);let{abortSignal:c,cleanup:d}=kF(a.abortSignal);a.abortSignal=c;try{return await b(a)}finally{d?.()}}}),b.addPolicy({name:"formDataPolicy",async sendRequest(a,b){if(jw&&"undefined"!=typeof FormData&&a.body instanceof FormData&&(a.formData=function(a){let b={};for(let[c,d]of a.entries())b[c]??=[],b[c].push(d);return b}(a.body),a.body=void 0),a.formData){let b=a.headers.get("Content-Type");b&&-1!==b.indexOf("application/x-www-form-urlencoded")?a.body=function(a){let b=new URLSearchParams;for(let[c,d]of Object.entries(a))if(Array.isArray(d))for(let a of d)b.append(c,a.toString());else b.append(c,d.toString());return b.toString()}(a.formData):await kc(a.formData,a),a.formData=void 0}return b(a)}},{beforePolicies:[ks]}),b.addPolicy(function(a={}){let b=kA(a.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(a,c)=>(a.headers.has(kB)||a.headers.set(kB,await b),c(a))}}(a.userAgentOptions)),b.addPolicy(function(a="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(b,c)=>(b.headers.has(a)||b.headers.set(a,b.requestId),c(b))}}(a.telemetryOptions?.clientRequestIdHeaderName)),b.addPolicy(function(){let a={name:ks,async sendRequest(a,b){if(!a.multipartBody)return b(a);if(a.body)throw Error("multipartBody and regular body cannot be set at the same time");let c=a.multipartBody.boundary,d=a.headers.get("Content-Type")??"multipart/mixed",e=d.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!e)throw Error(`Got multipart request body, but content-type header was not multipart: ${d}`);let[,f,g]=e;if(g&&c&&g!==c)throw Error(`Multipart boundary was specified as ${g} in the header, but got ${c} in the request body`);if(c??=g){var h=c;if(h.length>70)throw Error(`Multipart boundary "${h}" exceeds maximum length of 70 characters`);if(Array.from(h).some(a=>!kt.has(a)))throw Error(`Multipart boundary "${h}" contains invalid characters`)}else c=`----AzSDKFormBoundary${jQ()}`;return a.headers.set("Content-Type",`${f}; boundary=${c}`),await kr(a,a.multipartBody.parts,c),a.multipartBody=void 0,b(a)}};return{name:ks,sendRequest:async(b,c)=>{if(b.multipartBody)for(let a of b.multipartBody.parts){var d;kD(a.body)&&(a.body=kD(d=a.body)?d[kC]():d)}return a.sendRequest(b,c)}}}(),{afterPhase:"Deserialize"}),b.addPolicy(function(a={}){return function(a={}){return{name:"defaultRetryPolicy",sendRequest:ka([{name:"throttlingRetryStrategy",retry({response:a}){let b=j8(a);return Number.isFinite(b)?{retryAfterInMs:b}:{skipStrategy:!0}}},function(a={}){let b=a.retryDelayInMs??1e3,c=a.maxRetryDelayInMs??64e3;return{name:"exponentialRetryStrategy",retry({retryCount:d,response:e,responseError:f}){var g,h;let i=!!(g=f)&&("ETIMEDOUT"===g.code||"ESOCKETTIMEDOUT"===g.code||"ECONNREFUSED"===g.code||"ECONNRESET"===g.code||"ENOENT"===g.code||"ENOTFOUND"===g.code),j=i&&a.ignoreSystemErrors,k=!!((h=e)&&void 0!==h.status&&(h.status>=500||408===h.status)&&501!==h.status&&505!==h.status),l=k&&a.ignoreHttpStatusCodes;return e&&(Number.isFinite(j8(e))||!k)||l||j?{skipStrategy:!0}:!f||i||k?js(d,{retryDelayInMs:b,maxRetryDelayInMs:c}):{errorToThrow:f}}}}(a)],{maxRetries:a.maxRetries??3}).sendRequest}}(a)}(a.retryOptions),{phase:"Retry"}),b.addPolicy(function(a={}){let b=kA(a.userAgentPrefix),c=new jA({additionalAllowedQueryParameters:a.additionalAllowedQueryParameters}),d=function(){try{return ed({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:kz})}catch(a){kv.warning(`Error when creating the TracingClient: ${jC(a)}`);return}}();return{name:"tracingPolicy",async sendRequest(a,e){if(!d)return e(a);let f=await b,g={"http.url":c.sanitizeUrl(a.url),"http.method":a.method,"http.user_agent":f,requestId:a.requestId};f&&(g["http.user_agent"]=f);let{span:h,tracingContext:i}=function(a,b,c){try{let{span:d,updatedOptions:e}=a.startSpan(`HTTP ${b.method}`,{tracingOptions:b.tracingOptions},{spanKind:"client",spanAttributes:c});if(!d.isRecording())return void d.end();let f=a.createRequestHeaders(e.tracingOptions.tracingContext);for(let[a,c]of Object.entries(f))b.headers.set(a,c);return{span:d,tracingContext:e.tracingOptions.tracingContext}}catch(a){kv.warning(`Skipping creating a tracing span due to an error: ${jC(a)}`);return}}(d,a,g)??{};if(!h||!i)return e(a);try{let b=await d.withContext(i,e,a);return function(a,b){try{a.setAttribute("http.status_code",b.status);let c=b.headers.get("x-ms-request-id");c&&a.setAttribute("serviceRequestId",c),b.status>=400&&a.setStatus({status:"error"}),a.end()}catch(a){kv.warning(`Skipping tracing span processing due to an error: ${jC(a)}`)}}(h,b),b}catch(a){throw function(a,b){try{a.setStatus({status:"error",error:ju(b)?b:void 0}),kE(b)&&b.statusCode&&a.setAttribute("http.status_code",b.statusCode),a.end()}catch(a){kv.warning(`Skipping tracing span processing due to an error: ${jC(a)}`)}}(h,a),a}}}}({...a.userAgentOptions,...a.loggingOptions}),{afterPhase:"Retry"}),jw&&b.addPolicy(function(a={}){return function(a={}){let{maxRetries:b=20}=a;return{name:"redirectPolicy",async sendRequest(a,c){let d=await c(a);return kx(c,d,b)}}}(a)}(a.redirectOptions),{afterPhase:"Retry"}),b.addPolicy(function(a={}){return function(a={}){let b=a.logger??j_.info,c=new jA({additionalAllowedHeaderNames:a.additionalAllowedHeaderNames,additionalAllowedQueryParameters:a.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(a,d){if(!b.enabled)return d(a);b(`Request: ${c.sanitize(a)}`);let e=await d(a);return b(`Response status code: ${e.status}`),b(`Headers: ${c.sanitize(e.headers)}`),e}}}({logger:kv.info,...a})}(a.loggingOptions),{afterPhase:"Sign"}),b}(a??{});return a.credentialOptions&&b.addPolicy(kO({credential:a.credentialOptions.credential,scopes:a.credentialOptions.credentialScopes})),b.addPolicy(function(a={}){let b=a.stringifyXML;return{name:"serializationPolicy",async sendRequest(a,c){let d=kU(a),e=d?.operationSpec,f=d?.operationArguments;return e&&f&&(function(a,b,c){if(c.headerParameters)for(let d of c.headerParameters){let e=kR(b,d);if(null!=e||d.mapper.required){e=c.serializer.serialize(d.mapper,e,kZ(d));let b=d.mapper.headerCollectionPrefix;if(b)for(let c of Object.keys(e))a.headers.set(b+c,e[c]);else a.headers.set(d.mapper.serializedName||kZ(d),e)}}let d=b.options?.requestOptions?.customHeaders;if(d)for(let b of Object.keys(d))a.headers.set(b,d[b])}(a,f,e),function(a,b,c,d=function(){throw Error("XML serialization unsupported!")}){let e=b.options?.serializerOptions,f={xml:{rootName:e?.xml.rootName??"",includeRoot:e?.xml.includeRoot??!1,xmlCharKey:e?.xml.xmlCharKey??"_"}},g=f.xml.xmlCharKey;if(c.requestBody&&c.requestBody.mapper){a.body=kR(b,c.requestBody);let e=c.requestBody.mapper,{required:h,serializedName:i,xmlName:j,xmlElementName:k,xmlNamespace:l,xmlNamespacePrefix:m,nullable:n}=e,o=e.type.name;try{if(void 0!==a.body&&null!==a.body||n&&null===a.body||h){let b=kZ(c.requestBody);a.body=c.serializer.serialize(e,a.body,b,f);let h=o===jL.Stream;if(c.isXML){let b=m?`xmlns:${m}`:"xmlns",c=function(a,b,c,d,e){if(a&&!["Composite","Sequence","Dictionary"].includes(c)){let c={};return c[e.xml.xmlCharKey]=d,c.$={[b]:a},c}return d}(l,b,o,a.body,f);o===jL.Sequence?a.body=d(function(a,b,c,d){if(Array.isArray(a)||(a=[a]),!c||!d)return{[b]:a};let e={[b]:a};return e.$={[c]:d},e}(c,k||j||i,b,l),{rootName:j||i,xmlCharKey:g}):h||(a.body=d(c,{rootName:j||i,xmlCharKey:g}))}else{if(o===jL.String&&(c.contentType?.match("text/plain")||"text"===c.mediaType))return;h||(a.body=JSON.stringify(a.body))}}}catch(a){throw Error(`Error "${a.message}" occurred in serializing the payload - ${JSON.stringify(i,void 0,"  ")}.`)}}else if(c.formDataParameters&&c.formDataParameters.length>0)for(let d of(a.formData={},c.formDataParameters)){let e=kR(b,d);if(null!=e){let b=d.mapper.serializedName||kZ(d);a.formData[b]=c.serializer.serialize(d.mapper,e,kZ(d),f)}}}(a,f,e,b)),c(a)}}}(a.serializationOptions),{phase:"Serialize"}),b.addPolicy(function(a={}){let b=a.expectedContentTypes?.json??kV,c=a.expectedContentTypes?.xml??kW,d=a.parseXML,e=a.serializerOptions,f={xml:{rootName:e?.xml.rootName??"",includeRoot:e?.xml.includeRoot??!1,xmlCharKey:e?.xml.xmlCharKey??"_"}};return{name:"deserializationPolicy",sendRequest:async(a,e)=>kX(b,c,await e(a),f,d)}}(a.deserializationOptions),{phase:"Deserialize"}),b}({...a,credentialOptions:c})}(a),a.additionalPolicies?.length)for(let{policy:b,position:c}of a.additionalPolicies){let a="perRetry"===c?"Sign":void 0;this.pipeline.addPolicy(b,{afterPhase:a})}}async sendRequest(a){return this.pipeline.sendRequest(this._httpClient,a)}async sendOperationRequest(a,b){let c=b.baseUrl||this._endpoint;if(!c)throw Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let d=kG({url:function(a,b,c,d){let e=function(a,b,c){let d=new Map;if(a.urlParameters?.length)for(let e of a.urlParameters){let f=kR(b,e,c),g=kZ(e);f=a.serializer.serialize(e.mapper,f,g),e.skipEncoding||(f=encodeURIComponent(f)),d.set(`{${e.mapper.serializedName||g}}`,f)}return d}(b,c,d),f=!1,g=k0(a,e);if(b.path){let a=k0(b.path,e);"/{nextLink}"===b.path&&a.startsWith("/")&&(a=a.substring(1)),a.includes("://")?(g=a,f=!0):g=function(a,b){if(!b)return a;let c=new URL(a),d=c.pathname;d.endsWith("/")||(d=`${d}/`),b.startsWith("/")&&(b=b.substring(1));let e=b.indexOf("?");if(-1!==e){let a=b.substring(0,e),f=b.substring(e+1);d+=a,f&&(c.search=c.search?`${c.search}&${f}`:f)}else d+=b;return c.pathname=d,c.toString()}(g,a)}let{queryParams:h,sequenceParams:i}=function(a,b,c){let d=new Map,e=new Set;if(a.queryParameters?.length)for(let f of a.queryParameters){"Sequence"===f.mapper.type.name&&f.mapper.serializedName&&e.add(f.mapper.serializedName);let g=kR(b,f,c);if(null!=g||f.mapper.required){g=a.serializer.serialize(f.mapper,g,kZ(f));let b=f.collectionFormat?k_[f.collectionFormat]:"";if(Array.isArray(g)&&(g=g.map(a=>null==a?"":a)),"Multi"===f.collectionFormat&&0===g.length)continue;Array.isArray(g)&&("SSV"===f.collectionFormat||"TSV"===f.collectionFormat)&&(g=g.join(b)),f.skipEncoding||(g=Array.isArray(g)?g.map(a=>encodeURIComponent(a)):encodeURIComponent(g)),Array.isArray(g)&&("CSV"===f.collectionFormat||"Pipes"===f.collectionFormat)&&(g=g.join(b)),d.set(f.mapper.serializedName||kZ(f),g)}}return{queryParams:d,sequenceParams:e}}(b,c,d);return function(a,b,c,d=!1){if(0===b.size)return a;let e=new URL(a),f=function(a){let b=new Map;if(!a||"?"!==a[0])return b;for(let c of(a=a.slice(1)).split("&")){let[a,d]=c.split("=",2),e=b.get(a);e?Array.isArray(e)?e.push(d):b.set(a,[e,d]):b.set(a,d)}return b}(e.search);for(let[a,e]of b){let b=f.get(a);if(Array.isArray(b))if(Array.isArray(e)){b.push(...e);let c=new Set(b);f.set(a,Array.from(c))}else b.push(e);else b?(Array.isArray(e)?e.unshift(b):c.has(a)&&f.set(a,[b,e]),d||f.set(a,e)):f.set(a,e)}let g=[];for(let[a,b]of f)if("string"==typeof b)g.push(`${a}=${b}`);else if(Array.isArray(b))for(let c of b)g.push(`${a}=${c}`);else g.push(`${a}=${b}`);return e.search=g.length?`?${g.join("&")}`:"",e.toString()}(g,h,i,f)}(c,b,a,this)});d.method=b.httpMethod;let e=kU(d);e.operationSpec=b,e.operationArguments=a;let f=b.contentType||this._requestContentType;f&&b.requestBody&&d.headers.set("Content-Type",f);let g=a.options;if(g){let a=g.requestOptions;a&&(a.timeout&&(d.timeout=a.timeout),a.onUploadProgress&&(d.onUploadProgress=a.onUploadProgress),a.onDownloadProgress&&(d.onDownloadProgress=a.onDownloadProgress),void 0!==a.shouldDeserialize&&(e.shouldDeserialize=a.shouldDeserialize),a.allowInsecureConnection&&(d.allowInsecureConnection=!0)),g.abortSignal&&(d.abortSignal=g.abortSignal),g.tracingOptions&&(d.tracingOptions=g.tracingOptions)}this._allowInsecureConnection&&(d.allowInsecureConnection=!0),void 0===d.streamResponseStatusCodes&&(d.streamResponseStatusCodes=function(a){let b=new Set;for(let c in a.responses){let d=a.responses[c];d.bodyMapper&&d.bodyMapper.type.name===jL.Stream&&b.add(Number(c))}return b}(b));try{let a=await this.sendRequest(d),c=k$(a,b.responses[a.status]);return g?.onResponse&&g.onResponse(a,c),c}catch(a){if("object"==typeof a&&a?.response){let c=a.response,d=k$(c,b.responses[a.statusCode]||b.responses.default);a.details=d,g?.onResponse&&g.onResponse(c,d,a)}throw a}}}let k3="/.default";function k4(a){let b="";if(Array.isArray(a)){if(1!==a.length)return;b=a[0]}else"string"==typeof a&&(b=a);return b.endsWith(k3)?b.substr(0,b.lastIndexOf(k3)):b}let k5="noCorrelationId";class k6 extends k2{authorityHost;allowLoggingAccountIdentifiers;abortControllers;allowInsecureConnection=!1;tokenCredentialOptions;constructor(a){let b=`azsdk-js-identity/${du}`,c=a?.userAgentOptions?.userAgentPrefix?`${a.userAgentOptions.userAgentPrefix} ${b}`:`${b}`,d=function(a){let b=a?.authorityHost;return jD&&(b=b??process.env.AZURE_AUTHORITY_HOST),b??dw}(a);if(!d.startsWith("https:"))throw Error("The authorityHost address must use the 'https' protocol.");super({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3},...a,userAgentOptions:{userAgentPrefix:c},baseUri:d}),this.authorityHost=d,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=a?.loggingOptions?.allowLoggingAccountIdentifiers,this.tokenCredentialOptions={...a},a?.allowInsecureConnection&&(this.allowInsecureConnection=a.allowInsecureConnection)}async sendTokenRequest(a){d3.info(`IdentityClient: sending token request to [${a.url}]`);let b=await this.sendRequest(a);if(b.bodyAsText&&(200===b.status||201===b.status)){let c=JSON.parse(b.bodyAsText);if(!c.access_token)return null;this.logIdentifiers(b);let d={accessToken:{token:c.access_token,expiresOnTimestamp:function(a){if("number"==typeof a.expires_on)return 1e3*a.expires_on;if("string"==typeof a.expires_on){let b=+a.expires_on;if(!isNaN(b))return 1e3*b;let c=Date.parse(a.expires_on);if(!isNaN(c))return c}if("number"==typeof a.expires_in)return Date.now()+1e3*a.expires_in;throw Error(`Failed to parse token expiration from body. expires_in="${a.expires_in}", expires_on="${a.expires_on}"`)}(c),refreshAfterTimestamp:function(a){if(a.refresh_on){if("number"==typeof a.refresh_on)return 1e3*a.refresh_on;if("string"==typeof a.refresh_on){let b=+a.refresh_on;if(!isNaN(b))return 1e3*b;let c=Date.parse(a.refresh_on);if(!isNaN(c))return c}throw Error(`Failed to parse refresh_on from body. refresh_on="${a.refresh_on}"`)}}(c),tokenType:"Bearer"},refreshToken:c.refresh_token};return d3.info(`IdentityClient: [${a.url}] token acquired, expires on ${d.accessToken.expiresOnTimestamp}`),d}{let a=new dD(b.status,b.bodyAsText);throw d3.warning(`IdentityClient: authentication error. HTTP status: ${b.status}, ${a.errorResponse.errorDescription}`),a}}async refreshAccessToken(a,b,c,d,e,f={}){if(void 0===d)return null;d3.info(`IdentityClient: refreshing access token with client ID: ${b}, scopes: ${c} started`);let g={grant_type:"refresh_token",client_id:b,refresh_token:d,scope:c};void 0!==e&&(g.client_secret=e);let h=new URLSearchParams(g);return ee.withSpan("IdentityClient.refreshAccessToken",f,async c=>{try{var d;let e=kG({url:`${this.authorityHost}/${a}/${"adfs"===a?"oauth2/token":"oauth2/v2.0/token"}`,method:"POST",body:h.toString(),abortSignal:f.abortSignal,headers:(d={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},jP(d)),tracingOptions:c.tracingOptions}),g=await this.sendTokenRequest(e);return d3.info(`IdentityClient: refreshed token for client ID: ${b}`),g}catch(a){if(a.name===dC&&"interaction_required"===a.errorResponse.error)return d3.info(`IdentityClient: interaction required for client ID: ${b}`),null;throw d3.warning(`IdentityClient: failed refreshing token for client ID: ${b}: ${a}`),a}})}generateAbortSignal(a){let b=new AbortController,c=this.abortControllers.get(a)||[];c.push(b),this.abortControllers.set(a,c);let d=b.signal.onabort;return b.signal.onabort=(...c)=>{this.abortControllers.set(a,void 0),d&&d.apply(b.signal,c)},b.signal}abortRequests(a){let b=a||k5,c=[...this.abortControllers.get(b)||[],...this.abortControllers.get(k5)||[]];if(c.length){for(let a of c)a.abort();this.abortControllers.set(b,void 0)}}getCorrelationId(a){let b=a?.body?.split("&").map(a=>a.split("=")).find(([a])=>"client-request-id"===a);return b&&b.length&&b[1]||k5}async sendGetRequestAsync(a,b){let c=kG({url:a,method:"GET",body:b?.body,allowInsecureConnection:this.allowInsecureConnection,headers:jP(b?.headers),abortSignal:this.generateAbortSignal(k5)}),d=await this.sendRequest(c);return this.logIdentifiers(d),{body:d.bodyAsText?JSON.parse(d.bodyAsText):void 0,headers:d.headers.toJSON(),status:d.status}}async sendPostRequestAsync(a,b){let c=kG({url:a,method:"POST",body:b?.body,headers:jP(b?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(b))}),d=await this.sendRequest(c);return this.logIdentifiers(d),{body:d.bodyAsText?JSON.parse(d.bodyAsText):void 0,headers:d.headers.toJSON(),status:d.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(a){if(this.allowLoggingAccountIdentifiers&&a.bodyAsText)try{let b=(a.parsedBody||JSON.parse(a.bodyAsText)).access_token;if(!b)return;let c=b.split(".")[1],{appid:d,upn:e,tid:f,oid:g}=JSON.parse(Buffer.from(c,"base64").toString("utf8"));d3.info(`[Authenticated account] Client ID: ${d}. Tenant ID: ${f}. User Principal Name: ${e||"No User Principal Name available"}. Object ID (user): ${g}`)}catch(a){d3.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",a.message)}}}function k7(a){let b=a;return(void 0===b&&globalThis.process?.env?.AZURE_REGIONAL_AUTHORITY_NAME!==void 0&&(b=process.env.AZURE_REGIONAL_AUTHORITY_NAME),b===aM.AutoDiscoverRegion)?"AUTO_DISCOVER":b}function k8(a,b,c=[],d){let e;if(e=process.env.AZURE_IDENTITY_DISABLE_MULTITENANTAUTH||"adfs"===a?a:b?.tenantId??a,a&&e!==a&&!c.includes("*")&&!c.some(a=>0===a.localeCompare(e))){let a=`The current credential is not configured to acquire tokens for tenant ${e}. To enable acquiring tokens for this tenant add it to the AdditionallyAllowedTenants on the credential options, or add "*" to AdditionallyAllowedTenants to allow acquiring tokens for any tenant.`;throw d?.info(a),new dB(a)}return e}function k9(a,b){if(!b.match(/^[0-9a-zA-Z-.]+$/)){let b=Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw a.info(d6("",b)),b}}function la(a,b,c){return b?(k9(a,b),b):(c||(c=dv),c!==dv)?"common":"organizations"}function lb(a){return a&&0!==a.length?a.includes("*")?dx:a:[]}!function(a){a.AutoDiscoverRegion="AutoDiscoverRegion",a.USWest="westus",a.USWest2="westus2",a.USCentral="centralus",a.USEast="eastus",a.USEast2="eastus2",a.USNorthCentral="northcentralus",a.USSouthCentral="southcentralus",a.USWestCentral="westcentralus",a.CanadaCentral="canadacentral",a.CanadaEast="canadaeast",a.BrazilSouth="brazilsouth",a.EuropeNorth="northeurope",a.EuropeWest="westeurope",a.UKSouth="uksouth",a.UKWest="ukwest",a.FranceCentral="francecentral",a.FranceSouth="francesouth",a.SwitzerlandNorth="switzerlandnorth",a.SwitzerlandWest="switzerlandwest",a.GermanyNorth="germanynorth",a.GermanyWestCentral="germanywestcentral",a.NorwayWest="norwaywest",a.NorwayEast="norwayeast",a.AsiaEast="eastasia",a.AsiaSouthEast="southeastasia",a.JapanEast="japaneast",a.JapanWest="japanwest",a.AustraliaEast="australiaeast",a.AustraliaSouthEast="australiasoutheast",a.AustraliaCentral="australiacentral",a.AustraliaCentral2="australiacentral2",a.IndiaCentral="centralindia",a.IndiaSouth="southindia",a.IndiaWest="westindia",a.KoreaSouth="koreasouth",a.KoreaCentral="koreacentral",a.UAECentral="uaecentral",a.UAENorth="uaenorth",a.SouthAfricaNorth="southafricanorth",a.SouthAfricaWest="southafricawest",a.ChinaNorth="chinanorth",a.ChinaEast="chinaeast",a.ChinaNorth2="chinanorth2",a.ChinaEast2="chinaeast2",a.GermanyCentral="germanycentral",a.GermanyNorthEast="germanynortheast",a.GovernmentUSVirginia="usgovvirginia",a.GovernmentUSIowa="usgoviowa",a.GovernmentUSArizona="usgovarizona",a.GovernmentUSTexas="usgovtexas",a.GovernmentUSDodEast="usdodeast",a.GovernmentUSDodCentral="usdodcentral"}(aM||(aM={}));let lc=d8("MsalClient");function ld(a,b,d={}){var e;let f={msalConfig:function(a,b,c={}){var d;let e=la(c.logger??lc,b,a),f=jH(e,jG(c)),g=new k6({...c.tokenCredentialOptions,authorityHost:f,loggingOptions:c.loggingOptions});return{auth:{clientId:a,authority:f,knownAuthorities:(d=c.disableInstanceDiscovery,"adfs"===e&&f||d?[f]:[])},system:{networkClient:g,loggerOptions:{loggerCallback:jI(c.logger??lc),logLevel:jJ(d1()),piiLoggingEnabled:c.loggingOptions?.enableUnsafeSupportLogging}}}}(a,b,d),cachedAccount:d.authenticationRecord?{localAccountId:(e=d.authenticationRecord).homeAccountId,environment:e.authority,username:e.username,homeAccountId:e.homeAccountId,tenantId:e.tenantId}:null,pluginConfiguration:dA.generatePluginConfiguration(d),logger:d.logger??lc},g=new Map;async function h(a={}){let b=a.enableCae?"CAE":"default",c=g.get(b);if(c)return f.logger.getToken.info("Existing PublicClientApplication found in cache, returning it."),c;f.logger.getToken.info(`Creating new PublicClientApplication with CAE ${a.enableCae?"enabled":"disabled"}.`);let d=a.enableCae?f.pluginConfiguration.cache.cachePluginCae:f.pluginConfiguration.cache.cachePlugin;return f.msalConfig.auth.clientCapabilities=a.enableCae?["cp1"]:void 0,c=new iY({...f.msalConfig,broker:{nativeBrokerPlugin:f.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await d}}),g.set(b,c),c}let i=new Map;async function j(a={}){let b=a.enableCae?"CAE":"default",c=i.get(b);if(c)return f.logger.getToken.info("Existing ConfidentialClientApplication found in cache, returning it."),c;f.logger.getToken.info(`Creating new ConfidentialClientApplication with CAE ${a.enableCae?"enabled":"disabled"}.`);let d=a.enableCae?f.pluginConfiguration.cache.cachePluginCae:f.pluginConfiguration.cache.cachePlugin;return f.msalConfig.auth.clientCapabilities=a.enableCae?["cp1"]:void 0,c=new i_({...f.msalConfig,broker:{nativeBrokerPlugin:f.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await d}}),i.set(b,c),c}async function k(a,b,c={}){if(null===f.cachedAccount)throw f.logger.getToken.info("No cached account found in local state."),new dG({scopes:b});c.claims&&(f.cachedClaims=c.claims);let d={account:f.cachedAccount,scopes:b,claims:f.cachedClaims};f.pluginConfiguration.broker.isEnabled&&(d.tokenQueryParameters||={},f.pluginConfiguration.broker.enableMsaPassthrough&&(d.tokenQueryParameters.msal_request_type="consumer_passthrough")),c.proofOfPossessionOptions&&(d.shrNonce=c.proofOfPossessionOptions.nonce,d.authenticationScheme="pop",d.resourceRequestMethod=c.proofOfPossessionOptions.resourceRequestMethod,d.resourceRequestUri=c.proofOfPossessionOptions.resourceRequestUrl),f.logger.getToken.info("Attempting to acquire token silently");try{return await a.acquireTokenSilent(d)}catch(a){throw jK(b,a,c)}}function l(a){return a?.tenantId?jH(a.tenantId,jG(d)):f.msalConfig.auth.authority}async function m(a,b,c,d){let e=null;try{e=await k(a,b,c)}catch(a){if("AuthenticationRequiredError"!==a.name)throw a;if(c.disableAutomaticAuthentication)throw new dG({scopes:b,getTokenOptions:c,message:"Automatic authentication has been disabled. You may call the authentication() method."})}if(null===e)try{e=await d()}catch(a){throw jK(b,a,c)}return jF(b,e,c),f.cachedAccount=e?.account??null,f.logger.getToken.info(d5(b)),{token:e.accessToken,expiresOnTimestamp:e.expiresOn.getTime(),refreshAfterTimestamp:e.refreshOn?.getTime(),tokenType:e.tokenType}}function n(a,b){return{openBrowser:async a=>{let b=await c.e(624).then(c.bind(c,29624));await b.default(a,{newInstance:!0})},scopes:a,authority:l(b),claims:b?.claims,loginHint:b?.loginHint,errorTemplate:b?.browserCustomizationOptions?.errorMessage,successTemplate:b?.browserCustomizationOptions?.successMessage,prompt:b?.loginHint?"login":"select_account"}}async function o(a,b,c={}){lc.verbose("Authentication will resume through the broker");let d=await h(c),e=n(a,c);f.pluginConfiguration.broker.parentWindowHandle?e.windowHandle=Buffer.from(f.pluginConfiguration.broker.parentWindowHandle):lc.warning("Parent window handle is not specified for the broker. This may cause unexpected behavior. Please provide the parentWindowHandle."),f.pluginConfiguration.broker.enableMsaPassthrough&&((e.tokenQueryParameters??={}).msal_request_type="consumer_passthrough"),b?(e.prompt="none",lc.verbose("Attempting broker authentication using the default broker account")):lc.verbose("Attempting broker authentication without the default broker account"),c.proofOfPossessionOptions&&(e.shrNonce=c.proofOfPossessionOptions.nonce,e.authenticationScheme="pop",e.resourceRequestMethod=c.proofOfPossessionOptions.resourceRequestMethod,e.resourceRequestUri=c.proofOfPossessionOptions.resourceRequestUrl);try{return await d.acquireTokenInteractive(e)}catch(d){if(lc.verbose(`Failed to authenticate through the broker: ${d.message}`),c.disableAutomaticAuthentication)throw new dG({scopes:a,getTokenOptions:c,message:"Cannot silently authenticate with default broker account."});if(b)return o(a,!1,c);throw d}}return{getActiveAccount:function(){if(f.cachedAccount){var b;return{authority:(b=f.cachedAccount).environment??"login.microsoftonline.com",homeAccountId:b.homeAccountId,tenantId:b.tenantId||"common",username:b.username,clientId:a,version:"1.0"}}},getBrokeredToken:async function(a,b,c={}){lc.getToken.info(`Attempting to acquire token using brokered authentication with useDefaultBrokerAccount: ${b}`);let d=await o(a,b,c);return jF(a,d,c),f.cachedAccount=d?.account??null,f.logger.getToken.info(d5(a)),{token:d.accessToken,expiresOnTimestamp:d.expiresOn.getTime(),refreshAfterTimestamp:d.refreshOn?.getTime(),tokenType:d.tokenType}},getTokenByClientSecret:async function a(b,c,d={}){f.logger.getToken.info("Attempting to acquire token using client secret"),f.msalConfig.auth.clientSecret=c;let e=await j(d);try{let a=await e.acquireTokenByClientCredential({scopes:b,authority:l(d),azureRegion:k7(),claims:d?.claims});return jF(b,a,d),f.logger.getToken.info(d5(b)),{token:a.accessToken,expiresOnTimestamp:a.expiresOn.getTime(),refreshAfterTimestamp:a.refreshOn?.getTime(),tokenType:a.tokenType}}catch(a){throw jK(b,a,d)}},getTokenByClientAssertion:async function a(b,c,d={}){f.logger.getToken.info("Attempting to acquire token using client assertion"),f.msalConfig.auth.clientAssertion=c;let e=await j(d);try{let a=await e.acquireTokenByClientCredential({scopes:b,authority:l(d),azureRegion:k7(),claims:d?.claims,clientAssertion:c});return jF(b,a,d),f.logger.getToken.info(d5(b)),{token:a.accessToken,expiresOnTimestamp:a.expiresOn.getTime(),refreshAfterTimestamp:a.refreshOn?.getTime(),tokenType:a.tokenType}}catch(a){throw jK(b,a,d)}},getTokenByClientCertificate:async function a(b,c,d={}){f.logger.getToken.info("Attempting to acquire token using client certificate"),f.msalConfig.auth.clientCertificate=c;let e=await j(d);try{let a=await e.acquireTokenByClientCredential({scopes:b,authority:l(d),azureRegion:k7(),claims:d?.claims});return jF(b,a,d),f.logger.getToken.info(d5(b)),{token:a.accessToken,expiresOnTimestamp:a.expiresOn.getTime(),refreshAfterTimestamp:a.refreshOn?.getTime(),tokenType:a.tokenType}}catch(a){throw jK(b,a,d)}},getTokenByDeviceCode:async function a(b,c,d={}){f.logger.getToken.info("Attempting to acquire token using device code");let e=await h(d);return m(e,b,d,()=>{let a={scopes:b,cancel:d?.abortSignal?.aborted??!1,deviceCodeCallback:c,authority:l(d),claims:d?.claims},f=e.acquireTokenByDeviceCode(a);return d.abortSignal&&d.abortSignal.addEventListener("abort",()=>{a.cancel=!0}),f})},getTokenByUsernamePassword:async function a(b,c,d,e={}){f.logger.getToken.info("Attempting to acquire token using username and password");let g=await h(e);return m(g,b,e,()=>{let a={scopes:b,username:c,password:d,authority:l(e),claims:e?.claims};return g.acquireTokenByUsernamePassword(a)})},getTokenByAuthorizationCode:async function(a,b,c,d,e={}){let g;return f.logger.getToken.info("Attempting to acquire token using authorization code"),d?(f.msalConfig.auth.clientSecret=d,g=await j(e)):g=await h(e),m(g,a,e,()=>g.acquireTokenByCode({scopes:a,redirectUri:b,code:c,authority:l(e),claims:e?.claims}))},getTokenOnBehalfOf:async function(a,b,c,d={}){lc.getToken.info("Attempting to acquire token on behalf of another user"),"string"==typeof c?(lc.getToken.info("Using client secret for on behalf of flow"),f.msalConfig.auth.clientSecret=c):"function"==typeof c?(lc.getToken.info("Using client assertion callback for on behalf of flow"),f.msalConfig.auth.clientAssertion=c):(lc.getToken.info("Using client certificate for on behalf of flow"),f.msalConfig.auth.clientCertificate=c);let e=await j(d);try{let c=await e.acquireTokenOnBehalfOf({scopes:a,authority:l(d),claims:d.claims,oboAssertion:b});return jF(a,c,d),lc.getToken.info(d5(a)),{token:c.accessToken,expiresOnTimestamp:c.expiresOn.getTime(),refreshAfterTimestamp:c.refreshOn?.getTime(),tokenType:c.tokenType}}catch(b){throw jK(a,b,d)}},getTokenByInteractiveRequest:async function(a,b={}){lc.getToken.info("Attempting to acquire token interactively");let c=await h(b);return m(c,a,b,async()=>{let d=n(a,b);return f.pluginConfiguration.broker.isEnabled?o(a,f.pluginConfiguration.broker.useDefaultBrokerAccount??!1,b):(b.proofOfPossessionOptions&&(d.shrNonce=b.proofOfPossessionOptions.nonce,d.authenticationScheme="pop",d.resourceRequestMethod=b.proofOfPossessionOptions.resourceRequestMethod,d.resourceRequestUri=b.proofOfPossessionOptions.resourceRequestUrl),c.acquireTokenInteractive(d))})}}}var le=c(51455);let lf="ClientCertificateCredential",lg=d8(lf);class lh{tenantId;additionallyAllowedTenantIds;certificateConfiguration;sendCertificateChain;msalClient;constructor(a,b,c,d={}){if(!a||!b)throw Error(`${lf}: tenantId and clientId are required parameters.`);this.tenantId=a,this.additionallyAllowedTenantIds=lb(d?.additionallyAllowedTenants),this.sendCertificateChain=d.sendCertificateChain,this.certificateConfiguration={..."string"==typeof c?{certificatePath:c}:c};let e=this.certificateConfiguration.certificate,f=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(e||f))throw Error(`${lf}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(e&&f)throw Error(`${lf}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=ld(b,a,{...d,logger:lg,tokenCredentialOptions:d})}async getToken(a,b={}){return ee.withSpan(`${lf}.getToken`,b,async b=>{b.tenantId=k8(this.tenantId,b,this.additionallyAllowedTenantIds,lg);let c=Array.isArray(a)?a:[a],d=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(c,d,b)})}async buildClientCertificate(){let a,b=await li(this.certificateConfiguration,this.sendCertificateChain??!1);return a=void 0!==this.certificateConfiguration.certificatePassword?(0,jv.createPrivateKey)({key:b.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString():b.certificateContents,{thumbprint:b.thumbprint,thumbprintSha256:b.thumbprintSha256,privateKey:a,x5c:b.x5c}}}async function li(a,b){let c,d=a.certificate,e=a.certificatePath,f=d||await (0,le.readFile)(e,"utf8"),g=b?f:void 0,h=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,i=[];do(c=h.exec(f))&&i.push(c[3]);while(c);if(0===i.length)throw Error("The file at the specified path does not contain a PEM-encoded certificate.");let j=(0,jv.createHash)("sha1").update(Buffer.from(i[0],"base64")).digest("hex").toUpperCase();return{certificateContents:f,thumbprintSha256:(0,jv.createHash)("sha256").update(Buffer.from(i[0],"base64")).digest("hex").toUpperCase(),thumbprint:j,x5c:g}}function lj(a){return Array.isArray(a)?a:[a]}function lk(a,b){if(!a.match(/^[0-9a-zA-Z-_.:/]+$/)){let c=Error("Invalid scope was specified by the user or calling client");throw b.getToken.info(d6(a,c)),c}}function ll(a){return a.replace(/\/.default$/,"")}let lm=d8("ClientSecretCredential");class ln{tenantId;additionallyAllowedTenantIds;msalClient;clientSecret;constructor(a,b,c,d={}){if(!a)throw new dB("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!b)throw new dB("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!c)throw new dB("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=c,this.tenantId=a,this.additionallyAllowedTenantIds=lb(d?.additionallyAllowedTenants),this.msalClient=ld(b,a,{...d,logger:lm,tokenCredentialOptions:d})}async getToken(a,b={}){return ee.withSpan(`${this.constructor.name}.getToken`,b,async b=>{b.tenantId=k8(this.tenantId,b,this.additionallyAllowedTenantIds,lm);let c=lj(a);return this.msalClient.getTokenByClientSecret(c,this.clientSecret,b)})}}let lo=d8("UsernamePasswordCredential");class lp{tenantId;additionallyAllowedTenantIds;msalClient;username;password;constructor(a,b,c,d,e={}){if(!a)throw new dB("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!b)throw new dB("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!c)throw new dB("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!d)throw new dB("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=a,this.additionallyAllowedTenantIds=lb(e?.additionallyAllowedTenants),this.username=c,this.password=d,this.msalClient=ld(b,this.tenantId,{...e,tokenCredentialOptions:e??{}})}async getToken(a,b={}){return ee.withSpan(`${this.constructor.name}.getToken`,b,async b=>{b.tenantId=k8(this.tenantId,b,this.additionallyAllowedTenantIds,lo);let c=lj(a);return this.msalClient.getTokenByUsernamePassword(c,this.username,this.password,b)})}}let lq=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"],lr="EnvironmentCredential",ls=d8(lr);class lt{_credential=void 0;constructor(a){let b=d4(lq).assigned.join(", ");ls.info(`Found the following environment variables: ${b}`);let c=process.env.AZURE_TENANT_ID,d=process.env.AZURE_CLIENT_ID,e=process.env.AZURE_CLIENT_SECRET,f=(process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS??"").split(";"),g=function(){let a=(process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN??"").toLowerCase(),b="true"===a||"1"===a;return ls.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${b}`),b}(),h={...a,additionallyAllowedTenantIds:f,sendCertificateChain:g};if(c&&k9(ls,c),c&&d&&e){ls.info(`Invoking ClientSecretCredential with tenant ID: ${c}, clientId: ${d} and clientSecret: [REDACTED]`),this._credential=new ln(c,d,e,h);return}let i=process.env.AZURE_CLIENT_CERTIFICATE_PATH,j=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(c&&d&&i){ls.info(`Invoking ClientCertificateCredential with tenant ID: ${c}, clientId: ${d} and certificatePath: ${i}`),this._credential=new lh(c,d,{certificatePath:i,certificatePassword:j},h);return}let k=process.env.AZURE_USERNAME,l=process.env.AZURE_PASSWORD;c&&d&&k&&l&&(ls.info(`Invoking UsernamePasswordCredential with tenant ID: ${c}, clientId: ${d} and username: ${k}`),ls.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new lp(c,d,k,l,h))}async getToken(a,b={}){return ee.withSpan(`${lr}.getToken`,b,async b=>{if(this._credential)try{let c=await this._credential.getToken(a,b);return ls.getToken.info(d5(a)),c}catch(c){let b=new dD(400,{error:`${lr} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:c.message.toString().split("More details:").join("")});throw ls.getToken.info(d6(a,b)),b}throw new dB(`${lr} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}}let lu="ManagedIdentityCredential - IMDS",lv=d8(lu),lw={name:"imdsMsi",async isAvailable(a){let{scopes:b,identityClient:c,getTokenOptions:d}=a,e=k4(b);if(!e)return lv.info(`${lu}: Unavailable. Multiple scopes are not supported.`),!1;if(process.env.AZURE_POD_IDENTITY_AUTHORITY_HOST)return!0;if(!c)throw Error("Missing IdentityClient");let f=function(a){if(!k4(a))throw Error(`${lu}: Multiple scopes are not supported.`);let b=new URL("/metadata/identity/oauth2/token",process.env.AZURE_POD_IDENTITY_AUTHORITY_HOST??"http://169.254.169.254");return{url:`${b}`,method:"GET",headers:jP({Accept:"application/json"})}}(e);return ee.withSpan("ManagedIdentityCredential-pingImdsEndpoint",d??{},async a=>{let b;f.tracingOptions=a.tracingOptions;let d=kG(f);d.timeout=a.requestOptions?.timeout||1e3,d.allowInsecureConnection=!0;try{lv.info(`${lu}: Pinging the Azure IMDS endpoint`),b=await c.sendRequest(d)}catch(a){return ju(a)&&lv.verbose(`${lu}: Caught error ${a.name}: ${a.message}`),lv.info(`${lu}: The Azure IMDS endpoint is unavailable`),!1}return 403===b.status&&b.bodyAsText?.includes("unreachable")?(lv.info(`${lu}: The Azure IMDS endpoint is unavailable`),lv.info(`${lu}: ${b.bodyAsText}`),!1):(lv.info(`${lu}: The Azure IMDS endpoint is available`),!0)})}},lx=d8("ClientAssertionCredential");class ly{msalClient;tenantId;additionallyAllowedTenantIds;getAssertion;options;constructor(a,b,c,d={}){if(!a)throw new dB("ClientAssertionCredential: tenantId is a required parameter.");if(!b)throw new dB("ClientAssertionCredential: clientId is a required parameter.");if(!c)throw new dB("ClientAssertionCredential: clientAssertion is a required parameter.");this.tenantId=a,this.additionallyAllowedTenantIds=lb(d?.additionallyAllowedTenants),this.options=d,this.getAssertion=c,this.msalClient=ld(b,a,{...d,logger:lx,tokenCredentialOptions:this.options})}async getToken(a,b={}){return ee.withSpan(`${this.constructor.name}.getToken`,b,async b=>{b.tenantId=k8(this.tenantId,b,this.additionallyAllowedTenantIds,lx);let c=Array.isArray(a)?a:[a];return this.msalClient.getTokenByClientAssertion(c,this.getAssertion,b)})}}let lz="WorkloadIdentityCredential",lA=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_FEDERATED_TOKEN_FILE"],lB=d8(lz);class lC{client;azureFederatedTokenFileContent=void 0;cacheDate=void 0;federatedTokenFilePath;constructor(a){let b=d4(lA).assigned.join(", ");lB.info(`Found the following environment variables: ${b}`);let c=a??{},d=c.tenantId||process.env.AZURE_TENANT_ID,e=c.clientId||process.env.AZURE_CLIENT_ID;if(this.federatedTokenFilePath=c.tokenFilePath||process.env.AZURE_FEDERATED_TOKEN_FILE,d&&k9(lB,d),!e)throw new dB(`${lz}: is unavailable. clientId is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_CLIENT_ID".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);if(!d)throw new dB(`${lz}: is unavailable. tenantId is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_TENANT_ID".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);if(!this.federatedTokenFilePath)throw new dB(`${lz}: is unavailable. federatedTokenFilePath is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_FEDERATED_TOKEN_FILE".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);lB.info(`Invoking ClientAssertionCredential with tenant ID: ${d}, clientId: ${c.clientId} and federated token path: [REDACTED]`),this.client=new ly(d,e,this.readFileContents.bind(this),a)}async getToken(a,b){if(!this.client){let a=`${lz}: is unavailable. tenantId, clientId, and federatedTokenFilePath are required parameters. 
      In DefaultAzureCredential and ManagedIdentityCredential, these can be provided as environment variables - 
      "AZURE_TENANT_ID",
      "AZURE_CLIENT_ID",
      "AZURE_FEDERATED_TOKEN_FILE". See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`;throw lB.info(a),new dB(a)}return lB.info("Invoking getToken() of Client Assertion Credential"),this.client.getToken(a,b)}async readFileContents(){if(void 0!==this.cacheDate&&Date.now()-this.cacheDate>=3e5&&(this.azureFederatedTokenFileContent=void 0),!this.federatedTokenFilePath)throw new dB(`${lz}: is unavailable. Invalid file path provided ${this.federatedTokenFilePath}.`);if(!this.azureFederatedTokenFileContent){let a=(await (0,le.readFile)(this.federatedTokenFilePath,"utf8")).trim();if(a)this.azureFederatedTokenFileContent=a,this.cacheDate=Date.now();else throw new dB(`${lz}: is unavailable. No content on the file ${this.federatedTokenFilePath}.`)}return this.azureFederatedTokenFileContent}}let lD="ManagedIdentityCredential - Token Exchange",lE=d8(lD),lF={name:"tokenExchangeMsi",async isAvailable(a){let b=process.env,c=!!((a||b.AZURE_CLIENT_ID)&&b.AZURE_TENANT_ID&&process.env.AZURE_FEDERATED_TOKEN_FILE);return c||lE.info(`${lD}: Unavailable. The environment variables needed are: AZURE_CLIENT_ID (or the client ID sent through the parameters), AZURE_TENANT_ID and AZURE_FEDERATED_TOKEN_FILE`),c},async getToken(a,b={}){let{scopes:c,clientId:d}=a;return new lC({clientId:d,tenantId:process.env.AZURE_TENANT_ID,tokenFilePath:process.env.AZURE_FEDERATED_TOKEN_FILE,...{},disableInstanceDiscovery:!0}).getToken(c,b)}},lG=d8("ManagedIdentityCredential");class lH{managedIdentityApp;identityClient;clientId;resourceId;objectId;msiRetryConfig={maxRetries:5,startDelayInMs:800,intervalIncrement:2};isAvailableIdentityClient;sendProbeRequest;constructor(a,b){let c;"string"==typeof a?(this.clientId=a,c=b??{}):(this.clientId=a?.clientId,c=a??{}),this.resourceId=c?.resourceId,this.objectId=c?.objectId,this.sendProbeRequest=c?.sendProbeRequest??!1;let d=[{key:"clientId",value:this.clientId},{key:"resourceId",value:this.resourceId},{key:"objectId",value:this.objectId}].filter(a=>a.value);if(d.length>1)throw Error(`ManagedIdentityCredential: only one of 'clientId', 'resourceId', or 'objectId' can be provided. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}`);c.allowInsecureConnection=!0,c.retryOptions?.maxRetries!==void 0&&(this.msiRetryConfig.maxRetries=c.retryOptions.maxRetries),this.identityClient=new k6({...c,additionalPolicies:[{policy:function(a){return function(a,b={maxRetries:3}){return ka(a,{logger:kH,...b})}([{name:"imdsRetryPolicy",retry:({retryCount:b,response:c})=>c?.status!==404&&c?.status!==410?{skipStrategy:!0}:js(b,{retryDelayInMs:c?.status===410?Math.max(3e3,a.startDelayInMs):a.startDelayInMs,maxRetryDelayInMs:64e3})}],{maxRetries:a.maxRetries})}(this.msiRetryConfig),position:"perCall"}]}),this.managedIdentityApp=new jr({managedIdentityIdParams:{userAssignedClientId:this.clientId,userAssignedResourceId:this.resourceId,userAssignedObjectId:this.objectId},system:{disableInternalRetries:!0,networkClient:this.identityClient,loggerOptions:{logLevel:jJ(d1()),piiLoggingEnabled:c.loggingOptions?.enableUnsafeSupportLogging,loggerCallback:jI(lG)}}}),this.isAvailableIdentityClient=new k6({...c,retryOptions:{maxRetries:0}});let e=this.managedIdentityApp.getManagedIdentitySource();if("CloudShell"===e&&(this.clientId||this.resourceId||this.objectId))throw lG.warning(`CloudShell MSI detected with user-provided IDs - throwing. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}.`),new dB("ManagedIdentityCredential: Specifying a user-assigned managed identity is not supported for CloudShell at runtime. When using Managed Identity in CloudShell, omit the clientId, resourceId, and objectId parameters.");if("ServiceFabric"===e&&(this.clientId||this.resourceId||this.objectId))throw lG.warning(`Service Fabric detected with user-provided IDs - throwing. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}.`),new dB("ManagedIdentityCredential: Specifying a `clientId` or `resourceId` is not supported by the Service Fabric managed identity environment. The managed identity configuration is determined by the Service Fabric cluster resource configuration. See https://aka.ms/servicefabricmi for more information");if(lG.info(`Using ${e} managed identity.`),1===d.length){let{key:a,value:b}=d[0];lG.info(`${e} with ${a}: ${b}`)}}async getToken(a,b={}){lG.getToken.info("Using the MSAL provider for Managed Identity.");let c=k4(a);if(!c)throw new dB(`ManagedIdentityCredential: Multiple scopes are not supported. Scopes: ${JSON.stringify(a)}`);return ee.withSpan("ManagedIdentityCredential.getToken",b,async()=>{try{let d=await lF.isAvailable(this.clientId),e=this.managedIdentityApp.getManagedIdentitySource();if(lG.getToken.info(`MSAL Identity source: ${e}`),d){lG.getToken.info("Using the token exchange managed identity.");let b=await lF.getToken({scopes:a,clientId:this.clientId,identityClient:this.identityClient,retryConfig:this.msiRetryConfig,resourceId:this.resourceId});if(null===b)throw new dB("Attempted to use the token exchange managed identity, but received a null response.");return b}if(("DefaultToImds"===e||"Imds"===e)&&this.sendProbeRequest&&(lG.getToken.info("Using the IMDS endpoint to probe for availability."),!await lw.isAvailable({scopes:a,clientId:this.clientId,getTokenOptions:b,identityClient:this.isAvailableIdentityClient,resourceId:this.resourceId})))throw new dB("Attempted to use the IMDS endpoint, but it is not available.");lG.getToken.info("Calling into MSAL for managed identity token.");let f=await this.managedIdentityApp.acquireToken({resource:c});return this.ensureValidMsalToken(a,f,b),lG.getToken.info(d5(a)),{expiresOnTimestamp:f.expiresOn.getTime(),token:f.accessToken,refreshAfterTimestamp:f.refreshOn?.getTime(),tokenType:"Bearer"}}catch(b){var d;if(lG.getToken.error(d6(a,b)),"AuthenticationRequiredError"===b.name)throw b;if("network_error"===(d=b).errorCode||"ENETUNREACH"===d.code||"EHOSTUNREACH"===d.code||(403===d.statusCode||403===d.code)&&d.message.includes("unreachable"))throw new dB(`ManagedIdentityCredential: Network unreachable. Message: ${b.message}`,{cause:b});throw new dB(`ManagedIdentityCredential: Authentication failed. Message ${b.message}`,{cause:b})}})}ensureValidMsalToken(a,b,c){let d=b=>(lG.getToken.info(b),new dG({scopes:Array.isArray(a)?a:[a],getTokenOptions:c,message:b}));if(!b)throw d("No response.");if(!b.expiresOn)throw d('Response had no "expiresOn" property.');if(!b.accessToken)throw d('Response had no "accessToken" property.')}}let lI=require("child_process"),lJ=d8("AzureDeveloperCliCredential"),lK={notInstalled:"Azure Developer CLI couldn't be found. To mitigate this issue, see the troubleshooting guidelines at https://aka.ms/azsdk/js/identity/azdevclicredential/troubleshoot.",login:"Please run 'azd auth login' from a command prompt to authenticate before using this credential. For more information, see the troubleshooting guidelines at https://aka.ms/azsdk/js/identity/azdevclicredential/troubleshoot.",unknown:"Unknown error while trying to retrieve the access token",claim:"This credential doesn't support claims challenges. To authenticate with the required claims, please run the following command:"},lL={getSafeWorkingDir(){if("win32"!==process.platform)return"/bin";{let a=process.env.SystemRoot||process.env.SYSTEMROOT;return a||(lJ.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure Developer CLI credential."),a="C:\\Windows"),a}},async getAzdAccessToken(a,b,c,d){let e=[];b&&(e=["--tenant-id",b]);let f=[];return d&&(f=["--claims",btoa(d)]),new Promise((b,d)=>{try{let d=["auth","token","--output","json","--no-prompt",...a.reduce((a,b)=>a.concat("--scope",b),[]),...e,...f],g=["azd",...d].join(" ");lI.exec(g,{cwd:lL.getSafeWorkingDir(),timeout:c},(a,c,d)=>{b({stdout:c,stderr:d,error:a})})}catch(a){d(a)}})}};class lM{tenantId;additionallyAllowedTenantIds;timeout;constructor(a){a?.tenantId&&(k9(lJ,a?.tenantId),this.tenantId=a?.tenantId),this.additionallyAllowedTenantIds=lb(a?.additionallyAllowedTenants),this.timeout=a?.processTimeoutInMs}async getToken(a,b={}){let c,d=k8(this.tenantId,b,this.additionallyAllowedTenantIds);return d&&k9(lJ,d),c="string"==typeof a?[a]:a,lJ.getToken.info(`Using the scopes ${a}`),ee.withSpan(`${this.constructor.name}.getToken`,b,async()=>{try{c.forEach(a=>{lk(a,lJ)});let e=await lL.getAzdAccessToken(c,d,this.timeout,b.claims),f=e.stderr?.match("must use multi-factor authentication")||e.stderr?.match("reauthentication required"),g=e.stderr?.match("not logged in, run `azd login` to login")||e.stderr?.match("not logged in, run `azd auth login` to login");if(e.stderr?.match("azd:(.*)not found")||e.stderr?.startsWith("'azd' is not recognized")||e.error&&"ENOENT"===e.error.code){let b=new dB(lK.notInstalled);throw lJ.getToken.info(d6(a,b)),b}if(g){let b=new dB(lK.login);throw lJ.getToken.info(d6(a,b)),b}if(f){let b=c.reduce((a,b)=>a.concat("--scope",b),[]).join(" "),d=`azd auth login ${b}`,e=new dB(`${lK.claim} ${d}`);throw lJ.getToken.info(d6(a,e)),e}try{let b=JSON.parse(e.stdout);return lJ.getToken.info(d5(a)),{token:b.token,expiresOnTimestamp:new Date(b.expiresOn).getTime(),tokenType:"Bearer"}}catch(a){if(e.stderr)throw new dB(e.stderr);throw a}}catch(c){let b="CredentialUnavailableError"===c.name?c:new dB(c.message||lK.unknown);throw lJ.getToken.info(d6(a,b)),b}})}}function lN(a,b){if(!b.match(/^[0-9a-zA-Z-._ ]+$/)){let c=Error(`Subscription '${b}' contains invalid characters. If this is the name of a subscription, use its ID instead. You can locate your subscription by following the instructions listed here: https://learn.microsoft.com/azure/azure-portal/get-subscription-tenant-id`);throw a.info(d6("",c)),c}}let lO=d8("AzureCliCredential"),lP={claim:"This credential doesn't support claims challenges. To authenticate with the required claims, please run the following command:",notInstalled:"Azure CLI could not be found. Please visit https://aka.ms/azure-cli for installation instructions and then, once installed, authenticate to your Azure account using 'az login'.",login:"Please run 'az login' from a command prompt to authenticate before using this credential.",unknown:"Unknown error while trying to retrieve the access token",unexpectedResponse:'Unexpected response from Azure CLI when getting token. Expected "expiresOn" to be a RFC3339 date string. Got:'},lQ={getSafeWorkingDir(){if("win32"!==process.platform)return"/bin";{let a=process.env.SystemRoot||process.env.SYSTEMROOT;return a||(lO.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure CLI credential."),a="C:\\Windows"),a}},async getAzureCliAccessToken(a,b,c,d){let e=[],f=[];return b&&(e=["--tenant",b]),c&&(f=["--subscription",`"${c}"`]),new Promise((b,c)=>{try{let c=["account","get-access-token","--output","json","--resource",a,...e,...f],g=["az",...c].join(" ");lI.exec(g,{cwd:lQ.getSafeWorkingDir(),timeout:d},(a,c,d)=>{b({stdout:c,stderr:d,error:a})})}catch(a){c(a)}})}};class lR{tenantId;additionallyAllowedTenantIds;timeout;subscription;constructor(a){a?.tenantId&&(k9(lO,a?.tenantId),this.tenantId=a?.tenantId),a?.subscription&&(lN(lO,a?.subscription),this.subscription=a?.subscription),this.additionallyAllowedTenantIds=lb(a?.additionallyAllowedTenants),this.timeout=a?.processTimeoutInMs}async getToken(a,b={}){let c="string"==typeof a?a:a[0],d=b.claims;if(d&&d.trim()){let a=btoa(d),e=`az login --claims-challenge ${a} --scope ${c}`,f=b.tenantId;f&&(e+=` --tenant ${f}`);let g=new dB(`${lP.claim} ${e}`);throw lO.getToken.info(d6(c,g)),g}let e=k8(this.tenantId,b,this.additionallyAllowedTenantIds);return e&&k9(lO,e),this.subscription&&lN(lO,this.subscription),lO.getToken.info(`Using the scope ${c}`),ee.withSpan(`${this.constructor.name}.getToken`,b,async()=>{try{lk(c,lO);let b=ll(c),d=await lQ.getAzureCliAccessToken(b,e,this.subscription,this.timeout),f=d.stderr?.match("(.*)az login --scope(.*)"),g=d.stderr?.match("(.*)az login(.*)")&&!f;if(d.stderr?.match("az:(.*)not found")||d.stderr?.startsWith("'az' is not recognized")){let b=new dB(lP.notInstalled);throw lO.getToken.info(d6(a,b)),b}if(g){let b=new dB(lP.login);throw lO.getToken.info(d6(a,b)),b}try{let b=d.stdout,c=this.parseRawResponse(b);return lO.getToken.info(d5(a)),c}catch(a){if(d.stderr)throw new dB(d.stderr);throw a}}catch(c){let b="CredentialUnavailableError"===c.name?c:new dB(c.message||lP.unknown);throw lO.getToken.info(d6(a,b)),b}})}parseRawResponse(a){let b=JSON.parse(a),c=b.accessToken,d=1e3*Number.parseInt(b.expires_on,10);if(!isNaN(d))return lO.getToken.info("expires_on is available and is valid, using it"),{token:c,expiresOnTimestamp:d,tokenType:"Bearer"};if(isNaN(d=new Date(b.expiresOn).getTime()))throw new dB(`${lP.unexpectedResponse} "${b.expiresOn}"`);return{token:c,expiresOnTimestamp:d,tokenType:"Bearer"}}}var lS=c(31421);let lT={execFile:(a,b,c)=>new Promise((d,e)=>{lS.execFile(a,b,c,(a,b,c)=>{Buffer.isBuffer(b)&&(b=b.toString("utf8")),Buffer.isBuffer(c)&&(c=c.toString("utf8")),c||a?e(c?Error(c):a):d(b)})})},lU=d8("AzurePowerShellCredential"),lV="win32"===process.platform;function lW(a){return lV?`${a}.exe`:a}async function lX(a,b){let c=[];for(let d of a){let[a,...e]=d,f=await lT.execFile(a,e,{encoding:"utf8",timeout:b});c.push(f)}return c}let lY={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},lZ={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:"The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: \"Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force\".",claim:"This credential doesn't support claims challenges. To authenticate with the required claims, please run the following command:",troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},l$=[lW("pwsh")];lV&&l$.push(lW("powershell"));class l_{tenantId;additionallyAllowedTenantIds;timeout;constructor(a){a?.tenantId&&(k9(lU,a?.tenantId),this.tenantId=a?.tenantId),this.additionallyAllowedTenantIds=lb(a?.additionallyAllowedTenants),this.timeout=a?.processTimeoutInMs}async getAzurePowerShellAccessToken(a,b,c){for(let d of[...l$]){try{await lX([[d,"/?"]],c)}catch(a){l$.shift();continue}return l0((await lX([[d,"-NoProfile","-NonInteractive","-Command",`
          $tenantId = "${b??""}"
          $m = Import-Module Az.Accounts -MinimumVersion 2.2.0 -PassThru
          $useSecureString = $m.Version -ge [version]'2.17.0' -and $m.Version -lt [version]'5.0.0'

          $params = @{
            ResourceUrl = "${a}"
          }

          if ($tenantId.Length -gt 0) {
            $params["TenantId"] = $tenantId
          }

          if ($useSecureString) {
            $params["AsSecureString"] = $true
          }

          $token = Get-AzAccessToken @params

          $result = New-Object -TypeName PSObject
          $result | Add-Member -MemberType NoteProperty -Name ExpiresOn -Value $token.ExpiresOn

          if ($token.Token -is [System.Security.SecureString]) {
            if ($PSVersionTable.PSVersion.Major -lt 7) {
              $ssPtr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($token.Token)
              try {
                $result | Add-Member -MemberType NoteProperty -Name Token -Value ([System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ssPtr))
              }
              finally {
                [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ssPtr)
              }
            }
            else {
              $result | Add-Member -MemberType NoteProperty -Name Token -Value ($token.Token | ConvertFrom-SecureString -AsPlainText)
            }
          }
          else {
            $result | Add-Member -MemberType NoteProperty -Name Token -Value $token.Token
          }

          Write-Output (ConvertTo-Json $result)
          `]]))[0])}throw Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(a,b={}){return ee.withSpan(`${this.constructor.name}.getToken`,b,async()=>{let c="string"==typeof a?a:a[0],d=b.claims;if(d&&d.trim()){let a=btoa(d),e=`Connect-AzAccount -ClaimsChallenge ${a}`,f=b.tenantId;f&&(e+=` -Tenant ${f}`);let g=new dB(`${lZ.claim} ${e}`);throw lU.getToken.info(d6(c,g)),g}let e=k8(this.tenantId,b,this.additionallyAllowedTenantIds);e&&k9(lU,e);try{lk(c,lU),lU.getToken.info(`Using the scope ${c}`);let b=ll(c),d=await this.getAzurePowerShellAccessToken(b,e,this.timeout);return lU.getToken.info(d5(a)),{token:d.Token,expiresOnTimestamp:new Date(d.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(b){if(b.message.match(lY.installed)){let a=new dB(lZ.installed);throw lU.getToken.info(d6(c,a)),a}if(b.message.match(`(.*)${lY.login}(.*)`)){let a=new dB(lZ.login);throw lU.getToken.info(d6(c,a)),a}let a=new dB(`${b}. ${lZ.troubleshoot}`);throw lU.getToken.info(d6(c,a)),a}})}}async function l0(a){let b=a.match(/{[^{}]*}/g),c=a;if(b)try{for(let a of b)try{let b=JSON.parse(a);if(b?.Token)return(c=c.replace(a,""))&&lU.getToken.warning(c),b}catch(a){continue}}catch(b){throw Error(`Unable to parse the output of PowerShell. Received output: ${a}`)}throw Error(`No access token found in the output. Received output: ${a}`)}let l1=d8("VisualStudioCodeCredential"),l2={adfs:"The VisualStudioCodeCredential does not support authentication with ADFS tenants."};class l3{tenantId;additionallyAllowedTenantIds;msalClient;options;constructor(a){this.options=a||{},a&&a.tenantId?(k9(l1,a.tenantId),this.tenantId=a.tenantId):this.tenantId="common",this.additionallyAllowedTenantIds=lb(a?.additionallyAllowedTenants),function(a){let b=l2[a];if(b)throw new dB(b)}(this.tenantId)}async prepare(a){let b=k8(this.tenantId,this.options,this.additionallyAllowedTenantIds,l1)||this.tenantId;if(void 0===l||void 0===m||!l)throw new dB("Visual Studio Code Authentication is not available. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.");let c=await this.loadAuthRecord(l,a);this.msalClient=ld("aebc6443-996d-45c2-90f0-388ff96faa56",b,{...this.options,isVSCodeCredential:!0,brokerOptions:{enabled:!0,parentWindowHandle:new Uint8Array(0),useDefaultBrokerAccount:!0},authenticationRecord:c})}preparePromise;prepareOnce(a){return this.preparePromise||(this.preparePromise=this.prepare(a)),this.preparePromise}async getToken(a,b){let c=lj(a);if(await this.prepareOnce(c),!this.msalClient)throw new dB("Visual Studio Code Authentication failed to initialize. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.");return this.msalClient.getTokenByInteractiveRequest(c,{...b,disableAutomaticAuthentication:!0})}async loadAuthRecord(a,b){try{var c=await (0,le.readFile)(a,{encoding:"utf8"});let b=JSON.parse(c);if(b.version&&"1.0"!==b.version)throw Error("Unsupported AuthenticationRecord version");return b}catch(a){throw l1.getToken.info(d6(b,a)),new dB("Cannot load authentication record in Visual Studio Code. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.")}}}let l4=d8("BrokerCredential");class l5{brokerMsalClient;brokerTenantId;brokerAdditionallyAllowedTenantIds;constructor(a){this.brokerTenantId=la(l4,a.tenantId),this.brokerAdditionallyAllowedTenantIds=lb(a?.additionallyAllowedTenants);let b={...a,tokenCredentialOptions:a,logger:l4,brokerOptions:{enabled:!0,parentWindowHandle:new Uint8Array(0),useDefaultBrokerAccount:!0}};this.brokerMsalClient=ld(dv,this.brokerTenantId,b)}async getToken(a,b={}){return ee.withSpan(`${this.constructor.name}.getToken`,b,async b=>{b.tenantId=k8(this.brokerTenantId,b,this.brokerAdditionallyAllowedTenantIds,l4);let c=lj(a);try{return this.brokerMsalClient.getBrokeredToken(c,!0,{...b,disableAutomaticAuthentication:!0})}catch(a){throw l4.getToken.info(d6(c,a)),new dB("Failed to acquire token using broker authentication",{cause:a})}})}}function l6(a={}){return new l5(a)}function l7(a={}){return new l3(a)}function l8(a={}){a.retryOptions??={maxRetries:5,retryDelayInMs:800},a.sendProbeRequest??=!0;let b=a?.managedIdentityClientId??process.env.AZURE_CLIENT_ID,c=a?.workloadIdentityClientId??b,d=a?.managedIdentityResourceId,e=process.env.AZURE_FEDERATED_TOKEN_FILE,f=a?.tenantId??process.env.AZURE_TENANT_ID;return d?new lH({...a,resourceId:d}):e&&c?new lH(c,{...a,tenantId:f}):new lH(b?{...a,clientId:b}:a)}function l9(a){let b=a?.managedIdentityClientId??process.env.AZURE_CLIENT_ID,c=a?.workloadIdentityClientId??b,d=process.env.AZURE_FEDERATED_TOKEN_FILE,e=a?.tenantId??process.env.AZURE_TENANT_ID;return new lC(d&&c?{...a,tenantId:e,clientId:c,tokenFilePath:d}:e?{...a,tenantId:e}:a)}function ma(a={}){return new lM(a)}function mb(a={}){return new lR(a)}function mc(a={}){return new l_(a)}function md(a={}){return new lt(a)}let me=d8("DefaultAzureCredential");class mf{credentialUnavailableErrorMessage;credentialName;constructor(a,b){this.credentialName=a,this.credentialUnavailableErrorMessage=b}getToken(){return me.getToken.info(`Skipping ${this.credentialName}, reason: ${this.credentialUnavailableErrorMessage}`),Promise.resolve(null)}}class mg extends eg{constructor(a){!function(a){if(a?.requiredEnvVars){let b=(Array.isArray(a.requiredEnvVars)?a.requiredEnvVars:[a.requiredEnvVars]).filter(a=>!process.env[a]);if(b.length>0){let a=`Required environment ${1===b.length?"variable":"variables"} '${b.join(", ")}' for DefaultAzureCredential ${1===b.length?"is":"are"} not set or empty.`;throw me.warning(a),Error(a)}}}(a);let b=process.env.AZURE_TOKEN_CREDENTIALS?process.env.AZURE_TOKEN_CREDENTIALS.trim().toLowerCase():void 0,c=[l7,mb,mc,ma,l6],d=[md,l9,l8],e=[];if(b)switch(b){case"dev":e=c;break;case"prod":e=d;break;case"environmentcredential":e=[md];break;case"workloadidentitycredential":e=[l9];break;case"managedidentitycredential":e=[()=>l8({sendProbeRequest:!1})];break;case"visualstudiocodecredential":e=[l7];break;case"azureclicredential":e=[mb];break;case"azurepowershellcredential":e=[mc];break;case"azuredeveloperclicredential":e=[ma];break;default:{let a=`Invalid value for AZURE_TOKEN_CREDENTIALS = ${process.env.AZURE_TOKEN_CREDENTIALS}. Valid values are 'prod' or 'dev' or any of these credentials - EnvironmentCredential, WorkloadIdentityCredential, ManagedIdentityCredential, VisualStudioCodeCredential, AzureCliCredential, AzurePowerShellCredential, AzureDeveloperCliCredential.`;throw me.warning(a),Error(a)}}else e=[...d,...c];super(...e.map(b=>{try{return b(a??{})}catch(a){return me.warning(`Skipped ${b.name} because of an error creating the credential: ${a}`),new mf(b.name,a.message)}}))}}function mh(a){let{endpoint:b,apiKey:c,apiVersion:d,deployment:e,azureAuthMode:f}=a;return new ds("entraId"===f||!c&&b?{endpoint:b,apiVersion:d,deployment:e,azureADTokenProvider:function(a,b,c){let{abortSignal:d,tracingOptions:e}={},f=ku();return f.addPolicy(kO({credential:a,scopes:b})),async function(){let a=await f.sendRequest({sendRequest:a=>Promise.resolve({request:a,status:200,headers:a.headers})},kG({url:"https://example.com",abortSignal:d,tracingOptions:e})),b=a.headers.get("authorization")?.split(" ")[1];if(!b)throw Error("Failed to get access token");return b}}(new mg,"https://cognitiveservices.azure.com/.default")}:{endpoint:b,apiKey:c,apiVersion:d,deployment:e})}async function mi(a){if("Azure OpenAI"!==a.provider)return a.apiKey.length>5?{success:!0,message:`Connexion simul\xe9e pour ${a.provider} r\xe9ussie.`}:{success:!1,message:"Fournisseur non support\xe9 pour un test r\xe9el."};let{endpoint:b,apiVersion:c,deployment:d}=a;if(!b||!c||!d)return{success:!1,message:"Endpoint, API version et deployment sont requis pour Azure."};try{let b=mh(a);return await b.chat.completions.create({model:d,messages:[{role:"system",content:"Test connection."}],max_completion_tokens:5}),{success:!0,message:"Connexion \xe0 Azure OpenAI r\xe9ussie !"}}catch(b){let a=b instanceof Error?b.message:"Une erreur inconnue est survenue";if(a.includes("403")||a.includes("authentication"))return{success:!1,message:`Erreur d'authentification : ${a}. V\xe9rifiez que l'authentification par cl\xe9 API est activ\xe9e ou utilisez Entra ID.`};return{success:!1,message:`La connexion a \xe9chou\xe9 : ${a}`}}}async function mj(a){let b=[],{deployment:c}=a,d=a=>b.push(`[${new Date().toLocaleTimeString("fr-FR")}] ${a}`);d("D\xe9but du test de d\xe9bogage...");try{d("Initialisation du client AzureOpenAI...");let e=mh(a);d("Client initialis\xe9 avec succ\xe8s."),d("Envoi d'un message de test...");let f=await e.chat.completions.create({model:c,messages:[{role:"user",content:"Quelle est la capitale de la France ?"}],max_completion_tokens:50});if(d("R\xe9ponse re\xe7ue de l'API !"),f.choices&&f.choices.length>0){let a=f.choices[0],c=a.finish_reason;if(d(`Raison de la fin (finish_reason): ${c}`),"content_filter"===c)return d("\uD83D\uDD34 DIAGNOSTIC: Le filtre de contenu d'Azure a bloqu\xe9 la r\xe9ponse."),{success:!1,logs:b};if(a.message?.content)return b.push("--- D\xc9BUT DE LA R\xc9PONSE ---",a.message.content,"--- FIN DE LA R\xc9PONSE ---"),d(" TEST R\xc9USSI !"),{success:!0,logs:b}}return d(" AVERTISSEMENT: La structure de la r\xe9ponse est inattendue."),{success:!1,logs:b}}catch(c){d(" ERREUR CRITIQUE PENDANT L'APPEL API.");let a=c instanceof Error?c.message:"Erreur inconnue";return d(`Message: ${a}`),{success:!1,logs:b}}}async function mk(a,b,c){let d=[],e=a=>d.push(`[${new Date().toLocaleTimeString("fr-FR")}] ${a}`),f=performance.now();if(!a)throw Error("La question est vide.");let g=b.filter(a=>a.isValidated);if(0===g.length)throw Error("Aucun LLM n'a \xe9t\xe9 valid\xe9.");let h={question:a,status:"Refus\xe9e"},i="";switch(c.responseLength){case"Courte":i="Ta r\xe9ponse doit \xeatre tr\xe8s courte, concise, et ne faire que 1 \xe0 2 lignes au maximum.";break;case"Moyenne":i="Ta r\xe9ponse doit \xeatre de taille moyenne, entre 3 et 5 lignes.";break;case"Longue":i="Ta r\xe9ponse doit \xeatre longue, d\xe9taill\xe9e, et faire plus de 5 lignes."}let j="Fran\xe7ais"===c.language?"R\xe9ponds imp\xe9rativement et exclusivement en Fran\xe7ais.":"Answer imperatively and exclusively in English.",k=`Agissez en tant que : ${c.persona}. ${j} ${i} ${c.instructions}`;for(let b of g){let c=performance.now();e(`  [${b.provider}] D\xe9but du traitement.`);try{if("Google"===b.provider){let c=`https://generativelanguage.googleapis.com/v1beta/models/${b.model}:generateContent?key=${b.apiKey}`,d={contents:[{parts:[{text:k+"\n\n"+a}]}]};e(`  [${b.provider}] Envoi de la requ\xeate \xe0 l'API...`);let f=performance.now(),g=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),i=performance.now();if(e(`  [${b.provider}] R\xe9ponse re\xe7ue en ${Math.round(i-f)}ms.`),!g.ok){let a=await g.json();throw Error(`Erreur API Google: ${g.status} - ${a.error.message}`)}let j=await g.json(),l=j.candidates?.[0]?.content?.parts?.[0]?.text;j.promptFeedback?.blockReason?h[b.provider]=`ERREUR: Bloqu\xe9 par le filtre de contenu. Raison: ${j.promptFeedback.blockReason}`:l?(h[b.provider]=l,h.status="Valid\xe9e"):h[b.provider]="ERREUR: La r\xe9ponse de Google \xe9tait vide ou mal form\xe9e."}else{let c,d,f={messages:[{role:"system",content:k},{role:"user",content:a}]};switch(b.provider){case"Azure OpenAI":c=mh(b),d=b.deployment,f.max_completion_tokens=4096;break;case"OpenAI":c=new dr({apiKey:b.apiKey,timeout:6e4}),d="gpt-4o",f.max_tokens=4096;break;case"Anthropic":c=new dr({apiKey:b.apiKey,baseURL:"https://api.anthropic.com/v1",timeout:6e4,defaultHeaders:{"x-anthropic-version":"2023-06-01","max-tokens":"4096"}}),d="claude-3-opus-20240229",f.system=k,f.messages=[{role:"user",content:a}];break;case"Mistral":c=new dr({apiKey:b.apiKey,baseURL:"https://api.mistral.ai/v1",timeout:6e4}),d="mistral-large-latest",f.max_tokens=4096;break;default:h[b.provider]=`[Fournisseur non impl\xe9ment\xe9]`;continue}f.model=d,e(`  [${b.provider}] Envoi de la requ\xeate \xe0 l'API...`);let g=performance.now(),i=await c.chat.completions.create(f),j=performance.now();e(`  [${b.provider}] R\xe9ponse re\xe7ue en ${Math.round(j-g)}ms.`);let l=i.choices[0];l&&l.message?.content?(h[b.provider]=l.message.content,h.status="Valid\xe9e"):h[b.provider]=`ERREUR: R\xe9ponse vide. Raison: ${l?.finish_reason||"inconnue"}.`}}catch(c){let a=c instanceof Error?c.message:"Erreur inconnue";h[b.provider]=`ERREUR: ${a}`}let d=performance.now();e(`  [${b.provider}] Traitement termin\xe9 en ${Math.round(d-c)}ms.`)}let l=performance.now();return e(`Traitement total de la question termin\xe9 en ${Math.round(l-f)}ms.`),{result:h,logs:d}}d8("InteractiveBrowserCredential"),d8("DeviceCodeCredential"),d8("AzurePipelinesCredential"),d8("AuthorizationCodeCredential"),d8("OnBehalfOfCredential"),(0,c(40410).D)([mi,mj,mk]),(0,aN.A)(mi,"4077505fad787e7e08d33f9ed94e9c9d3f635581eb",null),(0,aN.A)(mj,"40872e551770e022325896aa5afeaa55e7ef5b1a6a",null),(0,aN.A)(mk,"700cf13863712079344a0b4e555b504e56b9b8a4aa",null)},98746:(a,b,c)=>{var d=c(74364).Buffer,e=c(94839),f=c(48604),g=c(27910),h=c(61626),i=c(28354),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function n(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function o(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function p(a){var b=(a=a||{}).secret;if(b=null==(b=null==b?a.publicKey:b)?a.key:b,!0===/^hs/i.test(a.algorithm)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=c,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(p,g),p.prototype.verify=function(){try{var a=n(this.signature.buffer,this.algorithm,this.key.buffer),b=o(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},p.decode=o,p.isValid=m,p.verify=n,a.exports=p}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[586,52],()=>b(b.s=25553));module.exports=c})();